!function(Q,O,K){"use strict";var R="ht";if(!Q[R]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),Q.performance&&Q.performance.now||function(){var f=Date.now();Q.performance||(Q.performance={}),Q.performance.now=function(){return Date.now()-f}}();for(var o=Date.now(),s=16,F=["ms","moz","webkit","o"],N=0;N<F.length&&!Q.requestAnimationFrame;++N)Q.requestAnimationFrame=Q[F[N]+"RequestAnimationFrame"],Q.cancelAnimationFrame=Q[F[N]+"CancelAnimationFrame"]||Q[F[N]+"CancelRequestAnimationFrame"];Q.requestAnimationFrame||(Q.requestAnimationFrame=function(Z){var l=Date.now(),g=s+o-l;return 0>g&&(g=0),o=l,Q.setTimeout(function(){o=Date.now(),Z(performance.now())},g)}),Q.cancelAnimationFrame||(Q.cancelAnimationFrame=function(T){return Q.clearTimeout(T)})}();var v,h,D,V,n=Q.document,E=null,b=Q[R]={},s=Q[R+"config"],y=b.Default=s&&s.Default||{},$=b.Style=s&&s.Style||{},w=b.Attr=s&&s.Attr||{},W=b.Color=s&&s.Color||{},m=b.IsGetter=s&&s.IsGetter||{},L=Math,U=L.round,r=L.floor,e=L.ceil,d=L.sqrt,M=L.max,i=L.min,a=L.abs,B=L.cos,N=L.acos,Y=L.sin,q=L.pow,x=L.asin,z=L.PI,I=2*z,T=z/2,g=L.tan,F=L.atan2,f=L.random,G=function(D,n,S){return Math.max(n,Math.min(S,D))},H=!1,A=!1,l=Q.parseInt||global.parseInt,C="2018-01-01",t=Q.navigator?Q.navigator.platform.indexOf("Win")>-1:!1,o=function(t){return t*t},_=Q.setTimeout,u=Q.clearTimeout,Z=Q.location,P=Q.navigator?Q.navigator.userAgent.toLowerCase():"",p=function(U){return U.test(P)},X=p(/msie/)||p(/trident/),j=p(/msie 10/),c=p(/edge/),J=p(/firefox/),S=p(/mac/),Ib=y.isTouchable===K?t?!1:n?"ontouchend"in n:!1:y.isTouchable,jl="default",$k="single",Yb="multiple",oh="front",_g="back",nl="left",yf="right",lf="top",ec="bottom",lm="center",Vp="eye",Wo="middle",Dp="east",im="west",wl="north",fj="none",pn="px",Oe="absolute",bb="border",Hn="triangle",qo="rect",Ei="circle",go="cylinder",np="shape",bn="items",Ek="normal",lb="remove",Wk="clear",gf="width",Of="height",cp="ingroup",Fn="check",Xh="uncheck",pk="radio",rc="radioOn",Ie="radioOff",kn="points",ch="values",cr="series",hq="body",Yk="label",Ye="label2",cd="note",fn="note2",Ai="icons",Kq="labelFont",Ji="labelColor",dc="labelSelectColor",br="note.expanded",vj="note2.expanded",Gp="edge.expanded",ss="edge.points",rk="edge.type",Ih="rotation",Sc="getRotation",es="setRotation",mb="hidden",oj="visible",$e="tuv",_i="no",Xf="draw",Th="select",zp="currentSubGraph",Xq="selectBackground",Yg="autoMakeVisible",yc="autoHideScrollBar",md="scrollBarColor",dj="scrollBarSize",Xl="indent",vn="rowHeight",Eo="columnLineColor",zi="rowLineColor",Rp="columnLineVisible",un="rowLineVisible",$q="visibleFunc",hr="expandIcon",og="collapseIcon",ni="checkMode",Cd="sortFunc",Gf="editable",yk="batchEditable",Ln="tristate",Qi="asc",pg="desc",ph="position",Wg="elevation",Zc="children",xd="translateX",Md="translateY",ck="dataModel",sb="maxSize",ub="shape3d",Mr="shape3d.resolution",nj="shape3d.visible",Oj="shape3d.from.visible",jk="shape3d.to.visible",Wl="shape3d.top.visible",pb="shape3d.bottom.visible",eh="repeat.uv.length",gp="serializeValue",Bd="deserializeValue",ao="centerUniform",Nm="rgba(255,255,255,0)",gc="style",Dn="attr",Ad="field",Ec="string",jr="boolean",Gl="color",lq="int",Uq="number",In="ew-resize",ce="ns-resize",yn="pointer",Mc="auto",ln="mousedown",Wj="mousemove",Ff="mouseup",dp="mouseout",Ac="touchstart",qe="touchmove",hm="touchend",Vg="keydown",zo="keyup",kf=J?"DOMMouseScroll":"mousewheel",ee=Ib?[Ac,qe,hm,Vg,zo,"keypress","input","contextmenu"]:[Vg,zo,"keypress","input",ln,Wj,Ff,dp,kf,"contextmenu","mouseenter","mouseleave","mouseover"],Yn=E,Hj=E,Gh=E,Sq=Ff.length,li=function(){Gh&&(u(Gh.timeout),Gh=E)},wq=function(){Gh&&ae(Gh.e,Gh.info)};Q.addEventListener&&(Ib||(Q.addEventListener(dp,function(){li()},!1),Q.addEventListener(kf,function(){Zm()},!1)),Q.addEventListener(zo,function(L){91===L.keyCode?Ho={}:delete Ho[L.keyCode]},!0),Q.addEventListener(Vg,function(S){Ho[S.keyCode]=!0},!0));var Wb,Zi,Ir,Ve=!1,oc=E,Fb=function(F,g){var z=_(function(){delete oc[z],jj(oc)&&(oc=E),F()},g);return z},Lp=E,co={},Ig={},ie={},Ip={},ai={},Ho={},lh={},sc={},Jb={},ue=/.json$/,uh=/^data:image\/svg\+xml/,Qb={},_e=[],fc={},sq=E,Il=E,Di=function(){},xf=function(){throw"Oops!"},os=[0,0,0],hj=[0,0,0,0],mr={x:0,y:0,width:0,height:0},Ql=E,dk=E,jq=E,ql=function(z){dk&&!z._72O&&(jq||(jq={}),jq[z._72O=Yj()]=z),Wb!=E?ug()<.05&&V&&!Zi&&(mh=li):mh=er},Kj=function(Q,Z,F,M){dk||(dk={});var L=dk[Q];if(L){if(L.url===Z)return;L.image?(L.image.onload=Di,L.image.onerror=Di):L.request&&(L.request.onload=Di,L.request.onerror=Di)}if(ue.test(Z)){var N=new XMLHttpRequest;if(dk[Q]={request:N,url:Z},N.overrideMimeType&&N.overrideMimeType("text/plain"),Z=y.beforeLoadURL(Z),Z.data){var R=y.parse(Z.data);bc(Q,R),y.handleImageLoaded(Q,R)}else N.open("GET",encodeURI(Z),!0),N.onload=function(D){if(200===this.status||0===this.status){var w=y.parse(D.target.response||D.target.responseText);bc(Q,w),y.handleImageLoaded(Q,w)}else bc(Q,y.handleUnfoundImage(Q,Z)||E)},N.onerror=function(){bc(Q,y.handleUnfoundImage(Q,Z)||E)},N.send(null)}else{var R=new Image;dk[Q]={image:R,url:Z},X&&(Z.toLowerCase().indexOf(".svg")>0||uh.test(Z))?(n.body.appendChild(R),R.style.visibility="hidden",R.onload=function(){_(function(){if(F&&(R.width=F),M&&(R.height=M),!R.width||!R.height){var d=R.width||R.clientWidth,J=R.height||R.clientHeight;R.width=d,R.height=J}y.handleImageLoaded(Q,R),bc(Q,R),n.body.removeChild(R),R.style.visibility=""},180)},R.onerror=function(){bc(Q,y.handleUnfoundImage(Q,Z)||E),n.body.removeChild(R),R.style.visibility=""}):(R.onload=function(){F&&(R.width=F),M&&(R.height=M),y.handleImageLoaded(Q,R),bc(Q,R)},R.onerror=function(){bc(Q,y.handleUnfoundImage(Q,Z)||E)}),/^data:image/.test(Z)||(Z=y.beforeLoadURL(Z),/^data:image/.test(Z)||(Z=y.appendTimeStamp(Z),Z=encodeURI(Z))),R.src=Z}},bc=function(Y,c){if(Ig[Y]=c,delete dk[Y],jj(dk)&&(dk=E,jq)){for(var g in jq){var q=jq[g];q._2O&&(q._2O={}),q.invalidateAll&&q.invalidateAll(K,"imageLoaded",Y),q.redraw&&q.redraw(),q.iv(),delete q._72O}jq=E}if(c&&jq)for(var g in jq){var q=jq[g];q.invalidateAll&&q.invalidateAll(K,"imageLoading",Y),q.redraw&&q.redraw(),q.iv()}},fp=function(){return Q.performance&&Q.performance.now?Q.performance.now():Date.now()},So=function(b,v){v?u(b):Q.cancelAnimationFrame(b)},Bs=function(y,W,c){return{width:y,height:W,comps:_n(c)?c:[c]}},Xk=function(N,I){return{type:Ei,rect:[N,I,1.6,1.6],borderWidth:1,borderColor:Yd,gradient:lg,gradientColor:ip,background:Yd}},No=function(t,G){return Bs(16,16,{type:Hn,rect:[4,4,10,8],background:t,rotation:G?1.57:3.14})},_q=function(O,w){return Bs(16,16,{type:Hn,rect:[4,4,8,7],background:O,rotation:w?3.14:0})},Pl=function(U){var u=U._orientation;return"horizontal"===u||"h"===u},Ar=function(W){var C=E||4,k=E||1,d=E||1;0>C?C=0:C>.25&&(C=.25);var v,j,x,H,T,M,S,f=.5,p=[],Z=[],O=[],s=I/d,K=I/k,l=f-C;for(j=0;k>=j;j++)for(H=-z+j*K,M=B(H),T=Y(H),v=0;d>=v;v++)x=v*s,S=l+C*M,p.push(B(x)*S,T*C,-Y(x)*S),(h=W)&&Z.push(v/d,1-j/k);for(j=0;k>j;j++){var q=j*(d+1),J=(j+1)*(d+1);for(v=0;d>v;v++)O.push(q+v,J+v+1,J+v,q+v,q+v+1,J+v+1),Dh.z=ar.z=W}},Wi=function(G){var C=2,E=0;for(var c in G)c.length===C&&l(c,32)===jc&&(sq=Il=G[c]),E++;return E},gb=function(q,B,k,Z){return k||(k=Ib?5:3,k/=Z||1),{x:q-k,y:B-k,width:2*k,height:2*k}},Cb=function(C,e,q,I){var o=this;e||(e=Ib?5:3,q=20,I=20);var f={x:C,y:e,width:q,height:I};if(q)for(var A=0;q>A;A++)if(3===q)I=20;else for(var w=0;I>w;w++)o=Q?Q:q;var H={x:z,y:2*z};if(Jd(f,H)){var S=Of[0]+lf[0]+Wk[1];tn[Vp]=o[S],o[S]=wd[Vp]}},sg=function(U){return(/ble$/.test(U)||/ed$/.test(U)||m[U]?"is":"get")+U.charAt(0).toUpperCase()+U.slice(1)},wd=function(d){return"set"+d.charAt(0).toUpperCase()+d.slice(1)},Xr=function(h){return typeof h===Ec||h instanceof String},ve=function(G){return typeof G===Uq},er=function(v){return typeof v===jr},ki=function(n){return n&&"object"==typeof n},hl=function(n){return"function"==typeof n},_n=function(U){return U instanceof Array},Tc=function(X){return X instanceof Km},ol=function(Y){return _n(Y)?new Km(Y):Y},Or=function(i){return i instanceof yj},gl=function(e){return e instanceof zf},Sd=function(y){return y instanceof $p},xo=function(r,e){if(!(r instanceof b.Group))return!1;if(!e)return r.isExpanded();var c=e.getDataUI(r);return c&&c._88I?!0:!1},Sm=function(Q){return Q instanceof ff},Hb=function(u){return u&&"IFRAME"===u.tagName},uq=function(R){return R==E||y.numberDigits==E?R:parseFloat(R.toFixed(y.numberDigits))},vp=function(b,A,T){var u,I=A.length;if(T)for(var Z=0;T>Z;Z++)if(3===I)b.push(A[0]),b.push(A[1]),b.push(A[2]);else for(u=0;I>u;u++)b.push(A[u]);else if(3===I)b.push(A[0]),b.push(A[1]),b.push(A[2]);else for(u=0;I>u;u++)b.push(A[u])},zn=function(O){return O?ki(O)?O:{}:!1},Jn=function(I,B,m){var i,D=ki(I)?I:I.prototype;for(i in B)m&&D[i]!==K||(D[i]=B[i]);return I},po=function(i){return String.fromCharCode(i)},ne=function(C){for(var d,n=0,A="";n<C.length;n++)d=C[C.length-1-n],"%"===d?d="'":"a"===d?d='"':"]"===d&&(d="\\"),A+=po(d.charCodeAt(0)-1);return A},hi=function(w,O,P){w.superClass.constructor.apply(O,P)},jj=function(f){for(var i in f)return!1;return!0},Zq=function(Z){return Z?0===Z.length:!0},Al=function(h,g){return h===g?!0:h.x===g.x&&h.y===g.y&&h.width===g.width&&h.height===g.height},Kn=function(m,Z,b){return Z>m?Z:m>b?b:m},ed=function(X){return 0>X?-1:X>0?1:0},ug=function(){var R=1e4*Y(Sq++);return R-r(R)},Vb=function(j,N,W){return od(j.x,j.y,N.x,N.y,W.x,W.y,W.x+W.width,W.y,!0)||od(j.x,j.y,N.x,N.y,W.x+W.width,W.y,W.x+W.width,W.y+W.height,!0)||od(j.x,j.y,N.x,N.y,W.x+W.width,W.y+W.height,W.x,W.y+W.height,!0)||od(j.x,j.y,N.x,N.y,W.x,W.y+W.height,W.x,W.y,!0)},od=function(q,U,F,c,V,$,Z,v,I){var h=(Z-V)*(U-$)-(v-$)*(q-V),J=(v-$)*(F-q)-(Z-V)*(c-U);if(0!==J){var P=h/J,d=q+P*(F-q),o=U+P*(c-U);return I&&(d+je<i(q,F)||d-je>M(q,F)||d+je<i(V,Z)||d-je>M(V,Z)||o+je<i(U,c)||o-je>M(U,c)||o+je<i($,v)||o-je>M($,v))?E:[d,o]}return E},tj=function(b,I,Y){if(b&&Y)if(I){if(I===gc)return b.getStyle(Y);if(I===Dn)return b.getAttr(Y);if(I===Ad)return b[Y]}else if(Y=sg(Y),b[Y])return b[Y]();return K},yb=function(w,I,P,U){if(w&&P)if(I){if(I===gc)w.s(P,U);else if(I===Dn)w.a(P,U);else if(I===Ad){var R=w[P];w[P]=U,w.fp("f:"+P,R,U)}}else P=wd(P),w[P]&&w[P](U)},qg=function(b,I,d){return I&&"top"!==I?"bottom"===I?{x:b.x,y:b.y,width:b.width,height:b.height*d}:"right"===I?{x:b.x,y:b.y,width:b.width*d,height:b.height}:"left"===I?{x:b.x+b.width*(1-d),y:b.y,width:b.width*d,height:b.height}:void 0:{x:b.x,y:b.y+b.height*(1-d),width:b.width,height:b.height*d}},Np=function(n,w,$,V,k){w&&an(n,$,V,1,k,w)},kr=function(R,u,z,w){var e=1-R;return e*e*u+2*R*e*z+R*R*w},Dh=function(l,d,K,p,C){var q=1-l;return q*q*q*d+3*q*q*l*K+3*q*l*l*p+l*l*l*C},vh=function(L){var r,e,d,U,O=0;return L.forEach(function(D){if(r=D.length,r>0)for(e=D[0],U=1;r>U;U++)d=D[U],O+=tm(e,d),e=d}),O},Ti=function($,k,T){var _="__"+$,a=function(d){T.interactiveDisabled||T["handle_"+$](d)};T[_]||(T[_]=a,k.addEventListener($,a,!1))},Fj=function(b,u,m){var O="__"+b,X=m[O];X&&(u.removeEventListener(b,X,!1),delete m[O])},bf=function(Z,R){var w="_"+R;Z[sg(R)]=function(){return this[w]},Z[wd(R)]=function(y){var r=this[w];this[w]=y,this.fp(R,r,y)}},qp=function(R){return O.create(R)},Jk=function(n){if(!n.element){var B,N;(B=n.textField)?N=Vo(bs.TextField,B):(B=n.textArea)?N=Vo(bs.TextArea,B):(B=n.button)?N=Vo(bs.Button,B):(B=n.comboBox)?N=Vo(bs.ComboBox,B):(B=n.checkBox)?N=Vo(bs.CheckBox,B):(B=n.radioButton)?N=Vo(bs.RadioButton,B):(B=n.slider)?N=Vo(bs.Slider,B):(B=n.colorPicker)?N=Vo(bs.ColorPicker,B):(B=n.image)&&(N=Vo(bs.Image,B)),N&&(n.element=N)}},sj=function(M,j){var C=hc(M);return C._ht=j,C},hc=function(T,m){var J=n.createElement("div"),v=J.style;return J.tabIndex=-1,J.onkeydown=Gm,v.msTouchAction=fj,Vq(J,E,0),Ib&&v.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",E),T&&(v.overflow=mb),m&&mc(m,J),J},iq=function(f,X){var z=n.createElement("canvas"),P=z.style;return P.msTouchAction=fj,X||(P.pointerEvents=fj),Vq(z,E,0),f&&mc(f,z),z},Vq=function(Y,M,P){var S=Y.style;S.border=M?M+" solid 1px":0,S.outline=0,S.padding=P?"0 "+P+pn:0,qq(Y)},qq=function(i){var z=i.style;z.position=Oe,z.margin=0,z.setProperty("box-sizing","border-box",E),z.setProperty("-moz-box-sizing","border-box",E)},ob=function(q,i,H,L){L||(L=to),i!=E&&(q.width=i*L,q.style.width=i+pn),H!=E&&(q.height=H*L,q.style.height=H+pn)},mc=function(e,F,s){e.appendChild(F),s&&(F.style.position=Oe)},Sj=function(l,O){O.split||(O+="");for(var n,Z=O.split("\n"),G=0,x=Z.length,C=0;x>C;C++){var r=wr(l.font,Z[C]);r.width>G&&(G=r.width),n||(n=r.height)}return l.ss=Z,{width:G,height:n*x}},Ug=function(u,k,h,b,x,M){var F=k.length;if(1===F)Yi(u,k[0],h,b,x);else for(var m=h.height/F,r={x:h.x,y:h.y,width:h.width,height:m},U=0;U<k.length;U++)M?$c(u,k[U],b,x,r.x,r.y,r.width,r.height,M):Yi(u,k[U],r,b,x),r.y+=m},Yi=function(Q,Z,f,m,t){Q.font=m?m:vm,Q.fillStyle=t?t:lk,Q.textAlign=lm,Q.textBaseline=Wo;var D,N;f?f.width===K?(D=f.x,N=f.y):(D=f.x+f.width/2,N=f.y+f.height/2):(D=0,N=0),Q.fillText(Z,U(D),U(N))},ag=function(N){N.getView&&(N=N.getView());var h=N.offsetWidth||N.scrollWidth;return!h&&N.style.width&&(h=l(N.style.width)),h},ll=function(j){j.getView&&(j=j.getView());var x=j.offsetHeight||j.scrollHeight;return!x&&j.style.height&&(x=l(j.style.height)),x},dn=function(){var A=function(b){Gm(b),b.stopPropagation()},e=Ib?[Ac]:[Vg,ln,kf];return function(O){var Q=hc(),Z=Q.style;return Z.backgroundColor=y.disabledBackground,O&&(Z.backgroundImage="url("+O+")",Z.backgroundPosition="50% 50%",Z.backgroundRepeat="no-repeat no-repeat"),e.forEach(function(z){Q.addEventListener(z,A)}),Q}}(),$l=function(l){var L=l.getContext("2d");return L.save(),L.lineCap=Kc,L.lineJoin=Rm,L},mh=function(G,W,O,S){lp(G,W*to,O*to),S*=to,1!==S&&G.scale(S,S)},lp=function($,u,q){$.translate(u,q)},Kh=function(n,c){c&&n.rotate(c)},Ph=function(i,B,g){B===K&&(B=1),g===K&&(g=1),(1!==B||1!==g)&&i.scale(B,g)},Rg=function(u){var f=n.activeElement;if(n.activeElement!==u){f&&f.forceOnblur&&f.forceOnblur();for(var s=[],a=u.parentNode;a;)s.push([a,a.scrollLeft,a.scrollTop]),a=a.parentNode;if(Ib)u.focus();else{var I=xl(),P=I.target;u.focus(),P.scrollLeft=I.left,P.scrollTop=I.top}s.forEach(function(H){H[0].scrollLeft=H[1],H[0].scrollTop=H[2]})}},Tf=function(E){return E&&E.getView?E.getView():E},qh=function(o,I,r,S,O){if(2===arguments.length&&(r=I.y,S=I.width,O=I.height,I=I.x),o.isSelfViewEvent)o.setX(I),o.setY(r),o.setWidth(S),o.setHeight(O);else{var G=Tf(o),Z=G.style;if((n.fullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement||n.msFullscreenElement)!==G)I!==K&&(Z.left=I+pn),r!==K&&(Z.top=r+pn),S!==K&&(Z.width=S+pn),O!==K&&(Z.height=O+pn);else{var f=y.getWindowInfo();Z.left=(I=f.left)+pn,Z.top=(r=f.top)+pn,Z.width=(S=f.width)+pn,Z.height=(O=f.height)+pn}o.endEditing&&!Ib&&o.endEditing(),o.redraw&&o.redraw(),o.invalidate&&o.invalidate(),o.onLayouted&&o.onLayouted(I,r,S,O),o.fireViewEvent&&o.fireViewEvent("layout")}},Ur=function(q){if(!q.touches)return q;var B=q.touches[0];return B?B:q.changedTouches[0]},Bo=function(U){return Ib?Ur(U).target:U.target},Gd=function(p){y.popup&&y.popup.close(),y.popup=p},tk=E,Yl=function(O){tk.handleWindowTouchMove(O)},Ok=function(t){tk.handleWindowTouchEnd(t),Q.removeEventListener(qe,Yl,!1),Q.removeEventListener(hm,Ok,!1),tk=E},bl=function(L){tk.handleWindowMouseMove(L)},ro=function(n){tk.handleWindowMouseUp(n),Q.removeEventListener(Wj,bl,!1),Q.removeEventListener(Ff,ro,!1),tk=E},he=function(C){return 1===Eg(C)},tg=function(S,r){return r?r.keyCode===S:Ho[S]},Mq=function(T){return xi(T)&&tg(65,T)},bi=function(p){return tg(46,p)||tg(8,p)},Pq=function(J){return function(u){return u?u.keyCode===J:Ho[J]}},jc=573,Pe=[65,83,68,87,37,38,39,40,32,13,27],jp=Pq(Pe[0]),Ko=Pq(Pe[1]),Hd=Pq(Pe[2]),sp=Pq(Pe[3]),Yf=Pq(Pe[4]),dh=Pq(Pe[5]),nb=Pq(Pe[6]),Kr=Pq(Pe[7]),kp=Pq(Pe[8]),Im=Pq(Pe[9]),Xm=Pq(Pe[10]),Vd={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},xe=[2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,5,5,5,5,5,487],cj=E,Eb=E,Ym=function(q,E){cj||(cj=iq()),ob(cj,q,E,1);var n=$l(cj);return n.clearRect(0,0,q,E),n},ye=function(){var j,O={};return function(i){var l,Y=O[i];return Y||(j||(j=iq(),ob(j,1,1,1)),l=j.getContext("2d"),l.clearRect(0,0,1,1),an(l,0,0,1,1,i),Y=l.getImageData(0,0,1,1).data,Y=O[i]=[Y[0],Y[1],Y[2],Y[3]]),Y}}(),pe=function(h){if(!Xr(h))return h;var Y=ye(h);return Y.CA||(Y.CA=[Y[0]/255,Y[1]/255,Y[2]/255,Y[3]/255]),Y.CA},En=function(R,V,b,K,D){var z=iq();z.width=b,z.height=K;var L=z.getContext("2d");L.drawImage(R,0,0,b,K);try{for(var o=L.getImageData(0,0,b,K),v=o.data,$=0,l=v.length;l>$;$+=4){var d=v[$+0],I=v[$+1],X=v[$+2],T=v[$+3];"override_a"===D?v[$+3]=255*V[3]:"override_rgb"===D?(v[$+0]=255*V[0],v[$+1]=255*V[1],v[$+2]=255*V[2]):"override"===D?(v[$+0]=255*V[0],v[$+1]=255*V[1],v[$+2]=255*V[2],v[$+3]=255*V[3]):(v[$+0]=V[0]*d,v[$+1]=V[1]*I,v[$+2]=V[2]*X,v[$+3]=V[3]*T)}L.putImageData(o,0,0)}catch(g){return R}return z},tn=function(j,e,f){return e&&(e="miter"===f?8*e+20:e+1,j&&is(j,e)),e},Qm=function(N,m){if(m){var l=new fs(m),O=N.width/2,T=N.height/2,$=wf([l.tf(-O,-T),l.tf(O,-T),l.tf(O,T),l.tf(-O,T)]);return $.x+=N.x+O,$.y+=N.y+T,$}return N},sk=function(N,P,w,m,V,K,e,g){m*=Math.PI/180;var x={x:Math.cos(m)*(N.x-e.x)/2+Math.sin(m)*(N.y-e.y)/2,y:-Math.sin(m)*(N.x-e.x)/2+Math.cos(m)*(N.y-e.y)/2},H=Math.pow(x.x,2)/Math.pow(P,2)+Math.pow(x.y,2)/Math.pow(w,2);H>1&&(P*=Math.sqrt(H),w*=Math.sqrt(H));var B=(V==K?-1:1)*Math.sqrt((Math.pow(P,2)*Math.pow(w,2)-Math.pow(P,2)*Math.pow(x.y,2)-Math.pow(w,2)*Math.pow(x.x,2))/(Math.pow(P,2)*Math.pow(x.y,2)+Math.pow(w,2)*Math.pow(x.x,2)));isNaN(B)&&(B=0);var $={x:B*P*x.y/w,y:B*-w*x.x/P},A={x:(N.x+e.x)/2+Math.cos(m)*$.x-Math.sin(m)*$.y,y:(N.y+e.y)/2+Math.sin(m)*$.x+Math.cos(m)*$.y},Q=function(K){return Math.sqrt(Math.pow(K[0],2)+Math.pow(K[1],2))},s=function(u,j){return(u[0]*j[0]+u[1]*j[1])/(Q(u)*Q(j))},F=function(m,g){return(m[0]*g[1]<m[1]*g[0]?-1:1)*Math.acos(s(m,g))},k=F([1,0],[(x.x-$.x)/P,(x.y-$.y)/w]),X=[(x.x-$.x)/P,(x.y-$.y)/w],T=[(-x.x-$.x)/P,(-x.y-$.y)/w],Y=F(X,T);s(X,T)<=-1&&(Y=Math.PI),s(X,T)>=1&&(Y=0);var s=P>w?P:w,Z=P>w?1:P/w,d=P>w?w/P:1;if(null==g){var C={x:0,y:0,width:0,height:0};is(C,s),C.x*=Z,C.width*=Z,C.y*=d,C.height*=d;var i=new fs(m);return C=wf([i.tf(C.x,C.y),i.tf(C.x+C.width,C.y),i.tf(C.x+C.width,C.y+C.height),i.tf(C.x,C.y+C.height)]),C.x+=A.x,C.y+=A.y,[{x:C.x,y:C.y},{x:C.x+C.width,y:C.y},{x:C.x+C.width,y:C.y+C.height},{x:C.x,y:C.y+C.height}]}g.translate(A.x,A.y),g.rotate(m),g.scale(Z,d),g.arc(0,0,s,k,k+Y,1-K),g.scale(1/Z,1/d),g.rotate(-m),g.translate(-A.x,-A.y)},si=function(D,M){D&&D.beginPath();for(var X,V,i,u=[],q=function(J){for(var r,P=/(\-{0,1}[\d\.]+)/gi,S=[];r=P.exec(J);)S.push(parseFloat(r[0]));return S},x=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,e={x:0,y:0};X=x.exec(M);){var S=X[0],y=S.substr(0,1);if("M"===y||"m"===y){for(var R=q(S),j=0;j<R.length;j+=2){var H=R[j],F=R[j+1];"m"===y&&(H+=e.x,F+=e.y),D&&D.moveTo(H,F),u.push({x:H,y:F}),e.x=H,e.y=F}V=i=null}else if("H"===y||"h"===y){for(var R=q(S),j=0;j<R.length;j+=1){var H=R[j];"h"===y&&(H+=e.x),D&&D.lineTo(H,e.y),u.push({x:H,y:e.y}),e.x=H}V=i=null}else if("C"===y||"c"===y){for(var R=q(S),j=0;j<R.length;j+=6){var G=R[j],$=R[j+1],Y=R[j+2],Z=R[j+3],H=R[j+4],F=R[j+5];"c"===y&&(G+=e.x,$+=e.y,Y+=e.x,Z+=e.y,H+=e.x,F+=e.y),D&&D.bezierCurveTo(G,$,Y,Z,H,F),u.push({x:G,y:$}),u.push({x:Y,y:Z}),u.push({x:H,y:F}),e.x=H,e.y=F}V=[G,$,Y,Z,H,F],i=null}else if("S"===y||"s"===y){for(var R=q(S),j=0;j<R.length;j+=4){var G,$;V?(G=2*V[4]-V[2],$=2*V[5]-V[3]):(G=e.x,$=e.y);var Y=R[j],Z=R[j+1],H=R[j+2],F=R[j+3];"s"===y&&(Y+=e.x,Z+=e.y,H+=e.x,F+=e.y),D&&D.bezierCurveTo(G,$,Y,Z,H,F),u.push({x:G,y:$}),u.push({x:Y,y:Z}),u.push({x:H,y:F}),e.x=H,e.y=F}V=[G,$,Y,Z,H,F],i=null}else if("Q"===y||"q"===y){for(var R=q(S),j=0;j<R.length;j+=4){var G=R[j],$=R[j+1],H=R[j+2],F=R[j+3];"q"===y&&(G+=e.x,$+=e.y,H+=e.x,F+=e.y),D&&D.quadraticCurveTo(G,$,H,F),u.push({x:G,y:$}),u.push({x:H,y:F}),e.x=H,e.y=F}V=null,i=[G,$,H,F]}else if("T"===y||"t"===y){for(var R=q(S),j=0;j<R.length;j+=2){var G,$;i?(G=2*i[2]-i[0],$=2*i[3]-i[1]):(G=e.x,$=e.y);var H=R[j],F=R[j+1];"t"===y&&(H+=e.x,F+=e.y),D&&D.quadraticCurveTo(G,$,H,F),u.push({x:G,y:$}),u.push({x:H,y:F}),e.x=H,e.y=F}V=null,i=[G,$,H,F]}else if("V"===y||"v"===y){for(var R=q(S),j=0;j<R.length;j+=1){var F=R[j];"v"===y&&(F+=e.y),D&&D.lineTo(e.x,F),u.push({x:e.x,y:F}),e.y=F}V=i=null}else if("L"===y||"l"===y){for(var R=q(S),j=0;j<R.length;j+=2){var H=R[j],F=R[j+1];"l"===y&&(H+=e.x,F+=e.y),D&&D.lineTo(H,F),u.push({x:H,y:F}),e.x=H,e.y=F}V=i=null}else if("A"===y||"a"===y){for(var R=q(S),j=0;j<R.length;j+=7){var E=R[j],P=R[j+1],b=R[j+2],d=R[j+3],k=R[j+4],H=R[j+5],F=R[j+6];"a"===y&&(H+=e.x,F+=e.y);var B=sk(e,E,P,b,d,k,{x:H,y:F},D);B&&(u=u.concat(B)),e.x=H,e.y=F}V=i=null}var w=S.substr(S.length-1);("z"===w||"Z"===w)&&D&&D.closePath()}return u},Hf=function(U,O){var T,e,k="L"===O[0],o=O.length;for(U.save(),k?(U.transform(O[5],O[6],O[7],O[8],O[9],O[10]),T=U.createLinearGradient(O[1],O[2],O[3],O[4]),e=11):(U.transform(O[7],O[8],O[9],O[10],O[11],O[12]),T=U.createRadialGradient(O[1],O[2],O[3],O[4],O[5],O[6]),e=13);o>e;)T.addColorStop(O[e],O[e+1]),e+=2;U.fillStyle=T},ar=function(d,l){var C,i,A,e,g,R,O,w,F,J,N,z,V,X="L"===d[0];C=X?5:7,i=d[C],A=d[C+1],e=d[C+2],g=d[C+3],R=d[C+4],O=d[C+5],w=l[0],F=l[1],J=l[2],N=l[3],z=l[4],V=l[5],d[C]=w*i+J*A,d[C+1]=F*i+N*A,d[C+2]=w*e+J*g,d[C+3]=F*e+N*g,d[C+4]=w*R+J*O+z,d[C+5]=F*R+N*O+V},Eh=function(Q,N,L,m){var c=!1;if(Q.beginPath?Q.beginPath():c=!0,Tc(N)&&(N=N._as),Tc(L)&&(L=L._as),L&&L.length){for(var s,$,t,G,C=0,D=0,_=L.length;_>D;D++)s=L[D],1===s?($=N[C++],Q.moveTo($.x,c?-$.y:$.y)):2===s?($=N[C++],Q.lineTo($.x,c?-$.y:$.y)):3===s?($=N[C++],t=N[C++],Q.quadraticCurveTo($.x,c?-$.y:$.y,t.x,c?-t.y:t.y)):4===s?($=N[C++],t=N[C++],G=N[C++],Q.bezierCurveTo($.x,c?-$.y:$.y,t.x,c?-t.y:t.y,G.x,c?-G.y:G.y)):5===s&&Q.closePath();m&&5!==s&&Q.closePath()}else{var A,f,i,p=N.length;if(p>0){for(A=N[0],Q.moveTo(A.x,c?-A.y:A.y),f=1;p>f;f++)i=N[f],Q.lineTo(i.x,c?-i.y:i.y);m&&Q.closePath()}}},dd=function(q,a,g,m){if(Tc(q)&&(q=q._as),Tc(a)&&(a=a._as),a&&a.length){g=g||gh;for(var _,T,f,w,e,W,n,j,M=[],D=E,s=0,O=0,X=a.length;X>O;O++)if(_=a[O],1===_)M.push(D=[]),D.push(q[s++]);else if(2===_)D.push(q[s++]);else if(3===_){for(T=D[D.length-1],f=q[s++],w=q[s++],W=1;g>W;W++)n=kr(W/g,T.x,f.x,w.x),j=kr(W/g,T.y,f.y,w.y),D.push({x:n,y:j,b:!0});D.push(w)}else if(4===_){for(T=D[D.length-1],f=q[s++],w=q[s++],e=q[s++],W=1;g>W;W++)n=Dh(W/g,T.x,f.x,w.x,e.x),j=Dh(W/g,T.y,f.y,w.y,e.y),D.push({x:n,y:j,b:!0});D.push(e)}else 5===_&&D.push(D[0]);return m&&5!==_&&D&&D.length>2&&D.push(D[0]),M}return m&&q.length>2&&(q=q.slice(),q.push(q[0])),q?[q]:[]},Hq=function(J,W,d,N,A,X){var c,h,T,o=ye(W),R=N,C=o[0],l=o[1],k=o[2];if(d){var B=ye(d);c=B[0]-C,h=B[1]-l,T=B[2]-k}else c=255-C,h=255-l,T=255-k;for(X||(X=N>10?1:.5,X=1>A?i(X/A,2):X);(N-=X)>0;){var f=1-N/R,v=C+c*f,G=l+h*f,V=k+T*f;v=i(e(v),255),G=i(e(G),255),V=i(e(V),255),J.strokeStyle="rgb("+v+","+G+","+V+")",J.lineWidth=N,J.stroke()}},Vm=function(){var C={};return function(J,D){var K=J+"-"+D,L=C[K];if(L)return L;var X,O,w,j=ye(J);return 0>D?(D=(100+D)/100,X=e(j[0]*D),O=e(j[1]*D),w=e(j[2]*D)):(D/=100,X=j[0],O=j[1],w=j[2],X+=(255-X)*D,O+=(255-O)*D,w+=(255-w)*D,X=i(e(X),255),O=i(e(O),255),w=i(e(w),255)),C[K]="rgb("+X+","+O+","+w+")"}}(),an=function(j,D,B,U,p,u){u&&(j.fillStyle=u),j.beginPath(),j.rect(D,B,U,p),j.fill()},mn=function(Z,W,M,T,C,z,o){Z.beginPath(),nr[W](Z,M.x,M.y,M.width,M.height,T,C,z,o)},Bf=function(U,W,w,_,X){var e=nr[w];U.fillStyle=e?e(U,W,_?_:ip,X.x,X.y,X.width,X.height):W},Qe=function(L,J,q,$,B,S){try{if(!J.tagName&&J.comps){J._cacheImage_||(J._cacheImage_={});var h;h="override"===$?"colors_override":"override_rgb"===$?"colors_override_rgb":"override_a"===$?"colors_override_a":"colors",J._cacheImage_[h]||(J._cacheImage_[h]={__count__:0});var z=J._cacheImage_[h][q];z||(J._cacheImage_[h].__count__>y.imageCacheThreshold&&(J._cacheImage_[h]={__count__:0}),z=b.Default.toCanvas(J,Oh(J),Lk(J),null,B,S,q,null,$),J._cacheImage_[h][q]=z,J._cacheImage_[h].__count__++),J=z}L.fillStyle=L.createPattern(J,"repeat")}catch(x){L.fillStyle="black"}},uo=function(T,X,A,K,z,r,m){T.save(),T.translate(X,A),T.scale(1,m/r),T.arc(0,0,r,K,z),T.restore()},vc=function(Q,s,N,l,h,P,W,E){var d,X,m,o,U,R,w,j,c,k,G;if(a(h)>2*z&&(h=2*z),U=e(a(h)/(z/4)),d=h/U,X=-d,m=-l,U>0){R=s+B(l)*P,w=N+Y(-l)*W,E?Q.lineTo(R,w):Q.moveTo(R,w);for(var b=0;U>b;b++)m+=X,o=m-X/2,j=s+B(m)*P,c=N+Y(m)*W,k=s+B(o)*(P/B(X/2)),G=N+Y(o)*(W/B(X/2)),Q.quadraticCurveTo(k,G,j,c)}},Gb=function(G,D,E,i,e,b,R,q,X){6===arguments.length&&(R=b,q=b,X=b);var K=D+i,c=E+e,Q=e>i?2*i:2*e;b=Q>b?b:Q,R=Q>R?R:Q,q=Q>q?q:Q,X=Q>X?X:Q;var x=.29*X,z=.58*X;G.moveTo(K,c-X),G.quadraticCurveTo(K,c-z,K-x,c-x),G.quadraticCurveTo(K-z,c,K-X,c),x=.29*q,z=.58*q,G.lineTo(D+q,c),G.quadraticCurveTo(D+z,c,D+x,c-x),G.quadraticCurveTo(D,c-z,D,c-q),x=.29*b,z=.58*b,G.lineTo(D,E+b),G.quadraticCurveTo(D,E+z,D+x,E+x),G.quadraticCurveTo(D+z,E,D+b,E),x=.29*R,z=.58*R,G.lineTo(K-R,E),G.quadraticCurveTo(K-z,E,K-x,E+x),G.quadraticCurveTo(K,E+z,K,E+R),G.lineTo(K,c-X)},Wn=function(s,m,S,t,H,h,z){m&&(S=U(S),t=U(t),z||(z=1),s.fillStyle=m,s.beginPath(),s.rect(S,t,z,h),s.rect(S,t,H,z),s.rect(S,t+h-z,H,z),s.rect(S+H-z,t,z,h),s.fill())},ah=function(z,k,Z,R){var S=R.x,f=R.y,A=R.width,v=R.height;if(!(!k||!Z||0>=A||0>=v)){var M,y=Kp(k),q=Be(k),X=Z>0;1===Z||-1===Z?(z.fillStyle=X?y:q,z.beginPath(),z.rect(S,f,1,v),z.rect(S,f,A,1),z.fill(),z.fillStyle=X?q:y,z.beginPath(),z.rect(S,f+v-1,A,1),z.rect(S+A-1,f,1,v),z.fill()):(Z=i(a(Z),i(A/2,v/2)),M=z.createLinearGradient(S,f,S+Z,f),M.addColorStop(0,X?y:q),M.addColorStop(1,k),z.fillStyle=M,z.beginPath(),z.moveTo(S,f),z.lineTo(S+Z,f+Z),z.lineTo(S+Z,f+v-Z),z.lineTo(S,f+v),z.lineTo(S,f),z.fill(),M=z.createLinearGradient(S,f,S,f+Z),M.addColorStop(0,X?y:q),M.addColorStop(1,k),z.fillStyle=M,z.beginPath(),z.moveTo(S,f),z.lineTo(S+Z,f+Z),z.lineTo(S+A-Z,f+Z),z.lineTo(S+A,f),z.lineTo(S,f),z.fill(),M=z.createLinearGradient(S,f+v,S,f+v-Z),M.addColorStop(0,X?q:y),M.addColorStop(1,k),z.fillStyle=M,z.beginPath(),z.moveTo(S,f+v),z.lineTo(S+Z,f+v-Z),z.lineTo(S+A-Z,f+v-Z),z.lineTo(S+A,f+v),z.lineTo(S,f+v),z.fill(),M=z.createLinearGradient(S+A,f,S+A-Z,f),M.addColorStop(0,X?q:y),M.addColorStop(1,k),z.fillStyle=M,z.beginPath(),z.moveTo(S+A,f),z.lineTo(S+A-Z,f+Z),z.lineTo(S+A-Z,f+v-Z),z.lineTo(S+A,f+v),z.lineTo(S+A,f),z.fill())}},Lo=function(k,b,D,F,K,s,z){var w=k.createLinearGradient(F,K,s,z);return w.addColorStop(0,D),w.addColorStop(1,b),w},Uo=function(W,k,Z,c,d,D,B){var e=W.createLinearGradient(c,d,D,B);return e.addColorStop(0,k),e.addColorStop(.5,Z),e.addColorStop(1,k),e},Fh=function(t,z,I,H,K,D,l){var F=t.createLinearGradient(H,K,D,l);return F.addColorStop(0,z),F.addColorStop(1/3,I),F.addColorStop(2/3,z),F.addColorStop(1,I),F},Lh=function(m,P,d,$,o,V,Z,z,D){var W=m.createRadialGradient($+V*z,o+Z*D,i(V,Z)/24,$+V/2,o+Z/2,M(V,Z)/2);return W.addColorStop(0,d),W.addColorStop(1,P),W},nr={polygon:function(Z,y,r,q,H,G){(G==E||3>G)&&(G=6);for(var b,t,$=i(q,H)/2,F=y+q/2,L=r+H/2,u=0,o=2*z/G,s=0;G>s;s++)b=F+B(u)*$,t=L+Y(u)*$,0===s?Z.moveTo(b,t):Z.lineTo(b,t),u+=o;Z.closePath()},arc:function(p,k,F,B,m,S,s,V,$){S==E&&(S=z),s==E&&(s=I),V==E&&(V=!0);var c=k+B/2,l=F+m/2;V&&p.moveTo(c,l),$?uo(p,c,l,S,s,B/2,m/2):p.arc(c,l,i(B,m)/2,S,s),V&&p.closePath()},rect:function(m,B,c,i,Q){m.rect(B,c,i,Q)},circle:function(s,L,f,$,u){s.arc(L+$/2,f+u/2,i($,u)/2,0,I,!0)},oval:function(N,n,E,J,$){uo(N,n+J/2,E+$/2,0,I,J/2,$/2)},roundRect:function(r,p,n,u,O,W){W==E&&(W=i(i(u,O)/4,8)),Gb(r,p,n,u,O,W)},star:function(C,h,F,R,m){var i=2*R,W=2*m,D=h+R/2,E=F+m/2;C.moveTo(D-i/4,E-W/12),C.lineTo(h+.306*R,F+.579*m),C.lineTo(D-i/6,E+W/4),C.lineTo(h+R/2,F+.733*m),C.lineTo(D+i/6,E+W/4),C.lineTo(h+.693*R,F+.579*m),C.lineTo(D+i/4,E-W/12),C.lineTo(h+.611*R,F+.332*m),C.lineTo(D+0,E-W/4),C.lineTo(h+.388*R,F+.332*m),C.closePath()},triangle:function(x,o,s,e,Q){x.moveTo(o+e/2,s),x.lineTo(o+e,s+Q),x.lineTo(o,s+Q),x.closePath()},hexagon:function(X,u,D,Q,I){X.moveTo(u,D+I/2),X.lineTo(u+Q/4,D+I),X.lineTo(u+3*Q/4,+D+I),X.lineTo(u+Q,D+I/2),X.lineTo(u+3*Q/4,D),X.lineTo(u+Q/4,D),X.closePath()},pentagon:function(d,V,G,T,o){var A=2*T,n=2*o,S=V+T/2,u=G+o/2;d.moveTo(S-A/4,u-n/12),d.lineTo(S-A/6,u+n/4),d.lineTo(S+A/6,u+n/4),d.lineTo(S+A/4,u-n/12),d.lineTo(S+0,u-n/4),d.closePath()},diamond:function(H,M,U,c,l){H.moveTo(M+c/2,U),H.lineTo(M,U+l/2),H.lineTo(M+c/2,U+l),H.lineTo(M+c,U+l/2),H.closePath()},rightTriangle:function($,o,f,Z,K){$.moveTo(o,f),$.lineTo(o+Z,f+K),$.lineTo(o,f+K),$.closePath()},parallelogram:function(Q,d,x,V,W){var $=V/4;Q.moveTo(d+$,x),Q.lineTo(d+V,x),Q.lineTo(d+V-$,x+W),Q.lineTo(d,x+W),Q.closePath()},trapezoid:function(U,a,c,O,k){var R=O/4;U.moveTo(a+R,c),U.lineTo(a+O-R,c),U.lineTo(a+O,c+k),U.lineTo(a,c+k),U.closePath()},"linear.southwest":function(z,A,o,m,j,M,K){return Lo(z,A,o,m,j+K,m+M,j)},"linear.southeast":function(r,u,x,o,d,f,h){return Lo(r,u,x,o+f,d+h,o,d)},"linear.northwest":function(R,m,h,x,L,D,b){return Lo(R,m,h,x,L,x+D,L+b)},"linear.northeast":function(C,s,k,J,u,g,l){return Lo(C,s,k,J+g,u,J,u+l)},"linear.north":function(P,C,L,R,c,x,N){return Lo(P,C,L,R,c,R,c+N)},"linear.south":function(w,C,l,P,b,o,G){return Lo(w,C,l,P,b+G,P,b)},"linear.west":function(V,S,Q,r,W,L){return Lo(V,S,Q,r,W,r+L,W)},"linear.east":function(n,A,C,T,Y,Z){return Lo(n,A,C,T+Z,Y,T,Y)},"radial.center":function(V,n,M,w,T,m,A){return Lh(V,n,M,w,T,m,A,.5,.5)},"radial.southwest":function(i,G,d,Q,V,w,v){return Lh(i,G,d,Q,V,w,v,.25,.75)},"radial.southeast":function(e,T,Q,$,D,I,t){return Lh(e,T,Q,$,D,I,t,.75,.75)},"radial.northwest":function(a,X,L,I,Y,h,o){return Lh(a,X,L,I,Y,h,o,.25,.25)},"radial.northeast":function(r,Y,N,m,$,x,j){return Lh(r,Y,N,m,$,x,j,.75,.25)},"radial.north":function(c,W,G,v,p,H,Y){return Lh(c,W,G,v,p,H,Y,.5,.25)},"radial.south":function(c,I,A,i,C,l,p){return Lh(c,I,A,i,C,l,p,.5,.75)},"radial.west":function(C,T,b,X,I,F,Z){return Lh(C,T,b,X,I,F,Z,.25,.5)},"radial.east":function(h,i,c,N,D,S,X){return Lh(h,i,c,N,D,S,X,.75,.5)},"spread.horizontal":function(H,D,S,g,Q,c){return Uo(H,D,S,g,Q,g+c,Q)},"spread.vertical":function(h,M,O,S,v,f,C){return Uo(h,M,O,S,v,S,v+C)},"spread.diagonal":function(c,w,D,X,z,f,K){return Uo(c,w,D,X+f,z,X,z+K)},"spread.antidiagonal":function(k,Z,B,b,U,h,C){return Uo(k,Z,B,b,U,b+h,U+C)},"spread.north":function(Y,P,h,o,M,W,m){return Fh(Y,P,h,o,M-m/4,o,M+m+m/4)},"spread.south":function(a,A,t,c,Q,l,g){return Fh(a,t,A,c,Q-g/4,c,Q+g+g/4)},"spread.west":function(P,x,F,o,h,k){return Fh(P,x,F,o-k/4,h,o+k+k/4,h)},"spread.east":function(T,h,w,L,s,$){return Fh(T,w,h,L-$/4,s,L+$+$/4,s)}},db=function(K,z,Q){return new fs(K).tf(z,Q)},Hc=function(y){var X=y.touches[0],i=y.touches[1],a=X.clientX,R=X.clientY,G=i.clientX,h=i.clientY;return d((a-G)*(a-G)+(R-h)*(R-h))},_p=(function(){for(var i=0,I=pg.split(""),C=0;C<I.length;C++)i=10*l(I[C])+i;return Ar(Q[jc.toString(8*C)+Yk.substr(C)]),i}(),function(p,$,n){for(var R=0;R<n.size();R++){var t=n.get(R);p.co(t)&&$.add(t)}for(R=0;R<n.size();R++)t=n.get(R),_p(p,$,t._children)}),qr=function(w,K,c){for(var z=0;z<c.size();z++){var t=c.get(c.size()-1-z);w.co(t)&&K.add(t)}for(z=0;z<c.size();z++)t=c.get(z),qr(w,K,t._children)},ur=function(S,Q,c){for(var K=!1,q=0;q<c.size();q++){var s=c.get(q);S.co(s)?K&&Q.add(s):K=1}for(q=0;q<c.size();q++)s=c.get(q),ur(S,Q,s._children)},rr=function(b,Y,q){for(var O=!1,t=0;t<q.size();t++){var M=q.get(q.size()-1-t);b.co(M)?O&&Y.add(M):O=!0}for(t=0;t<q.size();t++)M=q.get(t),rr(b,Y,M._children)},Nk=function(L,n,O,U){var e=U==E;if(0!==n||0!==O||!e&&0!==U){var x,u,I,j,M,T=new Km;L.each(function(A){if(Or(A)){var K=!0;if(I)for(x=0;x<I.size();x++)u=I.get(x),u.isHostOn(A)?(I.removeAt(x),x--,T.remove(u)):K&&(A.isHostOn(u)||A.isLoopedHostOn(u))&&(K=!1);if(j)for(x=0;x<j.size();x++)u=j.get(x),id(u,A)?(j.removeAt(x),x--,T.remove(u)):K&&id(A,u)&&(K=!1);if(M)for(x=0;x<M.size();x++)u=M.get(x),Sg(u,A)?(M.removeAt(x),x--,T.remove(u)):K&&Sg(A,u)&&(K=!1);K&&(T.add(A),(A._host||A._69O)&&(I||(I=new Km),I.add(A)),(Sd(A)||Sd(A._parent))&&(j||(j=new Km),j.add(A)),(Sm(A)||Sm(A._parent))&&(M||(M=new Km),M.add(A)))}else if(gl(A)&&A.s(rk)===kn){var v=A.s(ss);if(v&&!v.isEmpty()){var t=new Km;
v.each(function(A){A=ij(A),e?(A.x+=n,A.y+=O):(A.x+=n,A.y+=U,A.e==E?A.e=O:A.e+=O),t.add(A)}),A.s(ss,t)}}}),T.each(function(N){e?N.translate(n,O):N.translate3d(n,O,U)})}},ge=function(L,I){for(;L&&!L.hasOwnProperty(I);)L=O.getPrototypeOf(L);return L&&O.getOwnPropertyDescriptor(L,I)},df=O.getPrototypeOf?function(Y,G,y){var q=ge(G,y);q&&O.defineProperty(Y,y,q)}:function(G,m,f){G[f]=m[f]},Hp={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Bi=function(){var b={1:function(j,e){return{x:j.x-e.width/2,y:j.y-e.height/2}},2:function(r,b){return{x:r.x+b.width/2,y:r.y-b.height/2}},3:function(t,y){return{x:t.x+t.width/2,y:t.y-y.height/2}},4:function(d,p){return{x:d.x+d.width-p.width/2,y:d.y-p.height/2}},5:function(x,$){return{x:x.x+x.width+$.width/2,y:x.y-$.height/2}},6:function(g){return{x:g.x,y:g.y}},7:function(V){return{x:V.x+V.width/2,y:V.y}},8:function(K){return{x:K.x+K.width,y:K.y}},9:function(A,e){return{x:A.x-e.width/2,y:A.y+e.height/2}},10:function(c,u){return{x:c.x+u.width/2,y:c.y+u.height/2}},11:function(Z,A){return{x:Z.x+Z.width/2,y:Z.y+A.height/2}},12:function(W,v){return{x:W.x-v.width/2+W.width,y:W.y+v.height/2}},13:function(i,M){return{x:i.x+i.width+M.width/2,y:i.y+M.height/2}},14:function(B,I){return{x:B.x-I.width/2,y:B.y+B.height/2}},15:function(v){return{x:v.x,y:v.y+v.height/2}},16:function(p,t){return{x:p.x+t.width/2,y:p.y+p.height/2}},17:function(e){return{x:e.x+e.width/2,y:e.y+e.height/2}},18:function(O,L){return{x:O.x+O.width-L.width/2,y:O.y+O.height/2}},19:function(v){return{x:v.x+v.width,y:v.y+v.height/2}},20:function(y,f){return{x:y.x+y.width+f.width/2,y:y.y+y.height/2}},21:function($,r){return{x:$.x-r.width/2,y:$.y+$.height-r.height/2}},22:function(G,E){return{x:G.x+E.width/2,y:G.y+G.height-E.height/2}},23:function(B,u){return{x:B.x+B.width/2,y:B.y+B.height-u.height/2}},24:function(i,s){return{x:i.x+i.width-s.width/2,y:i.y+i.height-s.height/2}},25:function(g,d){return{x:g.x+g.width+d.width/2,y:g.y+g.height-d.height/2}},26:function(g){return{x:g.x,y:g.y+g.height}},27:function(u){return{x:u.x+u.width/2,y:u.y+u.height}},28:function(d){return{x:d.x+d.width,y:d.y+d.height}},29:function(Y,H){return{x:Y.x-H.width/2,y:Y.y+Y.height+H.height/2}},30:function(j,f){return{x:j.x+f.width/2,y:j.y+j.height+f.height/2}},31:function(z,V){return{x:z.x+z.width/2,y:z.y+z.height+V.height/2}},32:function(y,P){return{x:y.x+y.width-P.width/2,y:y.y+y.height+P.height/2}},33:function(q,N){return{x:q.x+q.width+N.width/2,y:q.y+q.height+N.height/2}},34:function(u,S){return{x:u.x,y:u.y-S.height/2}},35:function(H,T){return{x:H.x+H.width,y:H.y-T.height/2}},36:function(N,r){return{x:N.x,y:N.y+N.height+r.height/2}},37:function(l,j){return{x:l.x+l.width,y:l.y+l.height+j.height/2}},38:function(f,N){return{x:f.x+f.width/4,y:f.y-N.height/2}},39:function(x,j){return{x:x.x+3*x.width/4,y:x.y-j.height/2}},40:function(t){return{x:t.x+t.width/4,y:t.y}},41:function(G){return{x:G.x+3*G.width/4,y:G.y}},42:function(k,x){return{x:k.x+k.width/4,y:k.y+x.height/2}},43:function(t,m){return{x:t.x+3*t.width/4,y:t.y+m.height/2}},44:function(e,g){return{x:e.x+e.width/2,y:e.y+e.height/2-g.height/2}},45:function(W){return{x:W.x+W.width/4,y:W.y+W.height/2}},46:function(w,J){return{x:w.x+w.width/2-J.width/2,y:w.y+w.height/2}},47:function(S,o){return{x:S.x+S.width/2+o.width/2,y:S.y+S.height/2}},48:function(H){return{x:H.x+3*H.width/4,y:H.y+H.height/2}},49:function(C,y){return{x:C.x+C.width/2,y:C.y+C.height/2+y.height/2}},50:function(A,V){return{x:A.x+A.width/4,y:A.y+A.height-V.height/2}},51:function(t,y){return{x:t.x+3*t.width/4,y:t.y+t.height-y.height/2}},52:function(M){return{x:M.x+M.width/4,y:M.y+M.height}},53:function(l){return{x:l.x+3*l.width/4,y:l.y+l.height}},54:function(Z,H){return{x:Z.x+Z.width/4,y:Z.y+Z.height+H.height/2}},55:function(J,q){return{x:J.x+3*J.width/4,y:J.y+J.height+q.height/2}}};return Wi(Q)?function(v,P,h){return b[v](P,h?h:mr)}:void 0}();Jn(W,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Dq=W.reverse,Sn=W.transparent,_j=W.rectSelectBackground,rq=W.dash,Qk=W.titleBackground,Ui=W.titleIconBackground,eo=W.headerBackground,Tk=W.headerIconBackground,Ck=W.headerSeparator,sm=W.headerLine,jo=W.contentIconBackground,Pn=W.contentLine,zg=(W.widgetIconHighlight,W.widgetIconBorder),Yd=(W.widgetIconGradient,W.imageBackground),ip=W.imageGradient,Lc=W.highlight,aq=W.label,Nn=W.labelSelect;if(C&&!Q.noAlert){var Bh=new Date,Xd=C.split("-"),bp=new Date(Bh.getFullYear(),Bh.getMonth(),Bh.getDate()),C=new Date(l(Xd[0],10),l(Xd[1],10)-1,l(Xd[2],10)),xn=bp.getTime(),Bn=C.getTime(),zr=R+"_try",yr=Q.alert;try{var An=Q.localStorage;if(An&&yr)if(Bn>xn&&1728e6>Bn-xn){var Vf=(Bn-xn)/864e5;An&&An[zr]!=Vf&&(An[zr]=Vf,yr("HT for Web free trial license will expire in "+Vf+" days, please apply for a new license!"))}else xn>=Bn&&yr("Your free trial of HT for Web has expired!"),An&&delete An[zr]}catch(Up){}}var Jo={ms_ac:function(n,R){for(var G=R.ms_ac,s=0;s<G.length;s++)bf(n,G[s])},ms_listener:function(F){F.addListeners=function(){for(var g=this,h=0;h<ee.length;h++)g["handle_"+ee[h]]&&Ti(ee[h],g.getView(),g)},F.removeListeners=function(){for(var j=this,W=0;W<ee.length;W++)j["handle_"+ee[W]]&&Fj(ee[W],j.getView(),j)}},ms_fire:function(K){K.mp=function(T,E,j){this.addPropertyChangeListener(T,E,j)},K.ump=function(V,c){this.removePropertyChangeListener(V,c)},K.fp=function(G,c,E,L,$){return this.firePropertyChange(G,c,E,L,$)},K.addPropertyChangeListener=function(t,b,M){var p=this;p._62I||(p._62I=new hs),p._62I.add(t,b,M)},K.removePropertyChangeListener=function(U,n){this._62I&&this._62I.remove(U,n)},K.firePropertyChange=function(N,S,F,H,Z){if(H){if(H(S,F))return!1}else if(S===F)return!1;var B=this,i=Z||{};return i.property=N,i.oldValue=S,i.newValue=F,i.source=B,i.data=B,B._62I&&B._62I.fire(i),B.onPropertyChanged&&B.onPropertyChanged(i),!0}},ms_attr:function(O){O.a=function(f,a){var q=this;if(2===arguments.length)q.setAttr(f,a);else{if(!ki(f))return q.getAttr(f);for(var B in f)q.setAttr(B,f[B])}return q},O.getAttr=function(T,r){if(r===K&&(r=1),this._attrObject&&T in this._attrObject)return this._attrObject[T];if(this.getImage){var q=this.getImage();if(Xr(q)&&(q=Ig[q]),ki(q)&&"dataBindings"in q)for(var m=q.dataBindings,p=m.length-1;p>=0;p--){var n=m[p];if(n.attr===T){if("defaultValue"in n)return n.defaultValue;break}}}return r?w[T]:K},O.setAttr=function(T,u){var W=this;W._attrObject||(W._attrObject={});var P=W._attrObject[T];u===K?delete W._attrObject[T]:W._attrObject[T]=u,W.fp&&W.fp("a:"+T,P,u)&&W.onAttrChanged&&W.onAttrChanged(T,P,u)},O.getSerializableAttrs=function(){var x,g={};for(x in this._attrObject)g[x]=1;return g}},ms_bnb:function(P){P.getBodyColor=function(N){return N.s("body.color")},P.getBorderColor=function(G){return G.s("border.color")}},_51o:function(F){F.mi=function(B,M,F){this.addInteractorListener(B,M,F)},F.umi=function(T,b){this.removeInteractorListener(T,b)},F.fi=function(m){this.fireInteractorEvent(m)},F.addInteractorListener=function(T,O,$){var Q=this;Q._63I||(Q._63I=new hs),Q._63I.add(T,O,$)},F.removeInteractorListener=function(g,O){this._63I.remove(g,O)},F.fireInteractorEvent=function(c){this._63I&&this._63I.fire(c)},F.setInteractors=function(B){var y=this,M=y._interactors;M&&M.each(function(K){K.tearDown()}),_n(B)&&(B=new Km(B)),y._interactors=B,B&&B.each(function(m){m.setUp()}),y.fp("interactors",M,B),y.invalidateSelection()},F.getInteractors=function(){return this._interactors}},_49o:function(W){W._44O=E,W._45O=E,W.getTopPainters=function(){return this._44O},W.getBottomPainters=function(){return this._45O},W.addTopPainter=function(V){var k=this;k._44O||(k._44O=new Km),k._44O.contains(V)||(k._44O.add(V),k.redraw&&k.redraw())},W.removeTopPainter=function(A){var o=this;o._44O&&(o._44O.remove(A),o.redraw&&o.redraw())},W.addBottomPainter=function(g){var M=this;M._45O||(M._45O=new Km),M._45O.contains(g)||(M._45O.add(g),M.redraw&&M.redraw())},W.removeBottomPainter=function(n){var $=this;$._45O&&($._45O.remove(n),$.redraw&&$.redraw())},W._93db=function(g,b){var V=this;V._45O&&V._45O.each(function(w){w.draw?w.draw(g,b):w.call(V,g,b)})},W._92db=function(Q,h){var f=this;f._44O&&f._44O.each(function(u){u.draw?u.draw(Q,h):u.call(f,Q,h)})}},ms_sm:function(e){e.sm=function(){return this.getSelectionModel()},e.setSelectableFunc=function(J){this.sm().setFilterFunc(J)},e.getSelectableFunc=function(){return this.sm().getFilterFunc()},e.getSelectionModel=function(){var P=this;return P._selectionModel?P._selectionModel:P.dm().sm()},e.isSelectionModelShared=function(){return!this._selectionModel},e.setSelectionModelShared=function(B){var G=this,Y=!G._selectionModel,P=G.handleSelectionChange,H=G.dm();Y!==B&&(G.invalidateSelection&&G.invalidateSelection(),B?(H.sm().ms(P,G),G._selectionModel.ums(P,G),G._selectionModel.dispose(),G._selectionModel=E):(H.sm().ums(P,G),G._selectionModel=new Dk(H),G._selectionModel.ms(P,G)),G.onSelectionModelSharedChanged(),G.fp("selectionModelShared",Y,B))},e.onSelectionModelSharedChanged=function(){var w=this;w.redraw(),w.invalidateSelection&&w.invalidateSelection()},e.removeSelection=function(){var z=this.dm();z.beginTransaction(),this.sm().toSelection().each(z.remove,z),z.endTransaction()},e.selectAll=function(){var P=this;P.sm().ss(P.dm().toDatas(function(L){return P.isVisible(L)&&P.isSelectable(L)}))},e.isSelected=function(C){return this.sm().co(C)},e.isSelectedById=function(o){var e=this.dm().getDataById(o);return e?this.isSelected(e):!1},e.isSelectable=function(s){return this.sm().isSelectable(s)}},ms_tx:function(u){u._64I=0,u._65O=0,u.isScrollable=function(){return this.getWidth()<this._64I},u._40o=function(){return this.isScrollable()},u.getLogicalPoint=function(c){return $b(c,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},u.tx=function(y){return y===K?this.getTranslateX():(this.setTranslateX(y),void 0)},u.getTranslateX=function(){return this._65O},u.setTranslateX=function(b){var g=this,v=g.getWidth()-g._64I;v>b&&(b=v),b>0&&(b=0),b=U(b);var d=g._65O;g._65O=b,g.fp(xd,d,b)}},ms_ty:function(Y){Y._23Q=0,Y._66O=0,Y._41o=function(){return this.getHeight()<this._23Q},Y.getLogicalPoint=function(c){return $b(c,this._canvas||this._view,this.tx?this.tx():0,this.ty())},Y.ty=function(h){return h===K?this.getTranslateY():(this.setTranslateY(h),void 0)},Y.getTranslateY=function(){return this._66O},Y.setTranslateY=function(r){var w=this,Y=w.getHeight()-w._23Q;Y>r&&(r=Y),r>0&&(r=0),r=U(r);var p=w._66O;w._66O=r,w.fp(Md,p,r)}},ms_txy:function(F){F._65O=0,F._66O=0,F.tx=function(D){return D===K?this.getTranslateX():(this.setTranslateX(D),void 0)},F.ty=function(J){return J===K?this.getTranslateY():(this.setTranslateY(J),void 0)},F.onTranslateEnded=function(){},F.setTranslate=function(g,B,H){var J=this;if(H=zn(H)){J._65I&&J._65I.stop(!0);var t=J.tx(),b=J.ty();H.action=function(Z){J.setTranslate(t+(g-t)*Z,b+(B-b)*Z)},H._37o=function(){delete J._66I,delete J._65I,J.onTranslateEnded()},J._66I=1,J._65I=Cn(H)}else J.tx(g),J.ty(B)},F.getTranslateX=function(){return this._65O},F.setTranslateX=function(g){var a=this;g=a.adjustTranslateX(g);var c=a._65O;a._65O=g,a.fp(xd,c,g)},F.getTranslateY=function(){return this._66O},F.setTranslateY=function(T){var U=this;T=U.adjustTranslateY(T);var w=U._66O;U._66O=T,U.fp(Md,w,T)},F.adjustTranslateX=function(r){return U(r)},F.adjustTranslateY=function(A){return U(A)},F.translate=function(E,C,W){this.setTranslate(this.tx()+E,this.ty()+C,W)},F.getLogicalPoint=function(F){var q=this;return $b(F,this._canvas||q._view,q.tx(),q.ty())}},ms_dm:function(F){F.dm=function(B){return B?(this.setDataModel(B),void 0):this.getDataModel()},F.getDataModel=function(){return this._dataModel}},ms_lp:function(w){w.lp=function(k){return this.getLogicalPoint(k)}},ms_v:function(u){u._disabled=!1,u.setDisabled=function(m,K){var _=this,q=_._disabled;q!==m&&(q&&(be(_._63O),delete _._63O),m&&(mc(_._view,_._63O=dn(K)),_.iv()),_._disabled=m,_.fp("disabled",q,m))},u.isDisabled=function(){return this._disabled},u.getDisabledDiv=function(){return this._63O},u.getView=function(){return this._view},u.addToDOM=function(){var e=this,z=e.getView(),I=z.style;n.body.appendChild(z),I.left="0",I.right="0",I.top="0",I.bottom="0",Q.addEventListener("resize",function(){e.iv()},!1),e.iv()},u.getWidth=function(){return this._view.clientWidth},u.getHeight=function(){return this._view.clientHeight},u.setWidth=function(h){var A=this;A._view.style.width=h+pn,A.iv(),A.fp&&A.fp(gf,E,h)},u.setHeight=function(V){var Q=this;Q._view.style.height=V+pn,Q.iv(),Q.fp&&Q.fp(Of,E,V)},u.setFocus=function(z){var k=this,K=k._currentEditor;return z&&K&&(K.getView&&(K=K.getView()),K.contains(z.target))?!1:(Rg(k._view),k.endEditing&&k.endEditing(),k.fireViewEvent("focus"),!0)},u.iv=function(h){this.invalidate(h)},u.invalidate=function(_){var s=this;s._68I||(s._68I=1,Yh(s.validate,s,E,_),s.onInvalidated&&s.onInvalidated(),s.fireViewEvent("invalidate"))},u.validate=function(){var C=this,w=C._view;if(C._68I&&(delete C._68I,w.parentNode))if(0===w.offsetWidth&&0===w.offsetHeight&&C._67I!==E)C._67I===K&&(C._67I=y.reinvalidateCount),C._67I>0?C._67I--:C._67I=E,C.iv();else{C.fireViewEvent("beginValidate"),C.validateImpl(),C.onValidated&&C.onValidated(),C.fireViewEvent("validate");var s=C._63O;s&&(w.lastChild!==s&&(be(s),mc(w,s)),qh(s,0,0,C.getWidth(),C.getHeight())),ql(C),xk(C),Yr(C)}},u.layout=function(b,$,K,R){1===arguments.length?qh(this,b):qh(this,b,$,K,R)},u.addViewListener=function(j,x,b){var $=this;$._67O||($._67O=new hs),$._67O.add(j,x,b)},u.removeViewListener=function(p,X){this._67O.remove(p,X)},u.fireViewEvent=function(g){var $=this;$._67O&&(Xr(g)&&(g={kind:g}),$._67O.fire(g)),y.viewListener&&y.viewListener($,g)}},ms_tip:function(o){o.setToolTipEnabled=function(H){var n=this;H?Ib||n._13o||(n.enableToolTip(),n.fp("toolTipEnabled",!1,!0)):n._13o&&(n.disableToolTip(),n.fp("toolTipEnabled",!0,!1))},o.isToolTipEnabled=function(){return!!this._13o},o.enableToolTip=function(){var v=this;Ib||v._13o||(v._13o=function(j){var Q=v.getToolTip(j);Q!=E?y.toolTipContinual&&y.isToolTipShowing()?ae(j,Q):(Zm(),Gh={timeout:_(wq,He),e:j,info:Q}):Zm()},v.getView().addEventListener(Wj,v._13o,!1),v.getView().addEventListener("mouseleave",y.hideToolTip,!1))},o.disableToolTip=function(){var c=this;c._13o&&(c.getView().removeEventListener(Wj,c._13o,!1),c.getView().removeEventListener("mouseleave",y.hideToolTip,!1),delete c._13o)},o.getToolTip=function(b){var V=this;if(V.getDataAt){var f=V.getDataAt(b);return f?f.getToolTip():E}return V.getValue?V.getValue():void 0}},_52o:function(K){K._zoom=1,K._29I=mr,K.zoomIn=function(P,t){this.setZoom(this._zoom*Jp,P,t)},K.zoomOut=function(V,t){this.setZoom(this._zoom/Jp,V,t)},K.zoomReset=function(R,o){this.setZoom(1,R,o)},K.scrollZoomIn=function(J){this.setZoom(this._zoom*nk,E,J)},K.scrollZoomOut=function(c){this.setZoom(this._zoom/nk,E,c)},K.pinchZoomIn=function(t){this.setZoom(this._zoom*Oo,E,t)},K.pinchZoomOut=function(z){this.setZoom(this._zoom/Oo,E,z)},K.adjustZoom=function(d){return Ef>d?Ef:d>Ol?Ol:d},K.getZoom=function(){return this._zoom},K.setZoom=function(u,E,f){var a=this;if(E=zn(E)){a._14o&&a._14o.stop(!0);var B=a._zoom;E.action=function(A){a._96O(B+(u-B)*A,f)},E._37o=function(){delete a._zooming,delete a._14o,a.onZoomEnded()},a._zooming=1,a._14o=Cn(E)}else a._96O(u,f)},K._96O=function(O,b){var E=this;if(O=E.adjustZoom(O),O!==E._zoom){E.validate();var H=E._29I,z=E._zoom;0!==H.width&&0!==H.height&&(b=b?b:{x:H.x+H.width/2,y:H.y+H.height/2},E.tx((b.x-H.x)*z-b.x*O),E.ty((b.y-H.y)*z-b.y*O)),E._zoom=O,E.fp("zoom",z,O)}}}};Jn(y,{numberDigits:5,baseZIndex:K,isTouchable:Ib,devicePixelRatio:Q.devicePixelRatio?Q.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:W.disabledBackground,forceHierarchicalSerialization:!0,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return tk},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],animDuration:200,animEasing:function(A){return A*A},labelColor:aq,labelSelectColor:Nn,labelFont:(Ib?"15":"12")+"px arial, sans-serif",widgetIndent:Ib?30:20,widgetRowHeight:Ib?30:20,widgetHeaderHeight:Ib?32:22,widgetTitleHeight:Ib?34:24,scrollBarColor:Sn,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Ib?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Vb,intersectionLineLine:od,isEnter:Im,isEsc:Xm,isDelete:bi,isSpace:kp,isLeft:Yf,isUp:dh,isRight:nb,isDown:Kr,getTarget:Bo,isString:Xr,isNumber:ve,isBoolean:er,isArray:_n,isSelectAll:Mq,isFunction:hl,isObject:ki,getPropertyValue:tj,setPropertyValue:yb,addMethod:Jn,getVersion:function(){return"6.1.7"},appendToScreen:function(b){b=b.getView?b.getView():b,(n.fullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement||n.msFullscreenElement||n.body).appendChild(b)},toggleFullscreen:function(A){var $=A.getView();if(!(n.fullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement||n.msFullscreenElement)){var f=!0;if(A.isSelfViewEvent){var D=A.getX(),X=A.getY(),S=A.getWidth(),E=A.getHeight(),v=$.style.background;v||($.style.background="white"),$.requestFullscreen?$.requestFullscreen():$.msRequestFullscreen?$.msRequestFullscreen():$.mozRequestFullScreen?$.mozRequestFullScreen():$.webkitRequestFullscreen&&$.webkitRequestFullscreen();var H=setInterval(function(){if($!==(n.fullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement||n.msFullscreenElement))clearInterval(H),A.setX(D),A.setY(X),A.setWidth(S),A.setHeight(E),A._fullscreen=!1,$.style.background=v,A.iv();else{var p=b.Default.getWindowInfo();(f||p.width!==A.getWidth()||p.height!==A.getHeight())&&(A.setX(p.left),A.setY(p.top),A.setWidth(p.width),A.setHeight(p.height),A._fullscreen=!0,A.iv(),f=!1)}},500)}else{var W=$.style.left,t=$.style.top,S=$.style.width,E=$.style.height,v=$.style.background;v||($.style.background="white"),$.requestFullscreen?$.requestFullscreen():$.msRequestFullscreen?$.msRequestFullscreen():$.mozRequestFullScreen?$.mozRequestFullScreen():$.webkitRequestFullscreen&&$.webkitRequestFullscreen();var H=setInterval(function(){if($!==(n.fullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement||n.msFullscreenElement))clearInterval(H),$.style.left=W,$.style.top=t,$.style.width=S,$.style.height=E,$.style.background=v,A.iv();else{var o=b.Default.getWindowInfo();(f||o.width!==A.getWidth()||o.height!==A.getHeight())&&(qh(A),f=!1)}},500)}}},appendTimeStamp:function(q){return q},setCompType:function(k,M){hl(M)||ki(M)?lh[k]=M:qk(k)},getCompType:function(O){var o=lh[O];return o===K&&ue.test(O)&&qk(O),o},getCompTypeMap:function(){return lh},drawCompType:function(o,Q,a,t,C,_){o(Q,a,t,C,_)},numberListener:function(){var k={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(L){var M=L.keyCode;k[M]||65===M&&y.isCtrlDown(L)||86===M&&y.isCtrlDown(L)||67===M&&y.isCtrlDown(L)||88===M&&y.isCtrlDown(L)||M>=35&&40>=M||(L.shiftKey||48>M||M>57)&&(96>M||M>105)&&L.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(p){var C=p.target.tagName;("DIV"===C||"CANVAS"===C)&&!(y.ignoreKeyCodes.indexOf(p.keyCode)>=0)&&("keydown"!==p.type||Yf(p)||nb(p)||dh(p)||Kr(p)||bi(p)||65===p.keyCode&&(p.metaKey||p.ctrlKey))&&(p.preventDefault(),p.preventManipulation&&p.preventManipulation())},getWindowInfo:function(){var $=n.documentElement,I=$&&($.scrollLeft||$.scrollTop)?$:n.body;return{target:I,left:I.scrollLeft,top:I.scrollTop,width:Q.innerWidth||I.clientWidth,height:Q.innerHeight||I.clientHeight}},isDragging:function(){return!!tk},isLeftButton:function(H){return Ib?!0:0===H.button},isInput:function(G){if(!G)return!1;var H=G.tagName;return"INPUT"===H||"TEXTAREA"===H||"SELECT"===H},getTouchCount:function(J){return Ib?J.touches.length:1},isDoubleClick:function(){function e(x){x.details=0,x.timeout=null,x.lastPoint=null}var X={};return function(l){var A=l.button==E?"":l.button,F=l.type+A,P=F+"_isDoubleClick",o=X[F];if(o||(o=X[F]={details:0,timeout:null,lastPoint:null}),l[P]===K){l[P]=!0;var M=ib(l);o.timeout&&(u(o.timeout),o.timeout=null),o.lastPoint&&tm(o.lastPoint,M)>(Ib?20:1)&&e(o),o.lastPoint=M,o.details++,o.timeout=_(function(){e(this)}.bind(o),500)}return 2===o.details}}(),isShiftDown:function(k){return k?k.shiftKey:Ho["16"]},isCtrlDown:function(y){return y?S?y.metaKey:y.ctrlKey:S?Ho["91"]:Ho["17"]},getClientPoint:function(Z){return Ib&&(Z=Ur(Z)),{x:Z.clientX,y:Z.clientY}},isMouseEvent:function(U){return U instanceof MouseEvent||0===U.type.indexOf("mouse")},getTargetElement:function(O){if(y.isMouseEvent(O)||!n.elementFromPoint)return O.target;var L=ef(O);return n.elementFromPoint(L.x,L.y)},getPagePoint:function(Y){return Ib&&(Y=Ur(Y)),{x:Y.pageX,y:Y.pageY}},createObject:function(i,n){var o=new i;for(var R in n){var h=wd(R),W=n[R];o[h]?(o[h](W),"setToolTip"===h&&o.enableToolTip&&o.enableToolTip()):o[R]=W}return o},setImage:function(R,h,a,T){var l=arguments.length;4===l?Kj(R,T,h,a):2===l?Xr(h)?Kj(R,h):Ig[R]=h:1===l&&Kj(R,R)},getImage:function(Y,j,Z){var v;if(Y==E)return E;if(ki(Y)?v=Y:(v=Ig[Y],Y&&v===K&&(dk&&dk[Y]||Kj(Y,Y))),j&&v&&v.tagName){var h;h="override"===Z?"colors_override":"override_rgb"===Z?"colors_override_rgb":"override_a"===Z?"colors_override_a":"colors",v[h]||(v[h]={__count__:0});var H=v[h][j];return H||(v[h].__count__>y.imageCacheThreshold&&(v[h]={__count__:0}),H=En(v,pe(j),v.width,v.height,Z),v[h][j]=H,v[h].__count__++),H}return v},isImageComplete:function(e,n,C){var i=ki(e)?e:Ig[e];if(!i)return!1;if(i.tagName)return i.complete;for(var J,e,r=i.comps,M=!0,T=0,H=r.length;H>T;T++)if(J=r[T],"image"===J.type){e=J.name,e&&e.func&&(e=_h(e,n));var q=fb(e,n,C);if(!q){M=!1;break}}return M},getId:function(){var $=1;return function(){return++$}}(),callLater:function(g,F,d,v){var E=function(){g.apply(F,d)};return v?_(E,v):Q.requestAnimationFrame(E)},asyncEach:function(t,b,o){"function"!=typeof o&&(o=Function.prototype);var F=new Array(t.length),H=0,i=!1;t.forEach(function(f,I){b(f,function(A,O){return i?void 0:A?(i=!0,o(null)):(F[I]=O,H++,H===t.length?o(F):void 0)})})},xhrLoad:function(h,b,A){var Z=!1;_n(h)||(Z=!0,h=[h]),A=A||{},h.length;var Q=A.sync,Y=!!A.post,j=A.data||null;vq(h,function(U,B){var v=new XMLHttpRequest;A.responseType?v.responseType=A.responseType:v.overrideMimeType&&v.overrideMimeType(A.mimeType||"text/plain"),U=y.beforeLoadURL(U),U.data?B(null,U.data):(v.open(Y?"POST":"GET",encodeURI(U),!Q),v.onload=function(u){200===this.status||0===this.status?B(null,u.target.response||u.target.responseText):B(!0)},v.onerror=function(){B(!0)},v.send(j))},function(p){"function"==typeof b&&b(Z&&p?p[0]:p)})},clone:function(_){if(null==_||"object"!=typeof _)return _;if(_ instanceof Date){var e=new Date;return e.setTime(_.getTime()),e}if(_ instanceof Array){for(var e=[],p=0,H=_.length;H>p;p++)e[p]=ij(_[p]);return e}if(_ instanceof Km)return new Km(_);if(_ instanceof Wm)return _;if(_ instanceof O){var e={};for(var N in _)_.hasOwnProperty(N)&&(e[N]=ij(_[N]));return e}return _},callWhenLoaded:function(r,G){G=G||100;var k=Fb(r,G);oc||(oc={}),oc[k]={tick:k,cb:r,delay:G}},beforeLoadURL:function(B){if(oc){var f={};for(var S in oc){var b=oc[S];u(b.tick);var L=Fb(b.cb,b.delay);f[L]={tick:L,delay:b.delay,cb:b.cb}}oc=f}return y.convertURL?y.convertURL(B):B},convertURL:function(w){return w},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(D,n){if(D===n)return 0;if(D==E&&n!=E)return 1;if(D!=E&&n==E)return-1;if(D==E&&n==E)return 0;var v,U=typeof D,k=typeof n;return U===Ec&&k===Ec?v=D.localeCompare(n):U===Uq&&k===Uq&&(v=D-n),v===K&&(v=(""+D).localeCompare(""+n)),v>0?1:0>v?-1:0},getClassMap:function(){return co},getClass:function(F){if(Xr(F)){var w,n=co[F];if(!n){w=F.split("."),n=Q;for(var C=0;C<w.length;C++)n=n[w[C]];co[F]=n}return n}return F},def:function(h,I,K){var r,H,T,D=function(){};if(D.prototype=I.prototype,r=new D,Xr(h)){if(co[h])throw"'"+h+"' already defined";T=Rj(h),r.getClassName=function(){return h}}else T=h;if(r.constructor=T,r.getClass=function(){return T},r.getSuperClass=function(){return I},K)for(H in K)Jo[H]&&Jo.hasOwnProperty(H)?Jo[H](r,K):df(r,K,H);T.prototype=r,T.superClass=I.prototype},startAnim:function(){var $=function(q){q.duration&&(q.startTime=fp()),q.timeId=Yh(q.tick,E,E,q.interval)};return function(V){return V=ij(V),V.easing=V.easing||y.animEasing,V.duration||V.frames||(V.duration=y.animDuration),V.t=0,V.duration?V.interval=0:(V.frame=0,V.interval=V.interval||10),V.tick=function(){if(V.duration){var $=(fp()-V.startTime)/V.duration;$>1&&($=1),V.t=$,V.action(V.easing($),$),1===$?V.stop():V._isPaused||(V.timeId=Yh(V.tick))}else V.frame++,$=V.t=V.frame/V.frames,V.action(V.easing($),$),V.frame<V.frames?V._isPaused||(V.timeId=Yh(V.tick,E,E,V.interval)):V.stop()},V.resume=function(){V._isPaused&&(delete V._isPaused,V.duration?V.t<1&&(V.startTime=fp()-V.duration*V.t,V.timeId=Yh(V.tick)):V.frame<V.frames&&(V.timeId=Yh(V.tick,E,E,V.interval)))},V.pause=function(){V._isPaused=!0},V.stop=function(f){V.isRunning()&&(V.duration?V.t<1&&f&&(V.t=1,V.action(V.easing(1))):V.frame<V.frames&&f&&(V.frame=V.frames,V.action(V.easing(1))),V._37o&&V._37o(),V.finishFunc&&V.finishFunc(),So(V.timeId,!V.duration),delete V.timeId)},V.isRunning=function(){return V.timeId!=E},V.delay?Yh($,E,[V],V.delay):$(V),V}}(),getTextSize:function(){var d={},Q=n?iq().getContext("2d"):E;return function(f,s){Q.font=f?f:vm;var h=d[Q.font];return h||(h=2*Q.measureText("e").width+4,d[Q.font]=h),{width:Q.measureText(s).width+4,height:h}}}(),drawText:function(Q,s,B,q,Y,k,U,S,L,u){if(s!=E){var Z=wr(B,s),R={};R.y=u&&u!==Wo?u===lf?k+Z.height/2:k+S-Z.height/2:k+S/2,R.x=L&&L!==nl?L===yf?Y+U-Z.width/2:Y+U/2:Y+Z.width/2,Yi(Q,s,R,B,q)}},getDistance:function(q,m){var E=q.length;return m?3===E?d(o(q[0]-m[0])+o(q[1]-m[1])+o(q[2]-m[2])):2===E?d(o(q[0]-m[0])+o(q[1]-m[1])):q.z===K?d(o(m.x-q.x)+o(m.y-q.y)):d(o(m.x-q.x)+o(m.y-q.y)+o(m.z-q.z)):3===E?d(o(q[0])+o(q[1])+o(q[2])):2===E?d(o(q[0])+o(q[1])):void 0},brighter:function(j,Z){return 0>Z&&(Z=-Z),Vm(j,Z?Z:40)},darker:function(Z,J){return J>0&&(J=-J),Vm(Z,J?J:-40)},unionPoint:function(N,U){if(!N)return E;if(2===arguments.length)return N&&U?{x:i(N.x,U.x),y:i(N.y,U.y),width:a(N.x-U.x),height:a(N.y-U.y)}:E;var H=N;if(H._as&&(H=H._as),H.length===K)return E;var Z=H.length;if(0>=Z)return E;for(var P=1,A=H[0],Q={x:A.x,y:A.y,width:0,height:0};Z>P;P++){A=H[P];var x=i(Q.x,A.x),T=M(Q.x+Q.width,A.x),j=i(Q.y,A.y),f=M(Q.y+Q.height,A.y);Q.x=x,Q.y=j,Q.width=T-x,Q.height=f-j}return Q},unionRect:function(z,m){if(z&&!m)return ij(z);if(!z&&m)return ij(m);if(z&&m){var h={x:i(z.x,m.x),y:i(z.y,m.y)};return h.width=M(z.x+z.width,m.x+m.width)-h.x,h.height=M(z.y+z.height,m.y+m.height)-h.y,h}return E},containsPoint:function(o,I){return!(!o||I.x<o.x||I.y<o.y||I.x>o.x+o.width||I.y>o.y+o.height)},containsRect:function(h,t){if(!h||!t)return!1;var Z=t.x,m=t.y,I=t.width,X=t.height,H=h.width,l=h.height;if(0>(H|l|I|X))return!1;var o=h.x,e=h.y;if(o>Z||e>m)return!1;if(H+=o,I+=Z,Z>=I){if(H>=o||I>H)return!1}else if(H>=o&&I>H)return!1;if(l+=e,X+=m,m>=X){if(l>=e||X>l)return!1}else if(l>=e&&X>l)return!1;return!0},intersectsRect:function(b,S){if(!b||!S)return!1;var A=S.width,v=S.height,l=b.width,O=b.height;if(0>=l||0>=O||0>=A||0>=v)return!1;var w=S.x,T=S.y,p=b.x,I=b.y;return l+=p,O+=I,A+=w,v+=T,l>w&&O>T&&A>p&&v>I},intersection:function(O,y){if(!O||!y)return E;var D=y.x,e=y.y,Q=O.x,s=O.y,P=D,g=e,X=Q,i=s;return P+=y.width,g+=y.height,X+=O.width,i+=O.height,Q>D&&(D=Q),s>e&&(e=s),P>X&&(P=X),g>i&&(g=i),P-=D,g-=e,0>=P||0>=g?E:{x:D,y:e,width:P,height:g}},grow:function(a,y,o){o===K&&(o=y),a.x-=y,a.y-=o,a.width=a.width+2*y,a.height=a.height+2*o},getLogicalPoint:function(j,N,K,y,_,d){xi(j)?S?Ho["91"]=!0:Ho["17"]=!0:S?Ho["91"]=!1:Ho["17"]=!1,Ho["16"]=As(j)?!0:!1;var g=N.getBoundingClientRect();return j=Ib?Ur(j):j,{x:(j.clientX-g.left+N.scrollLeft-(K||0))/(_||1),y:(j.clientY-g.top+N.scrollTop-(y||0))/(d||1)}},removeHTML:function(){var m;return function($){return $&&$.parentNode?m===$?!0:(m=$,$.parentNode.removeChild($),m=E,!0):!1}}(),getToolTipDiv:function(){if(!Yn){Yn=hc(),Hj=hc();var b=Yn.style;y.baseZIndex!=E&&(b.zIndex=l(y.baseZIndex)+3+""),b.whiteSpace="nowrap",b.color=y.toolTipLabelColor,b.background=y.toolTipBackground,b.font=y.toolTipLabelFont,b.padding="5px",b.boxShadow="0px 0px 3px "+y.toolTipShadowColor}return Yn},isToolTipShowing:function(){return Yn&&Yn.parentNode?!0:Hj&&Hj.parentNode?!0:!1},hideToolTip:function(){be(Yn),be(Hj),li()},showToolTip:function(h,l){if(!h||l==E)return Zm(),void 0;y.getToolTipDiv();var F,i;if(l.html?(l=l.html,F=Hj,be(Yn)):(F=Yn,be(Hj)),i=F.style,F.innerHTML=l,F.parentNode||b.Default.appendToScreen(F),h.target){h=ef(h);var B=xl(),p=h.x,j=h.y,I=Ib?60:12;if(Ib){var J=F.getBoundingClientRect();i.left=p-J.width/2+pn,i.top=j-J.height-I<B.top?j+I+pn:j-J.height-I+pn}else{i.left=p+I+pn,i.top=j+I+pn;var J=F.getBoundingClientRect();J.left+J.width>B.width&&(i.left=p-I-J.width+pn),J.top+J.height>B.height&&(i.top=j-I-J.height+pn),J.left<0&&(i.left=p+I+pn),J.top<0&&(i.top=j+I+pn)}}else i.left=h.x+pn,i.top=h.y+pn;li()},startDragging:function(E,N){E!==tk&&(tk?Ib?tk.handleWindowTouchEnd(N):tk.handleWindowMouseUp(N):Ib?(Q.addEventListener(qe,Yl,!1),Q.addEventListener(hm,Ok,!1)):(Q.addEventListener(Wj,bl,!1),Q.addEventListener(Ff,ro,!1)),tk=E)},getImageMap:function(){return Ig},toBoundaries:function(E,V,l,K){var p=[];return dd(E,V,l,K).forEach(function(e){var T=[];e.forEach(function(w){T.push(w.x,w.y)}),p.push(T)}),p},getCurrentKeyCodeMap:function(){return Ho},drawCenterImage:function(R,u,z,d,f,b,I,H){var x=Oh(u,f,b),W=Lk(u,f,b);Sk(R,u,U(z-x/2),U(d-W/2),x,W,f,b,I,H)},drawStretchImage:function(R,D,f,x,Z,K,S,Q,h,w,n,F){var l,T=Oh(D,Q,h,K),g=Lk(D,Q,h,S);if("uniform"===f?(l=i(K/T,S/g),T*=l,g*=l,x+=U((K-T)/2),Z+=U((S-g)/2),K=T,S=g):"centerUniform"===f&&((T>K||g>S)&&(l=i(K/T,S/g),T*=l,g*=l),x+=U((K-T)/2),Z+=U((S-g)/2),K=T,S=g),"center"===f){var Y=n!==!1&&(T>K||g>S);Y&&(R.save(),R.beginPath(),R.rect(x,Z,K,S),R.clip()),Sk(R,D,x+K/2-T/2,Z+S/2-g/2,T,g,Q,h,w,F),Y&&R.restore()}else Sk(R,D,x,Z,K,S,Q,h,w,F)},toCanvas:function(U,a,p,s,x,T,g,P,O){U=_l(U,g),a=a||Oh(U,x),p=p||Lk(U,x);var S=iq(),v=$l(S);return P?(ob(S,a,p,P),v.scale(P,P)):ob(S,a,p,1),Tb(v,U,s,0,0,a,p,x,T,g,O),U&&U.clampToEdge&&(S.clampToEdge=U.clampToEdge),v.restore(),S},createGradientImage:function(o,C,c,B){for(var e=["L",0,0,o,0,1,0,0,1,0,0],v=0,r=Math.min(C.length,c.length);r>v;v++)e.push(c[v],C[v]);var K=b.Default.toCanvas({width:o,height:o,clampToEdge:!0,comps:[{type:"shape",rotation:B||0,points:[0,0,o,0,o,o,0,o],background:"#ffffff",gradientPack:e}]});return K},createElement:function(N,F,x,P){var b=n.createElement(N);return Vq(b,F||W.widgetBorder,2),b.style.font=x?x:vm,P!=E&&(b.value=P),y.onElementCreated&&y.onElementCreated(b),b
},containedInView:function(V,x){var F=Tf(x).getBoundingClientRect();return Jd({x:F.left,y:F.top,width:F.width,height:F.height},ib(V))},isIsolating:function(){return Ve},setIsolating:function(N){Ve=N},getMSMap:function(){return Jo},stringify:function(g,X){var n=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var k=JSON.stringify(g,function(x,e){return"function"==typeof e?"__ht__"+(e.__ht__||e.toString()):ve(e)?uq(e):e},X==E?2:X);return Date.prototype.toJSON=n,k},parse:function(g){return Xr(g)?JSON.parse(g,function(N,L){if(Xr(L)){if("__ht__function"==L.substr(0,14)){var s=L.indexOf("{")+1,R=L.lastIndexOf("}"),e=L.indexOf("(")+1,W=L.indexOf(")");if(s&&R&&e&&W){var y=new Function(L.substring(e,W),L.substring(s,R));return y.__ht__=L.substr(6),y}}if("__ht__date"==L.substr(0,10))return new Date(l(L.substr(10)))}return L}):g},loadJS:function(s,d){d&&s.push(d);var M=s.shift();if(_n(M))s=M.contact(s),y.loadJS(s);else if(hl(M))M(),y.loadJS(s);else if(Xr(M)){var x=n.createElement("script");x.onload=function(){y.loadJS(s)},x.setAttribute("src",M),n.getElementsByTagName("head")[0].appendChild(x)}else s.length&&y.loadJS(s)},toRoundedCorner:function(O,A){var h=O.size();if(0>=A)return{points:O};var N,p=new Km,V=new Km,Z=O.get(0);p.add(Z),V.add(1);for(var U=1;h>U;U++)if(h>U+1){var H=O.get(U),E=O.get(U+1),n=Z.x,b=Z.y,x=H.x,K=H.y,t=K-b,q=x-n,w=F(t,q);N=i(.99*tm(Z,H),A),p.add({x:x-N*B(w),y:K-N*Y(w)}),p.add(H),n=H.x,b=H.y,x=E.x,K=E.y,t=K-b,q=x-n,w=F(t,q),N=i(.99*tm(H,E),A),Z={x:n+N*B(w),y:b+N*Y(w)},p.add(Z),V.addAll([2,3])}else p.add(O.get(U)),V.add(2);return{points:p,segments:V}},toColorData:ye,setCanvas:ob,createDiv:hc,createDisabledDiv:dn,createView:sj,createCanvas:iq,appendChild:mc,initContext:$l,checkLoadingImage:ql,translateAndScale:mh,layout:qh,getPosition:Bi,drawPoints:Eh,drawRoundRect:Gb,drawBorder:Wn,setFocus:Rg,getter:sg,setter:wd,isEmptyObject:jj},!0),Jn(m,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var xg=y.disabledOpacity,He=y.toolTipDelay,to=y.devicePixelRatio,Pi=y.autoMakeVisible,cs=y.autoHideScrollBar,lg=y.imageGradient,ae=y.showToolTip,Zm=y.hideToolTip,Fl=y.dashPattern,Kc=y.lineCap,Rm=y.lineJoin,lk=y.labelColor,Qo=y.labelSelectColor,vm=y.labelFont,Nj=y.widgetIndent,Ed=y.widgetRowHeight,Ch=y.widgetHeaderHeight,up=y.widgetTitleHeight,Tl=y.scrollBarColor,$n=y.scrollBarSize,Dc=y.scrollBarTimeout,Jg=y.scrollBarMinLength,en=y.scrollBarInteractiveSize,Jp=y.zoomIncrement,nk=y.scrollZoomIncrement,Oo=y.pinchZoomIncrement,Ol=y.zoomMax,Ef=y.zoomMin,Vo=y.createObject,Gm=y.preventDefault,kg=y.setImage,_l=y.getImage,fb=y.isImageComplete,ms=y.drawCenterImage,Tb=y.drawStretchImage,Yj=y.getId,Yh=y.callLater,vq=y.asyncEach,yd=(y.xhrLoad,y.sortFunc),ij=y.clone,Rj=y.getClass,Cn=y.startAnim,Kp=y.brighter,Be=y.darker,$c=y.drawText,wr=y.getTextSize,Jm=y.isLeftButton,Eg=y.getTouchCount,_c=y.isDoubleClick,As=y.isShiftDown,xi=y.isCtrlDown,ib=y.getClientPoint,ef=y.getPagePoint,tm=y.getDistance,wf=y.unionPoint,xb=y.unionRect,Jd=y.containsPoint,ym=y.containsRect,Ae=y.intersectsRect,Fg=y.intersection,xl=y.getWindowInfo,is=y.grow,$b=y.getLogicalPoint,ws=y.startDragging,be=y.removeHTML,Bm=y.createElement,gh=y.segmentResolution,sr=y.shapeResolution,Rh=y.shapeSide,ok=y.def,Jl=function(b,w,D){ok(R+"."+b,w,D)},Nr=function(U,j){U.childNodes.forEach(function(E){j(E),Nr(E,j)})};Jn(y,{toolTipLabelColor:lk,toolTipLabelFont:vm,toolTipBackground:W.toolTipBackground,toolTipShadowColor:Sn,setDevicePixelRatio:function(d){to=y.devicePixelRatio="number"==typeof d?d:Q.devicePixelRatio,Nr(n.body,function(s){var I=s._ht;I&&I._canvas&&(ob(I._canvas,I.getWidth(),I.getHeight()),I.redraw?I.redraw():I.iv())})}},!0);var je=1e-6,Ik="undefined"!=typeof Uint16Array?Uint16Array:Array,Uf="undefined"!=typeof Float32Array?Float32Array:Array,Qh=function(q,A,n){var g=[q[0]-A[0],q[1]-A[1],q[2]-A[2]];if(n){var f=tm(g);f>0&&(g[0]/=f,g[1]/=f,g[2]/=f)}return g},tb=function(x){return[-x[0],-x[1],-x[2]]},We=function(e,D){return 3===e.length?e[0]*D[0]+e[1]*D[1]+e[2]*D[2]:e[0]*D[0]+e[1]*D[1]},kd=function(){var f=new Uf(16);return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f},Kb=kd(),Lg=function(p){var a=new Uf(16);return a[0]=p[0],a[1]=p[1],a[2]=p[2],a[3]=p[3],a[4]=p[4],a[5]=p[5],a[6]=p[6],a[7]=p[7],a[8]=p[8],a[9]=p[9],a[10]=p[10],a[11]=p[11],a[12]=p[12],a[13]=p[13],a[14]=p[14],a[15]=p[15],a},ig=function(u,t){return u[0]=t[0],u[1]=t[1],u[2]=t[2],u[3]=t[3],u[4]=t[4],u[5]=t[5],u[6]=t[6],u[7]=t[7],u[8]=t[8],u[9]=t[9],u[10]=t[10],u[11]=t[11],u[12]=t[12],u[13]=t[13],u[14]=t[14],u[15]=t[15],u},Mi=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},nf=function(z,k){var H=z[0],f=z[1],C=z[2];return z[0]=k[0]*H+k[4]*f+k[8]*C+k[12],z[1]=k[1]*H+k[5]*f+k[9]*C+k[13],z[2]=k[2]*H+k[6]*f+k[10]*C+k[14],z},rd=function(y,a){var R=y[0],B=y[1],P=y[2],x=y[3];return y[0]=a[0]*R+a[4]*B+a[8]*P+a[12]*x,y[1]=a[1]*R+a[5]*B+a[9]*P+a[13]*x,y[2]=a[2]*R+a[6]*B+a[10]*P+a[14]*x,y[3]=a[3]*R+a[7]*B+a[11]*P+a[15]*x,y},fi=function(){var v,f,N,C,P=po(Pe[1]+Pe[7]),_=po(Pe[0]+Pe[3]-Pe[10]),Y=po(Pe[8]+2),I=function(){return f=N.charAt(v),v+=1,f},u=function(){var D="";if(f===Y)for(;I();){if(f===Y)return I(),D;D+=f}else I()},x=function(){for(;f&&" ">=f;)I()},e=function(){var G,O={};if(f===P){if(I(),x(),f===_)return I(),O;for(;f;){if(G=u(),x(),I(),O[G]=C(),x(),f===_)return I(),O;I(),x()}}};return C=function(){switch(x(),f){case P:return e();default:return u()}},function(G){if(V={},G){var A;if(N=G,v=0,f=" ",A=C(),x(),!f)return A}}}(),Cm=function(i,z){if(z){var P=Y(z),r=B(z),m=i[4],V=i[5],t=i[6],F=i[7],R=i[8],n=i[9],X=i[10],$=i[11];i[4]=m*r+R*P,i[5]=V*r+n*P,i[6]=t*r+X*P,i[7]=F*r+$*P,i[8]=R*r-m*P,i[9]=n*r-V*P,i[10]=X*r-t*P,i[11]=$*r-F*P}},so=function(W,I){if(I){var s=Y(I),h=B(I),J=W[0],A=W[1],O=W[2],H=W[3],N=W[8],b=W[9],$=W[10],m=W[11];W[0]=J*h-N*s,W[1]=A*h-b*s,W[2]=O*h-$*s,W[3]=H*h-m*s,W[8]=J*s+N*h,W[9]=A*s+b*h,W[10]=O*s+$*h,W[11]=H*s+m*h}},Pc=function(n,I){if(I){var a=Y(I),K=B(I),U=n[0],o=n[1],f=n[2],h=n[3],E=n[4],y=n[5],u=n[6],X=n[7];n[0]=U*K+E*a,n[1]=o*K+y*a,n[2]=f*K+u*a,n[3]=h*K+X*a,n[4]=E*K-U*a,n[5]=y*K-o*a,n[6]=u*K-f*a,n[7]=X*K-h*a}},rp=function(Z,f,p){return Zb(E,p===!1?E:Z.getFinalScale3d(),Z.r3(),Z.getRotationMode(),Z.p3(),E,f)},Zb=function(X,N,o,D,H,Q,v){return Q||(Q=kd()),H&&xj(Q,H),nn(Q,o,D),v&&sf(Q,Q,v),N&&Nl(Q,N),X&&sf(Q,Q,X),Q},Ub=function(R,K,W){K=l(K),W=l(W);var Q=this;Q.g=R,Q._84O=K,Q._85O=W,Q._70I=!0,Q.F=0,Q._83O=K+W,Q.pen={x:0,y:0}},Fo="lineDashOffset",pj="setLineDash",Nb=function(G){for(var X in G)1===X.length&&(Fo=G[X]);return X?1:0},rj=function(x,b,m){return Zq(b)?x:x[pj]?(x[pj](b),m&&(x.lineDashOffset=m),x):new Ub(x,b[0],b.length>1?b[1]:b[0])},hh=function(m,w){!Zq(w)&&m[pj]&&(m[pj](_e),m.lineDashOffset=0)};if(ok(Ub,O,{_69I:6,moveTo:function(S,A){var V=this,y=V.pen;y.x=S,y.y=A,V.g.moveTo(S,A),V.start||(V.start={x:S,y:A})},lineTo:function(g,o){var n=this,I=n.pen,x=g-I.x,m=o-I.y,Z=F(m,x),z=B(Z),c=Y(Z),S=n._23O(I.x,I.y,g,o),M=n._85O,U=n._84O,y=n._83O;if(n.F){if(n.F>S)return n._70I?n._72I(g,o):n.moveTo(g,o),n.F-=S,void 0;if(n._70I?n._72I(I.x+z*n.F,I.y+c*n.F):n.moveTo(I.x+z*n.F,I.y+c*n.F),S-=n.F,n.F=0,n._70I=!n._70I,!S)return}var P=r(S/y);if(P){for(var l=z*U,G=c*U,h=z*M,C=c*M,f=0;P>f;f++)n._70I?(n._72I(I.x+l,I.y+G),n.moveTo(I.x+h,I.y+C)):(n.moveTo(I.x+h,I.y+C),n._72I(I.x+l,I.y+G));S-=y*P}n._70I?S>U?(n._72I(I.x+z*U,I.y+c*U),n.moveTo(g,o),n.F=M-(S-U),n._70I=!1):(n._72I(g,o),S===U?(n.F=0,n._70I=!n._70I):(n.F=U-S,n.moveTo(g,o))):S>M?(n.moveTo(I.x+z*M,I.y+c*M),n._72I(g,o),n.F=U-(S-M),n._70I=!0):(n.moveTo(g,o),S===M?(n.F=0,n._70I=!n._70I):n.F=M-S)},quadraticCurveTo:function(T,V,l,v){var P,K=this,D=K.pen,w=D.x,I=D.y,k=K._22O(w,I,T,V,l,v),x=0,Y=0,F=K._85O,f=K._84O;if(K.F){if(K.F>k)return K._70I?K._71I(T,V,l,v):K.moveTo(l,v),K.F-=k,void 0;if(x=K.F/k,P=K._20O(w,I,T,V,l,v,x),K._70I?K._71I(P[2],P[3],P[4],P[5]):K.moveTo(P[4],P[5]),K.F=0,K._70I=!K._70I,!k)return}var X=k-k*x,S=r(X/K._83O),g=f/k,B=F/k;if(S)for(var b=0;S>b;b++)K._70I?(Y=x+g,P=K._21O(w,I,T,V,l,v,x,Y),K._71I(P[2],P[3],P[4],P[5]),x=Y,Y=x+B,P=K._21O(w,I,T,V,l,v,x,Y),K.moveTo(P[4],P[5])):(Y=x+B,P=K._21O(w,I,T,V,l,v,x,Y),K.moveTo(P[4],P[5]),x=Y,Y=x+g,P=K._21O(w,I,T,V,l,v,x,Y),K._71I(P[2],P[3],P[4],P[5])),x=Y;X=k-k*x,K._70I?X>f?(Y=x+g,P=K._21O(w,I,T,V,l,v,x,Y),K._71I(P[2],P[3],P[4],P[5]),K.moveTo(l,v),K.F=F-(X-f),K._70I=!1):(P=K._19O(w,I,T,V,l,v,x),K._71I(P[2],P[3],P[4],P[5]),k===f?(K.F=0,K._70I=!K._70I):(K.F=f-X,K.moveTo(l,v))):X>F?(Y=x+B,P=K._21O(w,I,T,V,l,v,x,Y),K.moveTo(P[4],P[5]),P=K._19O(w,I,T,V,l,v,Y),K._71I(P[2],P[3],P[4],P[5]),K.F=f-(X-F),K._70I=!0):(K.moveTo(l,v),X===F?(K.F=0,K._70I=!K._70I):K.F=F-X)},bezierCurveTo:function(){var N=arguments;this.pen={x:N[4],y:N[5]},this.g.bezierCurveTo(N[0],N[1],N[2],N[3],N[4],N[5])},arc:function(X,N,S,r,a,T){T||(r=-r,a=-a),vc(this,X,N,r,a-r,S,S,!1)},rect:function(Z,a,u,L){var k=this;k.pen={x:Z,y:a},k.moveTo(Z,a),k.lineTo(Z,a+L),k.lineTo(Z+u,a+L),k.lineTo(Z+u,a),k.lineTo(Z,a)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(D,K,L,m){var k=L-D,h=m-K;return d(k*k+h*h)},_22O:function(c,V,x,t,U,s,K){for(var S,Q,d,$,M,J,R,m=0,w=c,A=V,q=K>0?K:this._69I,g=1;q>=g;g++)d=g/q,$=1-d,M=$*$,J=2*d*$,R=d*d,S=M*c+J*x+R*U,Q=M*V+J*t+R*s,m+=this._23O(w,A,S,Q),w=S,A=Q;return m},_21O:function(M,R,N,q,V,$,H,w){var L=this;if(0===H)return L._20O(M,R,N,q,V,$,w);if(1===w)return L._19O(M,R,N,q,V,$,H);var n=L._20O(M,R,N,q,V,$,w);return n.push(H/w),L._19O.apply(L,n)},_20O:function(g,w,i,l,e,c,a){if(1!==a){var W=i+(e-i)*a,k=l+(c-l)*a;i=g+(i-g)*a,l=w+(l-w)*a,e=i+(W-i)*a,c=l+(k-l)*a}return[g,w,i,l,e,c]},_19O:function(o,i,x,n,E,A,l){if(1!==l){var j=o+(x-o)*l,T=i+(n-i)*l;x+=(E-x)*l,n+=(A-n)*l,o=j+(x-j)*l,i=T+(n-T)*l}return[o,i,x,n,E,A]},_72I:function(A,y){var s=this.pen;(A!==s.x||y!==s.y)&&(s.x=A,s.y=y,this.g.lineTo(A,y))},_71I:function(w,Z,F,l){var C=this.pen;(w!==F||Z!==l||F!==C.x||l!==C.y)&&(C.x=F,C.y=l,this.g.quadraticCurveTo(w,Z,F,l))}}),H&&Z){var ls=Z.toString();A=ls.indexOf(mb.substr(0,2))>0&&ls.indexOf(lf+lf.substr(1,1))>1?!0:!1}var fr=E,gr=E,xk=function(l){fr&&!l._72O&&(gr||(gr={}),gr[l._72O=Yj()]=l)},qk=function(k,X){if(X||(X=k),X&&(fr||(fr={}),!fr[k])){var a=new XMLHttpRequest;if(fr[X]={request:a,url:X},a.overrideMimeType&&a.overrideMimeType("text/plain"),X=y.beforeLoadURL(X),X.data){var S=y.parse(X.data);gs(k,S),y.handleCompTypeLoaded(k,S)}else a.open("GET",encodeURI(X),!0),a.onload=function(a){if(200===this.status||0===this.status){var z=y.parse(a.target.response||a.target.responseText);gs(k,z),y.handleCompTypeLoaded(k,z)}else gs(k,E)},a.onerror=function(){gs(k,E)},a.send(null)}},gs=function(z,Y){if(lh[z]=Y,delete fr[z],jj(fr)&&(fr=E,gr)){for(var P in gr){var p=gr[P];p.invalidateAll&&p.invalidateAll(K,"compTypeLoaded",z),p.redraw&&p.redraw(),p.iv(),delete p._72O}gr=E}if(Y&&gr)for(var P in gr){var p=gr[P];p.invalidateAll&&p.invalidateAll(K,"compTypeLoading",z),p.redraw&&p.redraw(),p.iv()}},wn=W.chart,kq=y.compStack=[],em=/^style@/,xc=/^attr@/,Pj=/^field@/,dg={x:.5,y:.5},Oh=function(O,r,P,v){if(!O)return 0;if(_h(O.fitSize,r,P)&&v)return v;var S=_h(O.width,r,P);return null==S?20:S},Lk=function(Y,b,A,t){if(!Y)return 0;if(_h(Y.fitSize,b,A)&&t)return t;var x=_h(Y.height,b,A);return null==x?20:x},_h=function(c,Y,e){if(!c||!c.func)return c;var S,T=c.func,$=c.value;return S=hl(T)?e&&e.vectorDataBindingDisabled&&!c.isSafeFunc?$:T(Y,e):Y instanceof Wm?xc.test(T)?Y.a(T.slice(5)):em.test(T)?Y.s(T.slice(6)):Pj.test(T)?Y[T.slice(6)]:Y[T]?Y[T](e):$:$,$!==K&&S==E?$:S},Sk=y.drawImage=function(){var _,l,t,o,V,d,H=function(q,F){q.getValue&&q.getValue.compType===F||(q.getValue=function(t){var C=Z(q,t);if(C===K&&F.properties){var b=F.properties[t];b&&(C=b.defaultValue)}return C},q.getValue.compType=F)},Z=function(v,e,u){var m=v[e];return m&&m.func?(m=_h(m,l,t),u&&(m=u(m))):u&&(m=v[e]=u(m)),m},b=function(L,i){var $;if($=i?Z(L,i):L,V&&$){if("override"===d)return V;if("override_rgb"===d){var e=pe(V);return $=ye($),"rgba("+r(255*e[0])+","+r(255*e[1])+","+r(255*e[2])+","+$[3]/255+")"}if("override_a"===d){var e=pe(V);return $=ye($),"rgba("+$[0]+","+$[1]+","+$[2]+","+e[3]+")"}var e=pe(V);return $=ye($),"rgba("+r($[0]*e[0])+","+r($[1]*e[1])+","+r($[2]*e[2])+","+$[3]/255*e[3]+")"}return $},S=function(n){if(_n(n)){for(var z=new Km,s=n.length,c=0;s>c;c+=2)z.add({x:n[c],y:n[c+1]});n=z}return n},p=function(e){var F=Z(e,"anchorX"),W=Z(e,"anchorY");if(F!==K||W!==K)return{x:F===K?dg.x:F,y:W===K?dg.y:W};var c=Z(e,"type"),a=Z(e,"name");if("image"!==c||!a)return dg;var i=_l(a);return i&&i.anchorX&&i.anchorY?{x:i.anchorX,y:i.anchorY}:dg},n=function(b,H){var W=Z(b,qo),l=p(b);if(_n(W)){var w=W.length,q=Z(b,"relative"),e=H.width,J=H.height;if(4===w)W={x:W[0],y:W[1],width:W[2],height:W[3]},q?(W.x*=e,W.y*=J,W.width*=e,W.height*=J):H.fitSize&&(W.x*=H.widthScale,W.width*=H.widthScale,W.y*=H.heightScale,W.height*=H.heightScale);else if(3===w){var S=W[0];W={width:W[1],height:W[2]},q?(W.width*=e,W.height*=J):H.fitSize&&(W.width*=H.widthScale,W.height*=H.heightScale),"object"==typeof S?S.length&&(S={x:S[0],y:S[1]}):S=Bi(S,H,W),W.x=S.x-W.width*l.x,W.y=S.y-W.height*l.y}var D=Z(b,"offsetX");D&&(H.fitSize&&(D*=H.widthScale),W.x+=D),D=Z(b,"offsetY"),D&&(H.fitSize&&(D*=H.heightScale),W.y+=D)}return W},s=function(K){return _n(K)?new Km(K):K},z=function(m,Q,k,M,J,d,h){J===K&&(J=1),d===K&&(d=1);var p=Z(m,"clipPercentage"),N=Al(k,Q);if(N&&!M&&1===J&&1===d&&!(1>p))return!1;h=h||dg;var a=Q.x+Q.width*h.x,W=Q.y+Q.height*h.y,U=k.x+k.width*h.x,Y=k.y+k.height*h.y;if(_.save(),lp(_,a,W),Kh(_,M),Ph(_,J*(Q.width/k.width),d*(Q.height/k.height)),lp(_,-U,-Y),1>p){0>p&&(p=0);var F=qg(k,Z(m,"clipDirection"),p);_.beginPath(),_.rect(F.x,F.y,F.width,F.height),_.clip()}return!0},C=function(){_.restore()},g=function(s,y,N){var B=Z(s,"path"),j=Z(s,Ih),S=Z(s,"scaleX"),t=Z(s,"scaleY"),l=p(s),r=E,Y=si(null,B);if(N||(N=s.unionRect,N||(N=wf(Y),s.path.func||(s.unionRect=N)),r=N),N){r||(r=s.unionRect,r||(r=wf(Y),s.path.func||(s.unionRect=r)));var v=z(s,N,r,j,S,t,l),Q=Z(s,"borderPattern"),d=rj(_,Q),F=b(s,"background"),n=b(s,"borderColor"),R=Z(s,"borderWidth"),a=Z(s,"gradient"),w=b(s,"gradientColor"),H=Z(s,"border3d"),K=Z(s,"border3dColor"),u=Z(s,"border3dAccuracy"),f=_.lineJoin,U=_.lineCap;if(_.lineJoin=Z(s,"borderJoin")||Rm,_.lineCap=Z(s,"borderCap")||Kc,F?(Bf(_,F,a,w,r),si(_,B),_.fill(),d!==_&&si(_,B)):si(_,B),R&&n){var X=Z(s,"borderWidthAbsolute");X&&(_.save(),_.setTransform(1,0,0,1,0,0)),_.lineWidth=R,_.strokeStyle=n,_.stroke(),X&&_.restore(),H&&Hq(_,n,K,R,o,u)}if(hh(_,Q),Z(s,"dash")){var M=Z(s,"dashWidth")||R;if(M>0){Q=Z(s,"dashPattern")||Fl;var d=rj(_,Q,Z(s,"dashOffset")),g=b(s,"dashColor")||b(rq);d!==_&&si(_,B),_.strokeStyle=g,_.lineWidth=M,_.stroke(),Z(s,"dash3d")&&Hq(_,g,b(s,"dash3dColor"),M,o,Z(s,"dash3dAccuracy")),hh(_,Q)}}y===qo&&ah(_,F,Z(s,"depth"),r),_.lineJoin=f,_.lineCap=U,v&&C()}},Q=function(O,M,g,k){var T=Z(O,kn,S),q=Z(O,Ih),c=p(O);if(T&&k.fitSize){var B=Math.abs(Math.cos(q))<.001,Q=new Km,h=wf(T),K=k.widthScale,j=k.heightScale,u=h.x+c.x*h.width,N=h.y+c.y*h.height,J=u*K,r=N*j;T.each(function(b){var s=b.x-u,e=b.y-N;Q.add({x:J+s*(B?j:K),y:r+e*(B?K:j)})}),T=Q,O.unionRect=null}var D=Z(O,"scaleX"),v=Z(O,"scaleY"),L=M===np,W=E;if(!g&&L&&(g=O.unionRect,g||(g=wf(T),O.points.func||(O.unionRect=g)),W=g),g){L?W||(W=O.unionRect,W||(W=wf(T),O.points.func||(O.unionRect=W))):W=g;var I,y,w,m,F=z(O,g,W,q,D,v,c),n=Z(O,"borderPattern"),e=rj(_,n),Y=b(O,"background"),i=_l(Z(O,"repeatImage"),V,d),G=Z(O,"gradientPack"),U=b(O,"borderColor"),a=Z(O,"borderWidth"),P=Z(O,"segments",s),R=Z(O,"gradient"),H=b(O,"gradientColor"),x=Z(O,"border3d"),f=Z(O,"border3dColor"),X=Z(O,"border3dAccuracy"),A=Z(O,"closePath"),$=Z(O,"fillRule")||"nonzero",fb=_.lineJoin,qq=_.lineCap;if(_.lineJoin=Z(O,"borderJoin")||Rm,_.lineCap=Z(O,"borderCap")||Kc,L)if(Y||i||G){var Tb=Z(O,"fillClipPercentage");if(1>Tb){0>Tb&&(Tb=0);var ap=qg(W,Z(O,"fillClipDirection"),Tb);_.save(),_.beginPath(),_.rect(ap.x,ap.y,ap.width,ap.height),_.clip()}if(Eh(_,T,P,A),G)Hf(_,G);else if(i){var gf=_,fo=V,tl=d;Qe(_,i,V,d,l,t),_=gf,V=fo,d=tl}else{var gf=_;Bf(_,Y,R,H,W),_=gf}_.fill($),1>Tb&&_.restore(),G&&_.restore(),e!==_&&Eh(e,T,P,A)}else Eh(e,T,P,A);else if("roundRect"===M?I=Z(O,"cornerRadius"):"polygon"===M?I=Z(O,"polygonSide"):"arc"===M&&(I=Z(O,"arcFrom"),y=Z(O,"arcTo"),w=Z(O,"arcClose"),m=Z(O,"arcOval")),Y||i||G){var Tb=Z(O,"fillClipPercentage");if(1>Tb){0>Tb&&(Tb=0);var ap=qg(W,Z(O,"fillClipDirection"),Tb);_.save(),_.beginPath(),_.rect(ap.x,ap.y,ap.width,ap.height),_.clip()}if(mn(_,M,W,I,y,w,m),G)Hf(_,G);else if(i){var gf=_,fo=V,tl=d;Qe(_,i,V,d,l,t),_=gf,V=fo,d=tl}else Bf(_,Y,R,H,W);_.fill($),1>Tb&&_.restore(),G&&_.restore(),_!==e&&mn(e,M,W,I,y,w,m)}else mn(e,M,W,I,y,w,m);if(a&&U){var Ah=Z(O,"borderWidthAbsolute");Ah&&(_.save(),_.setTransform(1,0,0,1,0,0)),_.lineWidth=a,_.strokeStyle=U,_.stroke(),Ah&&_.restore(),x&&Hq(_,U,f,a,o,X)}if(hh(_,n),Z(O,"dash")){var fj=Z(O,"dashWidth")||a;if(fj>0){n=Z(O,"dashPattern")||Fl;var e=rj(_,n,Z(O,"dashOffset")),vn=b(O,"dashColor")||b(rq);e!==_&&(L?Eh(e,T,P,A):mn(e,M,W,I,y,w,m)),_.strokeStyle=vn,_.lineWidth=fj,_.stroke(),Z(O,"dash3d")&&Hq(_,vn,b(O,"dash3dColor"),fj,o,Z(O,"dash3dAccuracy")),hh(_,n)}}M===qo&&ah(_,Y,Z(O,"depth"),W),_.lineJoin=fb,_.lineCap=qq,F&&C()}},$=function($,v){var n=V,q=d,G=V||Z($,Gl),N=d||Z($,"blendMode"),R=_l(Z($,"name"),G,N);R&&(Tb(_,R,Z($,"stretch"),v.x,v.y,v.width,v.height,l,t,G,null,N),V=n,d=q)},f=function(R,u){var S=Z(R,"text");S!=E&&$c(_,S,Z(R,"font"),b(R,Gl),u.x,u.y,u.width,u.height,Z(R,"align"),Z(R,"vAlign"))},w=function(o,k){Wn(_,b(o,Gl),k.x,k.y,k.width,k.height,Z(o,"width"))},J=function($,f){var N=Z($,ch),V=0;if(N&&(N.forEach(function(r){V+=r}),V>0)){for(var e=Z($,"colors")||wn,q=Z($,"startAngle")||0,y=Z($,"hollow"),d=Z($,Yk),w=Z($,Kq),k=Z($,Ji),s=d?new Km:E,r=f.x,U=f.y,c=f.width,Q=f.height,g=r+c/2,O=U+Q/2,o=i(c,Q)/2,A=0,F=0;F<N.length;F++){var X=N[F],v=I*X/V,J=q+v;if(_.fillStyle=e[A++],A===e.length&&(A=0),_.beginPath(),y){var P=g+B(q)*o/2,x=O+Y(q)*o/2,b=g+B(J)*o,C=O+Y(J)*o;_.moveTo(P,x),_.arc(g,O,o/2,q,J,!1),_.lineTo(b,C),_.arc(g,O,o,J,q,!0)}else _.moveTo(g,O),_.arc(g,O,o,J,q,!0);s&&(v=(q+J)/2,s.add({text:hl(d)?d(X,F,V,l):X,x:g+.75*B(v)*o,y:O+.75*Y(v)*o})),_.closePath(),_.fill(),q=J}s&&s.each(function(K){$c(_,K.text,w,k,K.x,K.y,0,0,lm)})}},x=function(w,p){var S=Z(w,cr);if(S&&S.length>0){var C=S.length,T=Z(w,Yk),x=Z(w,Kq),c=Z(w,Ji),$=T?new Km:E,e=Z(w,"minValue")||0,d=Z(w,"maxValue");if(d==E&&(d=0,S.forEach(function(B){B.values.forEach(function(g){d=M(d,g)})})),e===d)return;for(var Q=p.height/(d-e),G=p.y+d*Q,I=Z(S[0],ch).length,j=p.width/(3*I+1),o=2*j/C,u=0,t=0;C>t;t++)for(var H=S[t],m=Z(H,Gl),A=Z(H,"colors"),b=Z(H,ch),f=0;I>f;f++){A?_.fillStyle=A[f]:m?_.fillStyle=m:(_.fillStyle=wn[u++],u===wn.length&&(u=0));var O=b[f],h=O*Q,i=p.x+(1+3*f)*j+t*o;if(an(_,i,G-h,o,h),$){var z=hl(T)?T(O,f,H,l):O,R=wr(x,z).height;$.add({x:i,y:G-h-R,width:o,height:R,text:z})}}$&&$.each(function(R){$c(_,R.text,x,c,R.x,R.y,R.width,R.height,lm)})}},U=function(Y,P){var u=Z(Y,cr);if(u&&u.length>0){var C=u.length,k=Z(u[0],ch).length,a=P.width/(3*k+1),q=0,f=Z(Y,"maxValue"),B=Z(Y,Yk),p=Z(Y,Kq),g=Z(Y,Ji),s=B?new Km:E;if(f==E){f=0;for(var X=0;k>X;X++){for(var h=0,K=0;C>K;K++)h+=Z(u[K],ch)[X];f=M(f,h)}}if(f>0){for(var X=0;k>X;X++)for(var Q=P.y+P.height,K=0;C>K;K++){var F=u[K],L=Z(F,Gl),A=Z(F,ch)[X],b=A/f*P.height;L?_.fillStyle=L:(_.fillStyle=wn[q++],q===wn.length&&(q=0)),Q-=b;var S={x:P.x+(1+3*X)*a,y:Q,width:2*a,height:b};an(_,S.x,S.y,S.width,S.height),s&&(S.text=hl(B)?B(A,X,F,l):A,s.add(S))}s&&s.each(function(G){$c(_,G.text,p,g,G.x,G.y,G.width,G.height,lm)})}}},e=function(c,K){var M=Z(c,cr);if(M&&M.length>0){for(var V=M.length,B=Z(M[0],ch).length,X=K.width/(3*B+1),O=0,k=Z(c,Yk),$=Z(c,Kq),f=Z(c,Ji),z=k?new Km:E,w=0;B>w;w++){for(var j=0,r=0;V>r;r++)j+=Z(M[r],ch)[w];if(j>0){var o=K.y+K.height;for(r=0;V>r;r++){var b=M[r],F=Z(b,Gl),Q=Z(b,ch)[w],R=Q/j*K.height;F?_.fillStyle=F:(_.fillStyle=wn[O++],O===wn.length&&(O=0)),o-=R;var e={x:K.x+(1+3*w)*X,y:o,width:2*X,height:R};an(_,e.x,e.y,e.width,e.height),z&&(e.text=hl(k)?k(Q,w,b,l):Q,z.add(e))}}}z&&z.each(function(u){$c(_,u.text,$,f,u.x,u.y,u.width,u.height,lm)})}},m=function(q,J){var C=Z(q,cr);if(C&&C.length>0){var b=C.length,h=Z(q,"minValue")||0,s=Z(q,"maxValue");if(s==E&&(s=0,C.forEach(function(I){I.values.forEach(function(k){s=M(s,k)})})),h===s)return;for(var a=J.height/(s-h),i=J.y+s*a,W=Z(C[0],ch).length,z=J.width/(3*W+1),m=0,w=Z(q,"lineWidth")||2,X=Z(q,"line3d"),$=Z(q,"linePoint"),U=Z(q,Yk),O=Z(q,Kq),L=Z(q,Ji),Y=0;b>Y;Y++){var u=C[Y],x=Z(u,Gl),A=Z(u,ch);x?_.strokeStyle=x:(x=_.strokeStyle=wn[m++],m===wn.length&&(m=0)),_.beginPath();for(var f=0;W>f;f++){var H=J.x+(2+3*f)*z,V=i-A[f]*a;0===f?_.moveTo(H,V):_.lineTo(H,V)}if(_.lineWidth=w,_.stroke(),X&&Hq(_,x,E,w,o),$||U){var t,T=w/2+2;for(f=0;W>f;f++){var F=A[f];if(H=J.x+(2+3*f)*z,V=i-F*a,hl($)?$(_,H,V,x,f,u,l):$&&(_.fillStyle=x,_.beginPath(),_.arc(H,V,T,0,I,!0),_.fill()),hl(U)?t=U(F,f,u,l):U&&(t=F),t){var B=wr(O,t).height,p=_.shadowBlur;if(p){var P=_.shadowOffsetX,R=_.shadowOffsetY,G=_.shadowColor;_.shadowOffsetX=0,_.shadowOffsetY=0,_.shadowBlur=0,_.shadowColor=E}$c(_,t,O,L,H,V-B-T+2,0,B,lm),p&&(_.shadowOffsetX=P,_.shadowOffsetY=R,_.shadowBlur=p,_.shadowColor=G)}}}}}},P={border:w,image:$,text:f,pieChart:J,columnChart:x,stackedColumnChart:U,percentageColumnChart:e,lineChart:m};return function(M,F,j,Y,r,O,W,f,L,G){if(F&&r&&O){_=M,l=W,t=f,o=t?t._zoom?t._zoom:1:1,V=L,d=G;var k=r,i=O;if(de()){var h,a,U;0===_[sb]?de[0]&&(h=!0):h=!0,_.texureImage2D?de[1]&&(a=!0):a=!0,_.texureImage3D?de[2]&&(U=!0):U=!0,h&&a&&U&&(k=j,i=Y)}if(F.tagName)return _.drawImage(F,k,i,r,O),void 0;if(Z(F,"visible")!==!1){V||(V=_h(F.color,l,t)),G||(d=_h(F.blendMode,l,t));var B=Oh(F,l,t,r),$=Lk(F,l,t,O),N={x:0,y:0,width:B,height:$,fitSize:Z(F,"fitSize")},v=Z(F,"clip"),u=Z(F,"opacity");N.fitSize&&(N.widthScale=B/_h(F.width,l,t),N.heightScale=$/_h(F.height,l,t)),_.save(),lp(_,k,i),(B!==r||$!==O)&&_.scale(r/B,O/$),v&&(hl(v)?v(_,B,$,l,t,F):(_.beginPath(),_.rect(0,0,B,$),_.clip())),u!=E&&(_.globalAlpha*=u),Z(F,"comps").forEach(function($){if(Z($,oj)!==!1){kq.splice(0,0,$);var M=Z($,"opacity"),V=Z($,"shadow"),I=Z($,"type"),q=n($,N);if(M!=E){var Y=_.globalAlpha;_.globalAlpha*=M}if(V){var u=_.shadowOffsetX,i=_.shadowOffsetY,r=_.shadowBlur,J=_.shadowColor,B=Z($,"shadowOffsetX"),G=Z($,"shadowOffsetY"),f=Z($,"shadowBlur"),L=b($,"shadowColor");_.shadowOffsetX=(B==E?3:B)*o,_.shadowOffsetY=(G==E?3:G)*o,_.shadowBlur=(f==E?6:f)*o,_.shadowColor=L||b(Sn)}if("save"===I)_.save();else if("endClip"===I||"restore"===I)_.restore();else if("clip"===I)_.save(),Eh(_,Z($,"points",S),Z($,"segments",s),!0),_.clip();else if(nr[I])q=q||{x:0,y:0,width:N.width,height:N.height},Q($,I,q,N);else if(I===np)Q($,I,q,N);else if("SVGPath"===I)g($,I,q);else{q=q||{x:0,y:0,width:N.width,height:N.height};var T=Z($,Ih),A=Z($,"scaleX"),X=Z($,"scaleY"),k=p($),j=z($,q,q,T,A,X,k);if(hl(I))H($,I),y.drawCompType(I,_,q,$,l,t);else if(y.getCompType(I)){var W=y.getCompType(I),D=W.func||W;H($,W),y.drawCompType(D,_,q,$,l,t)}else P[I]?P[I]($,q):y.getCompType(I)===K&&ue.test(I)&&qk(I);j&&C()}V&&(_.shadowOffsetX=u,_.shadowOffsetY=i,_.shadowBlur=r,_.shadowColor=J),M!=E&&(_.globalAlpha=Y),kq.splice(0,1)}}),_.restore()}}}}();y.getCurrentComp=function(){return kq[0]},y.getParentComp=function(){return kq[1]},y.getInternal=function(){return{isEnter:Im,isEsc:Xm,isSpace:kp,isLeft:Yf,isUp:dh,isRight:nb,isDown:Kr,addMethod:Jn,superCall:hi,toPointsArray:dd,translateAndScale:mh,appendArray:vp,createWorldMatrix:Zb,vec3TransformMat4:nf,setCanvas:ob,createDiv:hc,createView:sj,createCanvas:iq,createImage:Bs,initContext:$l,layout:qh,fillRect:an,Mat:fs,drawBorder:Wn,isString:Xr,setBorder:Vq,getPropertyValue:tj,setPropertyValue:yb,drawVerticalLine:Np,draw3DRect:ah,getPinchDist:Hc,isSameRect:Al,getPosition:Bi,intersectionLineRect:Vb,getNodeRect:pf,getEdgeAgentPosition:Sp,getImageWidth:Oh,getImageHeight:Lk,initItemElement:Jk,drawPoints:Eh,createG2:rj,closePopup:Gd,isH:Pl,createAnim:zn,createNormalMatrix:me,createNormals:ze,toFloatArray:rl,glMV:cl,batchShape:tc,createNodeMatrix:rp,getFaceInfo:il,transformAppend:Xp,drawFaceInfo:rs,to3dPointsArray:cb,setGLDebugMode:function(x){wj=x},cube:function(){return{vs:Ag,is:_d,uv:io}},ui:function(){return{DataUI:qd,NodeUI:Gc,EdgeUI:tq,GroupUI:wm,ShapeUI:pc,GridUI:Re,Data3dUI:Mp,Node3dUI:ng,Shape3dUI:us}},getInternalVersion:function(){return"U2FsdGVkX1/wtsksJU4HtGC6xd14Ip7vOWQOGLeCspU="},getDragger:function(){return tk},addMSMap:function(Q){Jn(Jo,Q)},k:v}},function(W){function o(R,O){R!=E&&(O==E&&Ec!=typeof R?this._54O(R,256):this._54O(R,O))}function Q(){return new o(E)}function g(M,X,_,m,b,p){for(;--p>=0;){var w=X*this[M++]+_[m]+b;b=r(w/67108864),_[m++]=67108863&w}return b}function L(d,S,J,w,K,p){for(var D=32767&S,Q=S>>15;--p>=0;){var A=32767&this[d],f=this[d++]>>15,y=Q*A+f*D;A=D*A+((32767&y)<<15)+J[w]+(1073741823&K),K=(A>>>30)+(y>>>15)+Q*f+(K>>>30),J[w++]=1073741823&A}return K}function J(R,K,D,m,F,M){for(var j=16383&K,V=K>>14;--M>=0;){var i=16383&this[R],l=this[R++]>>14,b=V*i+l*j;i=j*i+((16383&b)<<14)+D[m]+F,F=(i>>28)+(b>>14)+V*l,D[m++]=268435455&i}return F}function x(o){return Dc.charAt(o)}function t(x,e){var F=Tl[x.charCodeAt(e)];return F==E?-1:F}function V(u){for(var V=this.t-1;V>=0;--V)u[V]=this[V];u.t=this.t,u.s=this.s}function O(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+this.DV:this.t=0}function j(L){var U=Q();return U._58O(L),U}function T(H,j){var G,b=this;if(16==j)G=4;else if(8==j)G=3;else if(256==j)G=8;else if(2==j)G=1;else if(32==j)G=5;else{if(4!=j)return b.fromRadix(H,j),void 0;G=2}b.t=0,b.s=0;for(var U=H.length,l=!1,W=0;--U>=0;){var k=8==G?255&H[U]:t(H,U);0>k?"-"==H.charAt(U)&&(l=!0):(l=!1,0==W?b[b.t++]=k:W+G>b.DB?(b[b.t-1]|=(k&(1<<b.DB-W)-1)<<W,b[b.t++]=k>>b.DB-W):b[b.t-1]|=k<<W,W+=G,W>=b.DB&&(W-=b.DB))}8==G&&0!=(128&H[0])&&(b.s=-1,W>0&&(b[b.t-1]|=(1<<b.DB-W)-1<<W)),b._57O(),l&&o.ZERO._78O(b,b)}function s(){for(var s=this,a=s.s&s.DM;s.t>0&&s[s.t-1]==a;)--s.t}function G(w){var G=this;if(G.s<0)return"-"+G._85O()[De](w);var e;if(16==w)e=4;else if(8==w)e=3;else if(2==w)e=1;else if(32==w)e=5;else{if(4!=w)return G.toRadix(w);e=2}var B,W=(1<<e)-1,i=!1,I="",y=G.t,Q=G.DB-y*G.DB%e;if(y-->0)for(Q<G.DB&&(B=G[y]>>Q)>0&&(i=!0,I=x(B));y>=0;)e>Q?(B=(G[y]&(1<<Q)-1)<<e-Q,B|=G[--y]>>(Q+=G.DB-e)):(B=G[y]>>(Q-=e)&W,0>=Q&&(Q+=G.DB,--y)),B>0&&(i=!0),i&&(I+=x(B));return i?I:"0"}function K(){var s=Q();return o.ZERO._78O(this,s),s}function a(){return this.s<0?this._85O():this}function w(n){var R=this,V=R.s-n.s;if(0!=V)return V;var X=R.t;if(V=X-n.t,0!=V)return R.s<0?-V:V;for(;--X>=0;)if(0!=(V=R[X]-n[X]))return V;return 0}function n(c){var $,n=1;return 0!=($=c>>>16)&&(c=$,n+=16),0!=($=c>>8)&&(c=$,n+=8),0!=($=c>>4)&&(c=$,n+=4),0!=($=c>>2)&&(c=$,n+=2),0!=($=c>>1)&&(c=$,n+=1),n}function A(){var j=this;return j.t<=0?0:j.DB*(j.t-1)+n(j[j.t-1]^j.s&j.DM)}function m(v,M){var t;for(t=this.t-1;t>=0;--t)M[t+v]=this[t];for(t=v-1;t>=0;--t)M[t]=0;M.t=this.t+v,M.s=this.s}function k(f,R){for(var m=f;m<this.t;++m)R[m-f]=this[m];R.t=M(this.t-f,0),R.s=this.s}function C(l,i){var D,J=this,h=l%J.DB,H=J.DB-h,W=(1<<H)-1,g=r(l/J.DB),K=J.s<<h&J.DM;for(D=J.t-1;D>=0;--D)i[D+g+1]=J[D]>>H|K,K=(J[D]&W)<<h;for(D=g-1;D>=0;--D)i[D]=0;i[g]=K,i.t=J.t+g+1,i.s=J.s,i._57O()}function F(D,N){var M=this;N.s=M.s;var V=r(D/M.DB);if(V>=M.t)return N.t=0,void 0;var g=D%M.DB,j=M.DB-g,o=(1<<g)-1;N[0]=M[V]>>g;for(var z=V+1;z<M.t;++z)N[z-V-1]|=(M[z]&o)<<j,N[z-V]=M[z]>>g;g>0&&(N[M.t-V-1]|=(M.s&o)<<j),N.t=M.t-V,N._57O()}function h(j,D){for(var Y=this,p=0,b=0,X=i(j.t,Y.t);X>p;)b+=Y[p]-j[p],D[p++]=b&Y.DM,b>>=Y.DB;if(j.t<Y.t){for(b-=j.s;p<Y.t;)b+=Y[p],D[p++]=b&Y.DM,b>>=Y.DB;b+=Y.s}else{for(b+=Y.s;p<j.t;)b-=j[p],D[p++]=b&Y.DM,b>>=Y.DB;b-=j.s}D.s=0>b?-1:0,-1>b?D[p++]=Y.DV+b:b>0&&(D[p++]=b),D.t=p,D._57O()}function Z(p,g){var E=this.abs(),I=p.abs(),u=E.t;for(g.t=u+I.t;--u>=0;)g[u]=0;for(u=0;u<I.t;++u)g[u+E.t]=E.am(0,I[u],g,u,0,E.t);g.s=0,g._57O(),this.s!=p.s&&o.ZERO._78O(g,g)}function P(W){for(var _=this.abs(),E=W.t=2*_.t;--E>=0;)W[E]=0;for(E=0;E<_.t-1;++E){var M=_.am(E,_[E],W,2*E,0,1);(W[E+_.t]+=_.am(E+1,2*_[E],W,2*E+1,M,_.t-E-1))>=_.DV&&(W[E+_.t]-=_.DV,W[E+_.t+1]=1)}W.t>0&&(W[W.t-1]+=_.am(E,_[E],W,2*E,0,1)),W.s=0,W._57O()}function S(S,k,Z){var g=S.abs(),A=this;if(!(g.t<=0)){var I=A.abs();if(I.t<g.t)return k!=E&&k._58O(0),Z!=E&&A._77O(Z),void 0;Z==E&&(Z=Q());var M=Q(),b=A.s,H=S.s,i=A.DB-n(g[g.t-1]);i>0?(g._44O(i,M),I._44O(i,Z)):(g._77O(M),I._77O(Z));var u=M.t,d=M[u-1];if(0!=d){var x=d*(1<<A.F1)+(u>1?M[u-2]>>A.F2:0),C=A.FV/x,G=(1<<A.F1)/x,e=1<<A.F2,O=Z.t,F=O-u,j=k==E?Q():k;for(M._59O(F,j),Z._52O(j)>=0&&(Z[Z.t++]=1,Z._78O(j,Z)),o.ONE._59O(u,j),j._78O(M,M);M.t<u;)M[M.t++]=0;for(;--F>=0;){var B=Z[--O]==d?A.DM:r(Z[O]*C+(Z[O-1]+e)*G);if((Z[O]+=M.am(0,B,Z,F,0,u))<B)for(M._59O(F,j),Z._78O(j,Z);Z[O]<--B;)Z._78O(j,Z)}k!=E&&(Z._45O(u,k),b!=H&&o.ZERO._78O(k,k)),Z.t=u,Z._57O(),i>0&&Z._46O(i,Z),0>b&&o.ZERO._78O(Z,Z)}}}function u(g){var P=Q();return this.abs()._49O(g,E,P),this.s<0&&P._52O(o.ZERO)>0&&g._78O(P,P),P}function H(O){this.m=O}function y(k){return k.s<0||k._52O(this.m)>=0?k.mod(this.m):k}function N(q){return q}function X(R){R._49O(this.m,E,R)}function p(H,S,Q){H._47O(S,Q),this._74O(Q)}function $(U,q){U._48O(q),this._74O(q)}function z(){if(this.t<1)return 0;var Q=this[0];if(0==(1&Q))return 0;var Y=3&Q;return Y=15&Y*(2-(15&Q)*Y),Y=255&Y*(2-(255&Q)*Y),Y=65535&Y*(2-(65535&(65535&Q)*Y)),Y=Y*(2-Q*Y%this.DV)%this.DV,Y>0?this.DV-Y:-Y}function b(E){var U=this;U.m=E,U.mp=E._50O(),U.mpl=32767&U.mp,U.mph=U.mp>>15,U.um=(1<<E.DB-15)-1,U.mt2=2*E.t}function c(f){var r=Q();return f.abs()._59O(this.m.t,r),r._49O(this.m,E,r),f.s<0&&r._52O(o.ZERO)>0&&this.m._78O(r,r),r}function _(T){var u=Q();return T._77O(u),this._74O(u),u}function U(e){for(var D=this;e.t<=D.mt2;)e[e.t++]=0;for(var h=0;h<D.m.t;++h){var J=32767&e[h],z=J*D.mpl+((J*D.mph+(e[h]>>15)*D.mpl&D.um)<<15)&e.DM;for(J=h+D.m.t,e[J]+=D.m.am(0,z,e,h,0,D.m.t);e[J]>=e.DV;)e[J]-=e.DV,e[++J]++}e._57O(),e._45O(D.m.t,e),e._52O(D.m)>=0&&e._78O(D.m,e)}function wc(A,v){A._48O(v),this._74O(v)}function Ar(U,o,D){U._47O(o,D),this._74O(D)}function bh(){return 0==(this.t>0?1&this[0]:this.s)}function Fl($,q){if($>4294967295||1>$)return o.ONE;var T=Q(),m=Q(),z=q._73O(this),s=n($)-1;for(z._77O(T);--s>=0;)if(q._76O(T,m),($&1<<s)>0)q._75O(m,z,T);else{var x=T;T=m,m=x}return q.revert(T)}function bp(h,$){var I;return I=256>h||$._51O()?new H($):new b($),this.exp(h,I)}function Ug(){var H=this;if(H.s<0){if(1==H.t)return H[0]-H.DV;if(0==H.t)return-1}else{if(1==H.t)return H[0];if(0==H.t)return 0}return(H[1]&(1<<32-H.DB)-1)<<H.DB|H[0]}function Sd(p,l){return new o(p,l)}function ui(){var i=this;i.n=E,i.e=0,i.d=E,i.p=E,i.q=E,i.dmp1=E,i.dmq1=E,i._10A=E}function Ze(z){return z._53O(this.e,this.n)}function ak(Y){var i,l,U,K="",u=0;for(i=0;i<Y.length&&Y.charAt(i)!=Zc;++i)U=Rg.indexOf(Y.charAt(i)),0>U||(0==u?(K+=x(U>>2),l=3&U,u=1):1==u?(K+=x(l<<2|U>>4),l=15&U,u=2):2==u?(K+=x(l),K+=x(U>>2),l=3&U,u=3):(K+=x(l<<2|U>>4),K+=x(15&U),u=0));return 1==u&&(K+=x(l<<2)),K}function ie(G){var h=G.split(""),o=ak(G);return h.forEach(function(R){var K=R.length;K>0&&o&&(Wb+=l(R))}),o}function Rk(J,u){var L=ir._4O.Util._56O(J,"ss"),D={},Y=0;return D.v=L==u,D.t=1,D.s=0>Y?-1:0,Zi=D.v,Y>0?D[0]=Y:-1>Y?D[0]=Y+D.DV:D.t=0,[L,D]}function Bc(F){var Y=38,r=F.substring(0,Y);if(r&&30==r.indexOf("05000420")){var S=["ss",F.substring(Y)];return S}return[]}function Zo($,A){A=A.replace(xb,""),A=A.replace(/[ \n]+/g,"");var w=Sd(A,16);if(w._55O()>this.n._55O())return 0;var q=this._37O(w),y=q[De](16).replace(/^1f+00/,""),P=Bc(y);if(0==P.length)return!1;for(var K,a,p,L=.5,X=Rh,g=[0,.5,.75,.875,.9375],W=[],l=[],t=[],c=I/X,h=P[1],J=Rk($,h)[0],H=0,k=0;H<g.length;H++){var x=0===H%2?0:.5;for(K=0;X>=K;K++)a=(K+x)*c,p=1-g[H],W.push(B(a)*L*p,-L+2*g[H]*L,-Y(a)*L*p),l.push((K+x)/X,p)
}for(H=0;H<g.length-1;H++){var V=H*(X+1),Z=(H+1)*(X+1);for(K=0;X>K;K++)t.push(V+K,Z+K+1,Z+K,V+K,V+K+1,Z+K+1)}return t.forEach(function(A){k+=A}),h==J&&k>10}var If,Sf=0xdeadbeefcafe,Kq=15715070==(16777215&Sf),De="toString",Tp="",gj="nat",Rb=function(){};D=W["D"+11182[De](q(2,5))];var Tj=o.prototype;_i+=im.substr(0,1);var $h=W.navigator?W.navigator.appName:"";Kq&&"Microsoft Internet Explorer"==$h?(Tj.am=L,If=30):Kq&&"Netscape"!=$h?(Tj.am=g,If=26):(Tj.am=J,If=28),Tj.DB=If,Tj.DM=(1<<If)-1,Tj.DV=1<<If;var ok=52;Tj.FV=q(2,ok),Tj.F1=ok-If,Tj.F2=2*If-ok;var _e,gc,Dc="0123456789abcdefghijklmnopqrstuvwxyz",Tl=[],vg=function(h){return String.fromCharCode(h)};for(_e="0".charCodeAt(0),gc=0;9>=gc;++gc)Tl[_e++]=gc;for(_e="a".charCodeAt(0),gc=10;36>gc;++gc)Tl[_e++]=gc;for(_e="A".charCodeAt(0),gc=10;36>gc;++gc)Tl[_e++]=gc;var ol=H.prototype;ol._73O=y,ol.revert=N,ol._74O=X,ol._75O=p,ol._76O=$;var dl=b.prototype;dl._73O=c,dl.revert=_,dl._74O=U,dl._75O=Ar,dl._76O=wc,Tj._77O=V,Tj._58O=O,Tj._54O=T,Tj._57O=s,Tj._59O=m,Tj._45O=k,Tj._44O=C,Tj._46O=F,Tj._78O=h,Tj._47O=Z,Tj._48O=P,Tj._49O=S,Tj._50O=z,Tj._51O=bh,Tj.exp=Fl,Tj.toString=G,Tj._85O=K,Tj.abs=a,Tj._52O=w,Tj._55O=A,Tj.mod=u,Tj._53O=bp,o.ZERO=j(0),o.ONE=j(1),Tj._86O=Ug;var xr=function(Q,k){var b=this;b.isPublic=!0,typeof Q!==Ec?(b.n=Q,b.e=k):Q!=E&&k!=E&&Q.length>0&&k.length>0&&(b.n=Sd(Q,16),b.e=l(k,16))};Eb=function(){var Q,t,C=ie(lc),j=C.substr(0,4),N=C.substr(4,2),s=C.substr(6,2),M=1,z=!M,y=v,F=[],Z=ce.charAt(7);if(D&&(D[De]().indexOf(gj)<0||D[_i][De]().indexOf(gj)<0||!C?Q=fi(ar[Z]):(C=new D(j-0,N-M,s-0),t=C.setHours(9),D[_i]()>t?Q=fi(ar[Z]):z=!0)),C&&Q&&y){for(var r in Q)F.push(r);var u,O=Q[F[0]],$=Q[F[1]],k=Q[F[2]],o=Q[F[4]],c=Q[F[5]],p=Q[F[6]],m=hg._27O(y);m&&p&&(u=O+$+k+o+""+c,u&&m._31O(u,p)&&(z=!0))}return z||(mn=Zq),Z};var Ro=ui.prototype;Ro._37O=Ze,Ro._38O=xr;var Rg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zc="=",nb=25,zq=10,lc="IBgBAQ==",Lf=Lf||function(t,C){var P={},j=P._7A={},x=j._6A=function(){function k(){}return{_80O:function(w){k.prototype=this;var n=new k;return w&&n._5A(w),n.hasOwnProperty("_82O")||(n._82O=function(){n.$super._82O.apply(this,arguments)}),n._82O.prototype=n,n.$super=this,n},_3A:function(){var C=this._80O();return C._82O.apply(C,arguments),C},_82O:function(){},_5A:function(k){for(var e in k)k.hasOwnProperty(e)&&(this[e]=k[e]);k.hasOwnProperty(De)&&(this.toString=k.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),r=j._39O=x._80O({_82O:function(f,n){f=this._84O=f||[],this._65O=n!=C?n:4*f.length},toString:function(X){return(X||S).stringify(this)},_89O:function(b){var f=this._84O,T=b._84O,A=this._65O,X=b._65O;if(this._57O(),A%4)for(var o=0;X>o;o++){var u=255&T[o>>>2]>>>24-8*(o%4);f[A+o>>>2]|=u<<24-8*((A+o)%4)}else if(T.length>65535)for(var o=0;X>o;o+=4)f[A+o>>>2]=T[o>>>2];else f.push.apply(f,T);return this._65O+=X,this},_57O:function(){var b=this._84O,L=this._65O;b[L>>>2]&=4294967295<<32-8*(L%4),b.length=e(L/4)},_88O:function(){var N=x._88O.call(this);return N._84O=this._84O.slice(0),N},_87O:function(U){for(var G=[],o=0;U>o;o+=4)G.push(0|4294967296*f);return new r._82O(G,U)}}),s=P._2A={},S=s._69O={stringify:function(y){var M,Q=y._84O,i=y._65O,b=[];for(M=0;i>M;M++){var R=255&Q[M>>>2]>>>24-8*(M%4);b.push((R>>>4).toString(16)),b.push((15&R).toString(16))}return b.join("")},_68O:function(m){for(var e=m.length,$=[],R=0;e>R;R+=2)$[R>>>3]|=l(m.substr(R,2),16)<<24-4*(R%8);return new r._82O($,e/2)}},z=s._8A={stringify:function(D){var j,c=D._84O,W=D._65O,R=[];for(j=0;W>j;j++){var V=255&c[j>>>2]>>>24-8*(j%4);R.push(vg(V))}return R.join("")},_68O:function(J){var $,E=J.length,o=[];for($=0;E>$;$++)o[$>>>2]|=(255&J.charCodeAt($))<<24-8*($%4);return new r._82O(o,E)}},Q=s._9A={stringify:function(i){try{return decodeURIComponent(escape(z.stringify(i)))}catch(V){throw new Error("")}},_68O:function(S){return z._68O(unescape(encodeURIComponent(S)))}},O=j._32O=x._80O({_1A:function(){this._83O=new r._82O,this._23O=0},_33O:function(R){typeof R==Ec&&(R=Q._68O(R)),this._83O._89O(R),this._23O+=R._65O},_25O:function(E){var B=this._83O,H=B._84O,m=B._65O,J=this._79O,x=4*J,F=m/x;F=E?e(F):M((0|F)-this._22O,0);var K=F*J,o=i(4*K,m);if(K){for(var L=0;K>L;L+=J)this._20O(H,L);var D=H.splice(0,K);B._65O-=o}return new r._82O(D,o)},_88O:function(){var k=x._88O.call(this);return k._83O=this._83O._88O(),k},_22O:0});j._66O=O._80O({cfg:x._80O(),_82O:function(v){this.cfg=this.cfg._80O(v),this._1A()},_1A:function(){O._1A.call(this),this._34O()},_81O:function(b){return this._33O(b),this._25O(),this},_72O:function(c){c&&this._33O(c);var v=this._21O();return v},_79O:16,_26O:function(O){return function(L,T){return new O._82O(T)._72O(L)}},_19O:function(x){return function(p,E){return new R._71O._82O(x,E)._72O(p)}}});var R=P._67O={};return P}();!function(){var C=Lf,R=C._7A,M=R._39O,K=R._66O,h=C._67O,Y=[],t=[];!function(){function k(k){for(var g=d(k),X=2;g>=X;X++)if(!(k%X))return!1;return!0}function H(D){return 0|4294967296*(D-(0|D))}for(var O=2,E=0;64>E;)k(O)&&(8>E&&(Y[E]=H(q(O,.5))),t[E]=H(q(O,1/3)),E++),O++}();var l=[],m=h._41O=K._80O({_34O:function(){this._64O=new M._82O(Y.slice(0))},_20O:function(w,k){for(var j=this._64O._84O,P=j[0],U=j[1],v=j[2],z=j[3],J=j[4],o=j[5],Q=j[6],a=j[7],L=0;64>L;L++){if(16>L)l[L]=0|w[k+L];else{var A=l[L-15],I=(A<<25|A>>>7)^(A<<14|A>>>18)^A>>>3,r=l[L-2],f=(r<<15|r>>>17)^(r<<13|r>>>19)^r>>>10;l[L]=I+l[L-7]+f+l[L-16]}var d=J&o^~J&Q,m=P&U^P&v^U&v,G=(P<<30|P>>>2)^(P<<19|P>>>13)^(P<<10|P>>>22),b=(J<<26|J>>>6)^(J<<21|J>>>11)^(J<<7|J>>>25),T=a+b+d+t[L]+l[L],Z=G+m;a=Q,Q=o,o=J,J=0|z+T,z=v,v=U,U=P,P=0|T+Z}j[0]=0|j[0]+P,j[1]=0|j[1]+U,j[2]=0|j[2]+v,j[3]=0|j[3]+z,j[4]=0|j[4]+J,j[5]=0|j[5]+o,j[6]=0|j[6]+Q,j[7]=0|j[7]+a},_21O:function(){var n=this._83O,v=n._84O,u=8*this._23O,w=8*n._65O;return v[w>>>5]|=128<<24-w%32,v[(w+64>>>9<<4)+14]=r(u/4294967296),v[(w+64>>>9<<4)+15]=u,n._65O=4*v.length,this._25O(),this._64O},_88O:function(){var H=K._88O.call(this);return H._64O=this._64O._88O(),H}});C._41O=K._26O(m),C._42O=K._19O(m)}();var xb=new RegExp("");xb.compile("[^0-9a-f]","gi"),ui._28O=-1,ui._29O=-2,Ro._31O=Zo,Ro._63O=Zo,ui._43O=-2;var lf=new function(){var V=this;V._5O=function(W,M){if("8"!=W.substring(M+2,M+3))return 1;var c=l(W.substring(M+3,M+4));return 0==c?-1:c>0&&10>c?c+1:-2},V._13O=function(g,D){var z=V._5O(g,D);return 1>z?"":g.substring(D+2,D+2+2*z)},V._12O=function(m,b){var x=V._13O(m,b);if(""==x)return-1;var Z;return Z=l(x.substring(0,1))<8?new o(x,16):new o(x.substring(2),16),Z._86O()},V._6O=function(K,z){var l=V._5O(K,z);return 0>l?l:z+2*(l+1)},V._11O=function($,m){var n=V._6O($,m),W=V._12O($,m);return $.substring(n,n+2*W)},V._10O=function(M,I){var y=V._6O(M,I),T=V._12O(M,I);return y+2*T},V._7O=function(K,r){var w=[],i=V._6O(K,r);w.push(i);for(var U=V._12O(K,r),Q=i,Z=0;;){var F=V._10O(K,Q);if(F==E||F-i>=2*U)break;if(Z>=200)break;w.push(F),Q=F,Z++}return w}};if(lf._90O=vg(zq+24),lf._91O=R+vg(zq*zq+8),ir==E||!ir)var ir={};ir._4O!=E&&ir._4O||(ir._4O={});var pg=ir._4O;ir._4O.Util=new function(){var I=this;I._56O=function(_){var J=new ir._4O._3O;return J._30O(_)},I._4A=function(D){var f=new ir._4O._3O;return f._36O(D)},I._11A=function(E){var X=new pg._3O;return X._30O(E)}},ir._4O._3O=function(){var o=this;o._8O=function(L,U){if("ss"==L&&"cj"==U){try{o.md=Lf._67O._41O._3A()}catch(M){Rb(Tp)}o._24O=function(w){o.md._81O(w)},o._35O=function(v){var h=Lf._2A._69O._68O(v);o.md._81O(h)},o._60O=function(){var W=o.md._72O();return W[De](Lf._2A._69O)},o._30O=function(O){return o._24O(O),o._60O()},o._36O=function(n){return o._35O(n),o._60O()}}},o._24O=function(){Rb(Tp)},o._35O=function(){Rb(Tp)},o._60O=function(){Rb(Tp)},o._30O=function(){Rb(Tp)},o._36O=function(){Rb(Tp)},o._8O("ss","cj")},Ir=function(H){var o=Dh[gp[7]],P=1,r=!1;if(xe.a!=Dh[Uq])return xe.a;if(xe.forEach(function(b){P*=b}),H>P){if(o){o=o.split(lf._90O);var y=o[3],L=o[7],Z=o[11],N=o[19],j=o[23],t=o[27],n=y+L+Z+N+j;r=Ql()(n,t)}r||(qd.prototype._42=wq)}else r=!0;return xe.a=r,r},nb=String.fromCharCode(nb+20);var Jk=function(s){return s=s.replace(xb,Tp),s=s.replace(/[ \n]+/g,Tp)},Pj="30",Qr="06",Nq="02",Zj="03",vf=Sd,pk=/^1f+00/,hg=function(){var c;return c={_18O:function(E){var n=E,U=n.replace(/\s+/g,""),F=ak(U);return F},_14O:function(h){var S=this._18O(h),$=this._15O(S);return $},_15O:function(K){var _=this._17O(K);if("2a864886f70d010101"==_._61O){var N=this._16O(_.key),X=new ui;return X._38O(N.n,N.e),X}Rb(Tp)},_16O:function(X){var b={};X.substr(0,2)!=Pj&&Rb(Tp);var z=lf._7O(X,0);return 2!=z.length&&Rb(Tp),X.substr(z[0],2)!=Nq&&Rb(Tp),b.n=lf._11O(X,z[0]),X.substr(z[1],2)!=Nq&&Rb(Tp),b.e=lf._11O(X,z[1]),b},_17O:function(Q){var H={};H._40O=E;var G=lf._7O(Q,0);2!=G.length&&Rb(Tp);var o=G[0];Q.substr(o,2)!=Pj&&Rb(Tp);var I=lf._7O(Q,o);return 2!=I.length&&Rb(Tp),Q.substr(I[0],2)!=Qr&&Rb(Tp),H._61O=lf._11O(Q,I[0]),Q.substr(I[1],2)==Qr?H._40O=lf._11O(Q,I[1]):Q.substr(I[1],2)==Pj&&(H._40O={},H._40O.p=lf._70O(Q,I[1],[0],Nq),H._40O.q=lf._70O(Q,I[1],[1],Nq),H._40O.g=lf._70O(Q,I[1],[2],Nq)),Q.substr(G[1],2)!=Zj&&Rb(Tp),H.key=lf._11O(Q,G[1]).substr(2),H}},c._17O?c:E}(),Ih=hg._27O=function(S){return hg._14O(S)};Ql=function(){return function(Q,J){J=Jk(J);var a=vf(J,q(2,4)),x=this;if(!x||!x.n||a._55O()>x.n._55O())return 0;var o=x._37O(a),$=o[De](q(2,4)).replace(pk,""),K=Bc($);if(0==K.length)return!1;var y=K[0],d=K[1],F=function(F){return ir._4O.Util._56O(F,y)},f=F(Q);return d==f}.bind(Ih(v))};var ai,Ke;return function(){var x=og.length-hr.length;if(x>0)for(var D=0;x>D;D++)ai=pg.Util,Ke=Jk}(),Qb=function(Z,d){d=Ke(d);var p=Ih(Fo),P=pn.length,X=2*P,n=vf(d,q(P,X)),Y=p,b=!0;if(Y){var E=Y[fj[0]];E&&n._55O()<=E._55O()&&(b=!1)}if(b)return 0;var g=Y._37O(n),T=g[De](q(P,X)).replace(pk,""),R=Bc(T);if(0==R.length)return!1;var O=R[0],H=R[1],F=ai._11A(Z,O);return H==F},hg}(Q,O);var Km=b.List=function(){this._as=[];var R,s,r=arguments.length;if(1===r){var Y=arguments[0];if(Tc(Y)&&(Y=Y._as),_n(Y))for(s=Y.length,R=0;s>R;R++)this._as.push(Y[R]);else Y!=E&&this._as.push(Y)}else if(r>1)for(R=0;r>R;R++)this._as.push(arguments[R])};Jl("List",O,{forEach:function(K,l){this.each(K,l)},push:function(){for(var y=0;y<arguments.length;y++)this.add(arguments[y])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(J,v){return v===K?this._as.push(J):this._as.splice(v,0,J)},addAll:function(d){Tc(d)&&(d=d._as),_n(d)?vp(this._as,d):this._as.push(d)},get:function(o){return this._as[o]},slice:function(N,P){return new Km(this._as.slice(N,P))},remove:function(G){var I=this._as.indexOf(G);return I>=0&&I<this._as.length&&this.removeAt(I),I},removeAt:function(I){return this._as.splice(I,1)[0]},set:function($,V){return this._as[$]=V},clear:function(){return this._as.splice(0,this._as.length)},contains:function(n){return this._as.indexOf(n)>=0},indexOf:function(m){return this._as.indexOf(m)},each:function(o,W){for(var Q=0,A=this._as.length;A>Q;Q++){var M=this._as[Q];W?o.call(W,M,Q,this):o(M,Q,this)}},reverseEach:function(C,i){for(var f=this._as.length-1;f>=0;f--){var W=this._as[f];i?C.call(i,W):C(W)}},toArray:function(L,o){if(L){for(var t,R=[],K=0,l=this._as.length;l>K;K++)t=this._as[K],o?L.call(o,t)&&R.push(t):L(t)&&R.push(t);return R}return this._as.concat()},toList:function(H,p){if(H){for(var S,M=new Km,R=0,L=this._as.length;L>R;R++)S=this._as[R],p?H.call(p,S)&&M.add(S):H(S)&&M.add(S);return M}return new Km(this)},reverse:function(){this._as.reverse()},sort:function(r){return this._as.sort(r?r:yd),this},toString:function(){return this._as.toString()}}),O.defineProperties(Km.prototype,{length:{get:function(){return this._as.length},set:function(m){this._as.length=m}}});var pd=new Km;Jn(pd,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Di,each:Di,reverseEach:Di,toArray:function(){return[]},toList:function(){return new Km},add:xf,addAll:xf,set:xf,remove:xf,removeAt:xf,clear:xf});var fs=b.Matrix=function(O,p,x,S,r){var h=this;O=O||0;var Z=Y(O),u=B(O);S=S||1,r=r||1,h.a=u*S,h.b=Z*S,h.c=-Z*r,h.d=u*r,h.tx=p||0,h.ty=x||0};fs.prototype.tf=function(W,u){1===arguments.length&&(u=W.y,W=W.x);var m=this;return{x:m.a*W+m.c*u+m.tx,y:m.b*W+m.d*u+m.ty}},fs.prototype.translate=function(M,H){var o=this;return o.tx+=M,o.ty+=H,o},fs.prototype.scale=function(z,q){var y=this;return y.a*=z,y.d*=q,y.c*=z,y.b*=q,y.tx*=z,y.ty*=q,y},fs.prototype.rotate=function(C){var U=B(C),v=Y(C),R=this,o=R.a,l=R.c,P=R.tx;return R.a=o*U-R.b*v,R.b=o*v+R.b*U,R.c=l*U-R.d*v,R.d=l*v+R.d*U,R.tx=P*U-R.ty*v,R.ty=P*v+R.ty*U,R},fs.prototype.transform=function(Z){var H=this,X=Z.a,z=Z.b,I=Z.c,v=Z.d,$=Z.tx,_=Z.ty,J=H.a,a=H.b,O=H.c,U=H.d,s=H.tx,y=H.ty;return H.a=X*J+I*a,H.b=z*J+v*a,H.c=X*O+I*U,H.d=z*O+v*U,H.tx=X*s+I*y+$,H.ty=z*s+v*y+_,H},fs.prototype.tfi=function(C,f){1===arguments.length&&(f=C.y,C=C.x);var o=this,x=1/(o.a*o.d+o.c*-o.b);return{x:o.d*x*C+-o.c*x*f+(o.ty*o.c-o.tx*o.d)*x,y:o.a*x*f+-o.b*x*C+(-o.ty*o.a+o.tx*o.b)*x}};var hs=b.Notifier=function(){this._f=0};Jl("Notifier",O,{contains:function(b,w){if(this._ls)for(var $,j=0,e=this._ls.size();e>j;j++)if($=this._ls.get(j),b===$.l&&w===$.s)return!0;return!1},add:function(M,Q,H){var n=this,J={l:M,s:Q,a:H};n._ls||(n._ls=new Km),n._f?(n._as||(n._as=new Km),n._as.add(J)):J.a?n._ls.add(J,0):n._ls.add(J)},remove:function(J,j){var s=this;s._ls&&(s._f?(s._rs||(s._rs=new Km),s._rs.add({l:J,s:j})):s._remove(J,j))},_remove:function(c,E){for(var v,C=this._ls,y=0,H=C.size();H>y;y++)if(v=C.get(y),v.l===c&&v.s===E)return C.removeAt(y),void 0},fire:function(w){var N=this,u=N._ls;if(N._b=1e4,u){++N._f;try{for(var M,a=0,h=u.size();h>a;a++)M=u.get(a),M.s?M.l.call(M.s,w):M.l(w)}finally{if(--N._f)return;if(N._rs){for(h=N._rs.size(),a=0;h>a;a++)M=N._rs.get(a),N._remove(M.l,M.s);delete N._rs}if(N._as){for(h=N._as.size(),a=0;h>a;a++)M=N._as.get(a),M.a?u.add(M,0):u.add(M);delete N._as}}}}});var Wm=b.Data=function(){this._id=Yj()};Jl("Data",O,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:E,_parent:E,_children:pd,_childMap:E,_styleMap:E,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return E},_22Q:function(){return E},s:function(z,h){var l=this;if(2===arguments.length)l.setStyle(z,h);else{if(!ki(z))return l.getStyle(z);for(var G in z)l.setStyle(G,z[G])}return l},fp:function(i,q,t,S,U){return this.firePropertyChange(i,q,t,S,U)},firePropertyChange:function(U,i,T,r,n){if(r){if(r(i,T))return!1}else if(i===T)return!1;var J=this,h=n||{};return h.property=U,h.oldValue=i,h.newValue=T,h.data=J,J._dataModel&&J._dataModel.handleDataPropertyChange(h),J.onPropertyChanged(h),!0},onPropertyChanged:function(E){var q=this,U=q._parent,v=E.property;if(Sd(U)){var h=q.s(cp),u="s:ingroup"===v;(h&&ek[v]||v===u)&&U._81I(),(h||u)&&U.fp("childChange",!0,!1)}Sm(U)&&ek[v]&&U.updateFromChildren()},_21I:function(y){var Z=this;if(y&&Z._dataModel)throw"Remove data from dataModel before adding";Z._dataModel=y},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var S=0,I=this._children.toArray(),o=I.length;o>S;S++)I[S].removeFromDataModel()},getId:function(){return this._id},setId:function(S){this._id=S},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(F,b){return this._children.toList(F,b)},eachChild:function(E,R){this._children.each(E,R)},addChild:function(F,C){var i=this;F!==i&&(i._children===pd&&(i._children=new Km,i._childMap={}),C>=0||(C=i._children.size()),i._childMap[F._id]||i.isDescendantOf(F)||(F._parent&&F._parent.removeChild(F),(0>C||C>i._children.size())&&(C=i._children.size()),i._children.add(F,C),i._childMap[F._id]=F,F.setParent(i),i.onChildAdded(F,C),i.fp(Zc,E,F)))},onChildAdded:function(){},removeChild:function(q){var e=this;if(e._childMap&&e._childMap[q._id]){var u=e._children.remove(q);delete e._childMap[q._id],e.fp(Zc,q,E),q.setParent(E,u),e.onChildRemoved(q,u)}},onChildRemoved:function(){},getChildAt:function(M){return this._children.get(M)},clearChildren:function(){var h=this;if(!h._children.isEmpty())for(var l=0,S=h._children.toArray(),y=S.length;y>l;l++)h.removeChild(S[l])},getParent:function(){return this._parent},setParent:function(W,D){var g=this;if(!(g._73I||g._parent===W||g===W||W&&W.isDescendantOf(g))){var d,e=g._parent;g._parent=W,g._73I=1,e?(D==E&&(D=e.getChildren().indexOf(g)),e.removeChild(g)):g._dataModel&&D==E&&(D=g._dataModel.getRoots().indexOf(g)),W&&(W.addChild(g),d=W.getChildren().indexOf(g)),delete g._73I,g.fp("parent",e,W,K,{oldIndex:D,newIndex:d}),g.onParentChanged(e,W)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(J){return J?this.isDescendantOf(J)||J.isDescendantOf(this):!1},isParentOf:function(J){return J&&this._childMap?!!this._childMap[J._id]:!1},isDescendantOf:function(E){if(!E||E.isEmpty())return!1;for(var M=this._parent;M;){if(E===M)return!0;M=M._parent}return!1},getStyleMap:function(){return this._styleMap},getStyle:function(q,B){B===K&&(B=1);var b=this._styleMap?this._styleMap[q]:K;return b===K&&B?$[q]:b},setStyle:function(f,N){var D=this;D._styleMap||(D._styleMap={});var V=D._styleMap[f];N===K?delete D._styleMap[f]:D._styleMap[f]=N,D.fp("s:"+f,V,N)&&D.onStyleChanged(f,V,N)},onStyleChanged:function(){},iv:function(){this.invalidate()},invalidate:function(){this.fp("*",!1,!0)},toString:function(){var T=this;return T._displayName||T._name||T._tag||T._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(n,i){var r=this,F=r.s(Ai);F||r.s(Ai,F={}),i?F[n]=i:delete F[n],r.fp(Ai,E,F)},removeStyleIcon:function(q){var s=this.s(Ai);if(s){var U=s[q];delete s[q],this.fp(Ai,E,s)}return U},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var T,Y={};for(T in this._styleMap)Y[T]=1;return Y}});var Wf=b.DataModel=function(){var z=this;z._datas=new Km,z._dataMap={},z._roots=new Km,z._rootMap={},z._78O={},z._36I=new hs,z._35I=new hs,z._selectionModel=new Dk(z);var S=z._29Q=[],d=z._scheduleCallback=function(){for(var r=Date.now(),P=0;P<S.length;P++){var y=S[P];y.enabled&&r-y.lastTime>y.interval&&(y.beforeAction&&y.beforeAction(),z.each(function(F){y.action(F)}),y.afterAction&&y.afterAction(),y.lastTime=r)}S.length&&(z._30Q=Q.requestAnimationFrame(d))}};Jl("DataModel",O,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:K,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:K,_init:K,sm:function(){return this.getSelectionModel()},mm:function(n,G,N){this.addDataModelChangeListener(n,G,N)},umm:function(q,W){this.removeDataModelChangeListener(q,W)},md:function(H,r,m){this.addDataPropertyChangeListener(H,r,m)},umd:function(H,K){this.removeDataPropertyChangeListener(H,K)},mh:function(F,C,N){this.addHierarchyChangeListener(F,C,N)},umh:function(J,F){this.removeHierarchyChangeListener(J,F)},getHistoryManager:function(){return this._historyManager},getAttrObject:function(){return this._attrObject},setAttrObject:function(t){return this._attrObject=t},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(i){return this._dataMap[i]},removeDataById:function(o){this.remove(this.getDataById(o))},toDatas:function(S,C){return this._datas.toList(S,C)},each:function(N,j){this._datas.each(N,j)},getDataByTag:function(b){return this._78O[b]},removeDataByTag:function(x){this.remove(this.getDataByTag(x))},add:function(O,h,e){var x=this,t=O._id,Q=O._tag,m=x._roots;if(x._dataMap[t])throw"'"+t+"' already exists";Q!=E&&(x._78O[Q]=O),x._dataMap[t]=O,e>=0?x._datas.add(O,e):x._datas.add(O),O._parent||(x._rootMap[t]=O,h>=0?m.add(O,h):m.add(O)),O._21I(x),x.onAdded(O),x._36I.fire({kind:"add",data:O,rootsIndex:h,datasIndex:e})},onAdded:function(){},remove:function(U,C){if(U){var p=this,H=U._id,A=C&&C.keepStructure,V=C&&C.keepChildren,$=U.getTag();if(U._dataModel===p){this.beginTransaction(),A?p._removingData||(p._removingData=U):p.prepareRemove(U),V||U.toChildren().each(function(X){p.remove(X,C)},p),A?p._removingData===U&&(U._parent&&U._parent.removeChild(U),delete p._removingData):U._parent&&U._parent.removeChild(U);var s=p._datas.remove(U);delete p._dataMap[H],$!=E&&delete p._78O[$];var i;p._rootMap[H]&&(delete p._rootMap[H],i=p._roots.remove(U)),U._21I(E),p.onRemoved(U),p._36I.fire({kind:lb,data:U,rootsIndex:i,datasIndex:s}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var q=this;if(q._datas.size()){var y=q._historyManager?this.toJSON():K;q._datas.toArray().forEach(function(m){m._21I(E)}),q._datas.clear(),q._dataMap={},q._roots.clear(),q._rootMap={},q._78O={},q._36I.fire({kind:Wk,json:y})}},contains:function(c){return c&&c._dataModel===this},handleDataPropertyChange:function(a){var Q=this,i=a.data,d=a.property;if("parent"===d){var l=i._id,V=Q._rootMap,L=Q._roots;i._parent?V[l]&&(delete V[l],L.remove(i)):V[l]||(V[l]=i,L.add(i))}else if("tag"===d){var X=a.oldValue,p=a.newValue,O=Q._78O;X!=E&&delete O[X],p!=E&&(O[p]=i)}this.onDataPropertyChanged(i,a),this._35I.fire(a)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(U,j,Y){this._36I.add(U,j,Y)},removeDataModelChangeListener:function(z,N){this._36I.remove(z,N)},addDataPropertyChangeListener:function(N,R,z){this._35I.add(N,R,z)},removeDataPropertyChangeListener:function(E,v){this._35I.remove(E,v)},_38I:function(F,x,n){this._37I&&this._37I.fire({data:F,oldIndex:x,newIndex:n})},addHierarchyChangeListener:function(c,Y,I){this._37I||(this._37I=new hs),this._37I.add(c,Y,I)},removeHierarchyChangeListener:function(Y,C){this._37I.remove(Y,C)},getSiblings:function(d){var H=d._parent;return H?H._children:this._roots},eachByHierarchical:function(I,H,Q){if(H)return this._eachByHierarchical(I,H,Q);for(var U=0,j=this._roots,S=j.size();S>U;U++)if(this._eachByHierarchical(I,j.get(U),Q)===!1)return!1;return!0},_eachByHierarchical:function(D,I,K){if(K){if(D.call(K,I)===!1)return!1}else if(D(I)===!1)return!1;for(var J=I.size(),E=0;J>E;E++)if(this._eachByHierarchical(D,I.getChildAt(E),K)===!1)return!1;return!0},reverseEachByHierarchical:function(P,a,y){if(a)return this._reverseEachByHierarchical(P,a,y);for(var F=this._roots,Z=F.size(),o=Z-1;o>=0;o--)if(this._reverseEachByHierarchical(P,F.get(o),y)===!1)return!1;return!0},_reverseEachByHierarchical:function(W,s,d){for(var Q=s.size(),P=Q-1;P>=0;P--)if(this._reverseEachByHierarchical(W,s.getChildAt(P),d)===!1)return!1;if(d){if(W.call(d,s)===!1)return!1}else if(W(s)===!1)return!1;return!0},eachByDepthFirst:function(t,S,K){if(S)return this._11I(t,S,K);for(var R=0,e=this._roots,y=e.size();y>R;R++)if(this._11I(t,e.get(R),K)===!1)return!1;return!0},_11I:function(W,J,w){for(var i=J.size(),U=0;i>U;U++)if(this._11I(W,J.getChildAt(U),w)===!1)return!1;if(w){if(W.call(w,J)===!1)return!1}else if(W(J)===!1)return!1;return!0},eachByBreadthFirst:function(y,I,n){var D=new Km;for(I?D.add(I):this._roots.each(D.add,D);D.size()>0;)if(I=D.removeAt(0),I.eachChild(D.add,D),n){if(y.call(n,I)===!1)return!1}else if(y(I)===!1)return!1;return!0},moveTo:function(s,V){var K=this.getSiblings(s),x=K.indexOf(s);x===V||0>x||V>=0&&V<=K.size()&&(K.remove(s),V>K.size()&&V--,K.add(s,V),this._38I(s,x,V))},moveUp:function(c){this.moveTo(c,this.getSiblings(c).indexOf(c)-1)},moveDown:function(G){this.moveTo(G,this.getSiblings(G).indexOf(G)+1)},moveToTop:function(j){this.moveTo(j,0)},moveToBottom:function(Q){this.moveTo(Q,this.getSiblings(Q).size())},moveSelectionUp:function(R){this.beginTransaction(),R||(R=this.sm());var n=new Km;ur(R,n,this._roots),n.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(l){this.beginTransaction(),l||(l=this.sm());var J=new Km;rr(l,J,this._roots),J.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(I){this.beginTransaction(),I||(I=this.sm());var z=new Km;qr(I,z,this._roots),z.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(r){this.beginTransaction(),r||(r=this.sm());var F=new Km;_p(r,F,this._roots),F.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(H,A,w){var J=this.getDatas();null==w&&(w=J.indexOf(H)),w===A||0>w||A>=0&&A<=J.size()&&(J.remove(H),A>J.size()&&A--,J.add(H,A),this._76I(H,w,A))},bringForward:function(g){this.moveToIndex(g,this.getDatas().indexOf(g)+1)},bringToFront:function(D){this.moveToIndex(D,this.size())},sendBackward:function(I){this.moveToIndex(I,this.getDatas().indexOf(I)-1)},sendToBack:function(v){this.moveToIndex(v,0)},bringSelectionForward:function(z){this.beginTransaction(),z||(z=this.sm());for(var i=new Km,O=this.getDatas(),r=!1,P=0;P<O.size();P++){var d=O.get(O.size()-1-P);z.contains(d)?r&&i.add(d):r=!0}i.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(l){this.beginTransaction(),l||(l=this.sm());for(var Y=new Km,D=this.getDatas(),V=0;V<D.size();V++){var $=D.get(V);l.contains($)&&Y.add($)}Y.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(c){this.beginTransaction(),c||(c=this.sm());for(var L=new Km,$=this.getDatas(),m=!1,u=0;u<$.size();u++){var M=$.get(u);c.contains(M)?m&&L.add(M):m=!0}L.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(R){this.beginTransaction(),R||(R=this.sm());for(var Z=new Km,v=this.getDatas(),H=0;H<v.size();H++){var N=v.get(v.size()-1-H);R.contains(N)&&Z.add(N)}Z.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(p){var d=this;d.removeScheduleTask(p),p.enabled==E&&(p.enabled=!0),p.interval==E&&(p.interval=10),p.action==E&&(p.action=Di),p.lastTime=Date.now(),d._29Q.push(p),d._30Q==E&&(d._30Q=Q.requestAnimationFrame(d._scheduleCallback))},removeScheduleTask:function(x){var F=this,S=F._29Q,N=S.indexOf(x);N>=0&&S.splice(N,1),S.length||F._30Q==E||(Q.cancelAnimationFrame(F._30Q),delete F._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(q){this._historyManager||new b.HistoryManager(this),null!=q&&this._historyManager.setMaxHistoryCount(q),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(F){this._historyManager&&this._historyManager.undo(F)},redo:function(I){this._historyManager&&this._historyManager.redo(I)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(V){this._historyManager&&this._historyManager.addHistory(V)},onHistoryManagerChanged:function(){}});var Dk=b.SelectionModel=function(D){var F=this;F._68O=Yb,F._map={},F._73O=new Km,F._74I=new hs,F._21I(D)};Jl("SelectionModel",O,{ms_fire:1,ms_dm:1,ms:function(d,Z,g){this.addSelectionChangeListener(d,Z,g)},ums:function(j,m){this.removeSelectionChangeListener(j,m)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===$k},co:function(w){return this._map[w._id]!=E},ss:function(F){this.setSelection(F)},as:function(A){this.appendSelection(A)},rs:function(n){this.removeSelection(n)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(J){var N=this;if(N._68O!==J&&(J===fj||J===$k||J===Yb)){N.cs();var f=N._68O;N._68O=J,N.fp("selectionMode",f,J)}},_21I:function(m){var d=this,J=d._dataModel;J!==m&&(J&&(d.cs(),J.umm(d.handleDataModelChange,d)),d._dataModel=m,m.mm(d.handleDataModelChange,d,!0),d.fp(ck,J,m))},dispose:function(){var m=this;m.cs(),m._dataModel.umm(m.handleDataModelChange,m)},handleDataModelChange:function(z){var H=this;if(z.kind===lb){var N=z.data;H.co(N)&&(H._73O.remove(N),delete H._map[N._id],H._75I(lb,new Km(N)))}else z.kind===Wk&&H.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(g){var J=this;if(J._filterFunc!==g){J.cs();var L=J._filterFunc;J._filterFunc=g,J.fp("filterFunc",L,J._filterFunc)}},_75I:function(h,v,Q,J){Q&&(this._73O.each(function(O){J[O._id]?Q.remove(O):Q.add(O)}),v=Q.toList()),this._74I.fire({kind:h,datas:new Km(v)})},addSelectionChangeListener:function(E,O,H){this._74I.add(E,O,H)},removeSelectionChangeListener:function(y,P){this._74I.remove(y,P)},_97O:function(u,S){for(var z,l=this,O=0,B=new Km(u);O<B.size();O++)z=B.get(O),(l._filterFunc&&!l._filterFunc(z)||S&&l.co(z)||!S&&!l.co(z)||!l._dataModel.contains(z))&&(B.removeAt(O),O--);return B},appendSelection:function(T){var j=this;if(j._68O!==fj){var U,s,L=j._73O,X=j._97O(T,!0);X.isEmpty()||(j.sg()&&(U=new Km(L),s=j._map,L.clear(),j._map={},X=new Km(X.get(X.size()-1))),X.each(function(J){L.add(J),j._map[J._id]=J}),j._75I("append",X,U,s))}},removeSelection:function(b){var l=this,K=l._97O(b),X=0,C=K.size();if(0!==C){for(;C>X;X++){var J=K.get(X);l._73O.remove(J),delete l._map[J._id]}l._75I(lb,K)}},toSelection:function(f,$){return this._73O.toList(f,$)},getSelection:function(){return this._73O},each:function(p,W){this._73O.each(p,W)},setSelection:function(N){var o=this,Z=o._73O;if(o._68O!==fj&&!(Z.isEmpty()&&!N||1===Z.size()&&o.ld()===N)){var c=new Km(Z),p=o._map;Z.clear(),o._map={};var b=o._97O(N,!0);o.sg()&&b.size()>1&&(b=new Km(b.get(b.size()-1))),b.each(function(Y){Z.add(Y),o._map[Y._id]=Y}),o._75I("set",E,c,p)}},clearSelection:function(){var M=this,H=M._73O;if(H.size()>0){var Y=H.toList();H.clear(),M._map={},M._75I(Wk,Y)}},selectAll:function(){var n=this;if(n._68O!==fj){var Y,q,b=n._dataModel.toDatas();if(n._filterFunc)for(Y=0;Y<b.size();Y++)q=b.get(Y),n._filterFunc(q)||(b.removeAt(Y),Y--);var H=n._73O,D=new Km(H),$=n._map;H.clear(),n._map={},n.sg()&&b.size()>1&&(b=new Km(b.get(b.size()-1)));var l=b.size();for(Y=0;l>Y;Y++)q=b.get(Y),H.add(q),n._map[q._id]=q;n._75I("all",E,D,$)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(K){return this._map[K._id]!=E},getLastData:function(){var c=this._73O;return c.size()>0?c.get(c.size()-1):E},getFirstData:function(){var c=this._73O;return c.size()>0?c.get(0):E},isSelectable:function(Q){var F=this;return Q&&F._68O!==fj?F._filterFunc?F._filterFunc(Q):!0:!1},getTopSelection:function(){var x=this,e=new Km;return x._73O.each(function(C){for(var M=C.getParent();M;){if(x.contains(M)){C=E;break}M=M.parent}C&&e.add(C)}),e}});var pf=function(){return Cb(0),function(F,c){var L;if(xo(c)){var P=F.getDataUI(c);P&&P._88I&&(L=P._88I.rect)}return L?L:c.getRect()}}();Jn(y,{edgeGroupAgentFunc:E,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:W.rectSelectBorder,graphViewRectSelectBackground:_j,graphViewEditPointSize:Ib?17:7,graphViewEditPointBorderColor:W.editPointBorder,graphViewEditPointBackground:W.editPointBackground,setEdgeType:function(u,f,b){sc[u]=f,Jb[u]=b},getEdgeType:function(A){return sc[A]},getEdgeTypeMap:function(){return sc},getNodeRect:pf},!0),Jn($,{"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":K,"image.stretch":"fill",icons:K,ingroup:!0,"body.color":K,opacity:K,pixelPerfect:!0,"clip.direction":"top","clip.percentage":1,"select.color":Lc,"select.width":1,"select.padding":2,"select.type":qo,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":K,"border.width":2,"border.padding":2,"border.type":qo,label:K,"label.font":K,"label.color":lk,"label.background":K,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":K,"label.max":K,"label.opacity":K,"label.scale":1,"label.align":K,"label.selectable":!0,label2:K,"label2.font":K,"label2.color":lk,"label2.background":K,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":K,"label2.max":K,"label2.opacity":K,"label2.scale":1,"label2.align":K,"label2.selectable":!0,note:K,"note.expanded":!0,"note.font":K,"note.color":Qo,"note.background":Lc,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":K,"note.toggleable":!0,"note.border.width":1,"note.border.color":K,"note.opacity":K,"note.scale":1,"note.align":K,note2:K,"note2.expanded":!0,"note2.font":K,"note2.color":Qo,"note2.background":Lc,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":K,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":K,"note2.opacity":K,"note2.scale":1,"note2.align":K,"group.type":K,"group.image":K,"group.image.stretch":"fill","group.repeat.image":K,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":K,"group.title.color":Qo,"group.title.background":W.groupTitleBackground,"group.title.align":nl,"group.background":W.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":K,"group.border.color":Yd,"group.border.cap":Kc,"group.border.join":Rm,"group.gradient":E,"group.gradient.color":"#FFF",shape:K,"shape.background":Yd,"shape.repeat.image":K,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Yd,"shape.border.3d":!1,"shape.border.3d.color":K,"shape.border.3d.accuracy":K,"shape.border.cap":Kc,"shape.border.join":Rm,"shape.border.pattern":K,"shape.gradient":E,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Fl,"shape.dash.offset":0,"shape.dash.color":rq,"shape.dash.width":K,"shape.dash.3d":!1,"shape.dash.3d.color":K,"shape.dash.3d.accuracy":K,"shape.polygon.side":6,"shape.arc.from":z,"shape.arc.to":I,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":K,"shape.gradient.pack":K,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"autolayout.gap":K,"autolayout.hgap":K,"autolayout.vgap":K,"edge.type":K,"edge.points":K,"edge.segments":K,"edge.color":Yd,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":K,"edge.3d.accuracy":K,"edge.cap":Kc,"edge.join":Rm,"edge.source.position":17,"edge.source.anchor.x":K,"edge.source.anchor.y":K,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":K,"edge.target.anchor.y":K,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":K,"edge.dash":!1,"edge.dash.pattern":Fl,"edge.dash.offset":0,"edge.dash.color":rq,"edge.dash.width":K,"edge.dash.3d":!1,"edge.dash.3d.color":K,"edge.dash.3d.accuracy":K,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":K,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":K,"grid.column.percents":K,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":W.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":W.gridCellBorderColor,"grid.block":K,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":W.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":lk,"text.font":vm,"text.shadow":!1,"text.shadow.color":Sn,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3},!0),Jn(Wf,{_76I:function(m,d,x){this._39I&&this._39I.fire({data:m,oldIndex:d,newIndex:x})
},addIndexChangeListener:function(b,Z,n){var l=this;l._39I||(l._39I=new hs),l._39I.add(b,Z,n)},removeIndexChangeListener:function(x,b){this._39I.remove(x,b)},prepareRemove:function(K){gl(K)&&(K.setSource(E),K.setTarget(E)),K._70O&&K._70O.toList().each(this.remove,this),K._69O&&K._69O.toList().each(function(d){d.setHost(E)}),K._host&&K.setHost(E)},onAdded:function(b){this.isAutoAdjustIndex()&&this.adjustIndex(b)},onDataPropertyChanged:function(h,x){cq[x.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(h)},isAdjustable:function(B){return Or(B)||gl(B)},isAdjustedToBottom:function(s){return Sd(s)?s.isExpanded()&&qj(s):!1},adjustIndex:function(W){var i=this;this.isHierarchicalRendering()||(i.isAdjustedToBottom(W)?(i.sendToBottom(W),W.eachChild(i.adjustIndex,i)):i.sendToTop(W))},sendToTop:function(k){var s=this;if(s.contains(k)&&s.isAdjustable(k)){var L=s._datas;if(k!==L.get(s.size()-1)){var r=L.indexOf(k);L.removeAt(r),L.add(k),s._76I(k,r,s.size()-1)}if(gl(k)){var U=k._40I;U&&!s.isAdjustedToBottom(U)&&s.sendToTop(U),U=k._41I,U&&!s.isAdjustedToBottom(U)&&s.sendToTop(U)}k._69O&&k._69O.each(function(u){u.isRelatedTo(k)||Or(k)&&u.isLoopedHostOn(k)||s.sendToTop(u)}),k.ISubGraph||(!Sd(k)||k.isExpanded())&&k._adjustChildrenToTop&&k.eachChild(function(t){gl(t)||s.sendToTop(t)})}},sendToBottom:function(s,E){var Y=this;if(s!==E&&Y.contains(s)&&Y.isAdjustable(s)&&(!E||Y.contains(E))){var G=Y._datas,f=G.remove(s),w=E?Y._datas.indexOf(E):0;if(G.add(s,w),f!==w){Y._76I(s,f,w);var R=s._parent;!R||R.ISubGraph||gl(R)||Y.sendToBottom(s._parent,s)}}}}),Jn(Jo,{ms_edit:function(o){o._46O=function(P){var w=this,l=w.gv.dm(),X=w._index,C=w._89I,Q=w._node,h=w._shape,N=w._edge,B=w._77I;Q&&C?(this.fi({kind:"endEditRect",event:P,data:Q,direction:C}),l.endTransaction()):h&&X>=0?(w.fi({kind:"endEditPoint",event:P,data:h,index:X}),l.endTransaction()):N&&X>=0?(w.fi({kind:"endEditPoint",event:P,data:N,index:X}),l.endTransaction()):B&&(w.fi({kind:"endEditRotation",event:P,data:B}),l.endTransaction())},o._78I=function(R){var V=this;V.autoScroll(R);var h=V.gv.lp(R),Y=V._index,U=V._89I,b=V._node,N=V._shape,e=V._edge,O=V._77I;if(b&&U)V._80O(h),V.fi({kind:"betweenEditRect",event:R,data:b,direction:U});else if(N&&Y>=0)h.e=N.getPoints().get(Y).e,N.setPoint(Y,h),V.fi({kind:"betweenEditPoint",event:R,data:N,index:Y});else if(e&&Y>=0){var x=e.s(ss);h.e=x.get(Y).e,x.set(Y,h),e.fp(ss,E,x),V.fi({kind:"betweenEditPoint",event:R,data:e,index:Y})}else if(O){var l=O.p(),c=O.getScale(),D=T+F(h.y-l.y,h.x-l.x);c.y<0&&(D+=z),a(D)<.04&&(D=0),O.setRotation(D),V.fi({kind:"betweenEditRotation",event:R,data:O})}},o._80O=function(y){var H=this,n=H._node,T=H._rect,m=T.x,P=T.y,I=T.width,N=T.height,t=H._89I,g=H._anchor,h=H._matrix,y=h.tfi(y);"northwest"===t?T=wf(y,{x:m+I,y:P+N}):t===wl?T=wf({x:m,y:y.y},{x:m+I,y:P+N}):"northeast"===t?T=wf({x:m,y:y.y},{x:y.x,y:P+N}):t===im?T=wf({x:y.x,y:P},{x:m+I,y:P+N}):t===Dp?T=wf({x:m,y:P},{x:y.x,y:P+N}):"southwest"===t?T=wf({x:y.x,y:P},{x:m+I,y:y.y}):"south"===t?T=wf({x:m,y:P},{x:m+I,y:y.y}):"southeast"===t&&(T=wf({x:m,y:P},y)),n.setPosition(h.tf(T.x+T.width*g.x,T.y+T.height*g.y)),n.setWidth(T.width),n.setHeight(T.height)},o._80I=function(W,x,v,R){var H=this,t=H.gv._zoom,Z=(H.gv.getEditPointSize()+2)/t;return Jd({x:x-Z/2,y:v-Z/2,width:Z,height:Z},W)?(H._89I!==R&&(H._89I=R),!0):!1},o._79I=function(f,P,Z){var x=this,N=x.gv,r=P?N.getDataUI(P):E,u=r?r._55O:E;if(u){var t,a,I,q,X=N._zoom,$=(N.getEditPointSize()+2)/X,w=N.lp(f);if(Or(P)){if(u._56O&&Or(P)&&(a=u._98o,Jd({x:a.x-$/2,y:a.y-$/2,width:$,height:$},w)))return x._77I=P,Z&&x.fi({kind:"beginEditRotation",event:f,data:P}),x.setCursor("crosshair"),!0;if(u._43O&&P instanceof mm)for(I=P.getPoints(),t=I.size()-1;t>=0;t--)if(a=I.get(t),Jd({x:a.x-$/2,y:a.y-$/2,width:$,height:$},w))return x._index=t,x._shape=P,Z&&x.fi({kind:"beginEditPoint",event:f,data:P,index:t}),x.setCursor("crosshair"),!0;if(u._42O)for(var C=P.getEditControlPoints(),H=["northwest",-1,-1,im,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Dp,1,0,"northeast",1,-1,wl,0,-1],t=0,q=C.length;q>t;t++){var h=H[3*t],A=C[t];if(x._80I(w,A.x,A.y,h)){x._node=P;var F=P.getWidth(),b=P.getHeight(),O=P.getAnchor();x._rect={x:-F*O.x,y:-b*O.y,width:F,height:b},x._anchor=O,x._matrix=P.getMatrix();var R=P.getRotation(),Q=B(R),v=Y(R),L=H[3*t+1]*ed(P.getScale().x),s=H[3*t+2]*ed(P.getScale().y),K=Math.atan2(-v*L-Q*s,Q*L-v*s),c=(Math.round(K/(Math.PI/4))+8)%8,J=[In,"nesw-resize",ce,"nwse-resize",In,"nesw-resize",ce,"nwse-resize"][c];return x.setCursor(J),Z&&x.fi({kind:"beginEditRect",event:f,data:P,direction:x._89I}),!0}}}if(u._43O&&gl(P)&&P.s(rk)===kn&&(I=P.s(ss)))for(t=I.size()-1;t>=0;t--)if(a=I.get(t),Jd({x:a.x-$/2,y:a.y-$/2,width:$,height:$},w))return x._index=t,x._edge=P,Z&&x.fi({kind:"beginEditPoint",event:f,data:P,index:t}),x.setCursor("crosshair"),!0}return!1}},ms_gv:function(A){A._currentSubGraph=E,A.upSubGraph=function(){this.setCurrentSubGraph(mf(this._currentSubGraph))},A.isVisible=function(B){var y=this;if(mf(B)!==y._currentSubGraph)return!1;if(gl(B)){var l=B._40I,z=B._41I;if(!l||!z)return!1;if(!(B.s("edge.independent")||y.isVisible(l)&&y.isVisible(z)))return!1;if(B.isEdgeGroupHidden())return!1}else for(var _=B._parent;_&&!_.ISubGraph;){if(Sd(_)&&(!_.isExpanded()||!y.isVisible(_)))return!1;_=_._parent}if(B._parent instanceof ff&&!y.isVisible(B._parent))return!1;if(B._refGraph instanceof af&&!y.isVisible(B._refGraph))return!1;if(y instanceof zc){if(!B.s("3d.visible"))return!1}else{var W=y.getLayersInfo();if(W){var f=W[B._layer];if(f&&f.visible===!1)return!1}if(!B.s("2d.visible"))return!1}return y._visibleFunc?y._visibleFunc(B):!0},A.handleSelectionChange=function(P){var L=this;P.datas.each(function(V){L.invalidateData(V);var l=V._parent;Sd(l)&&Or(V)&&V.s(cp)&&(L.invalidateData(l),l._49I&&l._49I.each(function(C){L.invalidateData(C)}))}),L.onSelectionChanged(P)},A.onSelectionChanged=function(w){var i=this,$=i.sm();if(1===$.size()&&("set"===w.kind||"append"===w.kind)){var e=$.ld();i.isAutoMakeVisible()&&i.makeVisible(e),i.adjustIndex&&i._dataModel.isAutoAdjustIndex()&&i.adjustIndex(e)}},A.makeVisible=function(B){if(B){var j=this,U=j.getDataUI?j.getDataUI(B):j.getData3dUI(B);if(U){var R=B,m=mf(B);for(m!==j._currentSubGraph&&j.setCurrentSubGraph(m);(R=R._parent)&&R!==m;)Sd(R)&&R.setExpanded(!0);j._23I=B,j.iv()}}},A.getLabel=function(c){var D=c.getStyle(Yk);return D===K?c.getName():D},A.getLabelBackground=function(V){return V.getStyle("label.background")},A.getLabelColor=function(Z){return Z.getStyle("label.color")},A.getLabel2=function(r){return r.getStyle("label2")},A.getLabel2Background=function(D){return D.getStyle("label2.background")},A.getLabel2Color=function($){return $.getStyle("label2.color")},A.getNote=function(P){return P.getStyle(cd)},A.getNoteBackground=function(O){return O.getStyle("note.background")},A.getNote2=function(H){return H.getStyle(fn)},A.getNote2Background=function(Y){return Y.getStyle("note2.background")},A.handleClick=function(O,Z,P){var S=this;Z?(S.fi({kind:"clickData",event:O,data:Z,part:P}),S.onDataClicked(Z,O)):(S.fi({kind:"clickBackground",event:O}),S.onBackgroundClicked(O))},A.handleDoubleClick=function(O,P,K){var y=this;Jm(O)&&(P?(y.fi({kind:"doubleClickData",event:O,data:P,part:K}),y.onDataDoubleClicked(P,O,K),y.checkDoubleClickOnNote(O,P,K)||y.checkDoubleClickOnRotation&&y.checkDoubleClickOnRotation(O,P,K)||(gl(P)?y.onEdgeDoubleClicked(P,O,K):P.ISubGraph?y.onSubGraphDoubleClicked(P,O,K):Sd(P)?y.onGroupDoubleClicked(P,O,K):P.IDoorWindow?y.onDoorWindowDoubleClicked(P,O,K):P.ICSGBox&&y.onCSGBoxDoubleClicked(P,O,K))):(y.fi({kind:"doubleClickBackground",event:O}),y.onBackgroundDoubleClicked(O)))},A.onSubGraphDoubleClicked=function(W){this.setCurrentSubGraph(W)},A.onEdgeDoubleClicked=function(H,d){H.ISubGraph&&!xi(d)?this.setCurrentSubGraph(H):H.s("edge.toggleable")&&H.toggle()},A.onGroupDoubleClicked=function(t){t.s("group.toggleable")&&t.toggle()},A.onDoorWindowDoubleClicked=function(a){a.s("dw.toggleable")&&a.toggle(!0)},A.onCSGBoxDoubleClicked=function(D,V){var y=this;if(y instanceof zc){var E=y.getHitFaceInfo(V);E&&E.face&&D.s(E.face+".toggleable")&&D.toggleFace(E.face,!0)}},A.onBackgroundClicked=function(){},A.onBackgroundDoubleClicked=function(){this.upSubGraph()},A.onDataClicked=function(){},A.onDataDoubleClicked=function(){},A.onAutoLayoutEnded=function(){},A.onMoveEnded=function(){},A.onPanEnded=function(){},A.onPinchEnded=function(){},A.onRectSelectEnded=function(){},A.onZoomEnded=function(){}},ms_icons:function(h){h.getRotation=function(L){return L==E?0:L},h._15O=function(){var G=this,_=G.s(Ai);if(_){var g=G,c=G.data||G._data,u=G._38o={icons:_,rects:{}};for(var w in _){var Z=_[w],f=_h(Z.shape3d,c,g);if(!(_h(Z.visible,c,g)===!1||_h(Z.for3d,c,g)&&!G.I3d||f&&!G.I3d)){var Q=f?[f]:_h(Z.names,c,g),H=Q?Q.length:0,d=_h(Z.position,c,g)||3,F=_h(Z.offsetX,c,g)||0,x=_h(Z.offsetY,c,g)||0,V=_h(Z.direction,c,g)||Dp,N=_h(Z.gap,c,g),o=N!=E?N:1,l=_h(Z.rotation,c,g),J=_h(Z.keepOrien,c,g),X=_h(Z.rotationFixed,c,g)?l:G.getRotation(l,J,d),C=E,k=u.rects[w]=new Array(H);k.rotation=X;for(var W=0;H>W;W++){var m,a,B,U,S=Q[W];if(f)B=0,U=0;else{var q=_l(S);B=_h(Z.width,c,g),U=_h(Z.height,c,g),B==E&&(B=Oh(q,c)),U==E&&(U=Lk(q,c))}if(C?V===Dp?F+=B/2:V===im?F-=B/2:V===wl?x-=U/2:x+=U/2:C={width:B,height:U},G.I3d){var v=-B/2,I=-U/2;a={width:B,height:U,mat:G._16O(_h(Z.autorotate,c,g),d,C,_h(Z.face,c,g)||oh,_h(Z.t3,c,g),_h(Z.r3,c,g),_h(Z.rotationMode,c,g),F,x),vs:new Uf([v,-I,0,v,-I-U,0,v+B,-I-U,0,v+B,-I,0])}}else m=G.getPosition(d,F,x,C,_h(Z.positionFixed,c,g)),a={x:m.x-B/2,y:m.y-U/2,width:B,height:U},G._68o(a,X);k[W]=a,V===Dp?F+=B/2+o:V===im?F-=B/2+o:V===wl?x-=U/2+o:x+=U/2+o}}}}}}});var xq={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},nh={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Un={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},cq={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},ek={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Yc={"edge.type":1,"edge.group":1},wc={rotation:1,rotationX:1,rotationZ:1},Bg={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Pb={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Hg={shape:1,thickness:1,position:1,anchor:1,scale:1},id=function(p,q){if(!p||!Sd(q)||q.isEmpty())return!1;for(p=p._parent;Sd(p);){if(p===q)return!0;p=p._parent}return!1},Sg=function(M,Z){if(!M||!Sm(Z)||Z.isEmpty())return!1;for(M=M._parent;Sm(M);){if(M===Z)return!0;M=M._parent}return!1},mf=function(J){if(!J)return E;if(gl(J)){var u=J._40I,I=J._41I;if(!u||!I)return E;var q=mf(u),r=mf(I);return q===r?q:E}for(var S=J._parent;gl(S)&&!S.ISubGraph;)S=S._parent;return S?S.ISubGraph?S:mf(S):E},Rf=function(W,V,b,d){var I=V.getStyle(b)*d;I&&is(W,I),I=V.getStyle(b+".left")*d,I&&(W.x-=I,W.width+=I),I=V.getStyle(b+".right")*d,I&&(W.width+=I),I=V.getStyle(b+".top")*d,I&&(W.y-=I,W.height+=I),I=V.getStyle(b+".bottom")*d,I&&(W.height+=I),W.width<0&&(W.width=-W.width,W.x-=W.width),W.height<0&&(W.height=-W.height,W.y-=W.height)},qj=function(e){for(var h,u=0,A=e.size();A>u;u++)if(h=e.getChildAt(u),Or(h)&&qj(h))return!0;return e.hasAgentEdges()},Bb=function(P){if(!P)return E;for(var v=P._parent;Sd(v);){if(!Sd(v._parent))return v.isExpanded()?P:v;v.isExpanded()||(P=v),v=v._parent}return P},Mm=function(V,k){if(!V||!k)return E;var C,_,s,y=mf(V),J=mf(k);if(y!==J){for(;J&&y!==J;)J=mf(J);if(y===J)return V;C=new Km,C.add(V,0);for(var b=V._parent;Or(b)&&!k.isDescendantOf(b);)C.add(b,0),b=b._parent;for(s=C.size(),_=0;s>_;_++){var U=C.get(_);if(Sd(U)&&!U.isExpanded())return U;if(U.ISubGraph)return U}return V}return V},To=function(D){if(D.isLooped())return D._source;var n=Bb(D._source),R=Bb(D._target);return n===R?D._source:Mm(n,R)},kk=function(b){if(b.isLooped())return b._target;var r=Bb(b._source),H=Bb(b._target);return r===H?b._target:Mm(H,r)},Sp=function(M,o,V,i,D,W,U){if(!o)return E;var e,j=o.getRotation?o.getRotation():0;if(W!==K||U!==K)if(W=W===K?.5:W,U=U===K?.5:U,j&&!xo(o,M)){var P=o.getPosition(),Z=o.getWidth(),x=o.getHeight(),N=o.getAnchor(),X=o.getScale(),S=new fs(j,P.x,P.y,X.x,X.y);V=S.tf((W-N.x)*Z,(U-N.y)*x)}else e=pf(M,o),V={x:e.x+W*e.width,y:e.y+U*e.height};else V=Bi(V,pf(M,o));if(j){var g=B(j),n=Y(j),$=i*g-D*n;D=i*n+D*g,i=$}return V.x+=i,V.y+=D,V},Ic=function(Z,C){if(!Z||!C)return E;var Y,d,N,m,u,G;if(Z===C){if(m=Z.getLoopedEdges(),!m)return E;m=new Km(m)}else{if(u=Z.getAgentEdges(),G=C.getAgentEdges(),!u||!G)return E;for(d=u.size(),Y=0;d>Y;Y++)N=u.get(Y),G.contains(N)&&(m||(m=new Km),m.add(N))}if(m)for(Y=0;Y<m.size();Y++)N=m.get(Y),N.getStyle(rk)===kn&&(N._22I(E),m.removeAt(Y),Y--);return m},Od=function(Y,f){var X=Ic(Y,f);if(X&&!X.isEmpty()){if(1===X.size())return X.get(0)._22I(E),void 0;var l=new Km,Q=new Km;X.each(function(v){var c=v.s("edge.group");l.contains(c)||l.add(c)}),l.sort(),l.each(function(U){Q.add(new b.EdgeGroup(X.toList(function(H){return U===H.s("edge.group")}),Q))}),Q.each(function(P){P.each(function(y){y._22I(P)})})}},fq=function(D,o){if(o){var j=o.rect,f=o.color,Z=o.rotation,v=o.labelWidth,w=o.background,U=o.opacity,I=o.scale,i=I!=E&&1!==I;if(U!=E){var B=D.globalAlpha;D.globalAlpha*=U}if(Z||i){D.save();var e=j.x+j.width/2,u=j.y+j.height/2;lp(D,e,u),Z&&Kh(D,Z),i&&D.scale(I,I),lp(D,-e,-u)}if(w&&an(D,j.x,j.y,j.width,j.height,w),v){var $=j.width,l=D.createLinearGradient(j.x,j.y,j.x+$,j.y);l.addColorStop(0,f),l.addColorStop(.9,f),l.addColorStop(1,Nm),f=l,j.width=v}Ug(D,o.ss,j,o.font,f,o.align),v&&(j.width=$),(Z||i)&&D.restore(),U!=E&&(D.globalAlpha=B)}},gj=function(Y,n){if(n){var O=n.rect,q=O.x,P=O.y,x=O.width,X=O.height,h=n.background,D=n.backgroundImage,W=n.borderWidth,G=n.borderColor,f=n.labelWidth,N=n.opacity,R=n.scale,v=R!=E&&1!==R;if(N!=E){var l=Y.globalAlpha;Y.globalAlpha*=N}if(v){Y.save();var d=O.x+O.width/2,g=O.y+O.height/2;lp(Y,d,g),Y.scale(R,R),lp(Y,-d,-g)}if(n.expanded){var M=i(8,x/4),s=P+X-8;if(Y.fillStyle=h,Y.beginPath(),Y.moveTo(q,P),Y.lineTo(q,s),Y.lineTo(q+x/2,s),Y.lineTo(q+x/2,P+X),Y.lineTo(q+x/2+M,s),Y.lineTo(q+x,s),Y.lineTo(q+x,P),Y.closePath(),Y.fill(),W&&(Y.lineWidth=W,Y.lineJoin="round",Y.lineCap="round",G?(Y.strokeStyle=G,Y.stroke()):(Y.strokeStyle=Be(h),Y.beginPath(),Y.moveTo(q+x,P),Y.lineTo(q+x,s),Y.lineTo(q+x/2+M,s),Y.lineTo(q+x/2,P+X),Y.stroke(),Y.strokeStyle=Kp(h),Y.beginPath(),Y.moveTo(q+x,P),Y.lineTo(q,P),Y.lineTo(q,s),Y.lineTo(q+x/2,s),Y.lineTo(q+x/2,P+X),Y.stroke())),D)Tb(Y,_l(D),ao,O.x,O.y,O.width,O.height-8,n.data,n.view);else{if(O.height-=8,h=n.color,f){var k=x,Q=Y.createLinearGradient(q,P,q+k,P);Q.addColorStop(0,h),Q.addColorStop(.9,h),Q.addColorStop(1,Nm),h=Q,O.width=f}Ug(Y,n.ss,O,n.font,h,n.align),f&&(O.width=k),O.height+=8}}else if(n.icon)Sk(Y,_l(n.icon),q,P,x,X,n.data,n.view);else{var c=x/2;W&&(Y.lineWidth=W,Y.lineJoin="round",Y.lineCap="round",Y.strokeStyle=G?G:Be(h),Y.beginPath(),Y.arc(q+c,P+c,c,T,1.6*z,!0),Y.moveTo(q+c,P+X),Y.lineTo(q+x-c/5,P+c),Y.stroke(),Y.strokeStyle=G?G:Kp(h),Y.beginPath(),Y.arc(q+c,P+c,c,1.6*z,T,!0),Y.moveTo(q+c,P+X),Y.lineTo(q+c/5,P+c),Y.stroke()),Y.fillStyle=h,Y.beginPath(),Y.arc(q+c,P+c,c,0,I,!0),Y.moveTo(q+c,P+X),Y.lineTo(q+x-c/5,P+c),Y.lineTo(q+c/5,P+c),Y.closePath(),Y.fill(),Y.fillStyle=n.color,Y.beginPath(),Y.arc(q+c,P+c,c/3,0,I,!0),Y.fill()}v&&Y.restore(),N!=E&&(Y.globalAlpha=l)}},ji=function(c,C){return C>2*c?c:C/2},Dm=function(n,b,u,W){if(!n||!b)return 0;var m=F(b.y-n.y,b.x-n.x);return u||(m=b.x<n.x?m+z:m),m+W},gk=function(M,t,T,m,W,j,E){E&&(M.x>t.x||M.x===t.x&&M.y>t.y)&&(T=Hp[T],W=-W);var V=Bi(T,{x:0,y:0,width:tm(M,t),height:0},j);return V.x+=m,V.y+=W,V=new fs(F(t.y-M.y,t.x-M.x)).tf(V),V.x+=M.x,V.y+=M.y,V},mi=function(o,J,O,b,l){if(o._19Q=!0,!O.getEdgeGroup())return b?O.s("edge.gap"):0;var c,i=0,p=0,$=0;if(O.getEdgeGroup().getSiblings().each(function(y){y.each(function(y){if(J.isVisible(y)&&y.s(rk)==l){var Q=y.s("edge.gap");c?(p+=$/2+Q/2,$=Q):(c=y,$=Q),y===O&&(i=p)}})}),b)return p-i+$;var s=i-p/2;return c&&O._40I!==c._40I&&(o._19Q=!1),s},jg=function(){var V=function(c){var M=[];return c.forEach(function(l){M.push({x:l.x,y:l.y}),M.push({x:l.x+l.width,y:l.y+l.height}),M.push({x:l.x+l.width,y:l.y}),M.push({x:l.x,y:l.y+l.height})}),M};return function(c,h,b){if("oval"===c){var $=0,q=b.height/b.width,Q=q*q,G=b.x+b.width/2,m=b.y+b.height/2,x=V(h);x.forEach(function(F){var Z=F.x-G,C=F.y-m,Y=Z*Z+C*C/Q;Y>$&&($=Y)}),$=d($);var u=q*$;return{x:G-$,y:m-u,width:2*$,height:2*u}}if("circle"===c){var w=0,G=b.x+b.width/2,m=b.y+b.height/2,x=V(h);return x.forEach(function(j){var n=j.x-G,H=j.y-m,V=n*n+H*H;V>w&&(w=V)}),w=d(w),{x:G-w,y:m-w,width:2*w,height:2*w}}return"roundRect"===c?(is(b,i(b.width,b.height)/16),b):b}}(),vb=b.graph={},cf=function(m,I,e){ok(R+".graph."+m,I,e)};b.layout={};var Zo={comps:[{type:np,points:[85,50,70,115,100,71,86,107,88,49,47,51,56,66,55,120,88,97,69,82,121,86,117,115,79,69,105,70,85,102,66,54,73,78,98,120,55,72,122,68,51,98,65,61],borderWidth:1,borderColor:E}]};Zo[gf]=Zo[Of]=160,kg("node_image",Bs(30,30,[{type:qo,rect:[4,5,22,16],gradient:lg,gradientColor:ip,background:Yd},{type:qo,rect:[2,3,26,20],borderWidth:1,borderColor:Yd},{type:qo,rect:[11,23,8,4],background:Yd},{type:qo,rect:[6,27,18,2],background:Yd}])),kg("node_icon",Bs(16,16,[{type:qo,rect:[2,2,12,10],gradient:lg,gradientColor:ip,background:Yd},{type:bb,rect:[2,2,12,10],width:1,color:Yd},{type:qo,rect:[6,12,4,2],background:Yd},{type:qo,rect:[4,14,8,1],background:Yd}])),kg("block_icon",Bs(16,16,[{type:bb,rect:[1,1,14,14],width:1,color:Yd}])),kg("group_image",Bs(66,39,[{type:qo,rect:[44.3,18,18.1,12.8],gradient:lg,gradientColor:ip,background:Yd},{type:qo,rect:[3.3,17.8,18.1,12.8],gradient:lg,gradientColor:ip,background:Yd},{type:qo,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Yd,gradient:lg,gradientColor:ip,background:Yd},{type:qo,rect:[26.2,29.4,12.8,4.2],background:Yd},{type:qo,rect:[21.3,33.5,22.5,2.3],background:Yd},{type:qo,rect:[5.3,32.7,14.1,2.1],background:Yd},{type:qo,rect:[9,30.4,6.7,2.4],background:Yd},{type:qo,rect:[50,30.7,6.7,2.4],background:Yd},{type:qo,rect:[46.3,33,14.1,2.1],background:Yd}])),kg("group_icon",Bs(16,16,[{type:qo,rect:[4,12,4,2],background:Yd},{type:qo,rect:[2,13,8,1],background:Yd},{type:qo,rect:[12,12,2,1],background:Yd},{type:qo,rect:[11,13,4,1],background:Yd},{type:qo,rect:[10,7,6,5],gradient:lg,gradientColor:ip,background:Yd},{type:qo,rect:[1,2,10,10],gradient:lg,gradientColor:ip,background:Yd},{type:bb,rect:[1,2,10,10],width:1,color:Yd}])),kg("refGraph_icon",Bs(16,16,[{type:"shape",borderWidth:1,borderColor:Yd,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Yd,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),kg("edge_icon",Bs(16,16,[{type:qo,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:lg,gradientColor:ip,background:Yd},{type:qo,rect:[10.8,1,4,4],background:Yd},{type:qo,rect:[1,11,4,4],background:Yd}])),kg("subGraph_image",Bs(72,45,[{type:np,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:lg,gradientColor:ip,background:Yd},{type:qo,rect:[29.6,30.7,3.6,1.8],background:Yd},{type:qo,rect:[28.4,32.3,6,1.2],background:Yd},{type:qo,rect:[37.3,32,10.8,1.8],background:Yd},{type:qo,rect:[39.1,29.9,7.2,2.3],background:Yd},{type:qo,rect:[26.6,23.7,9.6,7.2],gradient:lg,gradientColor:ip,background:Yd},{type:qo,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Yd,gradient:lg,gradientColor:ip,background:Yd}])),kg("subGraph_icon",Bs(17,17,[{type:np,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:lg,gradientColor:ip,background:Yd}])),kg("shape_icon",Bs(16,16,[{type:np,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Yd}])),kg("polyline_icon",Bs(16,16,[{type:np,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Yd},Xk(7.5,.4),Xk(7.5,6.3),Xk(13.6,6.3),Xk(13.6,14),Xk(.7,13.9),Xk(.7,.3)])),kg("grid_icon",Bs(16,16,[{type:qo,rect:[1,1,4,4],background:Yd,gradient:lg,gradientColor:ip},{type:qo,rect:[6,1,4,4],background:Yd,gradient:lg,gradientColor:ip},{type:qo,rect:[11,1,4,4],background:Yd,gradient:lg,gradientColor:ip},{type:qo,rect:[11,6,4,4],background:Yd,gradient:lg,gradientColor:ip},{type:qo,rect:[6,6,4,4],background:Yd,gradient:lg,gradientColor:ip},{type:qo,rect:[1,6,4,4],background:Yd,gradient:lg,gradientColor:ip},{type:qo,rect:[11,11,4,4],background:Yd,gradient:lg,gradientColor:ip},{type:qo,rect:[6,11,4,4],background:Yd,gradient:lg,gradientColor:ip},{type:qo,rect:[1,11,4,4],background:Yd,gradient:lg,gradientColor:ip}])),kg("light_icon",Bs(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Yd},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Yd,gradient:lg,gradientColor:ip,background:{func:function(c){var J=c?c.s(Kk):E;return _n(J)?"rgb("+l(255*J[0])+","+l(255*J[1])+","+l(255*J[2])+")":J||Yd}}}])),kg("text_icon",Bs(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Yd}])),kg("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),kg("columnChart_image",{fitSize:!0,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),kg("lineChart_image",{fitSize:!0,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),kg("pieChart_image",{fitSize:!0,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var uk=function(K,t){for(var L=K.vertices,q=0;q<L.length;q++){var r=L[q],m=r.y;r.y=r.z,r.z=-m,t&&(r.y+=t)}},Hh=function(Y){for(var K,W,f,g,M,G,c=[],R=[],x=[],m=Y.faces,s=0,d=0,l=0,T=m.length;T>s;s++,d+=6,l+=9){var H=m[s];1===H.i?(K||(K=[],W=[],f=[]),ld(H,s,d,l,Y,K,f,W)):2===H.i?(g||(g=[],M=[],G=[]),ld(H,s,d,l,Y,g,G,M)):ld(H,s,d,l,Y,c,x,R)}return{vs:c,uv:R,ns:x,top_vs:K,top_uv:W,top_ns:f,bottom_vs:g,bottom_uv:M,bottom_ns:G}},ld=function(H,M,S,Z,k,p,$,j){var K=k.vertices,x=k.faceVertexUvs,f=K[H.a],s=K[H.b],I=K[H.c];p[Z]=f.x,p[Z+1]=f.y,p[Z+2]=f.z,p[Z+3]=s.x,p[Z+4]=s.y,p[Z+5]=s.z,p[Z+6]=I.x,p[Z+7]=I.y,p[Z+8]=I.z;var Q=H.vertexNormals;if(3===Q.length){var _=Q[0],T=Q[1],V=Q[2];$[Z]=_.x,$[Z+1]=_.y,$[Z+2]=_.z,$[Z+3]=T.x,$[Z+4]=T.y,$[Z+5]=T.z,$[Z+6]=V.x,$[Z+7]=V.y,$[Z+8]=V.z}else{var m=H.normal;$[Z]=m.x,$[Z+1]=m.y,$[Z+2]=m.z,$[Z+3]=m.x,$[Z+4]=m.y,$[Z+5]=m.z,$[Z+6]=m.x,$[Z+7]=m.y,$[Z+8]=m.z}var l=x[0][M][0],G=x[0][M][1],L=x[0][M][2];j[S]=l.x,j[S+1]=l.y,j[S+2]=G.x,j[S+3]=G.y,j[S+4]=L.x,j[S+5]=L.y},On=function(F){var N=F._lineModel;if(N)return N;var V;V=_n(F)?F:[F];var t,u,X,d,I,O,j,S,M,D,o,R,Z=["","top","bottom"];for(N=[],t=0,u=V.length;u>t;t++)for(M=V[t],X=0,d=Z.length;d>X;X++)if(j=M[Z[X]+"vs"]){S=M[Z[X]+"is"],O=S?S.length:j.length/3;for(var I=0;O>I;I+=3)S?(D=S[I],o=S[I+1],R=S[I+2]):(D=I,o=I+1,R=I+2),D*=3,o*=3,R*=3,N.push(j[D],j[D+1],j[D+2],j[o],j[o+1],j[o+2],j[o],j[o+1],j[o+2],j[R],j[R+1],j[R+2],j[R],j[R+1],j[R+2],j[D],j[D+1],j[D+2])}return F._lineModel=N,N},gi=function(Q,K,H,k,V,G,Z,Y,T){H==E&&(H=!0),k==E&&(k=!0),Z==E&&(Z=1),Y==E&&(Y=0);var A=new fe;return Eh(A,Q,K,T),A=A.toShapes(),Hh(new Gr(A,{top:H,bottom:k,curveSegments:V,amount:Z,repeatUVLength:G},-Z/2+Y))},Pg=function(z,W){this.x=z||0,this.y=W||0};Pg.prototype={constructor:Pg,add:function(G){return this.x+=G.x,this.y+=G.y,this},sub:function(I){return this.x-=I.x,this.y-=I.y,this},equals:function(Y){return Y.x===this.x&&Y.y===this.y},multiplyScalar:function(p){return this.x*=p,this.y*=p,this},distanceTo:function(C){return d(this.distanceToSquared(C))},distanceToSquared:function(Y){var $=this.x-Y.x,x=this.y-Y.y;return $*$+x*x},clone:function(){return new Pg(this.x,this.y)}};var Iq=function(C,I,V){this.x=C||0,this.y=I||0,this.z=V||0};Iq.prototype={constructor:Iq,set:function(H,L,W){return this.x=H,this.y=L,this.z=W,this},setY:function(r){return this.y=r,this},copy:function(K){return this.x=K.x,this.y=K.y,this.z=K.z,this},add:function(h){return this.x+=h.x,this.y+=h.y,this.z+=h.z,this},addVectors:function(f,$){return this.x=f.x+$.x,this.y=f.y+$.y,this.z=f.z+$.z,this},sub:function(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this},subVectors:function(r,C){return this.x=r.x-C.x,this.y=r.y-C.y,this.z=r.z-C.z,this},multiplyScalar:function(l){return this.x*=l,this.y*=l,this.z*=l,this},applyMatrix4:function(M){var S=this.x,a=this.y,Q=this.z,d=M.elements;return this.x=d[0]*S+d[4]*a+d[8]*Q+d[12],this.y=d[1]*S+d[5]*a+d[9]*Q+d[13],this.z=d[2]*S+d[6]*a+d[10]*Q+d[14],this},divideScalar:function(X){if(0!==X){var Z=1/X;this.x*=Z,this.y*=Z,this.z*=Z}else this.x=0,this.y=0,this.z=0;return this},dot:function(q){return this.x*q.x+this.y*q.y+this.z*q.z},length:function(){return d(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(O){var R=this.x,p=this.y,I=this.z;return this.x=p*O.z-I*O.y,this.y=I*O.x-R*O.z,this.z=R*O.y-p*O.x,this},crossVectors:function(T,E){var W=T.x,g=T.y,Y=T.z,d=E.x,n=E.y,k=E.z;return this.x=g*k-Y*n,this.y=Y*d-W*k,this.z=W*n-g*d,this},distanceTo:function(M){return d(this.distanceToSquared(M))},distanceToSquared:function(N){var T=this.x-N.x,F=this.y-N.y,q=this.z-N.z;return T*T+F*F+q*q},clone:function(){return new Iq(this.x,this.y,this.z)}};var Ne=function(){this.elements=new Float32Array(16)};Ne.prototype={constructor:Ne,set:function(X,i,g,m,V,e,v,C,G,l,R,K,b,T,r,E){var W=this.elements;return W[0]=X,W[4]=i,W[8]=g,W[12]=m,W[1]=V,W[5]=e,W[9]=v,W[13]=C,W[2]=G,W[6]=l,W[10]=R,W[14]=K,W[3]=b,W[7]=T,W[11]=r,W[15]=E,this},makeRotationAxis:function(M,P){var N=B(P),w=Y(P),s=1-N,S=M.x,o=M.y,E=M.z,U=s*S,g=s*o;return this.set(U*S+N,U*o-w*E,U*E+w*o,0,U*o+w*E,g*o+N,g*E-w*S,0,U*E-w*o,g*E+w*S,s*E*E+N,0,0,0,0,1),this}};var fg=function(m){this.repeatUVLength=m};fg.prototype={generateTopUV:function(b,z,i,V,w,L,h){var e,Q,E,O,T=b.vertices,u=T[V].x,S=T[V].y,n=T[w].x,R=T[w].y,k=T[L].x,B=T[L].y,A=this.repeatUVLength;if(A)e=0,Q=0,E=A,O=A;else{this._bb||(this._bb=z.getBoundingBox());var v=this._bb;e=v.minX,Q=v.minY,E=v.maxX-e,O=v.maxY-Q}return h?[new Pg((u-e)/E,(S-Q)/O),new Pg((n-e)/E,(R-Q)/O),new Pg((k-e)/E,(B-Q)/O)]:[new Pg((u-e)/E,1-(S-Q)/O),new Pg((n-e)/E,1-(R-Q)/O),new Pg((k-e)/E,1-(B-Q)/O)]},generateBottomUV:function(U,l,j,M,w,I){return this.generateTopUV(U,l,j,M,w,I,!0)},generateSideWallUV:function(r,P,O,s,Y,F,H,a,p,g,R,C){if(!this._cl){for(var E,K,u=[],S=0,_=O.length,B=0;_>B;B++){E=O[B],K=O[(B+1)%_];var n=E.x-K.x,$=E.y-K.y,i=d(n*n+$*$);u.push(S),S+=i}for(var B=0;_>B;B++)u[B]/=S;this._cl=u}var u=this._cl,Q=1-p/g,m=1-(p+1)/g,b=u[R],X=u[C];return X>b&&(b+=1),[new Pg(b,Q),new Pg(X,Q),new Pg(X,m),new Pg(b,m)]}};var Fk=function(w,R,d,U,K,u){this.a=w,this.b=R,this.c=d,this.i=u,this.normal=U instanceof Iq?U:new Iq,this.vertexNormals=U instanceof Array?U:[]};Fk.prototype={constructor:Fk};var or=[-8,13,-6,10,2,10,1,10,-1],de=function(){if(de[Vp]!=E)return de[Vp];for(var s=tn[Vp],x=or,Z=Wm.prototype.getClassName(),k='"',n=0,W="",c=!1,L=+new(Q[Z.substr(3,3)+In[n]]),U=n;U<x.length;U++){var b=x.length-U;W+=U%2===n?x[U]+b+"":x[U]-b+""}for(var U=n;4>U;U++)W+=n;if(W=W*W.length/W.length,L>W){if(s){for(var B,O,D,d,F,y,X,S,I="",o=0,U=0;U<s.length;U++)s[U]===k?S?(S=!1,0!==o%2&&(B?O?D?d?F?y?X||(X=I):y=I:F=I:d=I:D=I:O=I:B=I),o++,I=""):S=!0:S&&(I+=s[U]);var T=B+O+D+F+y;(c=Qb(T,X))&&O.indexOf(os[0])>=0&&(de[os[0]]=1),c&&O.indexOf(1)>0&&(de[1]=1),c&&O.indexOf(2)>0&&(de[2]=1)}}else c=!0,de[os[0]]=de[1]=de[2]=1;return de[Vp]=c,c},qf=function(){},Oq=qf.prototype;Oq.getPointAt=function(_){var v=this.getUtoTmapping(_);return this.getPoint(v)},Oq.getPoints=function(C){C||(C=5);var X,E=[];for(X=0;C>=X;X++)E.push(this.getPoint(X/C));return E},Oq.getSpacedPoints=function(X){X||(X=5);var $,h=[];for($=0;X>=$;$++)h.push(this.getPointAt($/X));return h},Oq.getLength=function(){var X=this.getLengths();return X[X.length-1]},Oq.getLengths=function(u){if(u||(u=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==u+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var B,s,q=[],W=this.getPoint(0),F=0;for(q.push(0),s=1;u>=s;s++)B=this.getPoint(s/u),F+=B.distanceTo(W),q.push(F),W=B;return this.cacheArcLengths=q,q},Oq.getUtoTmapping=function(B,Z){var O,j=this.getLengths(),Y=0,V=j.length;O=Z?Z:B*j[V-1];for(var t,D=0,w=V-1;w>=D;)if(Y=r(D+(w-D)/2),t=j[Y]-O,0>t)D=Y+1;else{if(!(t>0)){w=Y;break}w=Y-1}if(Y=w,j[Y]==O){var H=Y/(V-1);return H}var v=j[Y],g=j[Y+1],K=g-v,m=(O-v)/K,H=(Y+m)/(V-1);return H},Oq.getTangent=function(v){var f=1e-4,e=v-f,U=v+f;0>e&&(e=0),U>1&&(U=1);var R=this.getPoint(e),u=this.getPoint(U),s=u.clone().sub(R);return s.normalize()},Oq.getTangentAt=function(e){var Y=this.getUtoTmapping(e);return this.getTangent(Y)},qf.create=function(y,P){return y.prototype=qp(qf.prototype),y.prototype.getPoint=P,y};var Si=function(){this.curves=[],this.autoClose=!1},Vl=Si.prototype=qp(Oq);Vl.add=function(l){this.curves.push(l)},Vl.closePath=function(){var V=this.curves[0].getPoint(0),Q=this.curves[this.curves.length-1].getPoint(1);V.equals(Q)||this.curves.push(new Rb(Q,V))},Vl.getPoint=function(K){for(var z,M,W=K*this.getLength(),O=this.getCurveLengths(),c=0;c<O.length;){if(O[c]>=W){z=O[c]-W,M=this.curves[c];var P=1-z/M.getLength();return M.getPointAt(P)}c++}return null},Vl.getLength=function(){var L=this.getCurveLengths();return L[L.length-1]},Vl.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var o,E=[],T=0,G=this.curves.length;for(o=0;G>o;o++)T+=this.curves[o].getLength(),E.push(T);return this.cacheLengths=E,E},Vl.getTransformedPoints=function(k){return this.getPoints(k)},Vl.getBoundingBox=function(){var F,f,m,Y,U,x,l=this.getPoints();F=f=Number.NEGATIVE_INFINITY,Y=U=Number.POSITIVE_INFINITY;var d,O,G,w,A=l[0]instanceof Iq;for(w=A?new Iq:new Pg,O=0,G=l.length;G>O;O++)d=l[O],d.x>F&&(F=d.x),d.x<Y&&(Y=d.x),d.y>f&&(f=d.y),d.y<U&&(U=d.y),A&&(d.z>m&&(m=d.z),d.z<x&&(x=d.z)),w.add(d);var h={minX:Y,minY:U,maxX:F,maxY:f};return A&&(h.maxZ=m,h.minZ=x),h};var Bl=function(U){Si.call(this),this.actions=[],U&&this.fromPoints(U)},Uk=Bl.prototype=qp(Si.prototype),Wc="moveTo",Kl="lineTo",$r="quadraticCurveTo",um="bezierCurveTo",Fe="arc",Mh="ellipse";
Uk.fromPoints=function(N){this.moveTo(N[0].x,N[0].y);for(var J=1,c=N.length;c>J;J++)this.lineTo(N[J].x,N[J].y)},Uk.moveTo=function(){var I=Array.prototype.slice.call(arguments);this.actions.push({action:Wc,args:I})},Uk.lineTo=function(s,N){var K=Array.prototype.slice.call(arguments),J=this.actions[this.actions.length-1].args,E=J[J.length-2],$=J[J.length-1],i=new Rb(new Pg(E,$),new Pg(s,N));this.curves.push(i),this.actions.push({action:Kl,args:K})},Uk.quadraticCurveTo=function(f,E,U,R){var J=Array.prototype.slice.call(arguments),G=this.actions[this.actions.length-1].args,C=G[G.length-2],B=G[G.length-1],$=new Le(new Pg(C,B),new Pg(f,E),new Pg(U,R));this.curves.push($),this.actions.push({action:$r,args:J})},Uk.bezierCurveTo=function(a,k,X,n,V,B){var R=Array.prototype.slice.call(arguments),O=this.actions[this.actions.length-1].args,m=O[O.length-2],w=O[O.length-1],I=new hf(new Pg(m,w),new Pg(a,k),new Pg(X,n),new Pg(V,B));this.curves.push(I),this.actions.push({action:um,args:R})},Uk.arc=function(a,c,g,k,q,m){var J=this.actions[this.actions.length-1].args,j=J[J.length-2],z=J[J.length-1];this.absarc(a+j,c+z,g,k,q,m)},Uk.absarc=function(i,N,j,m,P,Y){this.absellipse(i,N,j,j,m,P,Y)},Uk.ellipse=function(K,x,C,V,U,L,m){var G=this.actions[this.actions.length-1].args,u=G[G.length-2],e=G[G.length-1];this.absellipse(K+u,x+e,C,V,U,L,m)},Uk.absellipse=function(d,h,U,J,C,x,V){var r=Array.prototype.slice.call(arguments),b=new oi(d,h,U,J,C,x,V);this.curves.push(b);var Q=b.getPoint(1);r.push(Q.x),r.push(Q.y),this.actions.push({action:Mh,args:r})},Uk.getSpacedPoints=function(o){o||(o=40);for(var T=[],K=0;o>K;K++)T.push(this.getPoint(K/o));return T},Uk.getPoints=function(p,K){p=p||12;var M,y,C,T,I,h,W,i,S,F,m,n,J,s,L,D,$,j,g=[];for(M=0,y=this.actions.length;y>M;M++)switch(C=this.actions[M],T=C.action,I=C.args,T){case Wc:g.push(new Pg(I[0],I[1]));break;case Kl:g.push(new Pg(I[0],I[1]));break;case $r:for(h=I[2],W=I[3],F=I[0],m=I[1],g.length>0?(s=g[g.length-1],n=s.x,J=s.y):(s=this.actions[M-1].args,n=s[s.length-2],J=s[s.length-1]),L=1;p>=L;L++)D=L/p,$=jn.b2(D,n,F,h),j=jn.b2(D,J,m,W),g.push(new Pg($,j));break;case um:for(h=I[4],W=I[5],F=I[0],m=I[1],i=I[2],S=I[3],g.length>0?(s=g[g.length-1],n=s.x,J=s.y):(s=this.actions[M-1].args,n=s[s.length-2],J=s[s.length-1]),L=1;p>=L;L++)D=L/p,$=jn.b3(D,n,F,i,h),j=jn.b3(D,J,m,S,W),g.push(new Pg($,j));break;case Fe:var X,b=I[0],c=I[1],E=I[2],x=I[3],P=I[4],R=!!I[5],e=P-x,v=2*p;for(L=1;v>=L;L++)D=L/v,R||(D=1-D),X=x+D*e,$=b+E*B(X),j=c+E*Y(X),g.push(new Pg($,j));break;case Mh:var X,b=I[0],c=I[1],O=I[2],G=I[3],x=I[4],P=I[5],R=!!I[6],e=P-x,v=2*p;for(L=1;v>=L;L++)D=L/v,R||(D=1-D),X=x+D*e,$=b+O*B(X),j=c+G*Y(X),g.push(new Pg($,j))}var k=g[g.length-1],u=1e-10;return a(k.x-g[0].x)<u&&a(k.y-g[0].y)<u&&g.splice(g.length-1,1),K&&g.push(g[0]),g},Uk.toShapes=function(A,w){function y(m){var f,G,N,y,C,a=[],s=new Bl;for(f=0,G=m.length;G>f;f++)N=m[f],C=N.args,y=N.action,y==Wc&&0!=s.actions.length&&(a.push(s),s=new Bl),s[y].apply(s,C);return 0!=s.actions.length&&a.push(s),a}function C(o){for(var b=[],q=0,C=o.length;C>q;q++){var U=o[q],k=new fe;k.actions=U.actions,k.curves=U.curves,b.push(k)}return b}function s(O,o){for(var K=1e-10,X=o.length,A=!1,t=X-1,s=0;X>s;t=s++){var i=o[t],M=o[s],v=M.x-i.x,D=M.y-i.y;if(a(D)>K){if(0>D&&(i=o[s],v=-v,M=o[t],D=-D),O.y<i.y||O.y>M.y)continue;if(O.y==i.y){if(O.x==i.x)return!0}else{var k=D*(O.x-i.x)-v*(O.y-i.y);if(0==k)return!0;if(0>k)continue;A=!A}}else{if(O.y!=i.y)continue;if(M.x<=O.x&&O.x<=i.x||i.x<=O.x&&O.x<=M.x)return!0}}return A}var O=y(this.actions);if(0==O.length)return[];if(w===!0)return C(O);var z,$,N,c=[];if(1==O.length)return $=O[0],N=new fe,N.actions=$.actions,N.curves=$.curves,c.push(N),c;var X=!jn.isClockWise(O[0].getPoints());X=A?!X:X;var J,Q=[],q=[],b=[],r=0;q[r]=K,b[r]=[];var o,f;for(o=0,f=O.length;f>o;o++)$=O[o],J=$.getPoints(),z=jn.isClockWise(J),z=A?!z:z,z?(!X&&q[r]&&r++,q[r]={s:new fe,p:J},q[r].s.actions=$.actions,q[r].s.curves=$.curves,X&&r++,b[r]=[]):b[r].push({h:$,p:J[0]});if(!q[0])return C(O);if(q.length>1){for(var n=!1,k=[],M=0,P=q.length;P>M;M++)Q[M]=[];for(var M=0,P=q.length;P>M;M++){q[M];for(var p=b[M],G=0;G<p.length;G++){for(var S=p[G],L=!0,V=0;V<q.length;V++)s(S.p,q[V].p)&&(M!=V&&k.push({froms:M,tos:V,hole:G}),L?(L=!1,Q[V].push(S)):n=!0);L&&Q[M].push(S)}}k.length>0&&(n||(b=Q))}var H,I,i;for(o=0,f=q.length;f>o;o++)for(N=q[o].s,c.push(N),H=b[o],I=0,i=H.length;i>I;I++)N.holes.push(H[I].h);return c};var fe=function(){Bl.apply(this,arguments),this.holes=[]},Ki=fe.prototype=qp(Uk);Ki.getPointsHoles=function(X){var T,o=this.holes.length,S=[];for(T=0;o>T;T++)S[T]=this.holes[T].getTransformedPoints(X);return S},Ki.extractAllPoints=function(C){return{shape:this.getTransformedPoints(C),holes:this.getPointsHoles(C)}},Ki.extractPoints=function(v){return this.extractAllPoints(v)};var jn={triangulateShape:function(g,P){function E(p,S,t){return p.x!=S.x?p.x<S.x?p.x<=t.x&&t.x<=S.x:S.x<=t.x&&t.x<=p.x:p.y<S.y?p.y<=t.y&&t.y<=S.y:S.y<=t.y&&t.y<=p.y}function q(k,W,e,P,I){var G=1e-10,S=W.x-k.x,V=W.y-k.y,n=P.x-e.x,j=P.y-e.y,N=k.x-e.x,J=k.y-e.y,X=V*n-S*j,s=V*N-S*J;if(a(X)>G){var z;if(X>0){if(0>s||s>X)return[];if(z=j*N-n*J,0>z||z>X)return[]}else{if(s>0||X>s)return[];if(z=j*N-n*J,z>0||X>z)return[]}if(0==z)return!I||0!=s&&s!=X?[k]:[];if(z==X)return!I||0!=s&&s!=X?[W]:[];if(0==s)return[e];if(s==X)return[P];var T=z/X;return[{x:k.x+T*S,y:k.y+T*V}]}if(0!=s||j*N!=n*J)return[];var d=0==S&&0==V,i=0==n&&0==j;if(d&&i)return k.x!=e.x||k.y!=e.y?[]:[k];if(d)return E(e,P,k)?[k]:[];if(i)return E(k,W,e)?[e]:[];var Y,K,B,o,v,b,Z,g;return 0!=S?(k.x<W.x?(Y=k,B=k.x,K=W,o=W.x):(Y=W,B=W.x,K=k,o=k.x),e.x<P.x?(v=e,Z=e.x,b=P,g=P.x):(v=P,Z=P.x,b=e,g=e.x)):(k.y<W.y?(Y=k,B=k.y,K=W,o=W.y):(Y=W,B=W.y,K=k,o=k.y),e.y<P.y?(v=e,Z=e.y,b=P,g=P.y):(v=P,Z=P.y,b=e,g=e.y)),Z>=B?Z>o?[]:o==Z?I?[]:[v]:g>=o?[v,K]:[v,b]:B>g?[]:B==g?I?[]:[Y]:g>=o?[Y,K]:[Y,b]}function J(j,g,l,p){var q=1e-10,L=g.x-j.x,K=g.y-j.y,T=l.x-j.x,S=l.y-j.y,U=p.x-j.x,$=p.y-j.y,Z=L*S-K*T,J=L*$-K*U;if(a(Z)>q){var y=U*S-$*T;return Z>0?J>=0&&y>=0:J>=0||y>=0}return J>0}function V(T,B){function m(A,y){var e=X.length-1,W=A-1;0>W&&(W=e);var R=A+1;R>e&&(R=0);var P=J(X[A],X[W],X[R],v[y]);if(!P)return!1;var s=v.length-1,f=y-1;0>f&&(f=s);var q=y+1;return q>s&&(q=0),P=J(v[y],v[f],v[q],X[A]),P?!0:!1}function E(R,x){var b,B,K;for(b=0;b<X.length;b++)if(B=b+1,B%=X.length,K=q(R,x,X[b],X[B],!0),K.length>0)return!0;return!1}function i(L,D){var G,s,l,H,m;for(G=0;G<Y.length;G++)for(s=B[Y[G]],l=0;l<s.length;l++)if(H=l+1,H%=s.length,m=q(L,D,s[l],s[H],!0),m.length>0)return!0;return!1}for(var v,g,R,$,W,k,f,D,U,b,S,X=T.concat(),Y=[],c=[],z=0,x=B.length;x>z;z++)Y.push(z);for(var y=0,l=2*Y.length;Y.length>0&&(l--,!(0>l));)for(R=y;R<X.length;R++){$=X[R],g=-1;for(var z=0;z<Y.length;z++)if(k=Y[z],f=$.x+":"+$.y+":"+k,c[f]===K){v=B[k];for(var a=0;a<v.length;a++)if(W=v[a],m(R,a)&&!E($,W)&&!i($,W)){g=a,Y.splice(z,1),D=X.slice(0,R+1),U=X.slice(R),b=v.slice(g),S=v.slice(0,g+1),X=D.concat(b).concat(S).concat(U),y=R;break}if(g>=0)break;c[f]=!0}if(g>=0)break}return X}for(var Q,D,H,B,u,k,U={},T=g.concat(),b=0,e=P.length;e>b;b++)Array.prototype.push.apply(T,P[b]);for(Q=0,D=T.length;D>Q;Q++)u=T[Q].x+":"+T[Q].y,U[u]!==K,U[u]=Q;var m=V(g,P),l=Cf.Triangulate(m,!1);for(Q=0,D=l.length;D>Q;Q++)for(B=l[Q],H=0;3>H;H++)u=B[H].x+":"+B[H].y,k=U[u],k!==K&&(B[H]=k);return l.concat()},isClockWise:function(x){return Cf.Triangulate.area(x)<0},b2p0:function(t,q){var i=1-t;return i*i*q},b2p1:function(n,y){return 2*(1-n)*n*y},b2p2:function(J,$){return J*J*$},b2:function(L,_,Z,u){return this.b2p0(L,_)+this.b2p1(L,Z)+this.b2p2(L,u)},b3p0:function(d,F){var L=1-d;return L*L*L*F},b3p1:function(_,q){var a=1-_;return 3*a*a*_*q},b3p2:function(r,i){var E=1-r;return 3*E*r*r*i},b3p3:function(y,c){return y*y*y*c},b3:function(v,Y,j,s,r){return this.b3p0(v,Y)+this.b3p1(v,j)+this.b3p2(v,s)+this.b3p3(v,r)}},Cf={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var N=O.keys(this.faces);return N.length?N[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(P){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(y){var W=y.familyName.toLowerCase(),H=this;return H.faces[W]=H.faces[W]||{},H.faces[W][y.cssFontWeight]=H.faces[W][y.cssFontWeight]||{},H.faces[W][y.cssFontWeight][y.cssFontStyle]=y,y},drawText:function(w){var s,B=this.getFace(),V=this.size/B.resolution,b=0,D=String(w).split(""),o=D.length,W=[];for(s=0;o>s;s++){var f=new Bl,r=this.extractGlyphPoints(D[s],B,V,b,f);r&&(b+=r.offset*this.spacing,W.push(r.path))}var O=b/2;return{paths:W,offset:O}},extractGlyphPoints:function(Z,Y,g,m,A){var R,h,z,k,S,T,q,_,G,j,P,I,J,o,c,v,b,a,l,f=[],M=Y.glyphs[Z]||Y.glyphs["?"];if(M){if(M.o)for(k=M._cachedOutline||(M._cachedOutline=M.o.split(" ")),T=k.length,q=g,_=g,R=0;T>R;)switch(S=k[R++]){case"m":G=k[R++]*q+m,j=k[R++]*_,A.moveTo(G,j);break;case"l":G=k[R++]*q+m,j=k[R++]*_,A.lineTo(G,j);break;case"q":if(P=k[R++]*q+m,I=k[R++]*_,c=k[R++]*q+m,v=k[R++]*_,A.quadraticCurveTo(c,v,P,I),l=f[f.length-1])for(J=l.x,o=l.y,h=1,z=this.divisions;z>=h;h++){var F=h/z;jn.b2(F,J,c,P),jn.b2(F,o,v,I)}break;case"b":if(P=k[R++]*q+m,I=k[R++]*_,c=k[R++]*q+m,v=k[R++]*_,b=k[R++]*q+m,a=k[R++]*_,A.bezierCurveTo(c,v,b,a,P,I),l=f[f.length-1])for(J=l.x,o=l.y,h=1,z=this.divisions;z>=h;h++){var F=h/z;jn.b3(F,J,c,b,P),jn.b3(F,o,v,a,I)}}return{offset:M.ha*g,path:A}}}};Cf.generateShapes=function(Y,n){n=n||{};var i=n.font;if(i===K&&(i=Cf.getDefaultFont(),!i))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var N=n.size!==K?n.size:1,R=n.curveSegments!==K?n.curveSegments:4,P=n.spacing!==K?n.spacing:1,B=n.weight!==K?n.weight:"normal",t=n.style!==K?n.style:"normal";Cf.size=N,Cf.divisions=R,Cf.face=i,Cf.weight=B,Cf.style=t,Cf.spacing=P;for(var p=Cf.drawText(Y),x=p.paths,y=[],C=0,r=x.length;r>C;C++)Array.prototype.push.apply(y,x[C].toShapes());return y},function(R){var Z=1e-10,l=function(Y,Q){var S=Y.length;if(3>S)return null;var m,l,c,f=[],P=[],v=[];if(T(Y)>0)for(l=0;S>l;l++)P[l]=l;else for(l=0;S>l;l++)P[l]=S-1-l;var D=S,w=2*D;for(l=D-1;D>2;){if(w--<=0)return Q?v:f;if(m=l,m>=D&&(m=0),l=m+1,l>=D&&(l=0),c=l+1,c>=D&&(c=0),p(Y,m,l,c,D,P)){var b,y,u,C,E;for(b=P[m],y=P[l],u=P[c],f.push([Y[b],Y[y],Y[u]]),v.push([P[m],P[l],P[c]]),C=l,E=l+1;D>E;C++,E++)P[C]=P[E];D--,w=2*D}}return Q?v:f},T=function(t){for(var L=t.length,Q=0,I=L-1,z=0;L>z;I=z++)Q+=t[I].x*t[z].y-t[z].x*t[I].y;return.5*Q},p=function(w,o,O,H,i,G){var t,I,y,h,P,l,A,z,r;if(I=w[G[o]].x,y=w[G[o]].y,h=w[G[O]].x,P=w[G[O]].y,l=w[G[H]].x,A=w[G[H]].y,Z>(h-I)*(A-y)-(P-y)*(l-I))return!1;var M,F,v,W,R,J,$,_,V,Q,p,d,K,f,e;for(M=l-h,F=A-P,v=I-l,W=y-A,R=h-I,J=P-y,t=0;i>t;t++)if(z=w[G[t]].x,r=w[G[t]].y,!(z===I&&r===y||z===h&&r===P||z===l&&r===A)&&($=z-I,_=r-y,V=z-h,Q=r-P,p=z-l,d=r-A,e=M*Q-F*V,K=R*_-J*$,f=v*d-W*p,e>=-Z&&f>=-Z&&K>=-Z))return!1;return!0};return R.Triangulate=l,R.Triangulate.area=T,R}(Cf),Q._typeface_js={faces:Cf.faces,loadFace:Cf.loadFace};var Cq=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},kj=Cq.prototype={constructor:Cq,computeFaceNormals:function(){for(var x=new Iq,f=new Iq,v=0,g=this.faces.length;g>v;v++){var Q=this.faces[v],m=this.vertices[Q.a],h=this.vertices[Q.b],l=this.vertices[Q.c];x.subVectors(l,h),f.subVectors(m,h),x.cross(f),x.normalize(),Q.normal.copy(x)}},computeVertexNormals:function(f){var w,z,$,N,k,I;for(I=new Array(this.vertices.length),w=0,z=this.vertices.length;z>w;w++)I[w]=new Iq;if(f){var D,s,H,a=new Iq,i=new Iq;for($=0,N=this.faces.length;N>$;$++)k=this.faces[$],D=this.vertices[k.a],s=this.vertices[k.b],H=this.vertices[k.c],a.subVectors(H,s),i.subVectors(D,s),a.cross(i),I[k.a].add(a),I[k.b].add(a),I[k.c].add(a)}else for($=0,N=this.faces.length;N>$;$++)k=this.faces[$],I[k.a].add(k.normal),I[k.b].add(k.normal),I[k.c].add(k.normal);for(w=0,z=this.vertices.length;z>w;w++)I[w].normalize();for($=0,N=this.faces.length;N>$;$++)k=this.faces[$],k.vertexNormals[0]=I[k.a].clone(),k.vertexNormals[1]=I[k.b].clone(),k.vertexNormals[2]=I[k.c].clone()},mergeVertices:function(){var W,w,s,X,C,b,H,R,k={},x=[],d=[],B=4,I=q(10,B);for(s=0,X=this.vertices.length;X>s;s++)W=this.vertices[s],w=U(W.x*I)+"_"+U(W.y*I)+"_"+U(W.z*I),k[w]===K?(k[w]=s,x.push(this.vertices[s]),d[s]=x.length-1):d[s]=d[k[w]];var Y=[];for(s=0,X=this.faces.length;X>s;s++){C=this.faces[s],C.a=d[C.a],C.b=d[C.b],C.c=d[C.c],b=[C.a,C.b,C.c];for(var S=0;3>S;S++)if(b[S]==b[(S+1)%3]){Y.push(s);break}}for(s=Y.length-1;s>=0;s--){var F=Y[s];for(this.faces.splice(F,1),H=0,R=this.faceVertexUvs.length;R>H;H++)this.faceVertexUvs[H].splice(F,1)}var f=this.vertices.length-x.length;return this.vertices=x,f}},oi=function(M,B,y,K,N,r,P){this.aX=M,this.aY=B,this.xRadius=y,this.yRadius=K,this.aStartAngle=N,this.aEndAngle=r,this.aClockwise=P};oi.prototype=qp(Oq),oi.prototype.getPoint=function(H){var m,h=this.aEndAngle-this.aStartAngle;0>h&&(h+=I),h>I&&(h-=I),m=this.aClockwise===!0?this.aEndAngle+(1-H)*(I-h):this.aStartAngle+H*h;var T=this.aX+this.xRadius*B(m),L=this.aY+this.yRadius*Y(m);return new Pg(T,L)};var Rb=function($,Y){this.v1=$,this.v2=Y},re=Rb.prototype=qp(Oq);re.getPoint=function(I){var U=this.v2.clone().sub(this.v1);return U.multiplyScalar(I).add(this.v1),U},re.getPointAt=function(h){return this.getPoint(h)},re.getTangent=function(){var C=this.v2.clone().sub(this.v1);return C.normalize()};var Le=function(K,q,l){this.v0=K,this.v1=q,this.v2=l};Le.prototype=qp(Oq),Le.prototype.getPoint=function(s){var n,c;return n=jn.b2(s,this.v0.x,this.v1.x,this.v2.x),c=jn.b2(s,this.v0.y,this.v1.y,this.v2.y),new Pg(n,c)};var hf=function(C,f,v,O){this.v0=C,this.v1=f,this.v2=v,this.v3=O};hf.prototype=qp(Oq),hf.prototype.getPoint=function(K){var k,D;return k=jn.b3(K,this.v0.x,this.v1.x,this.v2.x,this.v3.x),D=jn.b3(K,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Pg(k,D)},qf.create(function(u,G){this.v1=u,this.v2=G},function(B){var X=new Iq;return X.subVectors(this.v2,this.v1),X.multiplyScalar(B),X.add(this.v1),X});var Lm=qf.create(function(J,Y,U){this.v0=J,this.v1=Y,this.v2=U},function(T){var Q,f,H;return Q=jn.b2(T,this.v0.x,this.v1.x,this.v2.x),f=jn.b2(T,this.v0.y,this.v1.y,this.v2.y),H=jn.b2(T,this.v0.z,this.v1.z,this.v2.z),new Iq(Q,f,H)}),yg=qf.create(function(p,Q,t,F){this.v0=p,this.v1=Q,this.v2=t,this.v3=F},function(R){var v,G,K;return v=jn.b3(R,this.v0.x,this.v1.x,this.v2.x,this.v3.x),G=jn.b3(R,this.v0.y,this.v1.y,this.v2.y,this.v3.y),K=jn.b3(R,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Iq(v,G,K)}),Lb=function(G,h,b,T,g,M,N,V){Cq.call(this),T=T!==K?T:.5,g=g!==K?g:.5,V=V!==K?V:1,G=G||8,M=M||0,N=N||I;var W,L,X=1,j=V/2,R=[],e=[],s=this.vertices,z=this.faces,k=this.faceVertexUvs;for(L=0;X>=L;L++){var J=[],f=[],E=L/X,l=E*(g-T)+T;for(W=0;G>=W;W++){var i=W/G,x=new Iq,u=-(i*N+M);x.z=l*Y(u),x.y=-E*V+j,x.x=l*B(u),s.push(x),J.push(s.length-1),f.push(new Pg(i,E))}R.push(J),e.push(f)}var O,y,p=(g-T)/V;for(W=0;G>W;W++)for(0!==T?(O=s[R[0][W]].clone(),y=s[R[0][W+1]].clone()):(O=s[R[1][W]].clone(),y=s[R[1][W+1]].clone()),O.setY(d(O.x*O.x+O.z*O.z)*p).normalize(),y.setY(d(y.x*y.x+y.z*y.z)*p).normalize(),L=0;X>L;L++){var C=R[L][W],P=R[L+1][W],D=R[L+1][W+1],Q=R[L][W+1],q=O.clone(),A=O.clone(),S=y.clone(),t=y.clone(),r=e[L][W].clone(),H=e[L+1][W].clone(),F=e[L+1][W+1].clone(),o=e[L][W+1].clone();z.push(new Fk(C,P,Q,[q,A,t])),k[0].push([r,H,o]),z.push(new Fk(P,D,Q,[A.clone(),S,t.clone()])),k[0].push([H.clone(),F,o.clone()])}if(h&&T>0)for(this.vertices.push(new Iq(0,j,0)),W=0;G>W;W++){var C=R[0][W],P=R[0][W+1],D=this.vertices.length-1,q=new Iq(0,1,0),A=new Iq(0,1,0),S=new Iq(0,1,0),r=e[0][W].clone(),H=e[0][W+1].clone(),F=new Pg(H.x,0);z.push(new Fk(C,P,D,[q,A,S],null,1));var v=W/G*I,w=B(v),_=Y(v),Z=(W+1)/G*I,U=B(Z),a=Y(Z);k[0].push([new Pg(.5+.5*w,.5+.5*_),new Pg(.5+.5*U,.5+.5*a),new Pg(.5,.5)])}if(b&&g>0)for(this.vertices.push(new Iq(0,-j,0)),W=0;G>W;W++){var C=R[L][W+1],P=R[L][W],D=s.length-1,q=new Iq(0,-1,0),A=new Iq(0,-1,0),S=new Iq(0,-1,0),r=e[L][W+1].clone(),H=e[L][W].clone();z.push(new Fk(C,P,D,[q,A,S],null,2));var v=W/G*I,w=B(v),_=Y(v),Z=(W+1)/G*I,U=B(Z),a=Y(Z);k[0].push([new Pg(.5+.5*U,.5-.5*a),new Pg(.5+.5*w,.5-.5*_),new Pg(.5,.5)])}};Lb.prototype=qp(kj);var Um=function(_,e,R,Q,Z,o,j){Cq.call(this),j=j||.5,_=_||16,e=e||16,R=(R!==K?R:0)-z,Q=Q!==K?Q:I,Z=Z!==K?Z:0,o=o!==K?o:z;var x,h,M=[],T=[],O=this.vertices,t=this.faces,d=this.faceVertexUvs;for(h=0;e>=h;h++){var s=[],G=[];for(x=0;_>=x;x++){var N=x/_,p=h/e,v=new Iq;v.x=-j*B(R+N*Q)*Y(Z+p*o),v.y=j*B(Z+p*o),v.z=j*Y(R+N*Q)*Y(Z+p*o),O.push(v),s.push(O.length-1),G.push(new Pg(N,p))}M.push(s),T.push(G)}for(h=0;e>h;h++)for(x=0;_>x;x++){var g=M[h][x+1],u=M[h][x],J=M[h+1][x],D=M[h+1][x+1],L=O[g].clone().normalize(),l=O[u].clone().normalize(),n=O[J].clone().normalize(),S=O[D].clone().normalize(),b=T[h][x+1].clone(),y=T[h][x].clone(),E=T[h+1][x].clone(),F=T[h+1][x+1].clone();a(O[g].y)===j?(b.x=(b.x+y.x)/2,t.push(new Fk(g,J,D,[L,n,S])),d[0].push([b,E,F])):a(O[J].y)===j?(E.x=(E.x+F.x)/2,t.push(new Fk(g,u,J,[L,l,n])),d[0].push([b,y,E])):(t.push(new Fk(g,u,D,[L,l,S])),d[0].push([b,y,F]),t.push(new Fk(u,J,D,[l.clone(),n,S.clone()])),d[0].push([y.clone(),E,F.clone()]))}};Um.prototype=qp(kj);var Pm=function(y,r,q,o,K,A){Cq.call(this),y=y||.33,r=r||.17,o=o||8,q=q||6,K=K||0,A=A||I;for(var F=new Iq,d=[],U=[],j=0;o>=j;j++)for(var e=j/o*I+z,v=0;q>=v;v++){var V=v/q*A+K;F.x=y*B(V),F.z=-y*Y(V);var u=new Iq,D=y+r*B(e);u.x=D*B(V),u.z=-D*Y(V),u.y=r*Y(e),this.vertices.push(u),d.push(new Pg(v/q,1-j/o)),U.push(u.clone().sub(F).normalize())}for(var j=1;o>=j;j++)for(var v=1;q>=v;v++){var k=(q+1)*j+v-1,l=(q+1)*(j-1)+v-1,p=(q+1)*(j-1)+v,O=(q+1)*j+v,c=new Fk(k,l,O,[U[k].clone(),U[l].clone(),U[O].clone()]);this.faces.push(c),this.faceVertexUvs[0].push([d[k].clone(),d[l].clone(),d[O].clone()]),c=new Fk(l,p,O,[U[l].clone(),U[p].clone(),U[O].clone()]),this.faces.push(c),this.faceVertexUvs[0].push([d[l].clone(),d[p].clone(),d[O].clone()])}this.computeFaceNormals()};Pm.prototype=qp(kj);var Gr=function(O,P,C){return O?(Cq.call(this),O=O instanceof Array?O:[O],this.addShapeList(O,P),P.convertYZ!==!1&&uk(this,C),this.computeFaceNormals(),void 0):(O=[],void 0)},_m=Gr.prototype=qp(Cq.prototype);_m.addShapeList=function(X,V){for(var Q=X.length,v=0;Q>v;v++){var M=X[v];this.addShape(M,V)}},_m.addShape=function(k,F){function q(){if(F.bottom)for(var g=0;m>g;g++)h=B[g],R(h[2],h[1],h[0],!0);if(F.top)for(g=0;m>g;g++)h=B[g],R(h[0]+G*c,h[1]+G*c,h[2]+G*c,!1)}function A(){var O=0;for(a(v,O),O+=v.length,u=0,j=n.length;j>u;u++)T=n[u],a(T,O),O+=T.length}function a(N,y){for(var e,D,E=N.length;--E>=0;){e=E,D=E-1,0>D&&(D=N.length-1);var Y=0,H=c;for(Y=0;H>Y;Y++){var q=G*Y,C=G*(Y+1),J=y+e+q,z=y+D+q,l=y+D+C,h=y+e+C;O(J,z,l,h,N,Y,H,e,D)}}}function r(Z,g,D){Y.vertices.push(new Iq(Z,g,D))}function R($,q,I,i){$+=t,q+=t,I+=t,Y.faces.push(new Fk($,q,I,null,null,i?2:1));var N=i?M.generateBottomUV(Y,k,F,$,q,I):M.generateTopUV(Y,k,F,$,q,I);Y.faceVertexUvs[0].push(N)}function O(i,L,u,P,T,N,a,z,g){i+=t,L+=t,u+=t,P+=t,Y.faces.push(new Fk(i,L,P)),Y.faces.push(new Fk(L,u,P));var _=M.generateSideWallUV(Y,k,T,F,i,L,u,P,N,a,z,g);Y.faceVertexUvs[0].push([_[0],_[1],_[3]]),Y.faceVertexUvs[0].push([_[1],_[2],_[3]])}var I,D,e,U,S,L=F.amount,g=F.curveSegments||sr,c=F.steps||1,y=F.extrudePath,X=!1,M=new fg(F.repeatUVLength);y&&(I=y.getSpacedPoints(c),X=!0,D=F.frames!==K?F.frames:new gn.FrenetFrames(y,c,!1),e=new Iq,U=new Iq,S=new Iq);var T,u,j,Y=this,t=this.vertices.length,H=k.extractPoints(g),f=H.shape,n=H.holes,z=!jn.isClockWise(f);if(z){for(f=f.reverse(),u=0,j=n.length;j>u;u++)T=n[u],jn.isClockWise(T)&&(n[u]=T.reverse());z=!1}var B=jn.triangulateShape(f,n),v=f;for(u=0,j=n.length;j>u;u++)T=n[u],f=f.concat(T);for(var d,h,G=f.length,m=B.length,V=0;G>V;V++)d=f[V],X?(U.copy(D.normals[0]).multiplyScalar(d.x),e.copy(D.binormals[0]).multiplyScalar(d.y),S.copy(I[0]).add(U).add(e),r(S.x,S.y,S.z)):r(d.x,d.y,0);var N;for(N=1;c>=N;N++)for(V=0;G>V;V++)d=f[V],X?(U.copy(D.normals[N]).multiplyScalar(d.x),e.copy(D.binormals[N]).multiplyScalar(d.y),S.copy(I[N]).add(U).add(e),r(S.x,S.y,S.z)):r(d.x,d.y,L/c*N);q(),A()};var gn=function(E,y,R,J,L){function H(L,F,o){return t.vertices.push(new Iq(L,F,o))-1}Cq.call(this),y=y||64,R=R||1,J=J||8,L=L||!1;var j,D,k,V,Q,e,M,G,f,n,X,r,v,x,a,W,h,d,N,A,g=[],t=this,l=y+1,o=new Iq,i=new gn.FrenetFrames(E,y,L),K=i.tangents,z=i.normals,P=i.binormals;for(this.tangents=K,this.normals=z,this.binormals=P,f=0;l>f;f++)for(g[f]=[],V=f/(l-1),G=E.getPointAt(V),j=K[f],D=z[f],k=P[f],n=0;J>n;n++)Q=n/J*I,e=-R*B(Q),M=R*Y(Q),o.copy(G),o.x+=e*D.x+M*k.x,o.y+=e*D.y+M*k.y,o.z+=e*D.z+M*k.z,g[f][n]=H(o.x,o.y,o.z);for(f=0;y>f;f++)for(n=0;J>n;n++)X=L?(f+1)%y:f+1,r=(n+1)%J,v=g[f][n],x=g[X][n],a=g[X][r],W=g[f][r],h=new Pg(f/y,n/J),d=new Pg((f+1)/y,n/J),N=new Pg((f+1)/y,(n+1)/J),A=new Pg(f/y,(n+1)/J),this.faces.push(new Fk(v,x,W)),this.faceVertexUvs[0].push([h,d,A]),this.faces.push(new Fk(x,a,W)),this.faceVertexUvs[0].push([d.clone(),N,A.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};gn.prototype=qp(kj),gn.FrenetFrames=function(U,h,d){function V(){x[0]=new Iq,F[0]=new Iq,j=Number.MAX_VALUE,v=a(f[0].x),$=a(f[0].y),Y=a(f[0].z),j>=v&&(j=v,i.set(1,0,0)),j>=$&&(j=$,i.set(0,1,0)),j>=Y&&i.set(0,0,1),s.crossVectors(f[0],i).normalize(),x[0].crossVectors(f[0],s),F[0].crossVectors(f[0],x[0])}var t,j,v,$,Y,G,S,i=new Iq,f=[],x=[],F=[],s=new Iq,z=new Ne,e=h+1,O=1e-4;for(this.tangents=f,this.normals=x,this.binormals=F,G=0;e>G;G++)S=G/(e-1),f[G]=U.getTangentAt(S),f[G].normalize();for(V(),G=1;e>G;G++)x[G]=x[G-1].clone(),F[G]=F[G-1].clone(),s.crossVectors(f[G-1],f[G]),s.length()>O&&(s.normalize(),t=N(Kn(f[G-1].dot(f[G]),-1,1)),x[G].applyMatrix4(z.makeRotationAxis(s,t))),F[G].crossVectors(f[G],x[G]);if(d)for(t=N(Kn(x[0].dot(x[e-1]),-1,1)),t/=e-1,f[0].dot(s.crossVectors(x[0],x[e-1]))>0&&(t=-t),G=1;e>G;G++)x[G].applyMatrix4(z.makeRotationAxis(f[G],t*G)),F[G].crossVectors(f[G],x[G])};var ul=function(d,_,i,q){Cq.call(this),_=_||18,i=i||0,q=q==E?I:q;for(var R=1/(d.length-1),G=1/_,z=0,n=_;n>=z;z++)for(var g=i+z*G*q,A=B(g),U=Y(g),F=0,r=d.length;r>F;F++){var Q=d[F],w=new Iq;w.x=A*Q.x-U*Q.y,w.y=U*Q.x+A*Q.y,w.z=Q.z,this.vertices.push(w)}for(var J=d.length,z=0,n=_;n>z;z++)for(var F=0,r=d.length-1;r>F;F++){var t=F+J*z,Z=t,W=t+J,A=t+1+J,u=t+1,c=z*G,j=F*R,y=c+G,e=j+R;this.faces.push(new Fk(Z,u,W)),this.faceVertexUvs[0].push([new Pg(c,j),new Pg(c,e),new Pg(y,j)]),this.faces.push(new Fk(W,u,A)),this.faceVertexUvs[0].push([new Pg(y,j),new Pg(c,e),new Pg(y,e)])}this.mergeVertices(),uk(this),this.computeFaceNormals(),this.computeVertexNormals()};ul.prototype=qp(kj);var jh=function(G,j){j=j||{};var F=Cf.generateShapes(G,j);j.amount=j.amount!==K?j.amount:.5,j.convertYZ=!1,j.fill!==!1&&(j.bottom=!0,j.top=!0),Gr.call(this,F,j)};jh.prototype=qp(_m);var yj=b.Node=function(){hi(yj,this)},Tn={X:Cm,Y:so,Z:Pc},zl={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},uj="xzy",nn=function(L,_,s){if(_){var m=_[0],r=_[1],y=_[2];"xzy"===s?(so(L,r),Pc(L,y),Cm(L,m)):"xyz"===s?(Pc(L,y),so(L,r),Cm(L,m)):"yxz"===s?(Pc(L,y),Cm(L,m),so(L,r)):"yzx"===s?(Cm(L,m),Pc(L,y),so(L,r)):"zxy"===s?(so(L,r),Cm(L,m),Pc(L,y)):"zyx"===s?(Cm(L,m),so(L,r),Pc(L,y)):(so(L,r),Pc(L,y),Cm(L,m))}};Jl("Node",Wm,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:uj,_64O:0,_rotationX:0,_53O:0,_host:E,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Gc},_22Q:function(){return ng},getX:function(){return this.p().x},setX:function(v){this.p(v,this.p().y)},getY:function(){return this.p().y},setY:function(Y){this.p(this.p().x,Y)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(p){this.setAnchor(p,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(v){this.setAnchor(this.getAnchor().x,v)},getScaleX:function(){return this.getScale().x},setScaleX:function(B){this.setScale(B,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(g){this.setScale(this.getScale().x,g)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(b,Q){nf(b,Zb(E,E,this.r3(),this.getRotationMode())),this.translate3d(b[0]*Q,b[1]*Q,b[2]*Q)},translateFront:function(z){this.translate3dBy([0,0,1],z)},translateBack:function(G){this.translate3dBy([0,0,-1],G)},translateLeft:function(y){this.translate3dBy([-1,0,0],y)},translateRight:function(p){this.translate3dBy([1,0,0],p)},translateTop:function(j){this.translate3dBy([0,1,0],j)},translateBottom:function(r){this.translate3dBy([0,-1,0],r)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(K,i,t){1===arguments.length&&(i=K[1],t=K[2],K=K[0]),this.p(K,t),this.setElevation(i)},translate3d:function(b,N,m){1===arguments.length&&(N=b[1],m=b[2],b=b[0]),this.translate(b,m),this.setElevation(this._54O+N)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(a,D,f){1===arguments.length&&(D=a[1],f=a[2],a=a[0]),this.setSize(a,f),this.setTall(D)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(u,v,w){1===arguments.length&&(v=u[1],w=u[2],u=u[0]),this.setRotationX(u),this.setRotation(-v),this.setRotationZ(w)},setRotationY:function(e){this.setRotation(-e)},getRotationY:function(){return-this._64O},lookAt:function(W,q){q=q||oh;var Z=this,b=Qh(W,Z.p3()),U=tm(b);q===oh?(Z.r3([-x(b[1]/U),-F(b[2],b[0])+T,0]),Z.setRotationMode("xzy")):q===yf?(Z.r3(0,-F(b[2],b[0]),x(b[1]/U)),Z.setRotationMode("zyx")):q===nl?(Z.r3(0,-F(b[2],b[0])+z,-x(b[1]/U)),Z.setRotationMode("zyx")):q===lf?(Z.r3([-x(b[1]/U)+T,-F(b[2],b[0])+T,0]),Z.setRotationMode("xzy")):q===ec&&(Z.r3([-x(b[1]/U)-T,-F(b[2],b[0])+T,0]),Z.setRotationMode("xzy")),q===_g&&(Z.r3([-x(b[1]/U)+z,-F(b[2],b[0])+T,z]),Z.setRotationMode("zxy"))},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(h){var c=this;if(c!==h&&c._host!==h){var z=c._host;z&&z._removeAttach(c),c._host=h,c._host&&c._host._addAttach(c),c.fp("host",z,h),c.onHostChanged(z,h)}},getAttaches:function(){return this._69O},_addAttach:function(Y){var t=this;t._69O||(t._69O=new Km),t._69O.add(Y),t.fp("attaches",E,Y)},_removeAttach:function(o){var x=this;x._69O.remove(o),x._69O.isEmpty()&&delete x._69O,x.fp("attaches",o,E)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(Q){var D=this;D._44I||(D._44I=new Km),D._42I||(D._42I=new Km),D._44I.add(Q),D._42I.add(Q),D._20I()},_4I:function(k){var M=this;M._44I||(M._44I=new Km),M._43I||(M._43I=new Km),M._44I.add(k),M._43I.add(k),M._20I()},_16I:function(b){var s=this;s._44I.remove(b),s._42I.remove(b),s._44I.isEmpty()&&delete s._44I,s._42I.isEmpty()&&delete s._42I,s._20I()},_18I:function(z){var C=this;C._44I.remove(z),C._43I.remove(z),C._44I.isEmpty()&&delete C._44I,C._43I.isEmpty()&&delete C._43I,C._20I()},_20I:function(){var z=this;if(delete z._45I,!z._44I||z._44I.isEmpty())return delete z._70O,void 0;var Q;z._44I.each(function(T){T.isLooped()&&(Q||(Q={}),Q[T._id]||(z._45I||(z._45I=new Km),z._45I.add(T),Q[T._id]=T))}),Q?(z._70O=new Km,z._44I.each(function(V){Q[V._id]?"A"===Q[V._id]||(Q[V._id]="A",z._70O.add(V)):z._70O.add(V)})):z._70O=z._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(d){var f=this;f._46I||(f._46I=new Km),f._48I||(f._48I=new Km),f._46I.add(d),f._48I.add(d),f._19I()},_3I:function(S){var n=this;n._47I||(n._47I=new Km),n._48I||(n._48I=new Km),n._47I.add(S),n._48I.add(S),n._19I()},_15I:function(M){var P=this;P._46I.remove(M),P._48I.remove(M),P._46I.isEmpty()&&delete P._46I,P._48I.isEmpty()&&delete P._48I,P._19I()},_17I:function(h){var R=this;R._47I.remove(h),R._48I.remove(h),R._47I.isEmpty()&&delete R._47I,R._48I.isEmpty()&&delete R._48I,R._19I()},_19I:function(){var I=this;delete I._49I;var j=I._48I;if(j&&!j.isEmpty()){var H={};j.each(function(Z){H[Z._id]?I._49I||(I._49I=new Km):H[Z._id]=Z}),I._49I?j.each(function(D){H[D._id]&&(I._49I.add(D),delete H[D._id])}):I._49I=j}},getImage:function(){if(this._pendingCheckImageJSON){var Q=y.getImage(this._image);Q&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof af&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(U){var C=this,G=C._image,Q=C.getWidth(),v=C.getHeight();C._image=U,C.fp("image",G,U)&&(null!=U&&(ki(U)||Xr(U)&&/\.json$/i.test(U))&&(this._pendingCheckImageJSON=!0),C.fp(gf,Q,C.getWidth()),C.fp(Of,v,C.getHeight()))},getElevation:function(){return this._54O},setElevation:function(A){var p=this;if(!p._50O){p._50O=1;var Q=p._54O;p._54O=A,p.fp(Wg,Q,A),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(l){var V=this;if(!V._49O){V._49O=1;var f=V._64O;V._64O=l,V.fp(Ih,f,l),delete V._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(C){var Q=this;if(!Q._51O){Q._51O=1;var d=Q._rotationX;Q._rotationX=C,Q.fp("rotationX",d,C),delete Q._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(I){var j=this;if(!j._52O){j._52O=1;var g=j._53O;j._53O=I,j.fp("rotationZ",g,I),delete j._52O}},getPosition:function(){return this._position},setPosition:function(C,Q){var d=this;if(!d._50I){d._50I=1;var q;if(q=2===arguments.length?{x:C,y:Q}:C,q.x!==d._position.x||q.y!==d._position.y){var c=d._position;d._position=q,d.fp(ph,c,q)}delete d._50I}},translate:function(r,L){var T=this._position;this.p(T.x+r,T.y+L)},getWidth:function(){var V=this;if(V._width>=0)return V._width;var e=V.getStyle("shape3d");if(e){var s=Pr(e);if(s&&s.rawS3)return s.rawS3[0]}var W=_l(V._image);return W?Oh(W,V):20},setWidth:function(h){var X=this,Y=X._width;X._width=h,X.fp(gf,Y,h)},getHeight:function(){var o=this;if(o._height>=0)return o._height;var l=o.getStyle("shape3d");if(l){var G=Pr(l);if(G&&G.rawS3)return G.rawS3[2]}var t=_l(o._image);return t?Lk(t,o):20},setHeight:function(g){var p=this,$=p._height;p._height=g,p.fp(Of,$,g)},getTall:function(){var w=this;if(w._tall>=0)return w._tall;var n=w.getStyle("shape3d");if(n){var Z=Pr(n);if(Z&&Z.rawS3)return Z.rawS3[1]}return 20},setTall:function(Z){var J=this,m=J._tall;J._tall=Z,J.fp("tall",m,Z)},setSize:function(b,h){var i=this;2===arguments.length?(i.setWidth(b),i.setHeight(h)):(i.setWidth(b.width),i.setHeight(b.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(O,c,R,n,s){var Z=this,e=Z.getAnchor(),g=Z.getScale();arguments.length<=2&&(s=c,c=O.y,R=O.width,n=O.height,O=O.x);var m=s&&g.x<0?1-e.x:e.x,G=s&&g.y<0?1-e.y:e.y;Z.p(O+R*m,c+n*G),s&&(R/=Math.abs(g.x),n/=Math.abs(g.y)),Z.setWidth(R),Z.setHeight(n)},getMatrix:function(){var r=this,m=r._64O,T=r._position,f=r.getScale();return new fs(m,T.x,T.y,f.x,f.y)},getAnchorRect:function(){var t=this,m=t.getWidth(),c=t.getHeight(),H=t.getAnchor();return{x:-m*H.x,y:-c*H.y,width:m,height:c}},getRect:function(){var R=this,J=R.getWidth(),z=R.getHeight(),T=R.getAnchor(),l={x:-J*T.x,y:-z*T.y,width:J,height:z},W=R.getMatrix();return l=wf([W.tf(l.x,l.y),W.tf(l.x+l.width,l.y),W.tf(l.x+l.width,l.y+l.height),W.tf(l.x,l.y+l.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var v=this,l=v.getAnchor(),m=v._anchorElevation;return{x:l.x,y:m,z:l.y}},setAnchorElevation:function(Y){var r=this,i=r._anchorElevation;i!==Y&&(r._anchorElevation=Y,r.fp("anchorElevation",i,Y))
},setAnchor3d:function(K,d,b,J){var j,S=this;"number"==typeof K?j={x:K,y:d,z:b}:(j=K.length?{x:K[0],y:K[1],z:K[2]}:K,J=d),S.setAnchor(j.x,j.z,J),S.setAnchorElevation(j.y)},getAnchor:function(){var A=this;if(A.hasOwnProperty("_anchor"))return A._anchor;var R=_l(A._image);return R&&R.anchorX!==K?{x:R.anchorX,y:R.anchorY}:A._anchor},setAnchor:function(y,C,R){var z,$=this;"number"==typeof y?z={x:y,y:C}:(z=y.length?{x:y[0],y:y[1]}:y,R=C);var Q=$.getAnchor();if(Q.x!==z.x||Q.y!==z.y){var k=$.getDataModel();if(k&&k.beginTransaction(),$._anchor=z,$.fp("anchor",Q,z),R&&!Ve){var p=$.getPosition(),G=$.getSize(),g=$.getRotation(),N=$.getScale(),F=-G.width*(Q.x-z.x)*N.x,I=-G.height*(Q.y-z.y)*N.y,T=Y(g),a=B(g);$.setPosition(p.x+a*F-T*I,p.y+T*F+a*I)}k&&k.endTransaction()}},getScale:function(){return this._scale},setScale:function(f,m){var H,Y=this;H=2===arguments.length?{x:f,y:m}:f;var M=Y.getScale();(M.x!==H.x||M.y!==H.y)&&(Y._scale=H,Y.fp("scale",M,H))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var z=this,P=z._scaleTall,B=z.getScale();return[B.x,P,B.y]},getFinalScale3d:function(){var J=this,F=J.s3(),H=J._dynamicScale3d,P=J.getScale3d();return F&&(P[0]*=F[0],P[1]*=F[1],P[2]*=F[2]),H&&(P[0]*=H[0],P[1]*=H[1],P[2]*=H[2]),P},setScaleTall:function(z){var K=this,s=K._scaleTall;s!==z&&(K._scaleTall=z,K.fp("scaleTall",s,z))},setScale3d:function(I,O,V){var v,$=this;v="number"==typeof I?{x:I,y:O,z:V}:I.length?{x:I[0],y:I[1],z:I[2]}:I,$.setScaleTall(v.y),$.setScale(v.x,v.z)},getCorners:function(i,U){i==E&&(i=0),U==E&&(U=i);var F=this,Y=F.getAnchor(),l=F.getWidth(),W=F.getHeight(),t=-l*Y.x-i,w=-W*Y.y-U,a=l+2*i,o=W+2*U,K=F.getMatrix();return[K.tf(t,w),K.tf(t,w+o),K.tf(t+a,w+o),K.tf(t+a,w)]},getEditControlPoints:function(L,r,P){r==E&&(r=0),P==E&&(P=r);var T=this,x=T.getAnchor(),X=T.getWidth(),o=T.getHeight(),_=-X*x.x-r,F=-o*x.y-P,j=X+2*r,N=o+2*P;if(L)return[{x:_,y:F},{x:_,y:0},{x:_,y:F+N},{x:0,y:F+N},{x:_+j,y:F+N},{x:_+j,y:0},{x:_+j,y:F},{x:0,y:F}];var I=T.getMatrix();return[I.tf(_,F),I.tf(_,0),I.tf(_,F+N),I.tf(0,F+N),I.tf(_+j,F+N),I.tf(_+j,0),I.tf(_+j,F),I.tf(0,F)]},rotateAt:function(L,N,w){var R=this,p=R._position,U=R._64O,q=new fs(U,p.x,p.y).tf(L,N),f=d(L*L+N*N),S=F(p.y-q.y,p.x-q.x)+w;R.setRotation(U+w),R.p(q.x+f*B(S),q.y+f*Y(S))},onParentChanged:function(){yj.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(J){J._7I()})},onPropertyChanged:function(s){var Q=this;yj.superClass.onPropertyChanged.call(Q,s),Q._69O&&Q._69O.each(function(Y){Y.handleHostPropertyChange(s)}),Q._49I&&Q._49I.each(function(n){n.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(s){this.updateAttach(s)},onStyleChanged:function(n){yj.superClass.onStyleChanged.apply(this,arguments),Pb[n]&&this.updateAttach()},updateAttach:function(v){var I=this;I._51I||Ve||(I._51I=1,I._71O(v),delete I._51I)},_71O:function(y){var B,J,i,z,T,P,x=this,s=x._host,r=y?y.property:E,Y=y?y.oldValue:E,u=y?y.newValue:E;if(s instanceof b.Grid){if(r===Wg)x.setElevation(x._54O+u-Y);else if(!y||Bg[r]){if(B=x.s("attach.row.index"),J=x.s("attach.column.index"),i=s.getCellRect(B,J),!i)return;z=x.s("attach.row.span"),T=x.s("attach.column.span"),(1!==z||1!==T)&&(i=xb(i,s.getCellRect(B+z-1,J+T-1))),Rf(i,x,"attach.padding",1),x.setRect(i)}}else if(s instanceof mm&&(P=x.s("attach.index"))>=0&&(!y||Hg[r])){var U=x.s("attach.thickness");U!=E&&x.setHeight(s.getThickness()*U);var w=x.s("attach.offset"),_=s.getPoints(),N=_.size();if(N>P){var O=_.get(P),D=N===P+1?_.get(0):_.get(P+1),Z=[D.x-O.x,D.y-O.y],K=tm(Z);if(K){x.s("attach.offset.relative")&&(w*=K),x.s("attach.offset.opposite")&&(w=K-w);var a={x:O.x+Z[0]/K*w,y:O.y+Z[1]/K*w},q=x.s("attach.gap");q&&(x.s("attach.gap.relative")&&(q*=s.getThickness()),a=Po(E,a,D,q)),x.p(a),x.setRotation(F(Z[1],Z[0]))}}}else y&&(r===ph?x.translate(u.x-Y.x,u.y-Y.y):r===Wg?x.setElevation(x._54O+u-Y):wc[r]&&x._11Q(s,r,u-Y))},_11Q:function(t,$,F){var A=this,p=t.p3(),j=Qh(A.p3(),p),k=kd(),W=zl[A.getRotationMode()],v=W[0],l=W[1],M=W[2],u=Tn[v],c=Tn[l],O=Tn[M];$===Ih&&($="rotationY",F=-F),$===Ih+v?(O(k,t[Sc+M]()),c(k,t[Sc+l]()),u(k,F),c(k,-t[Sc+l]()),O(k,-t[Sc+M]()),A[es+v](A[Sc+v]()+F)):$===Ih+l?(O(k,t[Sc+M]()),c(k,F),O(k,-t[Sc+M]()),A[es+l](A[Sc+l]()+F)):$===Ih+M&&(O(k,F),A[es+M](A[Sc+M]()+F)),nf(j,k),A.p3(p[0]+j[0],p[1]+j[1],p[2]+j[2])},isHostOn:function(Z){var d=this;if(d._host&&Z&&Z._69O)for(var J={},r=d._host;r&&r!==d&&!J[r._id];){if(r===Z)return!0;J[r._id]=r,r=r._host}return!1},isLoopedHostOn:function(P){return this.isHostOn(P)&&P.isHostOn(this)},getSerializableProperties:function(){var B=yj.superClass.getSerializableProperties.call(this);return Jn(B,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),B}});var zf=b.Edge=function(v,Q){var l=this;hi(zf,l),l.setSource(v),l.setTarget(Q)};Jl("Edge",Wm,{_icon:"edge_icon",getUIClass:function(){return tq},_22Q:function(){return Ob},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(n){var U=this;if(U._source!==n){var Z=U._source;U._source=n,Z&&Z._16I(U),n&&n._2I(U),U._7I(),U.fp("source",Z,n)}},setTarget:function(d){var O=this;if(O._target!==d){var Y=O._target;O._target=d,Y&&Y._18I(O),d&&d._4I(O),O._7I(),O.fp("target",Y,d)}},isLooped:function(){var p=this;return p._source===p._target&&!!p._source&&!!p._target},_7I:function(){var k,v=this,l=To(v);v._40I!==l&&(k=this._40I,k&&k._15I(v),v._40I=l,l&&l._1I(v),v.fp("sourceAgent",k,l),Od(k,v._41I),Od(l,v._41I));var U=kk(v);v._41I!==U&&(k=v._41I,k&&k._17I(v),v._41I=U,U&&U._3I(v),v.fp("targetAgent",k,U),Od(k,v._40I),Od(U,v._40I))},_22I:function(k){this._52I=k,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var e=this;return e._52I&&e._52I.get(0)!==e&&!e.getStyle(Gp)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var n=this,U=n._52I;return U&&!n.getStyle(Gp)&&U.size()>1&&n===U.get(0)},toggle:function(){var W=this._52I,G=!this.s(Gp);W&&W.size()>1&&(W.each(function(D){D.s(Gp,G)}),W.getSiblings().each(function(m){m!==W&&m.each(function(k){k.fp("edgeGroup",E,m)})}))},setStyle:function(x,A){(x===ss||"edge.segments"===x)&&(A=ol(A)),zf.superClass.setStyle.call(this,x,A)},onStyleChanged:function(l){zf.superClass.onStyleChanged.apply(this,arguments),Yc[l]&&Od(this._41I,this._40I)},getSerializableProperties:function(){var T=zf.superClass.getSerializableProperties.call(this);return Jn(T,{source:1,target:1}),T}});var $p=b.Group=function(){hi($p,this)};Jl("Group",yj,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return wm},onChildAdded:function(){$p.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){$p.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var b=this;if(!b._54I&&!Ve){var r=b.getChildrenRect();r&&(b._53I=1,b.p(Bi(b.s("group.position"),r,b.getSize())),delete b._53I)}},getChildrenRect:function(){var Q,q=this;return q.eachChild(function(r){Q=xb(Q,q.getChildRect(r))}),Q},getChildRect:function(Q){var u;return Or(Q)&&Q.s(cp)&&(Sd(Q)&&Q.isExpanded()&&Q.eachChild(function(m){u=xb(u,Q.getChildRect(m))}),!u&&Q.getRect&&(u=Q.getRect())),u},setPosition:function(U,M){var J=this;if(!J._54I){var Z;Z=2===arguments.length?{x:U,y:M}:U,Ve||J._53I||(J._54I=1,Nk(J._children,Z.x-J._position.x,Z.y-J._position.y),delete J._54I),$p.superClass.setPosition.call(this,Z)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(L){var m=this;if(m._57O!==L){var d=m._57O;m._57O=L,m.fp("expanded",d,m._57O),m._8I()}},_8I:function(){$p.superClass._8I.call(this),this.eachChild(function(Y){Or(Y)&&Y._8I()})},onStyleChanged:function(f){$p.superClass.onStyleChanged.apply(this,arguments),"group.position"===f&&this._81I()},getSerializableProperties:function(){var P=$p.superClass.getSerializableProperties.call(this);return P.expanded=1,P}});var ff=b.Block=function(){hi(ff,this)};Jl("Block",yj,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Fq},onChildAdded:function(){ff.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){ff.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var o=this;if(!Ve&&!o._updatingToChildren&&o._syncSize){var m,g,E,F,U,h=[],T=o.getRotation();if(o.eachChild(function(X){Or(X)&&h.push.apply(h,X.getCorners())}),h.length){o._updatingFromChildren=1;var A=B(-T),V=Y(-T),I=1/0,r=-1/0,z=1/0,p=-1/0;for(F=0,U=h.length;U>F;F++)E=h[F],m=E.x,g=E.y,E.x=A*m-V*g,E.y=V*m+A*g,I=i(I,E.x),r=M(r,E.x),z=i(z,E.y),p=M(p,E.y);var j=o.getScale();o.setSize(a((r-I)/j.x),a((p-z)/j.y));var v;j.x<0&&(v=I,I=r,r=v),j.y<0&&(v=z,z=p,p=v),A=B(T),V=Y(T);var N=o.getAnchor();m=I+(r-I)*N.x,g=z+(p-z)*N.y,o.setPosition(A*m-V*g,V*m+A*g),delete o._updatingFromChildren}}},setPosition:function(R,j){var t=this;if(!t._updatingToChildren){var h;h=2===arguments.length?{x:R,y:j}:R,Ve||t._updatingFromChildren||(t._updatingToChildren=1,Nk(t._children,h.x-t._position.x,h.y-t._position.y),delete t._updatingToChildren),ff.superClass.setPosition.call(this,h)}},setWidth:function(v){return this.setSize(v,this.getHeight())},setHeight:function(b){return this.setSize(this.getWidth(),b)},setSize:function(X,B){1>X&&(X=1),1>B&&(B=1);var q=this;if(!q._updatingToChildren){2!==arguments.length&&(B=X.height,X=X.width);var N=q.getWidth(),x=q.getHeight();if(X!==N&&ff.superClass.setWidth.call(q,X),B!==x&&ff.superClass.setHeight.call(q,B),!Ve&&!q._updatingFromChildren){q._updatingToChildren=1;var a=X/N,d=B/x;q._adjustChildScaleOrSize(a,d,"size"),delete q._updatingToChildren,q.updateFromChildren()}}},_adjustChildScaleOrSize:function(S,C,z){var X=this;if(X._syncSize){var K=X.getPosition(),a=X.getRotation();X.getScale(),X.eachChild(function(T){if(Or(T)){var $=T.getPosition(),J=T.getRotation(),x=T.getWidth(),r=T.getHeight(),w=T.getScale(),n=w.x*x,G=w.y*r,f=new fs(J,$.x,$.y,n,G);f.translate(-K.x,-K.y),f.rotate(-a),J=F(f.b*Math.sign(n),f.a*Math.sign(n)),f.scale(S,C);var t,y,E,v=B(J);if(Math.abs(v)<.001?(t=Y(J),y=f.b/t,E=-f.c/t):(y=f.a/v,E=f.d/v),"scale"===z)T.setScale(y/x,E/r);else if("size"===z){var V=y/w.x,l=E/w.y;T.setScale(ed(y)*Math.abs(w.x),ed(E)*Math.abs(w.y)),T.setSize(Math.max(.1,Math.abs(V)),Math.max(.1,Math.abs(l)))}f.rotate(a),f.translate(K.x,K.y),T.setPosition(f.tx,f.ty)}})}},_calcChangeFactor:function(y,g,Y,N){var G,w,h,l;return G=a(y),w=a(Y),h=G>w?G/w:w/G,G=a(g),w=a(N),l=G>w?G/w:w/G,M(h,l)},setAnchor:function(){var X=this;if(!X._updatingToChildren){var m=X.getAnchor();if(ff.superClass.setAnchor.apply(X,arguments),!Ve&&!X._updatingFromChildren&&X._syncSize){X._updatingToChildren=1;var O=X.getAnchor();X.getPosition();var h=X.getSize(),w=X.getScale(),D=X.getRotation(),f=-h.width*w.x*(m.x-O.x),F=-h.height*w.y*(m.y-O.y),J=Y(D),K=B(D),o=K*f-J*F,$=J*f+K*F;X.eachChild(function(m){if(Or(m)){var z=m.getPosition();m.setPosition(z.x-o,z.y-$)}}),delete X._updatingToChildren}}},setRotation:function(T){var h=this;if(!h._updatingToChildren){var s=h.getRotation();if(ff.superClass.setRotation.apply(h,arguments),!Ve&&!h._updatingFromChildren){h._updatingToChildren=1;var g=h.getPosition(),L=T-s;h.eachChild(function(u){if(Or(u)){var s=u.getMatrix();s.translate(-g.x,-g.y),s.rotate(L),s.translate(g.x,g.y);var o=Math.sign(u.getScale().x);u.setRotation(F(s.b*o,s.a*o)),u.setPosition(s.tx,s.ty)}}),delete h._updatingToChildren}}},setScale:function(J,w){var k=this;if(!k._updatingToChildren){null==w&&(w=J.y,J=J.x);var P=k.getScale();if(a(J)<.01&&(J=.01*(ed(J)||ed(P.x))),a(w)<.01&&(w=.01*(ed(w)||ed(P.y))),ff.superClass.setScale.call(k,J,w),!Ve&&!k._updatingFromChildren){k._updatingToChildren=1;var r=J/P.x,v=w/P.y;k._adjustChildScaleOrSize(r,v,"size"),delete k._updatingToChildren,k.updateFromChildren()}}},getSerializableProperties:function(){var v=ff.superClass.getSerializableProperties.call(this);return v.clickThroughEnabled=1,v.syncSize=1,v}});var Ak=b.Grid=function(){hi(b.Grid,this)};Jl("Grid",yj,{IRotatable:!1,_icon:"grid_icon",_image:E,getUIClass:function(){return Re},setRotation:function(){},getCellRect:function(i,t){var I=this,g=I.s("grid.row.count"),k=I.s("grid.column.count");if(0>=g||0>=k||0>i||i>=g||0>t||t>=k)return E;var f,w,Q,S=I.getRect(),l=I.s("grid.row.percents"),V=I.s("grid.column.percents");if(Rf(S,I,"grid.border",-1),l&&l._as&&(l=l._as),V&&V._as&&(V=V._as),l&&l.length===g){for(Q=0,f=0;i>f;f++)Q+=S.height*l[f];S.y+=Q,S.height=S.height*l[i]}else S.height=S.height/g,S.y+=S.height*i;if(V&&V.length===k){for(w=0,f=0;t>f;f++)w+=S.width*V[f];S.x+=w,S.width=S.width*V[t]}else S.width=S.width/k,S.x+=S.width*t;return is(S,-I.s("grid.gap")),S}});var Cp=b.Text=function(){hi(Cp,this),this.setSize(100,50),this.s("text","TEXT")};Jl("Text",yj,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return jf},setWidth:function(n){n||(n=.001),Cp.superClass.setWidth.call(this,n)},setHeight:function(G){G||(G=.001),Cp.superClass.setHeight.call(this,G)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),kg("__text__",{width:{value:100,isSafeFunc:!0,func:function(c){return c._width}},height:{value:50,isSafeFunc:!0,func:function(G){return G._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"}}]});var mm=b.Shape=function(){hi(mm,this),this._59O=new Km};mm.__de__=Zo,Jl("Shape",yj,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return pc},_22Q:function(){return us},getLength:function(J){return vh(dd(this._59O,this._58O,J,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var C=this._58O;return C?new Km(C._as.slice(0)):C},setSegments:function(I){var F=this._58O;I=I?_n(I)?new Km(I.slice(0)):new Km(I._as.slice(0)):null,(F&&I&&F._as.join(",")!==I._as.join(",")||F!==I)&&(this._58O=I,this.fp("segments",F,I))},getPoints:function(){return this._59O},toPoints:function(){var _=this._59O;return new Km(_._as.slice(0))},setPoints:function(A,d){var E=this,S=E._59O;A=A?_n(A)?new Km(A.slice(0)):new Km(A._as.slice(0)):new Km;var I,x,N,v,X,q;d&&(I=E.getPosition(),q=new fs(E.getRotation(),0,0,E.getScale().x,E.getScale().y)),(S&&A&&S._as.join(",")!==A._as.join(",")||S!==A)&&(E._59O=A,E.fs(),E.fp("points",S,A)),d&&(x=E.getPosition(),N=x.x-I.x,v=x.y-I.y,X=q.tf(N,v),E.setPosition(x.x-N+X.x,x.y-v+X.y))},addPoint:function(v,Y,S){var m=this.toPoints();m.add(v,Y),this.setPoints(m,S)},setPoint:function(J,s,P){var Q=this.toPoints();Q.set(J,s),this.setPoints(Q,P)},removePointAt:function(h){var f=this.toPoints();f.removeAt(h),this.setPoints(f)},setWidth:function(p){var P=this;if(1>p&&(p=1),!P._55I&&!Ve&&P.getWidth()){P._55I=1;var j=P._position.x,S=p/P.getWidth(),g=P.toPoints(),d=new Km;g.each(function(i){d.add({x:(i.x-j)*S+j,y:i.y,e:i.e})}),P.setPoints(d);var H=P.s("shape.gradient.pack");H&&ar(H,[S,0,0,1,j*(1-S),0]),P.fs(),delete P._55I}mm.superClass.setWidth.call(P,p)},setHeight:function(h){var u=this;if(1>h&&(h=1),!u._55I&&!Ve&&u.getHeight()){u._55I=1;var J=u._position.y,N=h/u.getHeight(),T=u.toPoints(),p=new Km;T.each(function(l){p.add({x:l.x,y:(l.y-J)*N+J,e:l.e})}),u.setPoints(p);var V=u.s("shape.gradient.pack");V&&ar(V,[1,0,0,N,0,J*(1-N)]),u.fs(),delete u._55I}mm.superClass.setHeight.call(u,h)},setAnchorElevation:function(B){var A=this;if(A._55I=!0,!Ve){var U,c=B,v=A.getAnchorElevation(),Q=A.getTall();U=Q*(v-c),A.shiftPointsElevation(U)}mm.superClass.setAnchorElevation.apply(A,arguments),delete A._55I},getShapeElevation:function(){var q=this,C=q._54O;return C-(q.getTall()||0)*(q._anchorElevation-.5)},setAnchor:function(B,A,q){var r=this;if(r._55I=!0,!Ve){var j,s,G;"number"==typeof B?G={x:B,y:A}:(G=B.length?{x:B[0],y:B[1]}:B,q=A);var x=r.getAnchor(),e=r.getSize();j=e.width*(x.x-G.x),s=e.height*(x.y-G.y),q||r.shiftPoints(j,s);var o=r.getPosition()}if(mm.superClass.setAnchor.apply(r,arguments),!Ve){var Y=r.getPosition();q&&r.shiftPoints(Y.x-o.x+j,Y.y-o.y+s)}delete r._55I},shiftPoints:function(Z,q){var $=this,v=$.toPoints(),d=new Km;v.each(function(e){d.add({x:e.x+Z,y:e.y+q,e:e.e})}),$.setPoints(d),$.fs()},shiftPointsElevation:function(Q){var G=this;G._59O.each(function(u){u.e==E?u.e=Q:u.e+=Q}),G.fs()},setPosition:function(D,m){var _,C=this;if(!C._28Q){if(C._28Q=1,!C._55I&&!Ve){_=2===arguments.length?{x:D,y:m}:D;var o=_.x-C._position.x,R=_.y-C._position.y;if(0===o&&0===R)return delete C._28Q,void 0;C._55I=1,C.shiftPoints(o,R);var f=C.s("shape.gradient.pack");f&&ar(f,[1,0,0,1,o,R]),delete C._55I}mm.superClass.setPosition.apply(C,arguments),delete C._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var Y=this;if(2!==Y._59O.size())return!1;var A=Y._58O;return A?2===A.size()&&1===A.get(0)&&2===A.get(1)?!0:!1:!0},fireShapeChange:function(){var C=this;if(!C._55I&&!Ve){var I=wf(C._59O);I&&(C._55I=1,C.setRect(I),delete C._55I)}C.fp(np,!1,!0)},getSerializableProperties:function(){var d=mm.superClass.getSerializableProperties.call(this);return d.segments=1,d.points=1,d.thickness=1,d.closePath=1,d}});var Fm=b.Polyline=function(){hi(Fm,this),this.s({"shape.background":null,"shape.border.width":2})};Jl("Polyline",mm,{IRotatable:!1,_icon:"polyline_icon",_22Q:function(){return Dd},getUIClass:function(){return vr},setRotationX:function(){},setRotation:function(){},setRotationZ:function(){},setClosePath:function(){},shiftPointsElevation:function(){var Y=this;Y._24Q||Ve||(Y._24Q=1,Fm.superClass.shiftPointsElevation.apply(Y,arguments),delete Y._24Q)},setTall:function(b){var A=this;if(!A._24Q&&!Ve&&A.getTall()){A._24Q=1;var m=A._54O,x=b/A.getTall();A._59O.each(function(y){y.e=y.e==E?m:(y.e-m)*x+m}),A.fs(),delete A._24Q}Fm.superClass.setTall.call(A,b)},setElevation:function(V){var q=this;if(!q._24Q&&!Ve){q._24Q=1;var J=V-q._54O;q._59O.each(function(B){B.e==E?B.e=V:B.e+=J}),q.fs(),delete q._24Q}Fm.superClass.setElevation.apply(q,arguments)},fireShapeChange:function(){var v=this,z=v._59O;if(!v._24Q&&!Ve){var B=z.size();if(B){var Y=1,n=z.get(0),$=v._54O;n.e==E&&(n.e=$);for(var H=n.e,U=0;B>Y;Y++){n=z.get(Y),n.e==E&&(n.e=$);var d=i(H,n.e),e=M(H+U,n.e);H=d,U=e-d}v._24Q=1,v.setTall(U),v.setElevation(H+U*v._anchorElevation),delete v._24Q}}Fm.superClass.fireShapeChange.apply(v,arguments)}});var Jf=b.SubGraph=function(){hi(Jf,this)};Jl("SubGraph",yj,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Jf.superClass._8I.call(this),this.eachChild(function(Y){Or(Y)&&Y._8I()})}});var af=b.RefGraph=function(){hi(af,this)};Jl("RefGraph",ff,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(e){var u=this._ref;this._ref=e,this.fp("ref",u,e),this._pendingUpdateFromChidlren=!0,this.updateRef()},_21I:function(){af.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var B=this;if(B.clearChildrenFromDataModel(),B._ref&&B._dataModel){B._xhrLoadHandler&&(B._xhrLoadHandler.cancel=!0);var o=Ve,I=B._xhrLoadHandler=function($){if($&&B._dataModel){y.loadingRefGraph=!0;var h=B._pendingUpdateInfo={needToRestore:o};o&&(h.position=B.p(),h.width=B.getWidth(),h.height=B.getHeight(),h.rotation=B.getRotation(),h.anchor=B.getAnchor(),h.scale=B.getScale()),B.p(0,0),B.setAnchor(.5,.5),B.setRotation(0),B.setScale(1,1);var R=y.parse($),S=B._dataModel.deserialize(R,B,{justDatas:!0});S.each(function(o){o._refGraph=B}),B.checkPendingUpdateInfo(),y.loadingRefGraph=!1,y.handleRefGraphLoaded(B,S,R)}};y.xhrLoad(B._ref,function(S){I.cancel||I(S)})}},checkPendingUpdateInfo:function(){var D=this,H=D._pendingUpdateInfo;if(!H)return D.onPendingUpdated&&D.onPendingUpdated(),void 0;var M=!0;this.eachChild(function(g){(g._pendingCheckImageJSON||g._pendingUpdateInfo)&&(M=!1)}),M&&(D._pendingUpdateInfo=null,D.updateFromChildren(),H.needToRestore&&(D.setSize(H.width,H.height),D.setAnchor(H.anchor),D.setRotation(H.rotation),D.setScale(H.scale),D.p(H.position)),this.getParent()instanceof af&&this.getParent().checkPendingUpdateInfo(),D.onPendingUpdated&&D.onPendingUpdated())},getSerializableProperties:function(){var Y=af.superClass.getSerializableProperties.call(this);return Y.ref=1,Y}}),b.EdgeGroup=function(g,D){this._70O=g,this._siblings=D;for(var P,n,B=0,d=g.size(),J=$[Gp];d>B;B++)if(P=g.get(B).getStyle(Gp,!1),P!=E){J=P;break}J==E&&(J=!0);var b=y.edgeGroupAgentFunc;for(b&&(n=b(g),n&&n!==g.get(0)&&(g.remove(n),g.add(n,0))),B=0;d>B;B++)g.get(B).s(Gp,J)},Jl("EdgeGroup",O,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(P){return this._70O.get(P)},indexOf:function(j){return this._70O.indexOf(j)},each:function(q,i){this._70O.each(q,i)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(y,A){this._siblings.each(function(B){B._70O.each(y,A)})}});var ke=b.JSONSerializer=function($,v){this.dm=this._dataModel=$,this._hierarchical=y.forceHierarchicalSerialization?!0:v==E?$.isHierarchicalRendering():v};Jl("JSONSerializer",O,{ms_ac:["hierarchical"],serialize:function(i){return y.stringify(this.toJSON(),i)},toJSON:function(){var t=this,e=t.dm,i=e.getRoots(),D=t.json={v:y.getVersion(),p:{},a:{},d:[]},H=e.getSerializableAttrs();e.getInit()&&(D.init=e.getInit()),e.getName()&&(D.p.name=e.getName()),e.getBackground()&&(D.p.background=e.getBackground()),e.getLayers()&&(D.p.layers=e.getLayers()),D.p.autoAdjustIndex=e.isAutoAdjustIndex(),D.p.hierarchicalRendering=e.isHierarchicalRendering();for(var f in H){var L=e.a(f);L!==K&&t[gp](f,L,D.a)}return jj(D.a)&&delete D.a,t._hierarchical?i.each(t.serializeData,this):e.each(function(P){t.serializeData(P)}),D},isSerializable:function(){return!0},getProperties:function(W){return W.getSerializableProperties()},getStyles:function(E){return E.getSerializableStyles()},getAttrs:function(F){return F.getSerializableAttrs()},serializeData:function(W){var e=this;if(e.isSerializable(W)&&!W._refGraph){var B,H,k,S,M=Rj(W.getClassName())||W.getClass(),m=new M,$={c:W.getClassName(),i:W.getId(),p:{},s:{},a:{}};e.json.d.push($),B=e.getProperties(W);for(H in B)/^_/.test(H)?(k=W[H],k!==m[H]&&e[gp](H.substr(1),k,$.p)):(S=sg(H),W[S]&&(k=W[S](),k!==m[S]()&&e[gp](H,k,$.p)));B=e.getStyles(W);for(H in B)k=W.s(H),k!==m.s(H)&&e[gp](H,k,$.s);B=e.getAttrs(W);for(H in B)k=W.a(H),k!==m.a(H)&&e[gp](H,k,$.a);jj($.p)&&delete $.p,jj($.s)&&delete $.s,jj($.a)&&delete $.a}e._hierarchical&&W.getChildren().each(e.serializeData,e)},serializeValue:function(U,k,H){Tc(k)?k={__a:k._as}:k instanceof Wm&&(k={__i:k.getId()}),H[U]=k},deserialize:function(r,Q,H){var e=this,I=e.dm;I.beginTransaction(),Ve=!0,H=er(H)?{setId:H}:H||{},r=e.json=Xr(r)?y.parse(r):r,e._82I={};var B=new Km,b=new Km,d=0,$=r.d.length;if(H.justDatas||(hl(r.init)&&r.init(I),I.setInit(r.init)),!H.justDatas){for(var M in r.a)I.a(M,e[Bd](r.a[M]));for(var D in r.p)I[wd(D)](r.p[D])}for(;$>d;d++){var h=r.d[d],Y=Rj(h.c),N=new Y,t=h.i;H.setId&&t!=E&&(N._id=t),e._82I[t]=N,B.add(N),b.add(h)}for(d=0;$>d;d++)e.deserializeData(B.get(d),b.get(d));return B.each(function(E){Q&&!E.getParent()&&E.setParent(Q),I.add(E)}),Ve=!1,I.endTransaction(),B},deserializeData:function(X,v){for(var P in v.p)X[wd(P)](this[Bd](v.p[P]));for(P in v.s)X.s(P,this[Bd](v.s[P]));for(P in v.a)X.a(P,this[Bd](v.a[P]))},deserializeValue:function(V){if(ki(V)){var Q=V.__i;if(Q!=E)return this._82I[Q];if(Q=V.__a,_n(Q))return new Km(Q)}return V}}),Jn(Wf,{serialize:function(H,X){return new ke(this,X).serialize(H)},toJSON:function(F){return new ke(this,F).toJSON()},deserialize:function(g,b,O){return new ke(this).deserialize(g,b,O)}}),vb.GraphView=function(u){var a=this;a._24I={},a._34I=new Km,a._25I={},a._56I={},a._view=sj(1,a),a._canvas=iq(a._view),a.dm(u?u:new Wf),a.setEditable(!1),a.setScrollBarVisible(y.graphViewScrollBarVisible)},cf("GraphView",O,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[md,dj,Yg,yc,"resettable","editInteractor",zp,"pannable","rectSelectable","autoScrollZone",$q,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:y.graphViewResettable,_pannable:y.graphViewPannable,_rectSelectable:y.graphViewRectSelectable,_autoScrollZone:y.graphViewAutoScrollZone,_rectSelectBackground:y.graphViewRectSelectBackground,_rectSelectBorderColor:y.graphViewRectSelectBorderColor,_editPointSize:y.graphViewEditPointSize,_editPointBorderColor:y.graphViewEditPointBorderColor,_editPointBackground:y.graphViewEditPointBackground,_scrollBarColor:Tl,_scrollBarSize:$n,_autoHideScrollBar:cs,_autoMakeVisible:Pi,getLayers:function(){return this._dataModel.getLayers()},setLayers:function(F){this._dataModel.setLayers(F)},setEditable:function(I){var D=this,_=D.__interactorMap__;if(!_){var m=vb.XEditInteractor;_=D.__interactorMap__={scrollBar:new Kf(D),select:new Ue(D),edit:m?new m(D):new Af(D),move:new bd(D),"default":new Lq(D),touch:new nc(D,{editable:!1})}}I?(D._uieditable=!0,D.setInteractors([_.scrollBar,_.select,_.edit,_.move,_.default,_.touch])):(D._uieditable=!1,D.setInteractors([_.scrollBar,_.select,_.move,_.default,_.touch]))},getCanvas:function(){return this._canvas},_33I:function(m){var H=m.getUIClass();return H?new H(this,m):E},getDataUI:function(P){var f=this,W=f._25I[P._id];return W===K&&(W=f._33I(P),f._25I[P._id]=W),W},getNodeRect:function(t){return y.getNodeRect(this,t)},getEdgeInfo:function(X){var P=this.getDataUI(X);return P?(P._79o(),P._78o):null},getEdgeSourcePosition:function(_){var J=this,o=J.getDataUI(_),k=o.s,h=o._data._40I;return Sp(J,h,k("edge.source.position"),k("edge.source.offset.x"),k("edge.source.offset.y"),k("edge.source.anchor.x"),k("edge.source.anchor.y"))},getEdgeTargetPosition:function(i){var L=this,b=L.getDataUI(i),k=b.s,u=b._data._41I;return Sp(L,u,k("edge.target.position"),k("edge.target.offset.x"),k("edge.target.offset.y"),k("edge.target.anchor.x"),k("edge.target.anchor.y"))},invalidateAll:function(X){var z=this;if(X){for(var H in z._25I){var P=z._25I[H];P&&P.dispose()}z._25I={},z._56I={},z._24I={},z._34I.clear(),z.redraw()}else z.dm().each(function(T){z.invalidateData(T)})},invalidateSelection:function(){var N=this;N.sm().each(function(q){N.invalidateData(q)})},invalidateData:function(l){var j=this;j._24I[l._id]=l,j._21Q(l),j.iv()},_21Q:function(p){var _=this,U=_._24I;if(gl(p)&&Jb[p.s(rk)]){var r=p.getSourceAgent();r&&r.getAgentEdges().each(function(z){U[z._id]=z}),r=p.getTargetAgent(),r&&r.getAgentEdges().each(function(z){U[z._id]=z}),_.iv()}},redraw:function(j){var l=this;l._32I||(j?l._34I.add(j):(l._32I=1,l._34I.clear()),l.iv())},each:function(Q,G){var W,Z,V,K=0,X=this.getLayers(),g=this._dataModel,j=g._datas._as,$=j.length;if(X){for(var C=X.length;C>K;K++)if(V=X[K],ki(V)&&(V=V.name),g.isHierarchicalRendering()){var l=function(W){return W._layer===V?G?Q.call(G,W):Q(W):void 0};if(this._dataModel.eachByHierarchical(l)===!1)return}else for(var M=0;$>M;M++)if(W=j[M],W._layer===V&&(Z=G?Q.call(G,W):Q(W),Z===!1))return}else if(g.isHierarchicalRendering())this._dataModel.eachByHierarchical(Q,null,G);else for(;$>K;K++)if(W=j[K],Z=G?Q.call(G,W):Q(W),Z===!1)return},reverseEach:function(Y,D){var M,v,H,S,f=this._dataModel,d=f._layers,o=f._datas._as,R=o.length;if(d){for(M=d.length-1;M>=0;M--)if(S=d[M],ki(S)&&(S=S.name),f.isHierarchicalRendering()){var s=function(w){return w._layer===S?D?Y.call(D,w):Y(w):void 0};if(f.reverseEachByHierarchical(s)===!1)return}else for(var x=R-1;x>=0;x--)if(v=o[x],v._layer===S&&(H=D?Y.call(D,v):Y(v),H===!1))return}else if(f.isHierarchicalRendering())f.reverseEachByHierarchical(Y,null,D);else for(M=R-1;M>=0;M--)if(v=o[M],H=D?Y.call(D,v):Y(v),H===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var H=this,_=H._84I;if(!_){var U=this.dm().a("width"),o=this.dm().a("height");U>0&&o>0?H._84I={x:0,y:0,width:U,height:o}:(H.each(function(N){H.isVisible(N)&&(_=xb(_,H.getDataUIBounds(N)))}),H._84I=_?_:mr)}return H._84I},getScrollRect:function(){return xb(this.getContentRect(),this._29I)},makeCenter:function(V,g,i){var A=this;if(!A.getWidth()||!A.getHeight())return i||Yh(A.centerData,A,[V,g,!0],200),void 0;A.makeVisible(V),A.validate();var X=A.getDataUIBounds(V);if(X){var p=A.getWidth(),K=A.getHeight(),I=X.x+X.width/2,f=X.y+X.height/2,B=-I*A._zoom+p/2,n=-f*A._zoom+K/2;A.setTranslate(B,n,g)}},fitData:function(k,e,D,o,h){var c=this;if(!c.getWidth()||!c.getHeight())return h||Yh(c.fitData,c,[k,e,D,o,!0],200),void 0;var w=function(){c.makeVisible(k),c.validate();var W=c.getDataUIBounds(k);W&&(W=ij(W),is(W,D==E?20:D),c.fitRect(W,e,o))};e?y.callWhenLoaded(w):w()},fitContent:function(t,f,I,d){var L=this;if(!L.getWidth()||!L.getHeight())return d||Yh(L.fitContent,L,[t,f,I,!0],200),void 0;var $=function(){L.validate();var M=ij(L.getContentRect());is(M,f==E?20:f),L.fitRect(M,t,I)};t?y.callWhenLoaded($):$()},fitRect:function(l,h,W){var p=this,H=p.getWidth(),J=p.getHeight(),K=l.x+l.width/2,r=l.y+l.height/2,G=i(H/l.width,J/l.height),v=p._zoom,Y=-K*v+H/2,s=-r*v+J/2;0===G||isNaN(G)||(W&&(G=i(1,G)),h?p.setTranslate(Y,s,{finishFunc:function(){p.setZoom(G,h)}}):(p.setTranslate(Y,s),p.setZoom(G)))},toCanvas:function(Y,b){b=b||this._zoom,this.validateImpl();var _=this,U=_.getContentRect();U.width||(U.width=10),U.height||(U.height=10);var l=iq(),X=U.x*b,A=U.y*b,W=U.width*b,u=U.height*b;ob(l,W,u,1);var F=$l(l);return Y=Y||this._dataModel.getBackground(),Y&&an(F,0,0,W,u,Y),lp(F,-X,-A),F.scale(b,b),_._42(F),F.restore(),l},toDataURL:function(p,Q,j){return this.toCanvas(p,j).toDataURL(Q||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(Y,d){var z,K,R=this;R._93db(Y,d),R.each(function(U){R._56I[U._id]&&(z=R.getDataUI(U),z&&(K=z._79o(),b.HtmlNode&&U instanceof b.HtmlNode?z._42(Y):(!d||Ae(d,K))&&z._42(Y)))}),R._92db(Y,d)},validateImpl:function(){var p,h,o,n,f,F=this,J=F.tx(),D=F.ty(),T=F._zoom,w=F._canvas,G=this.getWidth(),z=this.getHeight(),B=F._29I,E={x:-J/T,y:-D/T,width:G/T,height:z/T},C={},x=F._34I,Z=F._24I,s=F._32I,u=F._23I;F._24I={},(G!==w.clientWidth||z!==w.clientHeight)&&(ob(w,G,z),s=1),s||Al(E,B)||(s=1),F._29I=E,F.each(function(w){h=w._id;var X=C[h]=F.isVisible(w);X!==F._56I[h]&&(Z[h]=w,o=F.getDataUI(Z[h]),o&&o._84o(X),F._84o(w,X))},F);for(h in Z)o=F.getDataUI(Z[h]),o&&(!s&&F._56I[h]&&(f=o._79o(),f&&x.add(f)),o.invalidate()),F._83I=1;if(F._56I=C,!s)for(h in Z)C[h]&&(o=F.getDataUI(Z[h]),o&&(f=o._79o(),f&&x.add(f)));if(s?n=E:(x.each(function(H){Ae(E,H)&&(n=xb(n,H))}),n&&(is(n,M(1,1/T)),n.x=r(n.x*T)/T,n.y=r(n.y*T)/T,n.width=e(n.width*T)/T,n.height=e(n.height*T)/T,n=Fg(E,n))),F._74O=n,n){p=$l(w);var i=n.x,S=n.y,d=n.width,P=n.height;i=Math.floor((i*T+J)*to),S=Math.floor((S*T+D)*to),d=Math.ceil(d*T*to)+1,P=Math.ceil(P*T*to)+1,p.beginPath(),p.rect(i,S,d,P),p.clip(),p.clearRect(i,S,d,P),mh(p,J,D,T),F._42(p,n),p.restore(),delete F._74O}if(x.clear(),delete F._32I,u&&G>0&&z>0){var o=F.getDataUI(u);if(o){var f=o._79o(),X=F._29I,A=X.x,m=X.y,b=X.width,c=X.height,T=F._zoom;f&&!Ae(f,X)&&(f.x+f.width<A&&F.tx(-f.x*T),f.x>A+b&&F.tx(-(f.x+f.width-b)*T),f.y+f.height<m&&F.ty(-f.y*T),f.y>m+c&&F.ty(-(f.y+f.height-c)*T))}delete F._23I}F._83I&&(delete F._83I,delete F._84I),F._98O(),jj(F._24I)||Yh(F.iv,F)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(w){var _=this;w!==_.isScrollBarVisible()&&(w?(mc(_._view,_._79O=hc()),mc(_._79O,_._27I=hc()),mc(_._79O,_._28I=hc())):(be(_._79O),delete _._79O,delete _._27I,delete _._28I),_.fp("scrollBarVisible",!w,w))
},showScrollBar:function(){var z=this;z._79O&&(z._85I||(_(function(){z._86I()},Dc),z.iv()),z._85I=new Date)},_86I:function(){var N=this;if(N._85I){var I=new Date,R=I.getTime();R-N._85I.getTime()>=Dc?(delete N._85I,N.iv()):_(function(){N._86I()},Dc)}},_98O:function(){var O=this,K=this._27I,X=this._28I;if(O._79O){if(O._autoHideScrollBar&&!O._85I)return K.style.visibility=mb,X.style.visibility=mb,void 0;var R=O.getScrollBarColor(),Y=O._zoom,q=O.getScrollBarSize(),j=O.getViewRect(),G=O.getScrollRect(),n=j.height*Y,L=G.height*Y,p=j.width*Y-q-2,u=n*((j.y-G.y)*Y/L),d=n*(n/L),f=K.style;L-.5>n?(Jg>d&&(u=u+d/2-Jg/2,0>u&&(u=0),u+Jg>n&&(u=n-Jg),d=Jg),qh(K,p,u,q,d),f.visibility=oj,f.background=R,f.borderRadius=q/2+pn):f.visibility=mb;var T=j.width*Y,s=G.width*Y,u=j.height*Y-q-2,p=T*((j.x-G.x)*Y/s),N=T*(T/s),f=X.style;s-.5>T?(Jg>N&&(p=p+N/2-Jg/2,0>p&&(p=0),p+Jg>T&&(p=T-Jg),N=Jg),qh(X,p,u,N,q),f.visibility=oj,f.background=R,f.borderRadius=q/2+pn):f.visibility=mb}},setDataModel:function(j){var E=this,T=E._dataModel,t=E._selectionModel;T!==j&&(T&&(T.ump(E.handleDataModelPropertyChange,E),T.umm(E.handleDataModelChange,E),T.umd(E.handleDataPropertyChange,E),T.removeIndexChangeListener(E._75O,E),T.removeHierarchyChangeListener(E.handleHierarchyChange,E),t||T.sm().ums(E.handleSelectionChange,E)),E._dataModel=j,j.mp(E.handleDataModelPropertyChange,E),j.mm(E.handleDataModelChange,E),j.md(E.handleDataPropertyChange,E),j.addIndexChangeListener(E._75O,E),j.addHierarchyChangeListener(E.handleHierarchyChange,E),t?t._21I(j):j.sm().ms(E.handleSelectionChange,E),E.invalidateAll(!0),E.fp(ck,T,j),E._canvas.style.background=j.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===K){var S=this.getLayers();S?(this._layersInfo={},S.forEach(function(Z){var n=ki(Z)?Z.name:Z;this._layersInfo[n]=Z},this)):this._layersInfo=null}return this._layersInfo},updateLayers:function(){this._layersInfo=K,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(X){if("background"===X.property){var H=this._canvas.style.background,x=X.newValue||"";this._canvas.style.background=x,this.fp("canvasBackground",H,x)}else"a:width"===X.property||"a:height"===X.property?(this._83I=1,this.redraw()):"layers"===X.property?this.updateLayers():"hierarchicalRendering"===X.property&&this.redraw()},handleDataPropertyChange:function(J){this.dm().isHierarchicalRendering()&&"parent"===J.property&&J.data.hasChildren()&&this.redraw(),this.invalidateData(J.data)},onPropertyChanged:function(T){var o=this,W=T.property;if(o.redraw(),"zoom"===W){var h=o.sm().getSelection();h.size()&&h.each(function(w){w.invalidate()})}Un[W]?o.showScrollBar():W===zp&&o.onCurrentSubGraphChanged(T)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(Q){var g=this,Y=Q.kind,d=Q.data;if(g._83I=1,"add"===Y)g.invalidateData(d),gl(d)&&d.getEdgeGroup()&&d.getEdgeGroup().eachSiblingEdge(g.invalidateData,g);else if(Y===lb){g._21Q(d);var w=d._id,p=g._25I[w];if(p){if(g._56I[w]){var R=p._79o();R&&g.redraw(R)}p.dispose(),delete g._25I[w],delete g._24I[w],delete g._56I[w]}d===g._currentSubGraph&&g.setCurrentSubGraph(E)}else Y===Wk&&(g.invalidateAll(!0),g.setCurrentSubGraph(E))},_75O:function(G){this.invalidateData(G.data)},handleHierarchyChange:function(B){this.dm().isHierarchicalRendering()&&B.data.hasChildren()&&this.redraw(),this.invalidateData(B.data)},adjustIndex:function(Z){var i=this;if(i.isVisible(Z)){for(var $=Z;$._parent&&i.isVisible($._parent);)$=$._parent;$&&$!==Z&&i._dataModel.adjustIndex($),i._dataModel.adjustIndex(Z)}},getImage:function(Q){return Q.getImage()},getSelectWidth:function(C){return C.s("select.width")},isSelectable:function(I){if(!this._clickThroughChecking&&I.getParent()instanceof ff&&I.getParent().isSyncSize())return!1;var G=this.getLayersInfo();if(G){var L=G[I._layer];if(L&&L.selectable===!1)return!1}return I.s("2d.selectable")&&this.sm().isSelectable(I)},isMovable:function(p){var g=this;if(gl(p)&&p.getStyle(rk)!==kn)return!1;var M=this.getLayersInfo();if(M){var X=M[p._layer];if(X&&X.movable===!1)return!1}return p.s("2d.movable")?g._movableFunc?g._movableFunc(p):!0:!1},isEditable:function(L){var R=this;if(b._uiSerializing)return R._uieditable;if(!R._editInteractor||!R.isSelected(L))return!1;if(Sd(L)){var Y=R.getDataUI(L);if(!Y||Y._88I)return!1}if(gl(L)&&L.getStyle(rk)!==kn)return!1;var A=this.getLayersInfo();if(A){var c=A[L._layer];if(c&&c.editable===!1)return!1}return L.s("2d.editable")?R._editableFunc?R._editableFunc(L):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(J){return Or(J)&&0!==J.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(J):!0},isRectEditable:function(l){return this._rectEditableFunc?this._rectEditableFunc(l):!0},isAnchorEditable:function(G){return this._anchorEditableFunc?this._anchorEditableFunc(G):!0},isRotationEditable:function(B){return B.setRotation&&B.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(B):!0:!1},getRotationPoint:function(y){var K=y.getAnchor(),B=y.getScale(),o=this._zoom,Q=db(y.getRotation(),0,-y.getHeight()*B.y*K.y-(B.y<0?-1:1)*(Ib?32:16)/o),p=y.p();return Q.x+=p.x,Q.y+=p.y,Q},getLogicalPoint:function(V){var m=this;return $b(V,m._canvas,m.tx(),m.ty(),m._zoom,m._zoom)},getSelectedDataAt:function(w){var O=this;return this.getDataAt(w,function(H){return O.isSelected(H)})},getDataAt:function(m,d,k){m.target&&(m=this.lp(m));var i,n=this._zoom;return this.reverseEach(function(t){return(d?d(t):this.isSelectable(t))&&this.rectIntersects(t,gb(m.x,m.y,k,n))?(i=t,!1):void 0},this),i},getIconInfoAt:function(Q,l){var W=this;if(Q.target&&(Q=W.lp(Q)),l||(l=W.getDataAt(Q)),l){var X=W.getDataUI(l);if(X&&X._38o){var u,d=X._38o,$=new Km;for(u in d.icons)$.add(u);for(var i=$.size()-1;i>=0;i--){u=$.get(i);for(var B=d.rects[u],e=B.rotation,c=B.length-1;c>=0;c--){var n=B[c],H=n.width,o=n.height,T={x:Q.x-n.x-H/2,y:Q.y-n.y-o/2};e!=E&&(T=db(-e,T.x,T.y));var n={x:-H/2,y:-o/2,width:H,height:o};if(Jd(n,T))return{key:u,index:c,name:d.icons[u].names[c],rect:B[c],point:Q,rotation:e,relativeRect:n,relativePoint:T,data:l}}}}}return E},getDatasInRect:function(_,T,a){a===K&&(a=1);var Z=this,z=new Km;return Z.reverseEach(function(B){a&&!Z.isSelectable(B)||(T?Z.rectIntersects(B,_):Z.rectContains(B,_))&&z.add(B)}),z},moveSelection:function(J,E){var e=this;e.dm().beginTransaction(),Nk(e.sm().toSelection(e.isMovable,e),J,E),e.dm().endTransaction()},moveDatas:function(j,K,b){var I=this;I.dm().beginTransaction(),j instanceof Km||(j=new Km(j)),Nk(j,K,b),I.dm().endTransaction()},getDataUIBounds:function(q){var f=this.getDataUI(q);return f?f._79o():E},drawData:function(d,l){var U=this.getDataUI(l);U&&(U._79o(),U._42(d)),l instanceof b.Block&&l.eachChild(function(J){this.drawData(d,J)},this)},getBoundsForGroup:function(e){return e.s(cp)?this.getDataUIBounds(e):E},rectIntersects:function(N,Z){this.validate();var Q=E;if(this._56I[N._id]){var p=this._25I[N._id];if(p){var j=p._79o();if(ym(Z,j))Q=!0;else if((Z=Fg(Z,j))&&(p.rectIntersects&&(Q=p.rectIntersects(Z)),Q==E)){if(!N.s("pixelPerfect"))return!0;var A=Z.x,M=Z.y,l=Z.width,P=Z.height,s=this._zoom,h=y.hitMaxArea,X=l*P*s*s;if(X>h){var O=Math.sqrt(h/X);s*=O}l*=s,P*=s,2>l&&(l=2),2>P&&(P=2),A*=s,M*=s;var Y=Ym(l,P);lp(Y,-A,-M),Y.scale(s,s),this._drawForChecking=!0,this.drawData(Y,N),this._drawForChecking=!1;try{for(var k=0,I=Y.getImageData(0,0,l,P).data;k<I.length;k+=4)if(0!==I[k+3]){Q=!0;break}Y.restore()}catch(x){cj=E,Q=!1}}}}return Q?!0:!1},rectContains:function(D,P){if(this._56I[D._id]){var R=this._25I[D._id];if(R)return ym(P,R._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(k){if(!y.isInput(k.target)){var i=this,u=i._focusData,D=u&&i._25I[u._id],O=0,L=i._dataModel._datas;if(!(u&&u._enabled&&u._editable&&D&&D.onKeyDown&&D.onKeyDown(k)===!0))if(9===k.keyCode&&(u&&(O=L.indexOf(u),As(k)?-1===--O&&(O=0):++O===L.size()&&(O=0)),i._focusData=u=L.get(O),i.sm().setSelection(u)),Mq(k)?i.selectAll():kp(k)&&i.isResettable()&&i.reset(),i.sm().isEmpty()){if(i._editing)return;var N=i.tx(),c=i.ty(),f=!1,J=As()?100:10;Yf(k)&&(N-=J,f=!0),dh(k)&&(c-=J,f=!0),nb(k)&&(N+=J,f=!0),Kr(k)&&(c+=J,f=!0),f&&i.setTranslate(N,c)}else{bi(k)&&i.handleDelete(k);var l=As()?10:1;Yf(k)&&(i.moveSelection(-l,0),i.fi({kind:"moveLeft"})),dh(k)&&(i.moveSelection(0,-l),i.fi({kind:"moveUp"})),nb(k)&&(i.moveSelection(l,0),i.fi({kind:"moveRight"})),Kr(k)&&(i.moveSelection(0,l),i.fi({kind:"moveDown"}))}}},handleScroll:function(M,C){Gm(M);var W=this.lp(M);C>0?this.scrollZoomIn(W):0>C&&this.scrollZoomOut(W)},handlePinch:function(g,T,o){this._68I||(T>o?this.pinchZoomIn(g):this.pinchZoomOut(g))},checkDoubleClickOnNote:function(g,e){var t=this,W=t.lp(g),T=t.getDataUI(e),h=T.note2Info;return h&&e.s("note2.toggleable")&&Jd(h.clickRect,W)?(e.s(vj,!e.s(vj)),t.fi({kind:"toggleNote2",event:g,data:e}),!0):(h=T.noteInfo,h&&e.s("note.toggleable")&&Jd(h.clickRect,W)?(e.s(br,!e.s(br)),t.fi({kind:"toggleNote",event:g,data:e}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(G,b){var k=this,s=k.getAutoScrollZone(),C=s/k.getZoom(),n=s/4,N=k._29I,w=k.lp(G),_={x:k.tx(),y:k.ty()};return w&&s>0&&N&&(w.x-N.x<C?k.translate(n,0):N.x+N.width-w.x<C&&k.translate(-n,0),w.y-N.y<C?k.translate(0,n):N.y+N.height-w.y<C&&k.translate(0,-n)),_.x=k.tx()-_.x,_.y=k.ty()-_.y,b&&(b.x+=_.x,b.y+=_.y),_},getMoveMode:function(H,m){var s=m.s("2d.move.mode");return s?s:Ho["88"]?"x":Ho["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(S,k,P){var q=this;return"currentSubGraph"===k?{__i:S.getId()}:P.serializeProperty(S,k,q)},deserializeProperty:function(P,Z,_){var g=this;if("currentSubGraph"===Z){var m=g.dm(),i=m.__idMap;return i[P.__i]}return _.deserializeProperty(P,Z,g)},setDefaultCursor:function(v,P){this._defaultCursor=v,P!==!1&&this.setCursor(v)},setCursor:function(X){"default"===X&&(X=this._defaultCursor||X);var e=this.getView().style;e.cursor=X,e.cursor="-webkit-"+X,e.cursor="-moz-"+X}});var qd=function(b,e){var M=this;M.gv=b,M.s=function(G){return e.getStyle(G)},M._data=e,M._87I=new Km};ok(qd,O,{_6I:E,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var f=this,m=f.gv.isSelected(f._data);return!m||f.isShadowed()?0:f.gv.getSelectWidth(f._data)},getBodyColor:function(j){var _=this._data,K=this.gv.getBodyColor(_);return K?K:j?_.getStyle(j):E},_2Q:function(r){return this.s(r)},_1Q:function(m,k,n,Z){var d=this.s,u=d(k+".dash.color");m.strokeStyle=u,m.lineWidth=n,m.stroke(),d(k+".dash.3d")&&Hq(m,u,d(k+".dash.3d.color"),n,this.gv._zoom,d(k+".dash.3d.accuracy")),hh(m,Z)},invalidate:function(){this._6I=E},_79o:function(){var d=this;if(!d._6I){d.labelInfo=d.label2Info=d.noteInfo=d.note2Info=d._38o=E,d._87I.clear(),d._3O();var x=d._data,o=d.gv;d._55O=o.isEditable(x)?{_42O:o.isRectEditable(x),_43O:o.isPointEditable(x),_56O:o.isRotationEditable(x)}:E,d._6I=d._81o()}return d._6I},_3O:function(){},getPosition:function(){return mr},_68o:function(m,P){m&&this._87I.add(Qm(m,P))},_81o:function(){var i=this,u=i.s;i._24O(Yk,"getLabel"),i._24O(Ye,"getLabel2"),i._26O(cd,"getNote"),i._26O(fn,"getNote2"),i._15O(),i._55O&&i._48O();var J;if(i._87I.each(function(i){J=xb(J,i)}),J&&i.isShadowed()){var q=ij(J);q.x+=u("shadow.offset.x"),q.y+=u("shadow.offset.y"),is(q,u("shadow.blur")),J=xb(J,q)}return i._87I.clear(),J},_42:function(V){var d=this,l=d._data,v=d.gv,s=d.s,N=s("opacity"),j=this.isShadowed();if(j){var i=V.shadowOffsetX,R=V.shadowOffsetY,_=V.shadowBlur,O=V.shadowColor,F=v.getZoom();V.shadowOffsetX=s("shadow.offset.x")*F,V.shadowOffsetY=s("shadow.offset.y")*F,V.shadowBlur=s("shadow.blur")*F,V.shadowColor=s("select.color")}if(N!=E){var W=V.globalAlpha;V.globalAlpha=N}d._80o(V),v.isLabelVisible(l)&&((!v._drawForChecking||s("label.selectable"))&&fq(V,d.labelInfo),(!v._drawForChecking||s("label2.selectable"))&&fq(V,d.label2Info)),v.isNoteVisible(l)&&(gj(V,d.noteInfo),gj(V,d.note2Info)),d._99O(V),N!=E&&(V.globalAlpha=W),j&&(V.shadowOffsetX=i,V.shadowOffsetY=R,V.shadowBlur=_,V.shadowColor=O)},_80o:function(){},_47O:function(){},_24O:function(d,x){var s=this,Q=s._data,A=s.gv,j=s.s,e=A[x](Q);if(e!=E){var N=j(d+".scale"),Y=j(d+".max"),T=j(d+".position"),w=s[d+"Info"]={label:e,scale:N,color:A[x+"Color"](Q),font:j(d+".font"),opacity:j(d+".opacity"),align:j(d+".align"),rotation:s.getRotation(j(d+".rotation"),!1,T),background:A[x+"Background"](Q)},c=Sj(w,e);Y>0&&Y<c.width&&(w.labelWidth=c.width,c.width=Y),1!==N&&(c.width*=N,c.height*=N);var g=s.getPosition(T,j(d+".offset.x"),j(d+".offset.y"),c,j(d+".position.fixed"));if(c.x=g.x-c.width/2,c.y=g.y-c.height/2,s._68o(w.rect=c,w.rotation),1!==N){var U=c.width/N,h=c.height/N;w.rect={x:g.x-U/2,y:g.y-h/2,width:U,height:h}}}},_26O:function(m,c){var G=this,v=G.gv,I=G._data,D=G.s,r=v[c](I);if(r!=E){var x,f,M=D(m+".scale"),W=G[m+"Info"]={note:r,scale:M,data:I,view:v,expanded:D(m+".expanded"),font:D(m+".font"),color:D(m+".color"),opacity:D(m+".opacity"),align:D(m+".align"),icon:D(m+".icon"),backgroundImage:D(m+".backgroundImage"),borderWidth:D(m+".border.width"),borderColor:D(m+".border.color"),background:v[c+"Background"](I)},C=G.getPosition(D(m+".position"),D(m+".offset.x"),D(m+".offset.y")),L=C.x,b=C.y;if(W.expanded){var H,A=D(m+".max"),V=D(m+".backgroundImage");V?(V=_l(V),H={width:Oh(V,I),height:Lk(V,I)}):H=Sj(W,r),H.width+=6,H.height+=2,A>0&&A<H.width&&(W.labelWidth=H.width,H.width=A),x=H.width,f=H.height+8,W.clickRect={x:L-x*M/2,y:b-f*M,width:x*M,height:f*M*H.height/f}}else{var i=D(m+".icon");i?(i=_l(i),x=Oh(i,I),f=Lk(i,I)):(x=12,f=18),W.clickRect={x:L-x*M/2,y:b-f*M,width:x*M,height:f*M}}W.rect={x:L-x/2,y:b-f*M/2-f/2,width:x,height:f};var T=e(W.borderWidth/2)*M;G._68o({x:L-x*M/2-T,y:b-f*M-T,width:x*M+2*T,height:f*M+2*T})}},_48O:function(){},_99O:function(w){var Z=this,Q=Z._38o;if(Q){var f=Z.gv,U=Z._data,L=Q.icons;for(var h in L){var F=L[h],z=Q.rects[h];if(z){var O=_h(F.opacity,U,f),R=_h(F.names,U,f),T=R?R.length:0,K=z.rotation;if(O!=E){var r=w.globalAlpha;w.globalAlpha*=O}for(var H=0;T>H;H++){var a=R[H],t=_l(a),Y=z[H];if(K){var d=Y.x+Y.width/2,A=Y.y+Y.height/2;w.save(),lp(w,d,A),Kh(w,K),lp(w,-d,-A)}Tb(w,t,_h(F.stretch,U,f),Y.x,Y.y,Y.width,Y.height,Z._data,Z.gv),K&&w.restore()}O!=E&&(w.globalAlpha=r)}}}}});var Gc=function(v,k){hi(Gc,this,[v,k])};ok(Gc,qd,{_checkEmptyRect:!0,_40O:function(f,W){var I=this,B=I.s,A=f.rect;(f.borderColor=I.gv.getBorderColor(I._data))&&(f.borderType=B("border.type"),f.borderWidth=B("border.width"),f.borderPadding=B("border.padding"),W=M(W,f.borderPadding+f.borderWidth/2));var g=I._data.getScale(),V=M(1,M(a(g.x),a(g.y)));if(f.selectWidth=I.getSelectWidth()){var t=I.gv._zoom;f.selectType=B("select.type"),f._97o=B("select.color"),f.selectPadding=B("select.padding"),W=M(W,(f.selectPadding+f.selectWidth/2/t)/V)}W>0&&(W*=V,A=ij(A),is(A,W)),I._68o(A)},_39O:function($,v){var f,c=this,k=v.rect;if(v.borderWidth>0&&(f=v.borderPadding,$.strokeStyle=v.borderColor,$.lineWidth=v.borderWidth,mn($,v.borderType,{x:k.x-f,y:k.y-f,width:k.width+2*f,height:k.height+2*f}),$.stroke()),v.selectWidth>0){var I=c.gv._zoom;if(f=v.selectPadding,$.strokeStyle=v._97o,$.lineWidth=v.selectWidth/I,v.rotation!=E){$.save(),$.translate(v.position.x,v.position.y),$.rotate(v.rotation);var a=c._data,d=a.getWidth(),Y=a.getHeight(),m=v.scale,A=v.anchor;k={x:m.x*-d*A.x,y:m.y*-Y*A.y,width:m.x*d,height:m.y*Y}}mn($,v.selectType,{x:k.x-f,y:k.y-f,width:k.width+2*f,height:k.height+2*f}),v.rotation!=E&&$.restore(),$.stroke()}},_3O:function(){var x=this,b=x.s,C=x._data,f=C.getStyle(np),r=x.getBodyColor(),I=x._83o=f?{shape:f,_53o:x.getBodyColor("shape.background"),_27Q:_l(b("shape.repeat.image"),r),shapeGradientPack:b("shape.gradient.pack"),_54o:b("shape.border.width"),_55o:b("shape.border.color"),_56o:b("shape.border.3d"),_57o:b("shape.border.3d.color"),_58o:b("shape.border.3d.accuracy"),shapeGradient:b("shape.gradient"),_59o:b("shape.gradient.color"),_60o:b("shape.border.pattern"),_61o:b("shape.border.cap"),_62o:b("shape.border.join"),bodyColor:r}:{img:_l(x.gv.getImage(C),r),bodyColor:r,stretch:b("image.stretch")};if(H&&!A);else{I.rect=C.getRect(),I.position=C.p(),I.scale=C.getScale(),I.anchor=C.getAnchor(),I.rotation=C.getRotation(),f===qo&&(I._63o=b("shape.depth"));var Z=0;if(f)Z=tn(E,I._54o/2,I._62o),x.s("shape.dash")&&(Z=M(Z,(x.s("shape.dash.width")||I._54o)/2));else if(I.img&&I.img.boundExtend)if(Z=_h(I.img.boundExtend,C,x.gv),I.img.boundExtendAbsolute){var o=C.getScale();Z/=x.gv._zoom*M(1,M(a(o.x),a(o.y)))}else if(!_h(I.img.fitSize,C,x.gv)){var t=_h(I.img.width,C,x.gv),n=_h(I.img.height,C,x.gv);Z*=M(C.getWidth()/t,C.getHeight()/n)}x._40O(I,Z);var d=b("clip.percentage");if(1>d&&(0>d&&(d=0),I.clipRect=qg(C.getAnchorRect(),b("clip.direction"),d)),f){var g=b("shape.fill.clip.percentage");1>g&&(0>g&&(g=0),I.shapeClipRect=qg(C.getAnchorRect(),b("shape.fill.clip.direction"),g))}}},getPosition:function(g,U,w,T){var E=Bi(g,this._83o.rect,T);return E.x+=U,E.y+=w,E},_80o:function(b){var D=this,F=D.s,W=D.gv,C=D._data,u=D._83o,G=u.rect,P=u.position,V=u.rotation,N=u.anchor,K=u.scale,M=u.shape,$=u.clipRect;if(!D._checkEmptyRect||G.width>0&&G.height>0){var O=C.getSize();if(O.x=-O.width*N.x,O.y=-O.height*N.y,b.save(),lp(b,P.x,P.y),Kh(b,V),Ph(b,K.x,K.y),$&&(b.beginPath(),b.rect($.x,$.y,$.width,$.height),b.clip()),D.freeDraw)D.freeDraw(b,O,u);else if(M){var g,Q,k,c,Z=u._60o,x=rj(b,Z),T=u._53o,S=u._27Q,v=u._54o,Y=u._55o,I=u.shapeGradientPack,L=b.lineJoin,o=b.lineCap;if("roundRect"===M?g=F("shape.corner.radius"):"polygon"===M?g=F("shape.polygon.side"):"arc"===M&&(g=F("shape.arc.from"),Q=F("shape.arc.to"),k=F("shape.arc.close"),c=F("shape.arc.oval")),b.lineJoin=u._62o,b.lineCap=u._61o,T||S||I){var _=u.shapeClipRect;_&&(b.save(),b.beginPath(),b.rect(_.x,_.y,_.width,_.height),b.clip()),mn(b,M,O,g,Q,k,c),I?Hf(b,I):S?Qe(b,S,u.bodyColor,null,C,W):Bf(b,T,u.shapeGradient,u._59o,O),b.fill(),_&&b.restore(),I&&b.restore(),b!==x&&mn(x,M,O,g,Q,k,c)}else mn(x,M,O,g,Q,k,c);if(v>0){var U=F("shape.border.width.absolute");U&&(b.save(),b.setTransform(1,0,0,1,0,0)),b.lineWidth=v,b.strokeStyle=Y,b.stroke(),U&&b.restore(),u._56o&&Hq(b,Y,u._57o,v,W._zoom,u._58o)}if(hh(b,Z),F("shape.dash")){var B=F("shape.dash.width")||v;if(B>0){Z=F("shape.dash.pattern");var x=rj(b,Z,D._2Q("shape.dash.offset"));x!==b&&mn(x,M,O,g,Q,k,c),D._1Q(b,"shape",B,Z)}}ah(b,T,u._63o,O),b.lineJoin=L,b.lineCap=o}else Tb(b,u.img,u.stretch,O.x,O.y,O.width,O.height,C,W,u.bodyColor);b.restore()}D._39O(b,u)},_48O:function(){},_47O:function(){}});var tq=function(s,A){hi(tq,this,[s,A])},hb=function(v,H,j,P){var G=tm(v,H);return j=P?i(j,G):ji(j,G),G?j/=G:j=0,{x:v.x+(H.x-v.x)*j,y:v.y+(H.y-v.y)*j}};ok(tq,qd,{_3O:function(){var j,C=this,m=C._data,V=C.gv,H=C.s,S=H(rk),h=m.isLooped(),f=H("edge.width"),s=H("edge.center"),l=H("edge.offset"),L=V.getBorderColor(m),G=L?H("border.width"):0,c=C.getSelectWidth(),_=m._40I,o=m._41I,P=C._78o=_&&o?{looped:h,type:S,width:f,center:s,color:C.getBodyColor("edge.color"),borderColor:L,borderWidth:G,_97o:c?H("select.color"):E,selectWidth:c,pattern:H("edge.pattern"),cap:H("edge.cap"),join:H("edge.join"),is3d:H("edge.3d"),_67o:H("edge.3d.color"),_66o:H("edge.3d.accuracy")}:E;if(P){var e=y.getEdgeType(S);if(e){var N=e(m,mi(C,V,m,h,S),V,C._19Q);N.points&&N.points.size()>1?(P._4O=N,j=wf(P._4O.points)):N[Xf]&&N.rect&&(P._4O=N,j=N.rect)}else{var p=H("edge.source.anchor.x"),t=H("edge.source.anchor.y"),B=H("edge.target.anchor.x"),T=H("edge.target.anchor.y"),Y=Sp(V,_,H("edge.source.position"),H("edge.source.offset.x"),H("edge.source.offset.y"),p,t),b=Sp(V,o,H("edge.target.position"),H("edge.target.offset.x"),H("edge.target.offset.y"),B,T);if(S===kn){var u=P.points=H(ss)||pd,$=u.size();P.segments=H("edge.segments");var O=p!==K||t!==K,A=B!==K||T!==K;if(!s)if(l)O||(Y=hb(Y,$?u.get(0):b,l,$)),A||(b=hb(b,$?u.get($-1):Y,l,$));else{var r;O||(r=Vb(Y,$?u.get(0):b,pf(V,_)),r&&(Y={x:r[0],y:r[1]})),A||(r=Vb($?u.get($-1):Y,b,pf(V,o)),r&&(b={x:r[0],y:r[1]}))}j=xb(wf(P.points),wf(Y,b))}else{var Q=mi(C,V,m,h,S);if(C._19Q||(Q=-Q),h)Y=ij(Y),Y.x=V.getNodeRect(_).x,P.radius=Q,j={x:Y.x-Q,y:Y.y-Q,width:2*Q,height:2*Q};else{var U=tm(Y,b),a=ji(l,U),v={x:a,y:Q},X={x:U-a,y:Q},D=F(b.y-Y.y,b.x-Y.x),i=P.mat=new fs(D);if(P.orienAngle=D,P.angle=b.x<Y.x?D+z:D,P.rect={x:v.x,y:v.y,width:X.x-v.x,height:0},P.origin=Y,v=i.tf(v),v.x+=Y.x,v.y+=Y.y,X=i.tf(X),X.x+=Y.x,X.y+=Y.y,s){var R={x:U,y:0};R=i.tf(R),R.x+=Y.x,R.y+=Y.y,j=wf([Y,v,X,R]),P.c1=Y,P.c2=R}else j=wf(v,X);Y=v,b=X}}P.sourcePoint=Y,P.targetPoint=b,m._lastSourcePoint=Y,m._lastTargetPoint=b}var n=0;H("edge.dash")&&(n=H("edge.dash.width")||f);var k="square"===P.cap?.71:.5;tn(j,M(n*k,f*k+G+c),P.join),C._68o(j)}},getRotation:function(U,D,P){U=U||0;var v=this._78o;if(v){var u,O=v.angle,c=v.points,V=v._4O;if(O!=E)return D?v.orienAngle+U:O+U;if(V&&V[Xf])return V.getRotation?V.getRotation(this,U,D,P):0;if(V&&V.points){var X=V.points;return u=X.size(),nh[P]?u&&0===u%2?Dm(X.get(u/2-1),X.get(u/2),D,U):U:xq[P]?Dm(X.get(0),X.get(1),D,U):Dm(X.get(u-2),X.get(u-1),D,U)}if(c)return u=c.size(),nh[P]?u&&0===u%2?Dm(c.get(u/2-1),c.get(u/2),D,U):U:xq[P]?Dm(v.sourcePoint,u?c.get(0):v.targetPoint,D,U):Dm(u?c.get(u-1):v.sourcePoint,v.targetPoint,D,U)}return U},getPosition:function(Z,R,N,y,B){var v=this._78o;if(v){var f,G=v.type,e=v.points,s=v._4O,E=v.sourcePoint,J=v.targetPoint;if(!G)return v.looped?{x:E.x-v.radius+R,y:E.y+N}:(B&&E&&J&&(E.x>J.x||E.x===J.x&&E.y>J.y)&&(Z=Hp[Z],N=-N),f=Bi(Z,v.rect,y),f.x+=R,f.y+=N,f=v.mat.tf(f),f.x+=v.origin.x,f.y+=v.origin.y,f);if(s&&s[Xf])return s.getPosition?s.getPosition(this,Z,R,N,y,B):{x:(E.x+J.x)/2,y:(E.y+J.y)/2};if(e){var f,X=e.size();if(nh[Z]){if(X){var n=X%2;if(0===n)return gk(e.get(X/2-1),e.get(X/2),Z,R,N,y,B);f=e.get((X-n)/2)}else f={x:(E.x+J.x)/2,y:(E.y+J.y)/2};return f=Bi(Z,{x:f.x,y:f.y,width:0,height:0},y),f.x+=R,f.y+=N,f}return xq[Z]?gk(E,X?e.get(0):J,Z,R,N,y,B):gk(X?e.get(X-1):E,J,Z,R,N,y,B)}if(s){var O=s.points,X=O.size();if(nh[Z]){var n=X%2;return 0===n?gk(O.get(X/2-1),O.get(X/2),Z,R,N,y,B):(f=O.get((X-n)/2),f=Bi(Z,{x:f.x,y:f.y,width:0,height:0},y),f.x+=R,f.y+=N,f)}return xq[Z]?gk(O.get(0),O.get(1),Z,R,N,y,B):gk(O.get(X-2),O.get(X-1),Z,R,N,y,B)}}return mr},_42:function(s){this._78o&&tq.superClass._42.call(this,s)},drawPath:function(J,f){J.beginPath();var L=f.type,r=f.points,n=f.segments,B=f._4O;if(!L||r){var T=f.sourcePoint,b=T.x,Z=T.y,A=f.targetPoint,v=A.x,y=A.y;if(L)if(n){var S=new Km({x:b,y:Z});S.addAll(r),S.add({x:v,y:y}),Eh(J,S,n)}else J.moveTo(b,Z),r.each(function(g){J.lineTo(g.x,g.y)}),J.lineTo(v,y);else f.looped?J.arc(b,Z,f.radius,0,I,!0):f.center?(J.moveTo(f.c1.x,f.c1.y),J.lineTo(b,Z),J.lineTo(v,y),J.lineTo(f.c2.x,f.c2.y)):(J.moveTo(b,Z),J.lineTo(v,y))}else B&&(B.points?Eh(J,B.points,B.segments):B[Xf]&&B[Xf](J,B))},_80o:function(s){var l=this,q=l.s,L=l._78o,G=L.width,j=L.selectWidth,S=L.borderWidth,F=L.color,r=s.lineJoin,h=s.lineCap,W=L.pattern;s.lineJoin=L.join,s.lineCap=L.cap,l.drawPath(rj(s,W),L);var i=q("edge.width.absolute");if(i&&(s.save(),s.setTransform(1,0,0,1,0,0)),j&&(s.strokeStyle=L._97o,s.lineWidth=G+2*(S+j),s.stroke()),S&&(s.strokeStyle=L.borderColor,s.lineWidth=G+2*S,s.stroke()),s.strokeStyle=F,s.lineWidth=G,s.stroke(),L.is3d&&Hq(s,F,L._67o,G,l.gv._zoom,L._66o),i&&s.restore(),hh(s,W),q("edge.dash")){W=q("edge.dash.pattern");var H=rj(s,W,l._2Q("edge.dash.offset"));H!==s&&l.drawPath(H,L),l._1Q(s,"edge",q("edge.dash.width")||G,W)}s.lineJoin=r,s.lineCap=h},_48O:function(){},_47O:function(){},_71o:function(g,p){var y=this,q=y._data;if(y._19Q=!0,!q.getEdgeGroup())return g?q.s("edge.gap"):0;var K,m=0,M=0,k=0;if(q.getEdgeGroup().getSiblings().each(function(s){s.each(function(l){if(y.gv.isVisible(l)&&l.s(rk)==p){var O=l.s("edge.gap");K?(M+=k/2+O/2,k=O):(K=l,k=O),l===q&&(m=M)}})}),g)return M-m+k;var O=m-M/2;return K&&q._40I!==K._40I&&(y._19Q=!1),O}});var wm=function(n,g){hi(wm,this,[n,g])};ok(wm,Gc,{_3O:function(){var l,c,U=this,g=U.s,C=U._data,S=U.gv;if(U._88I=E,C.isExpanded()&&C.eachChild(function(Z){var U=S.getBoundsForGroup(Z);U&&(c||(c=[]),c.push(U),l=xb(l,U))}),l){var J=S.getLabel(C),x=g("group.type");l=jg(x,c,l),Rf(l,C,"group.padding",1);var T=U._88I={type:x,rect:l,_64o:l};if(!x&&J!=E){var q,t=U.labelInfo={label:J,color:g("group.title.color"),font:g("group.title.font"),align:g("group.title.align")},k=Sj(t,J),d=k.width,W=k.height,o=g("group.title.align");d>l.width&&(l.width=d),t.rect={y:l.y-W,width:k.width,height:W},q=o===nl?l.x:o===yf?l.x+l.width-d:l.x+l.width/2-d/2,t.rect.x=q,T.titleRect={x:l.x,y:l.y-W,width:l.width,height:W+1},T.rect={x:l.x,y:l.y-W,width:l.width,height:l.height+W}}U._40O(T,g("group.border.width")/2)}else wm.superClass._3O.call(U)},getPosition:function(k,v,E,A){var Z=this._88I;if(Z){var Y=Bi(k,Z.rect,A);return Y.x+=v,Y.y+=E,Y}return wm.superClass.getPosition.apply(this,arguments)},_24O:function(O,g){var Z=this._88I;(!Z||Z.type||"label2"===O)&&wm.superClass._24O.call(this,O,g)},_80o:function(F){var w=this,E=w._88I;if(E){var $=w._data,J=w.s,L=w.gv,Q=E.type,o=E.rect,z=E._64o,K=E.titleRect,D=w.getBodyColor(),j=_l(J("group.image"),D),W=J("group.image.stretch"),X=w.getBodyColor("group.background"),d=_l(J("group.repeat.image"),D),t=J("group.gradient.pack"),i=J("group.gradient"),y=J("group.gradient.color"),O=J("group.depth");if(Q){var A=J("group.border.pattern"),N=J("group.border.width"),l=F.lineJoin,r=F.lineCap;if(F.lineJoin=J("group.border.join"),F.lineCap=J("group.border.cap"),j){if(F.save(),mn(F,Q,o),F.clip(),Tb(F,j,W,o.x,o.y,o.width,o.height,$,L,D),F.restore(),N>0){var m=rj(F,A);mn(m,Q,o),F.lineWidth=N,F.strokeStyle=J("group.border.color"),F.stroke(),hh(F,A)}}else{var m=rj(F,A);X||d||t?(mn(F,Q,o),t?Hf(F,t):d?Qe(F,d,D,null,$,L):Bf(F,X,i,y,o),F.fill(),t&&F.restore(),F!==m&&mn(m,Q,o)):mn(m,Q,o),N>0&&(F.lineWidth=N,F.strokeStyle=J("group.border.color"),F.stroke()),hh(F,A),Q===qo&&ah(F,X,O,o)}F.lineJoin=l,F.lineCap=r}else if(j?Tb(F,j,W,z.x,z.y,z.width,z.height,$,L,w.getBodyColor()):(X||d)&&(d?Qe(F,d,D,null,$,L):Bf(F,X,i,y,z),mn(F,qo,z),F.fill(),ah(F,X,O,z)),K){var x=J("group.title.background");an(F,K.x,K.y,K.width,K.height,x),ah(F,x,O,K)}w._39O(F,E)}else wm.superClass._80o.call(w,F)}});var Fq=function(U,J){hi(Fq,this,[U,J])};ok(Fq,Gc,{_80o:function(i){this._39O(i,this._83o)}});var pc=function(l,N){hi(pc,this,[l,N])};ok(pc,Gc,{_3O:function(){var D=this,H=D._data,X=D.s,F=D.gv,W=H.getPoints(),_=F.getBorderColor(H),l=_?X("border.width"):0,e=D.getSelectWidth(),m=X("shape.border.width"),f=H.getRect(),r=F.getBodyColor(H),N=D._99o=W.isEmpty()?E:{rect:f,rotation:H.getRotation(),fillRule:X("shape.fill.rule"),scale:H.getScale(),position:H.p(),points:W,segments:H.getSegments(),bodyColor:r,borderColor:_,borderWidth:l,_94o:X("shape.border.3d"),_95o:X("shape.border.3d.color"),_96o:X("shape.border.3d.accuracy"),_97o:e?X("select.color"):E,selectWidth:e,_53o:X("shape.background"),_27Q:_l(X("shape.repeat.image"),r),shapeGradientPack:X("shape.gradient.pack"),_54o:m,_55o:X("shape.border.color"),shapeGradient:X("shape.gradient"),_59o:X("shape.gradient.color"),_60o:X("shape.border.pattern"),_61o:X("shape.border.cap"),_62o:X("shape.border.join")};if(N){var L=H.getScale(),Y=M(1,M(a(L.x),a(L.y)));X("shape.dash")&&X("shape.dash.width")>m&&(m=X("shape.dash.width"));var v=m*("square"===N._61o?.71:.5)+l+e/D.gv._zoom/Y;v&&(v*=Y,f=ij(f),tn(f,v,N._62o)),D._68o(f);var Q=X("clip.percentage");1>Q&&(0>Q&&(Q=0),N.clipRect=qg(H.getAnchorRect(),X("clip.direction"),Q));var w=X("shape.fill.clip.percentage");1>w&&(0>w&&(w=0),N.shapeClipRect=qg(H.getAnchorRect(),X("shape.fill.clip.direction"),w))}},getPosition:function(C,h,$,i){var j=this._99o;if(j){var O=Bi(C,j.rect,i);return O.x+=h,O.y+=$,O}return mr},_42:function(h){this._99o&&pc.superClass._42.call(this,h)},_80o:function(n){var G,J=this,A=J.s,E=J._99o,M=E.position,r=E.scale,D=E.rotation,B=E.bodyColor,l=E.borderWidth,Q=E.selectWidth,c=E._53o,m=E._27Q,W=E.shapeGradientPack,v=E._54o,R=E.clipRect,x=E.shapeClipRect,N=E.points,P=E.segments,s=J._data.isClosePath(),L=E.fillRule,I=c||m||W;n.save(),lp(n,M.x,M.y),Kh(n,D),Ph(n,r.x,r.y),R&&(n.beginPath(),n.rect(R.x,R.y,R.width,R.height),n.clip()),I&&x&&(n.save(),n.beginPath(),n.rect(x.x,x.y,x.width,x.height),n.clip()),lp(n,-M.x,-M.y);var q=E._60o,V=rj(n,q),C=n.lineJoin,O=n.lineCap;n.lineJoin=E._62o,n.lineCap=E._61o,I?(Eh(n,N,P,s),W?Hf(n,W):m?Qe(n,m,B,null,J._data,J.gv):(G=B?B:c,Bf(n,G,E.shapeGradient,E._59o,E.rect)),n.fill(L),x&&(n.restore(),lp(n,-M.x,-M.y)),W&&n.restore(),V!==n&&Eh(V,N,P,s)):Eh(V,N,P,s);var K=A("shape.border.width.absolute");if(K&&(n.save(),n.setTransform(1,0,0,1,0,0)),Q&&(n.strokeStyle=E._97o,n.lineWidth=v+2*(l+Q),n.stroke()),l&&(n.strokeStyle=E.borderColor,n.lineWidth=v+2*l,n.stroke()),v&&(G=E._55o,!c&&B&&(G=B),n.strokeStyle=G,n.lineWidth=v,n.stroke(),E._94o&&Hq(n,G,E._95o,v,J.gv._zoom,E._96o)),K&&n.restore(),hh(n,q),A("shape.dash")){var d=A("shape.dash.width")||v;if(d>0){q=A("shape.dash.pattern");var V=rj(n,q,J._2Q("shape.dash.offset"));V!==n&&Eh(V,N,P,s),J._1Q(n,"shape",d,q)}}n.lineJoin=C,n.lineCap=O,n.restore()},_48O:function(){},_47O:function(){}});var vr=function(x,N){hi(vr,this,[x,N])};ok(vr,pc,{getRotation:function(T,Q,G){T=T||0;var n=this._data.getPoints(),l=n.size();return l>1?nh[G]?l&&0===l%2?Dm(n.get(l/2-1),n.get(l/2),Q,T):T:xq[G]?Dm(n.get(0),n.get(1),Q,T):Dm(n.get(l-2),n.get(l-1),Q,T):T},getPosition:function(T,v,P,h,o){var I=this._data.getPoints(),_=I.size();if(_>1){if(nh[T]){var s=_%2;if(0===s)return gk(I.get(_/2-1),I.get(_/2),T,v,P,h,o);var e=I.get((_-s)/2),w={x:e.x,y:e.y,width:0,height:0};return e=Bi(T,w,h),e.x+=v,e.y+=P,e}return xq[T]?gk(I.get(0),I.get(1),T,v,P,h,o):gk(I.get(_-2),I.get(_-1),T,v,P,h,o)}return mr}});var Re=function(q,g){hi(Re,this,[q,g])};ok(Re,Gc,{_3O:function(){var v=this;Re.superClass._3O.call(v);var z=v.s,N=v._83o;v._82o=N.img||N.shape?E:{background:v.getBodyColor("grid.background"),depth:z("grid.depth"),rect:N.rect,_88o:z("grid.cell.depth"),cellBorderColor:z("grid.cell.border.color"),_89o:z("grid.row.count"),_90o:z("grid.column.count"),block:z("grid.block"),_91o:z("grid.block.color"),_92o:z("grid.block.padding"),_93o:z("grid.block.width")}},_80o:function(M){var P=this,K=P._82o;if(!K)return Re.superClass._80o.call(P,M),void 0;var U,x,S=P._data,n=K.background,z=K.rect,o=K.block,E=K._91o,L=K._92o,W=K._93o,D=K._88o,y=K.cellBorderColor,A=K._89o,I=K._90o;if(n)if(an(M,z.x,z.y,z.width,z.height,n),ah(M,n,K.depth,z),D)for(U=0;A>U;U++)for(x=0;I>x;x++)z=S.getCellRect(U,x),z&&ah(M,n,D,z);else if(y){for(M.beginPath(),U=0;A>U;U++)for(x=0;I>x;x++)z=S.getCellRect(U,x),z&&M.rect(z.x,z.y,z.width,z.height);M.strokeStyle=y,M.lineWidth=1,M.stroke()}if("h"===o)for(U=0;A>U;U++)z=xb(S.getCellRect(U,0),S.getCellRect(U,I-1)),is(z,L),Wn(M,E,z.x,z.y,z.width,z.height,W);else if("v"===o)for(x=0;I>x;x++)z=xb(S.getCellRect(0,x),S.getCellRect(A-1,x)),is(z,L),Wn(M,E,z.x,z.y,z.width,z.height,W);P._39O(M,P._83o)}});var jf=function(e,n){hi(jf,this,[e,n])};ok(jf,Gc,{_checkEmptyRect:!1,_81o:function(){var z=this._data,u=jf.superClass._81o.call(this),L=z.s("text");if(L!=E){var N,v,y=z.s("text.font"),c=z.s("text.align"),H=z.s("text.vAlign"),$=wr(y,L),o=$.width,q=$.height,U=z.getAnchor(),I=z.getWidth(),D=z.getHeight();"left"===c?N=-I*U.x:"center"===c?N=-I*U.x+(I-o)/2:"right"===c&&(N=I*(1-U.x)-$.width),"top"===H?v=-D*U.y:"middle"===H?v=-D*U.y+(D-q)/2:"bottom"===H&&(v=D*(1-U.y)-$.height);var W,k=z.getMatrix();
if(W=wf([k.tf(N,v),k.tf(N+o,v),k.tf(N+o,v+q),k.tf(N,v+q)]),u=xb(u,W),u&&z.s("text.shadow")){var h=ij(u);h.x+=z.s("text.shadow.offset.x"),h.y+=z.s("text.shadow.offset.y"),is(h,z.s("text.shadow.blur")),u=xb(u,h)}}return u}});var Ah=vb.Interactor=function(_){this.gv=this._graphView=_};cf("Interactor",O,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(B){this.gv.fi(B)},setCursor:function(O){Ib||this.gv.setCursor(O)},startDragging:function(y){var X=this;X._lastClientPoint=ib(y),X._lastLogicalPoint=X.gv.lp(y),ws(X,y)},clearDragging:function(){var L=this;L._lastClientPoint=L._lastLogicalPoint=L._logicalPoint=E},autoScroll:function(y){return this.gv.autoScroll(y,this._lastClientPoint)}});var Lq=vb.DefaultInteractor=function(X){hi(Lq,this,[X])};cf("DefaultInteractor",Ah,{handle_mousedown:function(h){Gm(h);var C=this,v=C.gv,a=v.getDataAt(h);!v.setFocus(h)||v._editing||v._scrolling||(_c(h)?v.handleDoubleClick(h,a):v.handleClick(h,a),!kp()&&a||!v.isPannable()||!Jm(h)||xi(h)||(C._tx=v.tx(),C._ty=v.ty(),C.startDragging(h)))},handleWindowMouseUp:function(v){var G=this,o=G.gv;o._panning&&(delete o._panning,o.onPanEnded(),G.fi({kind:"endPan",event:v})),delete G._tx,delete G._ty,G.clearDragging()},handle_mousemove:function(P){var X=this,C=X.gv;X._hoverTimer&&(u(X._hoverTimer),delete X._hoverTimer),X._hoverTimer=_(function(){X.fi({kind:"hover",event:P}),u(X._hoverTimer),delete X._hoverTimer},C.getHoverDelay()||800)},handle_touchmove:function(Z){this.handle_mousemove(Z)},handleWindowMouseMove:function(n){var Y=this,V=Y.gv,U=Y._lastClientPoint;Y.fi({kind:V._panning?"betweenPan":"beginPan",event:n}),V._panning=1,V.setTranslate(Y._tx+n.clientX-U.x,Y._ty+n.clientY-U.y)},handle_mousewheel:function(f){this.gv.handleScroll(f,f.wheelDelta)},handle_DOMMouseScroll:function(k){2===k.axis&&this.gv.handleScroll(k,-k.detail)},handle_keydown:function(m){this.gv.handleKeyDown(m)}});var Ue=vb.SelectInteractor=function(K){hi(Ue,this,[K])};cf("SelectInteractor",Ah,{_42:function(){var v=this,c=v.gv,J=c.getZoom(),t=v.mark,r=v.div;r||(r=v.div=hc(),mc(v.getView(),r));var M={};M.x=t.x*J+c.tx(),M.y=t.y*J+c.ty(),M.width=t.width*J,M.height=t.height*J,qh(r,M),this.intersects()?(r.style.border="",r.style.background=c.getRectSelectBackground()):(r.style.background="",r.style.border="1px solid "+c.getRectSelectBorderColor())},handle_mousedown:function(R){var J=this,L=J.gv;if(J._57I=E,!(L._editing||L._scrolling||kp())){var b=L.getDataAt(R),C=L.sm();if(b)if(xi(R))C.co(b)?C.rs(b):C.as(b);else if(C.co(b)){if(_c(R)&&b instanceof ff&&b.isClickThroughEnabled()){var $=L.getDataAt(R,function(u){L._clickThroughChecking=!0;var v=u.getParent()===b&&L.isSelectable(u);return delete L._clickThroughChecking,v});$&&(R.clickThrough=!0,C.ss($))}}else C.ss(b);else xi(R)||!L.isPannable()?Jm(R)&&(xi(R)||C.cs(),L.isRectSelectable()&&(J.startDragging(R),L._77O=1)):Jm(R)&&(J._57I=ib(R))}},handle_mouseup:function(q){var R=this,P=R._57I;P&&(tm(P,ib(q))<=1&&R.gv.sm().cs(),R._57I=E)},handleWindowMouseUp:function(i){this.clear(i)},handleWindowMouseMove:function(X){var J=this,S=J.gv;J._logicalPoint=S.lp(X),J.mark?(J.fi({kind:"betweenRectSelect",event:X}),J.autoScroll(X),J.redraw()):J.fi({kind:"beginRectSelect",event:X}),J.mark=wf(J._lastLogicalPoint,J._logicalPoint),J.redraw()},intersects:function(){var G=this,L=G._lastLogicalPoint,V=G._logicalPoint;return L.x>V.x||L.y>V.y},clear:function(M){var A=this,k=A.gv,w=A.mark;if(A._57I=E,A._lastLogicalPoint){if(w){if(0!==w.width&&0!==w.height){var e=k.getDatasInRect(w,A.intersects());if(!e.isEmpty()){var b=k.sm(),q=b.toSelection();e.each(function(a){b.co(a)?q.remove(a):q.add(a)}),b.ss(q)}}be(A.div),delete A.div,delete A.mark,A.redraw(),A.fi({kind:"endRectSelect",event:M}),k.onRectSelectEnded()}A.clearDragging(),delete k._77O}},redraw:function(){var k=this;k._draw||(k._draw=1,_(function(){k.mark&&k._42(),delete k._draw},16))}});var bd=vb.MoveInteractor=function(y){hi(bd,this,[y])};cf("MoveInteractor",Ah,{handle_mousedown:function(f){var Y=this,p=Y.gv;if(Jm(f)&&!p._editing&&!p._scrolling&&!kp()){var L=p.getSelectedDataAt(f);L?(Y._data=L,p.handleMouseDown&&p.handleMouseDown(f,L),Y.startDragging(f),p.isMovable(L)&&(p._moving=1)):p._focusData=E}},handleWindowMouseUp:function(u){var T=this,h=T.gv;h.handleMouseUp&&h.handleMouseUp(u,T._data),T.clear(u)},handleWindowMouseMove:function(L){var q=this,P=q._data,X=q.gv;if((!X._93O||!X._93O(L,P))&&X._moving){q._logicalPoint||q.fi({kind:"prepareMove",event:L});var S=q._logicalPoint?"betweenMove":"beginMove",T={kind:S,event:L},o=q._logicalPoint=X.lp(L);"beginMove"===S&&X.getDataModel().beginTransaction();var K=q._calcShift(S,L),A=K.x,D=K.y,R=q.gv.getMoveMode(L,P);R&&("x"===R?D=0:"y"===R?A=0:"xy"!==R&&(A=D=0)),X.moveSelection(A,D),q._lastLogicalPoint=o,q.autoScroll(L),q.fi(T)}},_calcShift:function(){var l=this,P=l._logicalPoint,v=l._lastLogicalPoint,K=P.x-v.x,o=P.y-v.y;return{x:K,y:o}},clear:function(L){var x=this,O=x.gv;x._lastLogicalPoint&&(x._lastLogicalPoint=x._data=O._moving=E,x._logicalPoint&&(x.fi({kind:"endMove",event:L}),O.onMoveEnded(),O.getDataModel().endTransaction()),x.clearDragging())}});var Kf=vb.ScrollBarInteractor=function(x){hi(Kf,this,[x])};cf("ScrollBarInteractor",Ah,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(r){var J=this.gv.getViewRect();return this._41o()&&(J.x+J.width-this.gv.lp(r).x)*this.gv.getZoom()<en},isH:function(W){var P=this.gv.getViewRect();return this._40o()&&(P.y+P.height-this.gv.lp(W).y)*this.gv.getZoom()<en},handle_mousemove:function(l){this.handle_touchmove(l)},handle_touchmove:function(R){if(!tk&&Jm(R)){var p=this,u=p.isV(R),x=p.isH(R);(u||x)&&p.gv.showScrollBar(),p.gv._scrolling=u||x}},handleWindowMouseUp:function(j){this.handleWindowTouchEnd(j)},handleWindowTouchEnd:function(R){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=E,this.fi({kind:"endScroll",event:R})},handle_mousedown:function(T){this.handle_touchstart(T)},handle_touchstart:function(Z){var O=this;if(O.gv.setFocus(Z),Gm(Z),O.handle_touchmove(Z),!(Eg(Z)>1)&&O.gv._scrolling){O._cp=ib(Z),O._tx=O.gv.tx(),O._ty=O.gv.ty();var Q=O.isV(Z);O._state=Q?"vScroll":"hScroll",ws(O,Z),O.fi({kind:"beginScroll",event:Z})}},handleWindowMouseMove:function(e){this.handleWindowTouchMove(e)},handleWindowTouchMove:function(X){var C=ib(X),x=this.gv.getViewRect(),H=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-C.y)*H.height/x.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-C.x)*H.width/x.width),this.fi({kind:"betweenScroll",event:X})}});var nc=vb.TouchInteractor=function(g,G){G=G||{},G.selectable===K&&(G.selectable=!0),G.movable===K&&(G.movable=!0),G.pannable===K&&(G.pannable=!0),G.pinchable===K&&(G.pinchable=!0),G.editable===K&&(G.editable=!0),this.params=G,hi(nc,this,[g])};cf("TouchInteractor",Ah,{ms_edit:1,setUp:function(){var K=this;nc.superClass.setUp.call(K),Ib&&K.params.editable&&K.gv.setEditInteractor(K)},tearDown:function(){var P=this;nc.superClass.tearDown.call(P),Ib&&P.params.editable&&P.gv.setEditInteractor(E)},clear:function(R){var z=this,D=z.gv;D._moving&&(z.fi({kind:"endMove",event:R}),delete D._moving,D.onMoveEnded(),D.dm().endTransaction()),D._panning&&(z.fi({kind:"endPan",event:R}),delete D._panning,D.onPanEnded()),D._pinching&&(z.fi({kind:"endPinch",event:R}),delete D._pinching,D.onPinchEnded()),D._editing&&(z._46O(R),z._77I=z._node=z._edge=z._shape=z._rect=z._89I=z._index=D._editing=E),z._moving=z._panning=z._pinching=z._editing=z._57I=z._data=z._beginHistory=E,z.clearDragging()},handle_touchstart:function(G){var C=this;if(!C.gv._editing){Gm(G),C._57I=E;var f=C.params,X=C.gv,y=X.sm(),h=X.getDataAt(G),z=Eg(G);if(1===z){if(_c(G))return X.handleDoubleClick(G,h),void 0;X.handleClick(G,h),h&&(X.handleMouseDown&&X.handleMouseDown(G,h),C._data=h),f.selectable||(h=E),h?(y.co(h)||y.ss(h),f.editable&&X.isEditable(h)&&C._79I(G,h,!0)?(C._editing=1,C.startDragging(G)):f.movable&&X.isMovable(h)&&(C._moving=1,C.startDragging(G))):(C._57I=ib(G),f.pannable&&X.isPannable()&&(C._panning=1,C.startDragging(G),C._translate={x:X.tx(),y:X.ty()}))}else if(f.pinchable&&2===z){C._pinching=1,C.startDragging(G);var t=X.getView(),i=X.getZoom(),L=t.getBoundingClientRect(),r=G.touches[0],o=G.touches[1],F={x:(r.clientX+o.clientX)/2-L.left,y:(r.clientY+o.clientY)/2-L.top};F.x-=X.tx(),F.y-=X.ty(),F.x/=i,F.y/=i,C._p=F,C._d=Hc(G)}}},handle_touchend:function(d){var D=this,o=D.gv,x=D._57I,p=D._data;x&&(tm(x,ib(d))<=1&&o.sm().cs(),D._57I=E),p&&o.handleMouseUp&&o.handleMouseUp(d,p)},handleWindowTouchEnd:function(d){this.clear(d)},handleWindowTouchMove:function(P){var u=this,i=u.gv,H=Eg(P);if(1===H){if(u._editing&&(u._beginHistory||(u._beginHistory=1,i.dm().beginTransaction()),i._editing=1,u._78I(P)),u._moving)u._beginHistory||(u._beginHistory=1,i.dm().beginTransaction()),u.handleMove(P);else if(u._panning){var m=ib(P);i.setTranslate(u._translate.x+m.x-u._lastClientPoint.x,u._translate.y+m.y-u._lastClientPoint.y),u.fi({kind:i._panning?"betweenPan":"beginPan",event:P}),i._panning=1}}else if(2===H&&u._pinching){var M=Hc(P);i.handlePinch(u._p,M,u._d),u._d=M,u.fi({kind:i._pinching?"betweenPinch":"beginPinch",event:P}),i._pinching=1}},handleMove:function(S){var q=this,w=q.gv,_=w.lp(S);w._93O&&w._93O(S,q._data)||(w.moveSelection(_.x-q._lastLogicalPoint.x,_.y-q._lastLogicalPoint.y),q._lastLogicalPoint=_,q.autoScroll(S),q.fi({kind:w._moving?"betweenMove":"beginMove",event:S}),w._moving=1)}});var b=Q.ht,ak=b.graph._editor={Math:{},Guide:{}};b.Math=ak.Math,ak.getStyle=function(x){var C,B=ak.StyleMap;return B&&(C=B[x],C!==K)?C:ak.DefaultStyleMap[x]},ak.setStyle=function(u,h){var d=ak.StyleMap;d||(d=ak.StyleMap={}),d[u]=h},ak.inEdit=function(N){return N._inXEdit===!0},ak.startEdit=function(q){q._inXEdit=!0,ak.Inject.doInject(q)},ak._46O=function(e){e._inXEdit=!1,ak.Inject.undoInject(e)},ak.toScreenPosition=function(T,d){var J=T.tx(),A=T.ty(),u=T._zoom;return new ak.Math.Vector2(d.x*u+J,d.y*u+A)},ak.checkHit=function(g,m,B){return g.distanceTo(m)<B?!0:!1},ak.toWorldPosition=function(B,$){var y=B.tx(),M=B.ty(),Q=B._zoom;return{x:($.x-y)/Q,y:($.y-M)/Q}},ak.setAntialias=function(i,K){for(var q,p=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],A=0,N=p.length;N>A&&(q=p[A],!(q in i));A++);i[q],i[q]=K},ak.log=function(){};var Ll=ak.Inject={_modules:[]};Ll.registAsModule=function(U,u){var s={},a={};for(var $ in U){var S=u.prototype[$];s[$]=S}U.getBackup=function(B){return s[B]},U.getBackups=function(){return s},a.doInject=function(){for(var B in U)"getBackup"!==B&&(u.prototype[B]=U[B])},a.undoInject=function(){for(var O in U)"getBackup"!==O&&(u.prototype[O]=s[O])},Ll._modules.push(a)},Ll.doInject=function(u){for(var R,H=Ll._modules,d=0,w=H.length;w>d;d++)R=H[d],R.doInject(u)},Ll.undoInject=function(M){for(var p,H=Ll._modules,c=0,y=H.length;y>c;c++)p=H[c],p.undoInject(M)};var Ah=b.graph.EditInteractor=function(l){var q=this,Y=n.createElement("canvas");Y.className="editCanvas",Y.style.position="absolute",q._styleMap={},q._canvas=Y,q._context=Y.getContext("2d"),Ah.superClass.constructor.call(q,l),ak.setAntialias(q._context,!1),q._subModules=[new ak.Anchor(q),new ak.Rect(q),new ak.Curve(q),new ak.MoveHelper(q)],q._gridGuide=new ak.Guide.Grid(q),q._rectGuide=new ak.Guide.Rect(q)},Af=Ah;b.Default.def(Ah,b.graph.Interactor,{ms_edit:1,ms_fire:1}),O.defineProperties(Ah.prototype,{editDetail:{get:function(){var L=!!this._editDetail;return L},set:function(U){var j=this,J=j._editDetail;J!==U&&(j._editDetail=U,j.gv._editing=U,j.fp("editDetail",J,U),j.fp("pointsEditingMode",J,U))}},gvEditing:{get:function(){return this.gv._editing},set:function(n){(!this._editDetail||n)&&(this.gv._editing=n,n||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(i){this._editing=i,this.gvEditing=i}},pointsEditingMode:{get:function(){return this.editDetail},set:function(o){var v=this;v.editDetail!==o&&(o?v._tryEnterEditDetailMode():v._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var u=this._gridEnabled;if(!u)return!1;var w=this.gv;return w?!0:!0},set:function(w){w!==this._gridEnabled&&(this._gridEnabled=w,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(J){J!==this._agEnabled&&(this._agEnabled=J,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),Ah.prototype.getSubModule=function(J){var L,E,t,s=this._subModules;for(E=0,t=s.length;t>E;E++)if(L=s[E],L.catalog===J)return L},Ah.prototype.invokeSubModule=function(c,r){var t=this,Y=t._subModules;if(Y)for(var Q,L,F,P=Array.prototype.slice.call(arguments,2),M=0,j=Y.length;j>M;M++)if(Q=Y[M],L=Q[c],L&&(F=L.apply(Q,P),F!=K&&r))return Q},Ah.prototype.invokeSubModuleInverse=function(l,M){var i=this,m=i._subModules;if(m)for(var s,g,L,z=Array.prototype.slice.call(arguments,2),I=m.length-1;I>=0;I--)if(s=m[I],g=s[l],g&&(L=g.apply(s,z),L!=K&&M))return s},Ah.prototype.setUp=function(){ak.log("setUp");var f=this,l=f.gv,j=l.getView(),S=f._canvas;Ah.superClass.setUp.call(f),l.setEditInteractor(f),l._79O?j.insertBefore(S,l._79O):j.appendChild(S),ak.startEdit(l),f.invokeSubModule("setUp"),l.dm().mm(f._onDataModelChanged,f),l.dm().md(f._onDataPropertyChanged,f)},Ah.prototype.tearDown=function(){ak.log("tearDown");var l=this,W=l.gv,Q=W.getView();l._resetCustomCursorStyle(),Ah.superClass.tearDown.call(l),W.dm().umm(l._onDataModelChanged,l),W.dm().umd(l._onDataPropertyChanged,l),W.setEditInteractor(null),Q.removeChild(l._canvas),l._drawTimer&&(u(l._drawTimer),l._drawTimer=null),ak._46O(W),l.invokeSubModule("tearDown")},Ah.prototype._onDataModelChanged=function(c){var Y=this;("clear"===c.kind||"remove"===c.kind&&Y.editDetail&&c.data===Y.getSubModule("Curve").target)&&(Y.editDetail=!1,Y._42())},Ah.prototype._onDataPropertyChanged=function(E){var F=this;if(F.editDetail){var d=F.getSubModule("Curve"),r=E.data;r===d.target&&(r._writing||d._handleDataChanged())}},Ah.prototype.clear=function(){ak.log("clear")},Ah.prototype.redraw=function(){this._42()},Ah.prototype._42=function(){var i=this;i._drawTimer||(i._drawTimer=_(function(){i._drawTimer=null,i.drawImpl()},0))},Ah.prototype.drawImpl=function(){var e;for(e in{_42:!0})break;return function(){var B=this,i=B._canvas,C=B.gv,O=C.getWidth(),U=C.getHeight(),g=B._context,r=b.Default.getInternal();(i.width!==O||i.height!==U)&&r.setCanvas(i,O,U),g.clearRect(0,0,i.width,i.height);var D=B._getValidSelection();g.save();var u=b.Default.devicePixelRatio;g.scale(u,u),B._gridGuide._42(),B._rectGuide._42(),B.invokeSubModuleInverse(e,!1,g,C,D),g.restore()}}(),Ah.prototype._getValidSelection=function(){var A=this,g=A.gv,O=g.sm().getSelection(),V=[];return O.each(function(k){g.isVisible(k)&&g.isEditable(k)&&V.push(k)}),V},Ah.prototype.handle_touchmove=function(q){return this.handle_mousemove(q)},Ah.prototype.handle_mousemove=function(e){if(!b.Default.isDragging()){var l=this;(l.editDetail||!kp())&&(l.gvEditing=!1,l._checkEdit(e)&&(l.gvEditing=!0))}},Ah.prototype.handle_touchstart=function(R){return this.handle_mousedown(R)},Ah.prototype.handle_mousedown=function(I){Gm(I);var X=this;if(X.editDetail||!kp()){if(_c(I)&&!I.clickThrough){if(X.editDetail){if(X._tryQuitEditDetailMode(I))return}else if(X._tryEnterEditDetailMode())return;X.gv.dm().beginTransaction();var r=X.invokeSubModule("handleDoubleClick",!0,I);if(X.gv.dm().endTransaction(),r)return}var Q=X._checkEdit(I);Q&&(X._downPosition=X._getLogicalPoint(I),X.gv.dm().beginTransaction(),Q.startEdit(X,I),X.editing=!0)}},Ah.prototype._checkEdit=function(p){var h=this,V=h.gv,H=h._getLogicalPoint(p),Z=h.invokeSubModule("check",!0,V,p,H)||null;return h._editMod=Z,Z},Ah.prototype.handleWindowTouchMove=function(F){return this.handleWindowMouseMove(F)},Ah.prototype.handleWindowMouseMove=function(f){var M=this,N=M._downPosition;if(N){var q=M._getLogicalPoint(f);if(q.distanceTo(N)<M.getStyle("moveSensitivity"))return;delete M._downPosition}var m=M._editMod;m&&m.handleEdit(M.gv,f)},Ah.prototype._getLogicalPoint=function(H){var I=this,l=b.Default.getLogicalPoint(H,I._canvas);return new ak.Math.Vector2(l)},Ah.prototype.handleWindowTouchEnd=function(Q){return this.handleWindowMouseUp(Q)},Ah.prototype.handleWindowMouseUp=function(){var b;for(b in{_46O:!0})break;return function(E){var l=this;l.editing=!1,l.setCursor("default"),l.invokeSubModule(b,!1,E),l._42(),l.gv.dm().endTransaction()}}(),Ah.prototype.handle_mousewheel=function(x){var l=this;Gm(x),l.invokeSubModule("preHandleScroll",!0)||l.gv.handleScroll(x,x.wheelDelta)},Ah.prototype.handleDelete=function(){var J=this;return J.editDetail?(J.gv.dm().beginTransaction(),J.invokeSubModule("handleDelete",!0),J.gv.dm().endTransaction(),J._42(),void 0):(J.gv.removeSelection(),void 0)},Ah.prototype.handle_keydown=function(V){var W=this;if((V.metaKey||V.ctrlKey)&&W._42(),kp(V)&&!W.editing)return W.gvEditing=!1,W.setCursor("default"),W._42(),void 0;var F=Im(V);return W.editDetail?((F||Xm(V))&&(W.editDetail=!1,W._42()),W.gv.dm().beginTransaction(),W.invokeSubModule("handle_keydown",!0,V),W.gv.dm().endTransaction(),void 0):(F&&W._tryEnterEditDetailMode(),void 0)},Ah.prototype.handle_keyup=function(o){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,o),this.gv.dm().endTransaction()},Ah.prototype._tryEnterEditDetailMode=function(){var o=this;return!o.editDetail&&o.invokeSubModule("canEnterEditDetailMode",!0)&&1===o._getValidSelection().length?(o.editDetail=!0,o._42(),!0):void 0},Ah.prototype._tryQuitEditDetailMode=function(L){var P=this;if(P.editDetail){var G=P.gv,m=P.getSubModule("Curve").target;return L&&G.getDataAt(L)===m?void 0:(P.editDetail=!1,P._42(),!0)}},Ah.prototype.setStyle=function(E,_,u){var W=this;u?ak.setStyle(E,_):W._styleMap[E]=_,W.fp("styleChanged",null,{key:E,value:_,base:u}),W._42()},Ah.prototype.getStyle=function(n){var c=this,p=c._styleMap[n];return p!==K?p:ak.getStyle(n)},Ah.prototype.setCursor=function(C){this._resetCustomCursorStyle(),b.graph.EditInteractor.superClass.setCursor.call(this,C)},Ah.prototype._resetCustomCursorStyle=function(){var x=this;if(x._customStyle){var r=this.gv.getView();r.classList&&r.classList.remove&&r.classList.remove(x._customStyle),x._customStyle=null}},Ah.prototype._setRotateCursor=function(W){var g=this,j=g._cursorFactory;j||(j=g._cursorFactory=new ak.CursorFactory(g));var l=j.getRotateCursor(W),m=g.gv.getView();g._resetCustomCursorStyle(),g._customStyle=l,m.classList&&m.classList.add&&m.classList.add(l)};var _f=ak.Group=function(m){var b=this;b._entities=m,b._64O=0,b._position={x:0,y:0},b._scale={x:1,y:1},b._anchor={x:.5,y:.5},b._anchor2={x:.5,y:.5}};_f.prototype={},_f.prototype.constructor=_f;var Cg=null;_f.findOrCreateGroup=function(V){if(Cg&&Cg.checkIsMe(V))return Cg;var a=new ak.Group(V);return a.getKeyOb()?(Cg=a,a):void 0},_f.prototype.checkIsMe=function(C){var P=this._entities;if(P.length!==C.length)return!1;var h,N={},m=C.length;for(h=0;m>h;h++)N[C[h]._id]=!0;for(h=0;m>h;h++)if(!N[P[h]._id])return!1;return!0},_f.prototype.getRotation=function(){return this._64O},_f.prototype.getPosition=function(){return this._position},_f.prototype.getAnchor=function(){return this._anchor},_f.prototype.getWidth=function(){return this._width},_f.prototype.getScale=function(){return this._scale},_f.prototype.getSize=function(){return{width:this._width,height:this._height}},_f.prototype.getHeight=function(){return this._height},_f.prototype.getKeyOb=function(){for(var c=this._entities,Z=c.length-1;Z>=0;Z--){var I=c[Z];if(this.isNode(I))return I}},_f.prototype.getAnchor2=function(){var A=this,Z=A.rotateCenter;if(Z)return Z;var b=A.getKeyOb();if(!b)return A._anchor;var G=A._anchor2,e=b.getMatrix();return e.tf({x:b.getWidth()*(G.x-b.getAnchor().x),y:b.getHeight()*(G.y-b.getAnchor().y)})},_f.prototype.setAnchor2=function(O,w){var z=this,n=z.getKeyOb();if(n){var j,P=n.getMatrix();j="number"==typeof O?{x:O,y:w}:O;var E=P.tfi(j);z._anchor2={x:n.getAnchor().x+E.x/n.getWidth(),y:n.getAnchor().y+E.y/n.getHeight()}}},_f.prototype.setRotation=function(){},_f.prototype.beginRotate=function(j){this.rotateCenter=j.pos,this.rotateMode=j.groupRotateMode},_f.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},_f.prototype.addRotation=function(I,T){return"batch"===T?this._addRotationInBatchMode(I):"block"===T?this._addRotationInBlockMode(I):void 0},_f.prototype._addRotationInBlockMode=function(_){var y=this,Y=y.rotateCenter||y.getPosition();y._entities.forEach(function(N){if(y.isNode(N)){var G=N.getMatrix();G.translate(-Y.x,-Y.y),G.rotate(_),G.translate(Y.x,Y.y);var R=Math.sign(N.getScale().x);N.setRotation(F(G.b*R,G.a*R)),N.setPosition(G.tx,G.ty)}})},_f.prototype._addRotationInBatchMode=function(v){var n=this,l=n._anchor2;n._entities.forEach(function(V){if(n.isNode(V)){var k=V.getAnchor(),y=V.getMatrix(),H=y.tf({x:V.getWidth()*(l.x-k.x),y:V.getHeight()*(l.y-k.y)}),$=new ak.Math.Matrix2;$.set(y.a,y.b,y.c,y.d,y.tx,y.ty),$.translate(-H.x,-H.y),$.rotate(v),$.translate(H.x,H.y);var h=Math.sign(V.getScale().x);V.setRotation(F($.b*h,$.a*h)),V.setPosition($.tx,$.ty)}})},_f.prototype.setPosition=function(L){var m,g,c,q,j=this,t=j._position,S=L.x-t.x,i=L.y-t.y,l=j._entities;for(g=0,c=l.length;c>g;g++)m=l[g],Or(m)&&(q=m.getPosition(),m.setPosition(q.x+S,q.y+i));j._position=L},_f.prototype.setScale=function(h,d){var e=this,$=h/e._scale.x,D=d/e._scale.y;e._adjustChildScaleOrSize($,D,"size"),e._scale={x:h,y:d}},_f.prototype.getRect=function(){var s=this,R=s._position,N=s._width,r=s._height;return{x:R.x-N/2,y:R.y-r/2,width:N,height:r}},_f.prototype.setSize=function(M,_){var l=this,M=Math.max(1,M),_=Math.max(1,_),S=M/l._width,q=_/l._height;l._adjustChildScaleOrSize(S,q,"size"),l._width=M,l._height=_},_f.prototype._adjustChildScaleOrSize=function(I,o,P){var l,f,c,y,S,D,v,V,j,H,e,h,w,Y,Z=this,J=Z._position,M=Z._entities,C=new ak.Math.Matrix2;for(f=0,c=M.length;c>f;f++)if(l=M[f],Z.isNode(l)){if(y=l.getPosition(),S=l.getRotation(),D=l.getWidth(),v=l.getHeight(),V=l.getScale(),e=V.x*D,h=V.y*v,C.identity().scale(e,h).rotate(S).translate(y.x,y.y).translate(-J.x,-J.y).rotate(-Z._64O),S=F(C.b*Math.sign(e),C.a*Math.sign(e)),C.scale(I,o),j=Math.cos(S),H=Math.sin(S),Math.abs(j)<.001?(w=C.b/H,Y=-C.c/H):(w=C.a/j,Y=C.d/j),"scale"===P)l.setScale(w/D,Y/v);else if("size"===P){var T=w/V.x,d=Y/V.y;l.setScale(ed(w)*Math.abs(V.x),ed(Y)*Math.abs(V.y)),l.setSize(Math.max(.1,Math.abs(T)),Math.max(.1,Math.abs(d)))}C.rotate(Z._64O).translate(J.x,J.y),l.setPosition(C.tx,C.ty)}},_f.prototype.getMatrix=function(){var o=this,P=o._position,s=b.Default.getInternal(),d=o._scale;return new s.Mat(o._64O,P.x,P.y,d.x,d.y)},_f.prototype.getCorners=function(){var $=this,w=$._width,n=$._height,N=$._anchor,M=-w*N.x,e=-n*N.y,I=$.getMatrix();return[I.tf(M,e),I.tf(M,e+n),I.tf(M+w,e+n),I.tf(M+w,e)]},_f.prototype.calcInfo=function(){var R,x,o,G,P,V,O=this,S=[],p=O._entities,f=O._64O;for(G=0,P=p.length;P>G;G++)V=p[G],O.isNode(V)&&V.getCorners&&S.push.apply(S,V.getCorners());if(S.length){var H=Math.cos(-f),I=Math.sin(-f),Y=1/0,D=-1/0,U=1/0,v=-1/0;for(G=0,P=S.length;P>G;G++)o=S[G],R=o.x,x=o.y,o.x=H*R-I*x,o.y=I*R+H*x,Y=Math.min(Y,o.x),D=Math.max(D,o.x),U=Math.min(U,o.y),v=Math.max(v,o.y);O._width=(D-Y)/O._scale.x,O._height=(v-U)/O._scale.y,H=Math.cos(f),I=Math.sin(f);var c=O._anchor;R=Y+(D-Y)*c.x,x=U+(v-U)*c.y,O._position={x:H*R-I*x,y:I*R+H*x}}},_f.prototype.isNode=function(f){return Or(f)?xo(f)?!1:!0:!1},_f.prototype._42=function(G,R,e){var d,K,$,I,H,Y,y,w,B=this,N=B._entities,U=B.rotateMode;for("batch"===U&&(w=B.getKeyOb()),d=0,K=N.length;K>d;d++)$=N[d],B.isNode($)&&(Y=$.getRect(),I=ak.toScreenPosition(e,{x:Y.x,y:Y.y}),H=ak.toScreenPosition(e,{x:Y.x+Y.width,y:Y.y+Y.height}),y={min:I,max:H},$===w&&(y.isKeyOb=!0),ak.Icons.DrawIcon(G,R,ak.Icons.GroupSubEntityRect,y))};var tf=ak.CursorFactory=function(u){var y=this;y._interactor=u,y._rotateCursorStyles={}};tf.prototype={},tf.prototype.constructor=tf,tf.prototype.getRotateCursor=function(D){var Y=this;0>D&&(D+=2*Math.PI);var d=Y._interactor,f=d.getStyle("rotateCursorSize"),m=d.getStyle("rotateCursorRound"),i=Math.round(180*(D/Math.PI)/m);i*m>=360&&(i=0);var V=Y._rotateCursorStyles,I="htCustomRotateStyle_"+f+"_"+m+"_"+i;return V[I]||(Y._produceRotateCursor(I,f,m,i),V[I]=!0),I},tf.prototype._produceRotateCursor=function(I,m,l,g){var p=this;p._interactor;var C=p._canvas;C||(C=p._canvas=n.createElement("canvas")),C.width=C.height=m*devicePixelRatio,C.style.width=C.style.height=m+" px";var U=C.getContext("2d");ak.setAntialias(U,!1),U.scale(devicePixelRatio,devicePixelRatio);var i,u,y,o,A,q=Math.round(m/2),O=""+q+" "+q+",auto !important;";i=Math.PI/180*g*l,U.clearRect(0,0,m,m),U.save(),U.scale(m/32,m/32),U.translate(16,16),U.rotate(i+Math.PI/2),U.beginPath(),U.moveTo(-8,0),U.lineTo(-8,3),U.lineTo(-5,3),U.moveTo(8,0),U.lineTo(8,3),U.lineTo(5,3),U.moveTo(-8,3),U.quadraticCurveTo(0,-6,8,3),U.restore(),U.strokeStyle="white",U.lineWidth=4,U.stroke(),U.strokeStyle="black",U.lineWidth=2,U.stroke(),u=JSON.stringify(C.toDataURL()),o="cursor:url("+u+")"+O,1!==devicePixelRatio&&(y='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+m+'px" height="'+m+'px"><image xlink:href='+u+' width="'+m+'" height="'+m+'"/></svg>',o+="cursor:url(data:image/svg+xml;base64,"+btoa(y)+")"+O,o+="cursor:-webkit-image-set(url("+u+")"+devicePixelRatio+"x,url("+u+")1x)"+O),A=n.createElement("style"),A.textContent="body."+I+" *, ."+I+"{"+o+"}",n.head.appendChild(A)};var Ak=ak.Guide.Grid=function(N){var R=this;R._interactor=N,R._alignmentGuideId=0,R._xAlignmentGuide=[],R._yAlignmentGuide=[]};Ak.prototype={},Ak.prototype.constructor=Ak,O.defineProperties(Ak.prototype,{gridBlockSize:{get:function(){var D=this;return D._gridBlockSize||D._interactor.getStyle("gridBlockSize")},set:function(k){this._gridBlockSize=k,this._interactor._42()}},gridThickLinesEvery:{get:function(){var i=this;return i._gridThickLinesEvery||i._interactor.getStyle("gridThickLinesEvery")},set:function(C){this._gridThickLinesEvery=C,this._interactor._42()}},gridEnabled:{get:function(){var F=this,V=F._interactor;return V.gridEnabled&&F.isValidGrid()}}}),Ak.prototype._42=function(){var N=this,G=N._interactor;N.gridEnabled&&N.drawGrid(),G.alignmentGuideEnabled&&N.drawAlignmentGuide()},Ak.prototype.makeMatrix=function(){var j=this,E=j._interactor.getStyle("gridAngle"),y=j._interactor.getStyle("gridRotation"),K=new ak.Math.Matrix2,f=Math.sin(E),w=Math.cos(E);return K.set(1,0,w,f,0,0),K.rotate(y),K},Ak.prototype.isValidGrid=function(){var o=this,W=Math.PI,x=o._interactor,c=x.gv;if(c._zoom<x.getStyle("gridZoomThreshold"))return!1;var j=x.getStyle("gridAngle"),V=Math.abs(180*(j%W/W)),L=1-1e-8;return L>V||V>180-L?!1:!0},Ak.prototype.drawAlignmentGuide=function(){var b=this,m=b._interactor,B=m.gv,X=m._canvas,s=m._context,F=X.width,Q=X.height,w=B.tx(),N=B.ty(),P=B._zoom;s.beginPath(),s.strokeStyle=m.getStyle("gridAlignmentGuideColor"),s.lineWidth=1,b._xAlignmentGuide.forEach(function(d){var i=d.p*P+w;s.moveTo(i,0),s.lineTo(i,Q)}),b._yAlignmentGuide.forEach(function(K){var L=K.p*P+N;s.moveTo(0,L),s.lineTo(F,L)}),s.stroke()},Ak.prototype.drawGrid=function(){function w(l,p,c,F){var R=ak.toScreenPosition(V,L.apply({x:l,y:p})),Z=ak.toScreenPosition(V,L.apply({x:c,y:F}));P.moveTo(R.x,R.y),P.lineTo(Z.x,Z.y)}var j=this,I=j._interactor,U=j.gridBlockSize,s=j.gridThickLinesEvery,N=I.getStyle("gridThickColor"),H=I.getStyle("gridLightColor"),V=I.gv,O=I._canvas,P=I._context,X=O.width,t=O.height,L=j.makeMatrix(),F=L.applyInverse(ak.toWorldPosition(V,{x:0,y:0})),K=L.applyInverse(ak.toWorldPosition(V,{x:X,y:0})),M=L.applyInverse(ak.toWorldPosition(V,{x:0,y:t})),_=L.applyInverse(ak.toWorldPosition(V,{x:X,y:t})),l=Math.min(F.x,K.x,M.x,_.x),f=Math.max(F.x,K.x,M.x,_.x),h=Math.min(F.y,K.y,M.y,_.y),Q=Math.max(F.y,K.y,M.y,_.y);X=f-l,t=Q-h;var C=Math.ceil(l/U),e=Math.floor(f/U),W=Math.ceil(h/U),m=Math.floor(Q/U);V.tx(),V.ty(),V._zoom;var q,R,k;for(P.save(),P.lineWidth=1,P.beginPath(),P.strokeStyle=N,k=Math.ceil(C/s)*s;e>=k;k+=s)q=k*U,w(q,h,q,Q);for(k=Math.ceil(W/s)*s;m>=k;k+=s)R=k*U,w(l,R,f,R);for(P.stroke(),P.beginPath(),P.strokeStyle=H,k=C;e>=k;k++)0!==k%s&&(q=k*U,w(q,h,q,Q));for(k=W;m>=k;k++)0!==k%s&&(R=k*U,w(l,R,f,R));P.stroke(),P.restore()},Ak.prototype.getAlignmentGuides=function(){var I=this;return{x:I._xAlignmentGuide,y:I._yAlignmentGuide}},Ak.prototype.addAlignmentGuide=function(U,Z,q){var n=this,i="x"===U?n._xAlignmentGuide:n._yAlignmentGuide,q=q?q:++n._alignmentGuideId,o={p:Z,id:q};if(i.length){var W=n._findClosestAlignmentGuide(o.p,i);W.dis<0?i.splice(W.index+1,0,o):i.splice(W.index,0,o)}else i.push(o);return n._interactor._42(),q},Ak.prototype.findClosest=function(B,A,e){var l=this,d=l._interactor,f=d.gv;e&&(B=ak.toWorldPosition(f,B));var x,b,v,M=1/0,I=1/0,q=B.x,E=B.y;if(l.gridEnabled){var c=l.gridBlockSize,J=l.makeMatrix(),G=J.applyInverse(B);G=J.apply({x:Math.round(G.x/c)*c,y:Math.round(G.y/c)*c}),M=G.x-q,I=G.y-E,v=!0}if(d.alignmentGuideEnabled&&(x=l._findClosestAlignmentGuide(q,l._xAlignmentGuide).dis,b=l._findClosestAlignmentGuide(E,l._yAlignmentGuide).dis,Math.abs(x)<Math.abs(M)&&(M=x,v=!0),Math.abs(b)<Math.abs(I)&&(I=b,v=!0)),v){v=!1;var g=f._zoom,i=d.getStyle("smartGuideSensitivity")/g,h={};if(Math.abs(M)<i&&"y"!==A&&(h.x=e?M*g:M,v=!0),Math.abs(I)<i&&"x"!==A&&(h.y=e?I*g:I,v=!0),v)return h}},Ak.prototype._findClosestAlignmentGuide=function(G,N){if(!N.length)return{dis:1/0};for(var m,u=0,F=N.length-1;F-u>1;)m=Math.floor((u+F)/2),N[m].p<G?u=m:F=m;var r=N[u].p-G,R=N[F].p-G;return Math.abs(r)<=Math.abs(R)?{line:N[u],dis:r,index:u}:{line:N[F],dis:R,index:F}},Ak.prototype.removeAllAlignmentGuide=function(L){var y=this;"y"!==L&&(y._xAlignmentGuide=[]),"x"!==L&&(y._yAlignmentGuide=[]),y._interactor._42()},Ak.prototype.removeAlignmentGuide=function(E){var Z,O,u,z=this,q=z._xAlignmentGuide;for(k=0;2>k;k++)for(q=0===k?z._xAlignmentGuide:z._yAlignmentGuide,Z=0,O=q.length;O>Z;Z++)if(u=q[Z],u.id===E)return q.splice(Z,1),z._interactor._42(),{axis:0===k?"x":"y",position:u.p};return!1},Ak.prototype.adjustAlignmentGuide=function(E,x){var I=this,k=I.removeAlignmentGuide(E);return k?(I.addAlignmentGuide(k.axis,x,E),!0):!1};var Qj=ak.Guide.Rect=function(l){var k=this;k._interactor=l};Qj.prototype={},Qj.prototype.constructor=Qj,Qj.prototype.gatherRects=function(){var X,m,v,A,q=this,$=q._interactor.gv,E=[],x=[],k={x:E,y:x},C={},U=$.getDataModel(),P=U.a("width"),h=U.a("height");P&&h&&(X=0,m=0,v=P,A=h,E.push({node:U,type:0,p:X},{node:U,type:1,p:X+v/2},{node:U,type:2,p:X+v}),x.push({node:U,type:0,p:m},{node:U,type:1,p:m+A/2},{node:U,type:2,p:m+A}),C[U._id||0]={x:X,y:m,width:v,height:A}),U.each(function(N){if(Or(N)&&!$.isSelected(N)&&$.isVisible(N)){var I=!1;if($.sm().getSelection().each(function(u){I||(N.isHostOn(u)?I=!0:N.isDescendantOf(u)&&(I=!0))}),!I){var d=N.getRect();X=d.x,m=d.y,v=d.width,A=d.height,E.push({node:N,type:0,p:X},{node:N,type:1,p:X+v/2},{node:N,type:2,p:X+v}),x.push({node:N,type:0,p:m},{node:N,type:1,p:m+A/2},{node:N,type:2,p:m+A}),C[N._id]=d}}}),E.sort(function(Z,v){return Z.p-v.p}),x.sort(function(o,M){return o.p-M.p}),q._grid=k,q._87I=C},Qj.prototype.gatherLines=function(D,R,u){var A,s,c,C,w,U,Y,Z,G,z,j,f,J=this,d=[J.findClosest({x:D.x,y:D.y},R),J.findClosest({x:D.x+D.w/2,y:D.y+D.h/2},R),J.findClosest({x:D.x+D.w,y:D.y+D.h},R)],X={},v=J._87I;u=u||255;var O,L;for(J._guideLine=[],A=0;2>A;A++)for(X={},0===A?(C="y",Z=D.x,G=Z+D.w):(C="x",Z=D.y,G=Z+D.h),s=0;3>s;s++)w=d[s],w&&isFinite(w[C])&&(O=1<<3*A+s,u&O&&(U=w[C+"Line"],Y=U.node,L=Y._id||0,X[L]||(X[L]=!0,f=v[L],"y"===C?(z=f.x,j=f.x+f.width):(z=f.y,j=f.y+f.height),c=U.p,J._guideLine.push({type:C,a:Z,b:G,c:z,d:j,p:c}))))},Qj.prototype._binarySearchClosest=function(x,b){if(!b.length)return{dis:1/0};for(var D,m=0,h=b.length-1;h-m>1;)D=Math.floor((m+h)/2),b[D].p<x?m=D:h=D;
var K=b[m].p-x,V=b[h].p-x;return Math.abs(K)<=Math.abs(V)?{line:b[m],dis:K}:{line:b[h],dis:V}},Qj.prototype.findClosest=function(u,f,d){var $=this,N=$._interactor,Q=N.gv,A=$._grid;d&&(u=ak.toWorldPosition(Q,u));var W,w=$._binarySearchClosest(u.x,A.x),J=$._binarySearchClosest(u.y,A.y),g=w.dis,X=J.dis,n=Q._zoom,M=N.getStyle("smartGuideSensitivity")/n,z={};return Math.abs(g)<M&&"y"!==f&&(z.x=d?g*n:g,z.xLine=w.line,W=!0),Math.abs(X)<M&&"x"!==f&&(z.y=d?X*n:X,z.yLine=J.line,W=!0),W?z:void 0},Qj.prototype._42=function(){var W=this,V=W._guideLine;if(V&&!b.Default.isCtrlDown()){var Q,o,X,r,E,e,p,q,O,T,B,s,P,S,Z,Y,n,h=W._interactor,F=h.gv,u=h._context,L=F.tx(),D=F.ty(),f=F._zoom,$=h.getStyle("guideLineTextSpacing");for(Q=0,o=V.length;o>Q;Q++)X=V[Q],q=X.type,O=X.p,T=X.a,B=X.b,s=X.c,P=X.d,S=Math.min(T,s),Z=Math.max(B,P),"x"===q?(r=O*f+L,E=S*f+D,e=r,p=Z*f+D):(r=S*f+L,E=O*f+D,e=Z*f+L,p=E),ak.Icons.DrawIcon(h,u,ak.Icons.MoveLineGuide,[r,E,e,p]),P>=T&&B>=s||(S=T>P?P:B,Z=T>P?T:s,n=Z-S,"x"===q?(X.center2center||(r-=$,e=r),E=S*f+D,p=Z*f+D,Y=ak.Icons.MoveLineGuideDistanceV):"y"===q&&(X.center2center||(E-=$,p=E),r=S*f+L,e=Z*f+L,Y=ak.Icons.MoveLineGuideDistanceH),ak.Icons.DrawIcon(h,u,Y,{x0:r,y0:E,x1:e,y1:p,dis:n}))}},Qj.prototype.clear=function(){this._guideLine=null},ak.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,rotateRound:Math.PI/2,rotateSensitivity:Math.PI/60,shiftRotateRound:Math.PI/12,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:32,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:"#707070",shapeHighlighPointBackground:"#30599e"};var ap=ak.Icons={},kl=1e4,Co=null,pl=8;b.Default.setImage("Icons.RectPoint",{width:pl,height:pl,comps:[{type:"shape",points:[0,0,0,pl,pl,pl,pl,0],segments:[1,2,2,2,5],shadow:!0,borderWidth:1,shadowColor:{func:function(){return Co.getStyle("rectPointShadowColor")}},background:{func:function(){return Co.getStyle("rectPointBackground")}},borderColor:{func:function(){return Co.getStyle("rectPointBorderColor")}}}]});var as="#e000e0";ap.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var R=ap.GroupSubEntityRect.data;if(!R)return[];var i=R.min,a=R.max;return[i.x,i.y,i.x,a.y,a.x,a.y,a.x,i.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return ap.GroupSubEntityRect.data.isKeyOb?as:"#666666"}}}]},ap.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[ap.Line.data.P1.x,ap.Line.data.P1.y],pl,pl]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[ap.Line.data.P2.x,ap.Line.data.P2.y],pl,pl]}}}]},ap.EdgeHostGuide={comps:[{type:"shape",points:{func:function(){return ap.EdgeHostGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:2,borderColor:"red"}]},ap.Rect={comps:[{type:"shape",points:{func:function(){var a=ap.Rect.data;if(!a)return[];var x=a.LT,z=a.LB,m=a.RB,G=a.RT;return[x.x,x.y,z.x,z.y,m.x,m.y,G.x,G.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#666666"},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ap.Rect.data.rotation}},rect:{func:function(){return[[ap.Rect.data.LT.x,ap.Rect.data.LT.y],pl,pl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ap.Rect.data.rotation}},rect:{func:function(){return[[ap.Rect.data.LB.x,ap.Rect.data.LB.y],pl,pl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ap.Rect.data.rotation}},rect:{func:function(){return[[ap.Rect.data.RB.x,ap.Rect.data.RB.y],pl,pl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ap.Rect.data.rotation}},rect:{func:function(){return[[ap.Rect.data.RT.x,ap.Rect.data.RT.y],pl,pl]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return ap.Rect.data.rotation}},visible:{func:function(){return ap.Rect.data.L?!0:!1}},rect:{func:function(){return[[ap.Rect.data.L.x,ap.Rect.data.L.y],pl,pl]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return ap.Rect.data.rotation}},visible:{func:function(){return ap.Rect.data.R?!0:!1}},rect:{func:function(){return[[ap.Rect.data.R.x,ap.Rect.data.R.y],pl,pl]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return ap.Rect.data.rotation}},visible:{func:function(){return ap.Rect.data.T?!0:!1}},rect:{func:function(){return[[ap.Rect.data.T.x,ap.Rect.data.T.y],pl,pl]}}},{type:"image",name:"Icons.RectPoint",scaleX:.9,scaleY:.9,rotation:{func:function(){return ap.Rect.data.rotation}},visible:{func:function(){return ap.Rect.data.B?!0:!1}},rect:{func:function(){return[[ap.Rect.data.B.x,ap.Rect.data.B.y],pl,pl]}}}]};var Qd=18;b.Default.setImage("Icons.Anchor",{width:Qd,height:Qd,comps:[{type:"arc",rect:[4,4,Qd-8,Qd-8],arcFrom:0,arcClose:!1,background:"#ffffff",borderWidth:0,borderColor:"#000000"},{type:"shape",points:[2,Qd/2,Qd-2,Qd/2,Qd/2,2,Qd/2,Qd-2],segments:[1,2,1,2],background:null,borderWidth:1,borderColor:"#111111"},{type:"arc",rect:[5.5,5.5,Qd-11,Qd-11],arcFrom:0,arcClose:!1,background:null,borderWidth:1,borderColor:"#111111"}]}),ap.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[ap.Anchor.data.POS.x,ap.Anchor.data.POS.y],Qd,Qd]}}}]},ap.TipShiftX=12,ap.TipShiftY=12;var ns=[8,28];ap.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[ap.TipHelper.data.helperPos.x,ap.TipHelper.data.helperPos.y,ns[0]*ap.TipHelper.data.size,ns[1]]}},background:{func:function(){return Co.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return ap.TipHelper.data.text}},rect:{func:function(){return[ap.TipHelper.data.helperPos.x,ap.TipHelper.data.helperPos.y,ns[0]*ap.TipHelper.data.size,ns[1]]}},color:{func:function(){return Co.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var $g=7;ap.ShapePoint={comps:[{type:"circle",rect:{func:function(){var r=ap.ShapePoint.data;return[r,$g,$g]}},background:"#ffffff",borderWidth:1,borderColor:"#333333"}]},ap.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return ap.ShapeBgCurve.data.P}},segments:{func:function(){return ap.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:"#333333"}]};var ir=8;ap.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var e=ap.ShapeHighlighPoint.data;return[[e.x,e.y],ir,ir]}},background:{func:function(){return Co.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Mn=10;ap.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var $=ap.ShapeHighlighRealPoint.data;return[[$.x,$.y],Mn,Mn]}},background:"#ffffff",borderWidth:2,borderColor:"#333333"}]};var Nc=8;ap.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var S=ap.ShapeHighlighCtrlPoint.data,e=S.x,i=S.y,K=Nc/2;return[e-K,i-K,e-K,i+K,e+K,i+K,e+K,i-K]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Co.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Co.getStyle("shapeCtrlPointBorderColor")}}}]};var ih=3;ap.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return ap.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:ih,borderColor:{func:function(){return Co.getStyle("curveHighlightColor")}}}]},ap.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return ap.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"red"}]},ap.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return ap.MoveLineGuide.data}},background:null,borderWidth:1,borderColor:"red"}]};var De=5;ap.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var R=ap.MoveLineGuideDistanceH.data,f=R.x0,k=R.y0,z=R.x1,t=R.y1;return[f,k,z,t,f,k-De,f,k+De,z,t-De,z,t+De]}},segments:[1,2,1,2,1,2],background:null,borderWidth:1,borderColor:"red"},{type:"text",text:{func:function(){return Math.round(ap.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var v=ap.MoveLineGuideDistanceH.data;return[[(v.x0+v.x1)/2,v.y0-10],20,20]}},color:"red",font:"12px Arial",align:"center"}]},ap.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var X=ap.MoveLineGuideDistanceV.data,F=X.x0,U=X.y0,Y=X.x1,E=X.y1;return[F,U,Y,E,F-De,U,F+De,U,Y-De,E,Y+De,E]}},segments:[1,2,1,2,1,2],background:null,borderWidth:1,borderColor:"red"},{type:"text",text:{func:function(){return Math.round(ap.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var E=ap.MoveLineGuideDistanceV.data;return[[E.x0-10,(E.y0+E.y1)/2],20,20]}},color:"red",font:"12px Arial",align:"center"}]};var Uc=6;ap.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return ap.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var H=ap.ShapeActivingCtrl.data;return[H.point.x,H.point.y,H.c1.x,H.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:"#707070"},{type:"shape",visible:{func:function(){return ap.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var k=ap.ShapeActivingCtrl.data;return[k.point.x,k.point.y,k.c2.x,k.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:"#707070"},{type:"shape",visible:{func:function(){return ap.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var l=ap.ShapeActivingCtrl.data.c1,d=l.x,y=l.y,O=Uc/2;return[d-O,y-O,d-O,y+O,d+O,y+O,d+O,y-O]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Co.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Co.getStyle("shapeCtrlPointBorderColor")}}},{type:"shape",visible:{func:function(){return ap.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var U=ap.ShapeActivingCtrl.data.c2,m=U.x,c=U.y,L=Uc/2;return[m-L,c-L,m-L,c+L,m+L,c+L,m+L,c-L]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Co.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Co.getStyle("shapeCtrlPointBorderColor")}}}]},ak.Icons.DrawIcon=function(j,p,M,N){M.width=M.height=kl,M.data=N,Co=j,b.Default.drawImage(p,M,0,0,kl,kl)},ak.Icons.MapPoints=function(V,v){for(var I=0,r=V.length;r>I;I++)V[I]/=v},ak.roundTo=function(m,B,q){var S=Math.abs(m%B);return q>S||q>B-S?B*Math.round(m/B):m},ak.toFixed=function(z){return Math.round(100*z)/100},ak.getDataMatrix=function(v){if(v instanceof b.Shape){var L=new ak.Math.Matrix2,n=v.getPosition();return L.translate(-n.x,-n.y).scale(v.getScale().x,v.getScale().y).rotate(v.getRotation()).translate(n.x,n.y),L}return v.getMatrix?v.getMatrix():new ak.Math.Matrix2},Math.sign===K&&(Math.sign=function(Y){return 0>Y?-1:Y>0?1:+Y});var qi=ak.Math.Matrix2=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0};qi.prototype={},qi.prototype.constructor=qi,qi.prototype.set=function(a,f,r,S,L,y){return this.a=a,this.b=f,this.c=r,this.d=S,this.tx=L,this.ty=y,this},qi.prototype.apply=function(x,O){O=O||new Ge;var F=x.x,h=x.y;return O.x=this.a*F+this.c*h+this.tx,O.y=this.b*F+this.d*h+this.ty,O},qi.prototype.applyInverse=function(C,J){J=J||new Ge;var v=1/(this.a*this.d+this.c*-this.b),p=C.x,a=C.y;return J.x=this.d*v*p+-this.c*v*a+(this.ty*this.c-this.tx*this.d)*v,J.y=this.a*v*a+-this.b*v*p+(-this.ty*this.a+this.tx*this.b)*v,J},qi.prototype.translate=function(L,N){return this.tx+=L,this.ty+=N,this},qi.prototype.scale=function(D,r){return this.a*=D,this.d*=r,this.c*=D,this.b*=r,this.tx*=D,this.ty*=r,this},qi.prototype.rotate=function(k){var z=Math.cos(k),a=Math.sin(k),t=this.a,c=this.c,Q=this.tx;return this.a=t*z-this.b*a,this.b=t*a+this.b*z,this.c=c*z-this.d*a,this.d=c*a+this.d*z,this.tx=Q*z-this.ty*a,this.ty=Q*a+this.ty*z,this},qi.prototype.append=function(E){var Q=this.a,Z=this.b,j=this.c,d=this.d;return this.a=E.a*Q+E.b*j,this.b=E.a*Z+E.b*d,this.c=E.c*Q+E.d*j,this.d=E.c*Z+E.d*d,this.tx=E.tx*Q+E.ty*j+this.tx,this.ty=E.tx*Z+E.ty*d+this.ty,this},qi.prototype.setTransform=function(F,y,o,P,S,b,q,Z,i){var v,G,K,m,R,s,t,n,O,w;return R=Math.sin(q),s=Math.cos(q),t=Math.cos(i),n=Math.sin(i),O=-Math.sin(Z),w=Math.cos(Z),v=s*S,G=R*S,K=-R*b,m=s*b,this.a=t*v+n*K,this.b=t*G+n*m,this.c=O*v+w*K,this.d=O*G+w*m,this.tx=F+(o*v+P*K),this.ty=y+(o*G+P*m),this},qi.prototype.prepend=function(i){var p=this.tx;if(1!==i.a||0!==i.b||0!==i.c||1!==i.d){var Y=this.a,s=this.c;this.a=Y*i.a+this.b*i.c,this.b=Y*i.b+this.b*i.d,this.c=s*i.a+this.d*i.c,this.d=s*i.b+this.d*i.d}return this.tx=p*i.a+this.ty*i.c+i.tx,this.ty=p*i.b+this.ty*i.d+i.ty,this},qi.prototype.invert=function(){var Q=this.a,p=this.b,a=this.c,v=this.d,M=this.tx,V=Q*v-p*a;return this.a=v/V,this.b=-p/V,this.c=-a/V,this.d=Q/V,this.tx=(a*this.ty-v*M)/V,this.ty=-(Q*this.ty-p*M)/V,this},qi.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},qi.prototype.clone=function(){var $=new qi;return $.a=this.a,$.b=this.b,$.c=this.c,$.d=this.d,$.tx=this.tx,$.ty=this.ty,$},qi.prototype.copy=function(l){return l.a=this.a,l.b=this.b,l.c=this.c,l.d=this.d,l.tx=this.tx,l.ty=this.ty,l},qi.IDENTITY=new qi,qi.TEMP_MATRIX=new qi;var Ge=ak.Math.Vector2=function(q,Q){"object"==typeof q&&(q.x!=K?(Q=q.y,q=q.x):(Q=q[1],q=q[0])),this.set(q||0,Q||0)};Ge.prototype={},Ge.prototype.constructor=Ge,O.defineProperties(Ge.prototype,{width:{get:function(){return this.x},set:function(f){this.x=f}},height:{get:function(){return this.y},set:function(d){this.y=d}}}),Ge.prototype.clone=function(){return new Ge(this.x,this.y)},Ge.prototype.copy=function(k){return this.set(k.x,k.y),this},Ge.prototype.equals=function(b){return b.x===this.x&&b.y===this.y},Ge.prototype.set=function(L,m){return this.x=L||0,this.y=m||(0!==m?this.x:0),this},Ge.prototype.setScalar=function(j){return this.x=j,this.y=j,this},Ge.prototype.setX=function(w){return this.x=w||0,this},Ge.prototype.setY=function(e){return this.y=e||0,this},Ge.prototype.add=function(i){return this.x+=i.x,this.y+=i.y,this},Ge.prototype.addVectors=function(i,O){return this.x=i.x+O.x,this.y=i.y+O.y,this},Ge.prototype.addScalar=function(q){return this.x+=q,this.y+=q,this},Ge.prototype.addScaledVector=function(Z,g){return this.x+=Z.x*g,this.y+=Z.y*g,this},Ge.prototype.sub=function(p){return this.x-=p.x,this.y-=p.y,this},Ge.prototype.subScalar=function(p){return this.x-=p,this.y-=p,this},Ge.prototype.subVectors=function(g,i){return this.x=g.x-i.x,this.y=g.y-i.y,this},Ge.prototype.multiply=function(g){return this.x*=g.x,this.y*=g.y,this},Ge.prototype.multiplyScalar=function(I){return this.x*=I,this.y*=I,this},Ge.prototype.divide=function(q){return this.x/=q.x,this.y/=q.y,this},Ge.prototype.divideScalar=function(q){return this.multiplyScalar(1/q)},Ge.prototype.min=function(W){return this.x=Math.min(this.x,W.x),this.y=Math.min(this.y,W.y),this},Ge.prototype.max=function(N){return this.x=Math.max(this.x,N.x),this.y=Math.max(this.y,N.y),this},Ge.prototype.clamp=function(D,Y){return this.x=Math.max(D.x,Math.min(Y.x,this.x)),this.y=Math.max(D.y,Math.min(Y.y,this.y)),this},Ge.prototype.clampScalar=function(){var i,Z;return function(R,T){return i===K&&(i=new Ge,Z=new Ge),i.set(R,R),Z.set(T,T),this.clamp(i,Z)}}(),Ge.prototype.clampLength=function(r,U){var s=this.length();return this.multiplyScalar(Math.max(r,Math.min(U,s))/s)},Ge.prototype.dot=function(x){return this.x*x.x+this.y*x.y},Ge.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Ge.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Ge.prototype.normalize=function(){return this.divideScalar(this.length())},Ge.prototype.angle=function(){var s=Math.atan2(this.y,this.x);return 0>s&&(s+=2*Math.PI),s},Ge.prototype.distanceTo=function(x){return Math.sqrt(this.distanceToSquared(x))},Ge.prototype.distanceToSquared=function(u){var X=this.x-u.x,U=this.y-u.y;return X*X+U*U},Ge.prototype.isNearEnough=function(B){return this.distanceToSquared(B)<1e-8},Ge.prototype.setLength=function(p){return this.multiplyScalar(p/this.length())},Ge.prototype.lerp=function(a,y){return this.x+=(a.x-this.x)*y,this.y+=(a.y-this.y)*y,this},Ge.prototype.lerpVectors=function(w,h,c){return this.subVectors(h,w).multiplyScalar(c).add(w)},Ge.prototype.rotateAround=function(g,N){var Y=Math.cos(N),V=Math.sin(N),o=this.x-g.x,z=this.y-g.y;return this.x=o*Y-z*V+g.x,this.y=o*V+z*Y+g.y,this};var Dr=ak.Math.Curve=function(){this._curves=[]};Dr.prototype={},Dr.prototype.constructor=Dr,Dr.prototype.createFromHtShape=function(H,g){g instanceof b.List&&(g=g.toArray());var D,i,t,$,W,P,R,X=this,I=null,h=null,e=0,Q=ak.Math.Vector2,S=ak.Math.CubicBezier;for(i=0,t=g.length;t>i;i++){switch($=g[i],W=null,$){case 1:h=new Q(H[e],H[e+1]),I=h,e+=2;break;case 2:D=new Q(H[e],H[e+1]),e+=2,W=new S(h,h.clone(),D.clone(),D),h=D;break;case 3:P=new Q(H[e],H[e+1]),D=new Q(H[e+2],H[e+3]),e+=4,W=new S(h,P.clone().sub(h).multiplyScalar(2/3).add(h),P.clone().sub(D).multiplyScalar(2/3).add(D),D),h=D;break;case 4:P=new Q(H[e],H[e+1]),R=new Q(H[e+2],H[e+3]),D=new Q(H[e+4],H[e+5]),e+=6,W=new S(h,P,R,D),h=D;break;case 5:if(!I)break;W=new S(h,h.clone(),I.clone(),I),h=null,I=null}W&&(W._index=X._curves.length,X._curves.push(W))}},Dr.prototype.checkPoint=function(n,E){var t,X,G,A,O,N=this,u=N._curves;for(t=0,X=u.length;X>t;t++)if(A=u[t],O=A.intersectRect(n,E,E),O.length)return G=0,O.forEach(function(g){G+=g.t}),G/=O.length,n=A.getPointAt(G),n.t=G,{bezier:A,intersection:n}},Dr.prototype.insertKnot=function(X,o){var R=X.insertKnot(o),n=this,x=n._curves;x.splice(X._index,1,R[0],R[1])},Dr.prototype._isCloseEnough=function(W,r){return Math.abs(W.x-r.x)<1e-6&&Math.abs(W.y-r.y)<1e-6},Dr.prototype._isSamePoint=function(Y,O){return Y===O},Dr.prototype.moveRealPoint=function(o,p){var t=this,f=t._curves,q=p.clone().sub(o);f.forEach(function($){var J=$._p1;$._p2,$._p3;var X=$._p4;t._isSamePoint(J,o)&&($._p2.add(q),$._p1=p),t._isSamePoint(X,o)&&($._p3.add(q),$._p4=p)})},Dr.prototype.moveCtrlPoint=function(z,R,n){var B=z[n];if(B){var L=this,W=L._curves;R.clone().sub(B),W.forEach(function(S){var G;"c2"===n?G="_p2":"c1"===n&&(G="_p3"),L._isSamePoint(S[G],B)&&(S[G]=R)}),z[n]=R}},Dr.prototype.deleteRealPoint=function(G,u){var f,m,z,M,o,j,E,g=this,I=g._curves,y={},p=[],H=ak.Math.CubicBezier;for(m=0,z=I.length;z>m;m++)f=I[m],M=f._p1,o=f._p2,j=f._p3,E=f._p4,(y[m]||!g._isSamePoint(M,G))&&(g._isSamePoint(E,G)?z>m+1&&g._isSamePoint(I[m+1]._p1,G)&&(u||p.push(new H(M,o,I[m+1]._p3,I[m+1]._p4))):p.push(f));g._curves=p},Dr.prototype.findPairs=function(J,i){var o,G,s,U,v,V,n,T,B=this,l=B._curves,Q={},X=[];for(G=0,s=l.length;s>G;G++)o=l[G],U=o._p1,v=o._p2,V=o._p3,n=o._p4,!Q[G]&&B._isSamePoint(U,J)&&(i?X.push({point:U,r2:n}):X.push({point:U,c2:v})),B._isSamePoint(n,J)&&(T=i?{point:n,r1:U}:{point:n,c1:V},s>G+1&&B._isSamePoint(l[G+1]._p1,J)&&(i?T.r2=l[G+1]._p4:T.c2=l[G+1]._p2,Q[G+1]=!0),X.push(T));return X},Dr.prototype.toHtShape=function(){var z=this,f=z._curves,d=[],J=[],g={x:1/0,y:1/0};return f.forEach(function(f){var S=f._p1,F=f._p2,l=f._p3,i=f._p4;return z._isCloseEnough(S,g)||(d.push(1),J.push(S.clone())),g=i,z._isCloseEnough(S,F)&&z._isCloseEnough(l,i)?(d.push(2),J.push(i.clone()),void 0):(d.push(4),J.push(F.clone(),l.clone(),i.clone()),void 0)}),{segments:d,points:J}};var Uh=ak.Math.CubicBezier=function(l,o,w,i){var N=this;N._id=ak.Math.CubicBezier._globalId++,N._p1=l,N._p2=o,N._p3=w,N._p4=i};Uh._globalId=1,Uh.prototype={},Uh.prototype.constructor=Uh,Uh.prototype.toString=function(){return this._id},Uh.prototype.intersectRect=function(y,F,p){var e=F/2,n=p/2,r=y.x,v=y.y,V=ak.Math.Vector2,S=new V(-e+r,-n+v),Y=new V(e+r,n+v),s=new V(Y.x,S.y),Q=new V(S.x,Y.y),P=this,U=P.intersectLine(S,s),L=P.intersectLine(s,Y),d=P.intersectLine(Y,Q),G=P.intersectLine(Q,S),w=U.concat(L).concat(d).concat(G);return w},Uh.prototype.intersectLine=function(m,h){var g,W,Y,Q,A,k,J,Z,n,z,r,o,i,j=this,M=m.clone().min(h),c=m.clone().max(h);Q=j._p1,A=j._p2,k=j._p3,J=j._p4,g=Q.clone().multiplyScalar(-1),W=A.clone().multiplyScalar(3),Y=k.clone().multiplyScalar(-3),r=g.add(W).add(Y).add(J),g=Q.clone().multiplyScalar(3),W=A.clone().multiplyScalar(-6),Y=k.clone().multiplyScalar(3),z=g.add(W).add(Y),g=Q.clone().multiplyScalar(-3),W=A.clone().multiplyScalar(3),n=g.add(W),Z=Q.clone(),i=new ak.Math.Vector2(m.y-h.y,h.x-m.x),o=m.x*h.y-h.x*m.y;for(var b=j.getRoots(i.dot(r),i.dot(z),i.dot(n),i.dot(Z)+o),S=new Array,_=0,p=b.length;p>_;_++){var B=b[_];if(!(0>B||B>1)){var L=Q.clone().lerp(A,B),y=A.clone().lerp(k,B),X=k.clone().lerp(J,B),I=L.lerp(y,B),V=y.lerp(X,B),e=I.lerp(V,B);e.t=B,m.x==h.x?M.y<=e.y&&e.y<=c.y&&S.push(e):m.y==h.y?M.x<=e.x&&e.x<=c.x&&S.push(e):e.x>=M.x&&e.y>=M.y&&e.x<=c.x&&e.y<=c.y&&S.push(e)}}return S},Uh.prototype.solveTForPoint=function(E){var O,k,c,N,h=this;O=h._p1.x-E.x,k=h._p2.x-E.x,c=h._p3.x-E.x,N=h._p4.x-E.x;for(var r=h.getRoots(N-3*c+3*k-O,3*c-6*k+3*O,3*k-3*O,O),g=K,l=1/0,Z=0,R=r.length;R>Z;Z++){var b=r[Z];if(!(0>b||b>1)){var M=h._p1.clone().lerp(h._p2,b),z=h._p2.clone().lerp(h._p3,b),s=h._p3.clone().lerp(h._p4,b),o=M.lerp(z,b),S=z.lerp(s,b),p=o.lerp(S,b);p.t=b;var L=Math.abs(p.y-E.y);l>L&&(l=L,g=p)}}return g},Uh.prototype.getPointAt=function(s){var T=this,G=T._p1,f=T._p2,J=T._p3,i=T._p4,H=G.clone().lerp(f,s),c=f.clone().lerp(J,s),l=J.clone().lerp(i,s),p=H.lerp(c,s),m=c.lerp(l,s);return p.lerp(m,s)},Uh.prototype.getRoots=function(Z,M,Q,m){var d,E,v,I,Y,D=new Array;if(Math.abs(Z)<1e-6){var d=M,E=Q/d,v=m/d,I=E*E-4*v;if(I>0){var Y=Math.sqrt(I);D.push(.5*(-E+Y)),D.push(.5*(-E-Y))}else 0==I&&D.push(.5*-E)}M/=Z,Q/=Z,m/=Z,d=(3*Q-M*M)/3,E=(2*M*M*M-9*Q*M+27*m)/27;var $=M/3,R=E*E/4+d*d*d/27,B=E/2;if(Math.abs(R)<=1e-6&&(R=0),R>0){var t,h,Y=Math.sqrt(R);t=-B+Y,h=t>=0?Math.pow(t,1/3):-Math.pow(-t,1/3),t=-B-Y,t>=0?h+=Math.pow(t,1/3):h-=Math.pow(-t,1/3),D.push(h-$)}else if(0>R){var a=Math.sqrt(-d/3),U=Math.atan2(Math.sqrt(-R),-B)/3,w=Math.cos(U),f=Math.sin(U),c=Math.sqrt(3);D.push(2*a*w-$),D.push(-a*(w+c*f)-$),D.push(-a*(w-c*f)-$)}else{var t;t=B>=0?-Math.pow(B,1/3):Math.pow(-B,1/3),D.push(2*t-$),D.push(-t-$)}return D},Uh.prototype._70I=function(){var M=this;return M._p1.distanceToSquared(M._p2)<1e-10&&M._p3.distanceToSquared(M._p4)<1e-10},Uh.prototype.insertKnot=function(V){var k=this,W=k._p1,q=k._p2,O=k._p3,Y=k._p4,f=W.clone().lerp(q,V),B=q.clone().lerp(O,V),g=O.clone().lerp(Y,V),u=f.clone().lerp(B,V),z=B.clone().lerp(g,V),Q=u.clone().lerp(z,V);return k._70I()?(W.clone().lerp(Y,V),[new ak.Math.CubicBezier(W,W.clone(),Q.clone(),Q),new ak.Math.CubicBezier(Q,Q.clone(),Y.clone(),Y)]):[new ak.Math.CubicBezier(W,f,u,Q),new ak.Math.CubicBezier(Q,z,g,Y)]};var tq=b.Default.getInternal().ui().EdgeUI,mo={_47O:function(d){var W=this,F=mo.getBackups()._47O;ak.inEdit(W.gv)||F.call(W,d)}};ak.Inject.registAsModule(mo,tq);var Gc=b.Default.getInternal().ui().NodeUI,Wr={_47O:function(Y){var f=this,U=Wr.getBackups()._47O;ak.inEdit(f.gv)||U.call(f,Y)},getSelectWidth:function(){var I=this,A=I.gv,Q=I._data;if(A.isEditable(Q)&&ak.inEdit(A))return 0;var z=Wr.getBackup("getSelectWidth");return z.call(I)}};ak.Inject.registAsModule(Wr,Gc);var lj=b.graph.GraphView,Ep={_editPointSize:function(){var X=b.Default.isTouchable,a=ak.getStyle("pointSize");return a[X?0:1]}(),isPointEditable:function(u){var I=this;if(ak.inEdit(I))return I._pointEditableFunc?I._pointEditableFunc(u):!0;var g=Ep.getBackup("isPointEditable");g.call(I,u)},isEditable:function(Z){var V,H=this,G=Ep.getBackup("isEditable");if(V=Z instanceof ak.Group?!0:G.call(H,Z),!ak.inEdit(H))return V;if(!(Z instanceof b.Edge))return V;if(!Z.s("2d.editable"))return!1;var r=H.getEditableFunc();return r?r(Z):!0},_42:function(z,k){var p=this,Q=Ep.getBackups()._42;if(Q.call(p,z,k),ak.inEdit(p)){var w=p.getEditInteractor();w.drawImpl()}}};ak.Inject.registAsModule(Ep,lj);var pc=b.Default.getInternal().ui().ShapeUI,Ld={_47O:function(O){var h=this,i=Ld.getBackups()._47O;ak.inEdit(h.gv)||i.call(h,O)}};ak.Inject.registAsModule(Ld,pc);var Lq=b.graph.DefaultInteractor,Gn={handle_mousewheel:function(S){var K=this,x=Gn.getBackup("handle_mousewheel");ak.inEdit(K.gv)||x.call(K,S)}};ak.Inject.registAsModule(Gn,Lq);var bd=b.graph.MoveInteractor,Rr={_calcShift:function(m,U){var O=this,A=Rr.getBackup("_calcShift"),d=O.gv;if(!ak.inEdit(d))return A.call(O,m,U);var f=d.getEditInteractor(),o=f.getSubModule("Move").calcShift(m,U,O);return o||A.call(O,m,U)},clear:function(G){var B=this,C=Rr.getBackup("clear");C.call(B,G);var z=B.gv;if(ak.inEdit(z)){var b=z.getEditInteractor();b.getSubModule("Move").clear(G)}}};ak.Inject.registAsModule(Rr,bd);var Qj=ak.Rect=function(c){this.catalog="Rect",this._interactor=c};Qj.prototype={},Qj.prototype.constructor=Qj,Qj.prototype.gatherInfo=function(q,y){var z=this;if(1===y.length){var p=y[0];return p instanceof b.Shape&&p._70I()?z.gatherLine(q,p):xo(p,q)?!1:z.gatherSingleTarget(q,p)}return y.length>1?z.gatherMultiTargets(q,y):!1},Qj.prototype.gatherSingleTarget=function(p,T){if(T.getCorners){var L,A=this.info;this.target=T,L=this.screenInfo={};var l=T.getCorners();A.LT=new ak.Math.Vector2(l[0]),A.LB=new ak.Math.Vector2(l[1]),A.RB=new ak.Math.Vector2(l[2]),A.RT=new ak.Math.Vector2(l[3]),A.T=A.LT.clone().add(A.RT).divideScalar(2),A.B=A.LB.clone().add(A.RB).divideScalar(2),A.L=A.LT.clone().add(A.LB).divideScalar(2),A.R=A.RT.clone().add(A.RB).divideScalar(2);for(var D in A)L[D]=ak.toScreenPosition(p,A[D]);var E=this._interactor.getStyle("checkSize"),W=function(R,P,A){var r=P.clone().sub(R).setLength(-E),t=A.clone().sub(R).setLength(-E),w=r.add(t).add(R);return w};return L.rotLT=W(L.LT,L.RT,L.LB),L.rotLB=W(L.LB,L.LT,L.RB),L.rotRB=W(L.RB,L.LB,L.RT),L.rotRT=W(L.RT,L.LT,L.RB),L.rotT=L.rotLT.clone().add(L.rotRT).divideScalar(2),L.rotB=L.rotLB.clone().add(L.rotRB).divideScalar(2),L.rotL=L.rotLT.clone().add(L.rotLB).divideScalar(2),L.rotR=L.rotRT.clone().add(L.rotRB).divideScalar(2),L.rotation=T.getRotation(),!0}},Qj.prototype.gatherMultiTargets=function(L,l){var U=ak.Group.findOrCreateGroup(l);if(!U)return!1;var B=this;return B.editing&&"rotate"!==B.editing.mode||U.calcInfo(),B.gatherSingleTarget(L,U)},Qj.prototype.gatherLine=function(Q,x){this.target=x;var y=this.screenInfo={},p=x.getPoints(),R=ak.getDataMatrix(x);return y.P1=ak.toScreenPosition(Q,R.apply(p.get(0))),y.P2=ak.toScreenPosition(Q,R.apply(p.get(1))),!0},Qj.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Qj.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Qj.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Qj.prototype.check=function(N,O,Z){if(b.Default.isLeftButton(O)){var h=this;if(h.editing=null,h.tipInfo=null,h.screenInfo){if(h.screenInfo.P1)return h._checkLine(Z);var P,y,o,i=null,p=h._interactor,U=p.getStyle("checkSize"),n=h.target,G=N.isEditable(n);if(G&&N.isRectEditable(n))for(y=0;y<ak.Rect.ResizeKeys.length;y++)if(o=ak.Rect.ResizeKeys[y],ak.checkHit(Z,h.screenInfo[o],U)){i=o,P="resize";break}if(!i&&G&&N.isRotationEditable(n)){var x=p.getStyle("rotateCheckSize");for(y=0;y<ak.Rect.RotateKeys.length;y++)if(o=ak.Rect.RotateKeys[y],ak.checkHit(Z,h.screenInfo[o],x)){i=o,P="rotate";break}}if(!i)return p.setCursor("default"),void 0;if("rotate"===P){var s,r=N.lp(O);if(n instanceof ak.Group){var W=p.getStyle("groupRotateModeKey");"string"==typeof W&&(W=[W]);for(var Y=!1,E=0,k=W.length;k>E;E++)if(O[W[E]]){Y=!0;break}var $=p.getStyle("groupRotateModeDefault");s=Y?"batch"===$?"block":"batch":$}var c="batch"===s?n.getAnchor2():n.getPosition(),F=Math.atan2(r.y-c.y,r.x-c.x);p._setRotateCursor(F),h.editing={mode:P,key:i,pos:c,flipY:n.getScale().y<0,rotation:n.getRotation(),hitRot:F},s&&(h.editing.groupRotateMode=s)}else{var D=ak.Rect.ResizeKeys.indexOf(i),X=ak.Rect.ResizeDirection[D],J=Math.cos(n.getRotation()),t=Math.sin(n.getRotation()),q=X.x*Math.sign(n.getScale().x),j=X.y*Math.sign(n.getScale().y),S=Math.atan2(-t*q-J*j,J*q-t*j),g=(Math.round(S/(Math.PI/4))+8)%8,I=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][g];this._interactor.setCursor(I);var e=n.getWidth(),f=n.getHeight(),m=n.getAnchor();h.editing={mode:P,key:i,rect:{x:-e*m.x,y:-f*m.y,width:e,height:f},anchor:m,matrix:n.getMatrix()}}return i}}},Qj.prototype._checkLine=function(h){var i=this;i.screenInfo;var x,b=i._interactor.getStyle("checkSize");if(ak.checkHit(h,i.screenInfo.P1,b))x="P1";else{if(!ak.checkHit(h,i.screenInfo.P2,b))return this._interactor.setCursor("default"),void 0;x="P2"}return i.editing={mode:"line",key:x},x},Qj.prototype._fireEditEvent=function(Y,x){var $=this._interactor,X=this.editing;if(X){var r=X.mode;r="rotate"===r?"Rotation":r[0].toUpperCase()+r.slice(1),$.fi({kind:Y+"Edit"+r,event:x})}},Qj.prototype.startEdit=function(U,n){U.startDragging(n);var L=this,i=L.editing,A=L.target;return i?(L._fireEditEvent("begin",n),"rotate"===i.mode?(i.groupRotateMode&&A.beginRotate(i),void 0):(("line"===i.mode||A&&0===A.getRotation())&&(L._inSmartGuide=!0,L._interactor.rectGuide.gatherRects()),void 0)):void 0},Qj.prototype._46O=function(p){var J,R=this;R.editing&&(J=R.editing.groupRotateMode,R._fireEditEvent("end",p),R.editing=null),R.tipInfo=null,R._inSmartGuide&&(R._interactor.rectGuide.clear(),R._inSmartGuide=!1),J&&R.target&&R.target.endRotate()},Qj.prototype.handleEdit=function(c,o){var i=this,f=i.editing;if(f){var X,g,A,V,I,U,v=i.target,r=f.key,q=f.mode,l=i._interactor;if("rotate"===q){var N,h,k=c.lp(o),u=f.pos,d=Math.atan2(k.y-u.y,k.x-u.x);if(f.groupRotateMode?h=d-f.hitRot:(N=d-f.hitRot,h=f.rotation+N),h%=2*Math.PI,0>h&&(h+=2*Math.PI),!b.Default.isCtrlDown(o)){var C,p;As(o)?(C=l.getStyle("shiftRotateRound"),p=C/2):(C=l.getStyle("rotateRound"),p=l.getStyle("rotateSensitivity")),h=ak.roundTo(h,C,p)}f.groupRotateMode?(N=h-(f.lastRotation||0),0!==N&&(v.addRotation(N,f.groupRotateMode),f.lastRotation=h)):v.setRotation(h),l._setRotateCursor(d),h>Math.PI&&(h-=2*Math.PI);var Z=180*(h/Math.PI);Z=Z.toFixed(2),X=""+Z+""}else if("resize"===q){var K=f.rect;V=K.x,I=K.y;var R=K.width,e=K.height,$=f.anchor,E=f.matrix;g=c.lp(o);var S,w=As(o),j=i._unionPointMode1,W=i._unionPointMode2;if(i._inSmartGuide&&!b.Default.isCtrlDown(o)&&!w){var a;"L"===r||"R"===r?a="x":("T"===r||"B"===r)&&(a="y"),i._adsorbedToClosest(g,a),U=!0}S=E.tfi(g);var O;"LT"===r?(K=j(S,{x:V+R,y:I+e},R,e,w),O=9):"T"===r?(K=W({x:V,y:S.y},{x:V+R,y:I+e},R,e,w,"v"),O=1):"RT"===r?(K=j(S,{x:V,y:I+e},R,e,w),O=33):"L"===r?(K=W({x:S.x,y:I},{x:V+R,y:I+e},R,e,w,"h"),O=8):"R"===r?(K=W({x:V,y:I},{x:S.x,y:I+e},R,e,w,"h"),O=32):"LB"===r?(K=j(S,{x:V+R,y:I},R,e,w),O=12):"B"===r?(K=W({x:V,y:I},{x:V+R,y:S.y},R,e,w,"v"),O=4):"RB"===r&&(K=j(S,{x:V,y:I},R,e,w),O=36);var z=E.tf(K.x+K.width*$.x,K.y+K.height*$.y);v.setPosition(z),v.setSize(K.width,K.height),U&&(A=v.getRect(),l.rectGuide.gatherLines({node:v,x:A.x,y:A.y,w:A.width,h:A.height},a,O)),X=""+Math.round(K.width)+" * "+Math.round(K.height)}else if("line"===q){if(g=c.lp(o),As(o)){var t=v.getPoints(),y="P1"===r?t.get(1):t.get(0),s={x:g.x-y.x,y:g.y-y.y},T=l.getStyle("shiftLineRotateRound"),H=i._shiftDirList;if(!H||i._shiftRotateRound!==T){i._shiftRotateRound=T,i._shiftDirList=H=[];for(var F=0;F<Math.PI;F+=T)H.push({x:Y(F),y:B(F)})}for(var Q,m=0,G=0,M=H.length;M>G;G++){var P=H[G],n=P.x*s.x+P.y*s.y;Math.abs(n)>Math.abs(m)&&(m=n,Q=P)}g={x:y.x+Q.x*m,y:y.y+Q.y*m},l.rectGuide.clear()}else i._inSmartGuide&&!b.Default.isCtrlDown(o)&&(i._adsorbedToClosest(g),U=!0);var L=ak.getDataMatrix(v).applyInverse(g);v.setPoint("P1"===r?0:1,L,!0);var D=v.getPoints(),_=D.get(0),J=D.get(1);V=_.x-J.x,I=_.y-J.y,X=" "+Math.round(Math.sqrt(V*V+I*I))+" ",U&&(A=v.getRect(),l.rectGuide.gatherLines({node:v,x:A.x,y:A.y,w:A.width,h:A.height}))}var x=b.Default.getLogicalPoint(o,l._canvas);
x.x+=ak.Icons.TipShiftX,x.y+=ak.Icons.TipShiftY,i.tipInfo={helperPos:x,text:X,size:X.length},i._fireEditEvent("between",o)}},Qj.prototype._unionPointMode1=function(O,W,c,N,d){if(d&&c&&N){var e=O.x-W.x,J=O.y-W.y;Math.abs(e*N)<Math.abs(J*c)?(J=Math.sign(J)*Math.abs(e*N/c),O.y=W.y+J):(e=Math.sign(e)*Math.abs(J*c/N),O.x=W.x+e)}return b.Default.unionPoint(O,W)},Qj.prototype._unionPointMode2=function(y,J,_,z,h,R){var Z=b.Default.unionPoint(y,J);if(h&&_&&z){var E;"v"===R?(E=Z.x+Z.width/2,Z.width=_*Z.height/z,Z.x=E-Z.width/2):(E=Z.y+Z.height/2,Z.height=z*Z.width/_,Z.y=E-Z.height/2)}return Z},Qj.prototype._adsorbedToClosest=function(f,X){var B=this,O=B._interactor,x=O.rectGuide.findClosest(f,X),i=O.gridGuide.findClosest(f,X),N=1/0,g=1/0;x&&(isFinite(x.x)&&(N=x.x),isFinite(x.y)&&(g=x.y)),i&&(isFinite(i.x)&&Math.abs(i.x)<Math.abs(N)&&(N=i.x),isFinite(i.y)&&Math.abs(i.y)<Math.abs(g)&&(g=i.y)),isFinite(N)&&(f.x+=N),isFinite(g)&&(f.y+=g)},Qj.prototype._42=function(S,F,i){var O=this;O.info={},O.screenInfo=null;var W=O._interactor;if(!W.editDetail&&O.gatherInfo(F,i)){var f=O.editing?O.editing.groupRotateMode:null,V=O.screenInfo;"block"!==f&&(V.P1?ak.Icons.DrawIcon(W,S,ak.Icons.Line,O.screenInfo):ak.Icons.DrawIcon(W,S,ak.Icons.Rect,O.screenInfo),O.tipInfo&&ak.Icons.DrawIcon(W,S,ak.Icons.TipHelper,O.tipInfo)),O.target instanceof ak.Group&&O.target._42(W,S,F)}};var se=ak.Anchor=function(d){this.catalog="Anchor",this._interactor=d};se.prototype={},se.prototype.constructor=se,se.prototype.gatherInfo=function(w,y){var _=this;if(1===y.length){var C=y[0];if(!C.getAnchor)return;if(C instanceof b.Shape&&C._70I())return;if(xo(C,w))return;return _.gatherSingleTarget(w,y[0])}return y.length>1?_.gatherMultiTargets(w,y):!1},se.prototype.gatherSingleTarget=function(a,e){var g=this;return g.info.POS=e.getPosition(),g.screenInfo.POS=ak.toScreenPosition(a,g.info.POS),g.target=e,!0},se.prototype.gatherMultiTargets=function(e,N){var i=this,Q=ak.Group.findOrCreateGroup(N);return Q?(i.screenInfo.POS=ak.toScreenPosition(e,Q.getAnchor2()),i.target=Q,!0):!1},se.prototype.isVisible=function(){var i=this,X=i._interactor;if(X.getStyle("anchorVisible")===!1)return!1;var k=i.target;if(k){if(this.editing)return!0;var p=k.getAnchor(),s=X.getStyle("anchorOutsideVisibleThreshold");if(p.x<-s||p.x>1+s||p.y<-s||p.y>1+s)return!0;var I=k.getSize(),d=k.getScale(),t=Math.min(Math.abs(I.width*d.x),Math.abs(I.height*d.y));if(t*X.gv._zoom<X.getStyle("anchorHideThreshold"))return!1}return!0},se.prototype.check=function(J,t,F){if(b.Default.isLeftButton(t)){var A=this,x=A._interactor;if(A.isVisible()&&x.getStyle("anchorMovable")!==!1){A.editing=null,A.tipInfo=null;var X=A.target;if(X&&J.isAnchorEditable(X)&&J.isEditable(X)){var f;if(A.screenInfo&&(f=A.screenInfo.POS)&&ak.checkHit(F,new ak.Math.Vector2(f),x.getStyle("checkSize"))){if(X instanceof ak.Group)return A.editing={},!0;var n=X.getWidth(),V=X.getHeight(),K=X.getAnchor();return A.editing={rect:{x:-n*K.x,y:-V*K.y,width:n,height:V},anchor:K,matrix:X.getMatrix()},!0}}}}},se.prototype.startEdit=function(J,j){J.startDragging(j),J.fi({kind:"beginEditAnchor",event:j})},se.prototype._46O=function(P){var F=this;F.editing&&(F.editing=null,F._interactor.fi({kind:"endEditAnchor",event:P})),F.tipInfo=null},se.prototype.handleEdit=function(L,k){var V=this,X=V.target;if(X){var m=V.editing;if(m){var J=L.lp(k),v=V._interactor;if(X instanceof ak.Group)return X.setAnchor2(J),v._42(),void 0;var $=m.matrix,d=$.tfi(J),n=m.rect,s=(d.x-n.x)/n.width,z=(d.y-n.y)/n.height;if(!b.Default.isCtrlDown(k)){var P=v.getStyle("anchorRound"),F=v.getStyle("anchorSensitivity");s=ak.roundTo(s,P,F),z=ak.roundTo(z,P,F)}X.setAnchor(s,z,!0);var t=b.Default.getLogicalPoint(k,v._canvas);t.x+=ak.Icons.TipShiftX,t.y+=ak.Icons.TipShiftY;var C=""+s.toFixed(2)+", "+z.toFixed(2);V.tipInfo={helperPos:t,text:C,size:C.length},v.fi({kind:"betweenEditAnchor",event:k})}}},se.prototype._42=function(w,a,l){var e=this;e.info={},e.screenInfo={};var $=e._interactor;$.editDetail||e.gatherInfo(a,l)&&e.isVisible()&&(ak.Icons.DrawIcon($,w,ak.Icons.Anchor,e.screenInfo),e.tipInfo&&ak.Icons.DrawIcon($,w,ak.Icons.TipHelper,e.tipInfo))};var Dr=ak.Curve=function(v){this.catalog="Curve",this._interactor=v};Dr.prototype={},Dr.prototype.constructor=Dr,Dr.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Dr.prototype.setUp=function(){var e=this,A=e._interactor;A&&A.gv.mp(e._onGraphviewPropertyChanged,e)},Dr.prototype._onGraphviewPropertyChanged=function(G){("zoom"===G.property||"translateX"===G.property||"translateY"===G.property)&&this._handleDataChanged()},Dr.prototype.tearDown=function(){var O=this,A=O._interactor;A&&A.gv.ump(O._onGraphviewPropertyChanged,O)},Dr.prototype.canEnterEditDetailMode=function(){var i=this,p=i._interactor,Q=p._getValidSelection();if(1===Q.length){var E=Q[0],f=E instanceof b.Edge;if(E instanceof b.Shape||f){if(f){var e=E.s("edge.type");if(e&&"points"!==e)return}var s=p.gv;if(s.isPointEditable(E)&&s.isEditable(E))return i.target=E,!0}}},Dr.prototype.preHandleScroll=function(){var y=this.editing;return y&&y.inEdit?!0:void 0},Dr.prototype.getCurrentSelectintStatus=function(){var F=this;if(F.activing&&!F.activing.selections){if(F.activing.status!=K)return F.activing.status;var B=function(V){var l=F.activing.status;F.activing.status=V,F._interactor.fp("shapePointStatus",l,V)},r=ak.Curve.PointType,f=F.activing.point,L=F.activing.pairs;if(!L||1!==L.length)return B(r.Mirrored);var g=L[0],s=g.c1&&g.c1.isNearEnough(f),E=g.c2&&g.c2.isNearEnough(f);if(!g.c1||!g.c2)return s||E?B(r.Straight):B(r.Disconnected);if(s&&E)return B(r.Straight);if(s||E)return B(r.Asymmetric);var T=g.c1.clone().sub(f),X=g.c2.clone().sub(f);return Math.abs(T.x*X.y-T.y*X.x)>1e-5||T.x*X.x>0?B(r.Disconnected):Math.abs(T.length()-X.length())>1e-5?B(r.Asymmetric):B(r.Mirrored)}},Dr.prototype.handle_keydown=function(w){var y=this;if(y._interactor.editDetail){var d=ak.Curve.PointType;"1"===w.key?y.setCurrentSelectionStatus(d.Straight):"2"===w.key?y.setCurrentSelectionStatus(d.Mirrored):"3"===w.key?y.setCurrentSelectionStatus(d.Disconnected):"4"===w.key&&y.setCurrentSelectionStatus(d.Asymmetric)}},Dr.prototype.setCurrentSelectionStatus=function(c){var T=this;if(T.activing){var f=T.getCurrentSelectintStatus();if(null!==f&&f!==c){T.activing.status=c;var E=T.activing.point,B=T.activing.pairs;if(B&&1===B.length){var t=B[0],M=T.screenInfo.curve,p=ak.Curve.PointType,N=function(){T._writeToHt(),T._interactor.fp("shapePointStatus",f,c)};if(c===p.Straight)return M.moveCtrlPoint(t,E,"c1"),M.moveCtrlPoint(t,E,"c2"),N(),void 0;if(f===p.Straight){var a=M.findPairs(E,!0),H=a[0],Q=H.r1||E,o=H.r2||E,Y=o.clone().sub(Q).multiplyScalar(.25);return M.moveCtrlPoint(t,E.clone().sub(Y),"c1"),M.moveCtrlPoint(t,E.clone().add(Y),"c2"),N(),void 0}var u=t.c1,I=t.c2;if(u&&I){if(c===p.Mirrored)return M.moveCtrlPoint(t,E.clone().multiplyScalar(2).sub(I),"c1"),N(),void 0;if(c===p.Asymmetric&&f===p.Disconnected){var g=u.clone().sub(E).length(),Y=E.clone().sub(I).setLength(g).add(E);return M.moveCtrlPoint(t,Y,"c1"),N(),void 0}}T._interactor.fp("shapePointStatus",f,c)}}}},Dr.prototype._handleDataChanged=function(Y){var _=this;if(_.screenInfo&&_.target){var H=_._interactor;_.gatherSingleTarget(H.gv,_.target,!0),_.check(H.gv,null,Y?H._getLogicalPoint(Y):new ak.Math.Vector2(H._lastClientPoint)),H._42()}},Dr.prototype.gatherSingleTarget=function(O,d,A){var H,Z,S=this;S.screenInfo&&S.screenInfo.curve&&(Z=S.screenInfo.curve._curves);var c=S.editing;H=c?S.screenInfo:S.screenInfo={};var y,V,$=d instanceof b.Edge;$?(y=d.s("edge.segments"),V=d.s("edge.points")||new b.List):(y=d._58O,V=d._59O),H.S=y;var e=H.P=[],I=ak.getDataMatrix(d);if(V.each(function(o){o=I.apply(o);var Q=ak.toScreenPosition(O,o);e.push(Q.x,Q.y)}),$){var l=ak.toScreenPosition(O,d._lastSourcePoint),K=ak.toScreenPosition(O,d._lastTargetPoint);e.splice(0,0,l.x,l.y),e.push(K.x,K.y)}if(!H.S||!H.S.size()){H.S=new b.List,H.S.add(1);for(var X=0;X<e.length/2-1;X++)H.S.add(2)}if((!c||A)&&S.convertToCubicBezier(Z),S.activing&&(A||!S.editing||"realPoint"===S.editing.type)){var z=H.curve.findPairs(S.activing.point);S.activing.pairs=z}$&&"points"!==d.s("edge.type")&&S._writeToHt()},Dr.prototype._convertToNewPoint=function(h,V,l){var f,S,D;for(f=0,S=V.length;S>f;f++){if(D=V[f],D._p1.isNearEnough(h))return D._p1;if(D._p4.isNearEnough(h))return D._p4}if(l)for(f=0,S=Math.min(l.length,S);S>f;f++){if(D=l[f],D._p1===h)return V[f]._p1;if(D._p4===h)return V[f]._p4}},Dr.prototype.convertToCubicBezier=function(P){var I,A,l=this,Q=new ak.Math.Curve,F=l.screenInfo;if(Q.createFromHtShape(F.P,F.S),F.curve=Q,l.activing){var k=Q._curves;if(I=l.activing.point,A=l._convertToNewPoint(I,k,P),A&&(l.activing.point=A),l.activing.selections){var Z=-1,d=l.activing.selections;d.forEach(function(i){Z++,A=l._convertToNewPoint(i,k,P),A&&(d[Z]=A)})}}},Dr.prototype.check=function(d,v,_){if(!v||b.Default.isLeftButton(v)){var l=this;if(l._interactor.setCursor("default"),l.editing=null,l.highlight=null,l.tipInfo=null,l.screenInfo){if(kp())return l._interactor._42(),!0;if(l._checkEditCtrlPoint(_))return l._interactor._42(),!0;if(l._checkEditRealPoint(_))return l._interactor._42(),!0;var S=l.screenInfo.curve,y=S.checkPoint(_,l._interactor.getStyle("curveIntersectSize"));if(y){var J=l.highlight={};J.type="insertKnot",J.bezier=y.bezier,J.point=y.intersection}return l._interactor._42(),!0}}},Dr.prototype._checkEditRealPoint=function(Q){var H,g,V,t,R,M,Y=this,p=Y.screenInfo.curve._curves,j=Y._interactor.getStyle("curvePointIntersectSize"),d=1/0;for(j*=j,V=0,t=p.length;t>V;V++)H=p[V],R=H._p1,M=Q.distanceToSquared(R),d>M&&(d=M,g=R),R=H._p4,M=Q.distanceToSquared(R),d>M&&(d=M,g=R);if(d>j)return!1;var W=Y.highlight={};return W.type="changeRealPoint",W.point=g,Y.editing={type:"realPoint",point:g,shiftGuide:{point:g.clone(),dir:"x",limit:0}},Y._interactor.setCursor("crosshair"),!0},Dr.prototype._checkEditCtrlPoint=function(O){var G=this;if(G.activing&&!G.activing.selections){var $=G.getCurrentSelectintStatus();if($!==ak.Curve.PointType.Straight){var s=G.activing.pairs;if(s){var I=G._interactor.getStyle("curvePointIntersectSize");I*=I;var Q,m,S,p,U,n,P,A,l,Y=1/0;for(P=0,l=s.length;l>P;P++)for(p=s[P],A=0;2>A;A++)U=0===A?"c1":"c2",p[U]&&(n=O.distanceToSquared(p[U]),Y>n&&(Y=n,Q=p,m=P,S=U));if(Y>I)return!1;G.activing.hlpair=Q,G.activing.hltype=S;var e=G.highlight={};return e.type="changeCtrlPoint",e.point=Q[S],G.editing={type:"ctrlPoint",pair:Q,pairId:m,ctrlType:S,direction:Q[S].clone().sub(G.activing.point).normalize()},G._interactor.setCursor("crosshair"),!0}}}},Dr.prototype.startEdit=function(L,B){L.startDragging(B);var w=this;w.highlight&&"insertKnot"===w.highlight.type&&(w.insertKnot(),w.gatherSingleTarget(w._interactor.gv,w.target),w.activing=null,w._checkEditRealPoint(w._interactor._getLogicalPoint(B)));var t=w.highlight,k=b.Default.isCtrlDown(B);if(!t||kp()){var $=w._interactor.gv;if(!$.setFocus(B)||$._scrolling)return;return $.isPannable()&&Jm(B)&&!k&&(w._pan={tx:$.tx(),ty:$.ty()},L.fi({kind:"beginPan",event:B})),void 0}if("changeRealPoint"===t.type){var x,K=w.activing?w.activing.point:null,y=w.activing?w.activing.selections:null;if(k&&w.activing)K===t.point?(y?(w.activing={point:y[0]},y.length>1&&(y.splice(0,1),w.activing.selections=y)):w.activing=null,w.editing=null):y&&(x=y.indexOf(t.point))>=0?(y.length>1?y.splice(x,1):delete w.activing.selections,w.editing=null):y?(y.push(K),w.activing={point:t.point,selections:y}):w.activing={point:t.point,selections:[K]};else if(y)K===t.point||((x=y.indexOf(t.point))>=0?(y.splice(x,1,K),w.activing={point:t.point,selections:y}):w.activing={point:t.point});else{var h;K===t.point&&(h=w.activing.status),w.activing={point:t.point},h&&(w.activing.status=h)}L.fi({kind:"beginEditPoint",event:B})}},Dr.prototype.insertKnot=function(){var P=this,m=P.highlight,j=P.screenInfo.curve;j.insertKnot(m.bezier,m.point.t),P._writeToHt()},Dr.prototype._writeToHt=function(){for(var S,G,t=this,N=t.screenInfo.curve,a=N.toHtShape(),V=a.points,c=[],I=a.segments,P=t._interactor.gv,w=t.target,s=w instanceof b.Edge,z=ak.getDataMatrix(w).invert(),B=0,D=V.length;D>B;B++)S=V[B],G=ak.toWorldPosition(P,S),G=z.apply(G),c.push(G);if(w._writing=!0,s){w.s("edge.type","points"),w.setStyle("edge.segments",I),w.setStyle("edge.points",c.slice(1,c.length-1)),w.setStyle("edge.source.offset.x",0),w.setStyle("edge.source.offset.y",0),w.setStyle("edge.target.offset.x",0),w.setStyle("edge.target.offset.y",0);var i=t._nextChangeEdgeHost;delete t._nextChangeEdgeHost,i&&("source"===i.type?w.setSource(i.host):w.setTarget(i.host)),t._writeEdgeHostAnchor("source",c[0]),t._writeEdgeHostAnchor("target",c[c.length-1])}else c.length?(w.setSegments(I),w.setPoints(c,!0)):w.removeFromDataModel();delete w._writing},Dr.prototype._writeEdgeHostAnchor=function(z,J){var W=this,I=W.target,Q=W._calcHostAnchor(I,z,J);I.s("edge."+z+".anchor.x",Q.x),I.s("edge."+z+".anchor.y",Q.y)},Dr.prototype._calcHostAnchor=function(b,W,N,t){t||(t="source"===W?b.getSource():b.getTarget());var q=t.getRotation(),i=t.getAnchor(),Q=this._interactor.gv;if(xo(t,Q)&&(q=0),q){var S=t.getMatrix(),u=S.tfi(N),L=t.getSize();return{x:u.x/L.width+i.x,y:u.y/L.height+i.y}}var P=pf(Q,t),K={x:(N.x-P.x)/P.width,y:(N.y-P.y)/P.height};return K},Dr.prototype._handlePanning=function(_){var B=this,W=B._pan;if(W){W.started=!0;var D=B._interactor,K=D.gv,x=D._lastClientPoint,z=ib(_);K.setTranslate(W.tx+z.x-x.x,W.ty+z.y-x.y),B.gatherSingleTarget(D.gv,B.target),D._42(),D.fi({kind:"betweenPan",event:_})}},Dr.prototype.handleEdit=function(n,E){var M=this,k=M.editing;if(M._pan)return M._handlePanning(E),void 0;if(k){k.inEdit=!0;var s,l,Y=M._interactor._getLogicalPoint(E),C=b.Default.isCtrlDown(E),g=b.Default.isShiftDown(E);if(M._guideInfo=null,"ctrlPoint"===k.type&&g){var O=M.editing.direction.clone();s=M.activing.point;var J=O.dot(Y.clone().sub(s));Y=O.setLength(J).add(s)}else{var O;if("realPoint"===k.type&&g){var e=M.editing.shiftGuide,L=e.point,o=Math.abs(Y.x-L.x),t=Math.abs(Y.y-L.y);o>t&&o>e.limit&&"y"===e.dir&&(e.dir="x"),t>o&&t>e.limit&&"x"===e.dir&&(e.dir="y"),O=e.dir,"x"===O?(Y.y=L.y,e.limit=Math.max(e.limit,o)):"y"===O&&(Y.x=L.x,e.limit=Math.max(e.limit,t))}var P=M._isEditEdgeSourceTarget();if(P){var W=M._editEdgeSourceTarget(P,Y,C);W&&(l=W.tipText)}else if(!C){var d=M._guidingToEdit(Y,O),$="realPoint"===k.type?M._interactor.gridGuide.findClosest(Y,O,!0):null,K=1/0,N=1/0;$&&($.x&&(K=$.x),$.y&&(N=$.y));var c=!1;d&&(d.xList&&(Math.abs(d.x)<=Math.abs(K)?(c=!0,K=d.x):delete d.xList),d.yList&&(Math.abs(d.y)<=Math.abs(N)?(c=!0,N=d.y):delete d.yList),c&&(M._guideInfo=d)),isFinite(K)&&(Y.x+=K),isFinite(N)&&(Y.y+=N),c&&(d.v=Y)}}var B=M.screenInfo.curve;if("realPoint"===k.type){s=k.point,B.moveRealPoint(s,Y),k.point=Y,M.highlight.point=Y;var D=M.activing.status,I=M.activing.selections;if(M.activing={point:Y,status:D},I){var r=Y.clone().sub(s),U=0;I.forEach(function(k){var M=k.clone().add(r);B.moveRealPoint(k,M),I[U++]=M}),M.activing.selections=I}}else if("ctrlPoint"===k.type){var q=M.activing,w=q.pairs,v=w[k.pairId];B.moveCtrlPoint(v,Y,k.ctrlType);var Z=q.status,T=ak.Curve.PointType;if((Z===T.Mirrored||Z===T.Asymmetric)&&v.c1&&v.c2){var s=new ak.Math.Vector2(q.point),G="c1"===k.ctrlType?"c2":"c1";if(Z===ak.Curve.PointType.Mirrored)B.moveCtrlPoint(v,s.clone().multiplyScalar(2).sub(Y),G);else if(Z===T.Asymmetric){var J=v[G].clone().sub(s).length(),i=s.clone().sub(v[k.ctrlType]).setLength(J).add(s);isNaN(i.x)||B.moveCtrlPoint(v,i,G)}}}var h=b.Default.getLogicalPoint(E,M._interactor._canvas);if(h.x+=ak.Icons.TipShiftX,h.y+=ak.Icons.TipShiftY,!l){var x=ak.toWorldPosition(n,Y);l=""+ak.toFixed(x.x)+", "+ak.toFixed(x.y)}M.tipInfo={helperPos:h,text:l,size:l.length},M._writeToHt(),M._interactor.fi({kind:"betweenEditPoint",event:E})}},Dr.prototype._isEditEdgeSourceTarget=function(){var P=this,l=P.target;if(!(l instanceof b.Edge))return!1;var R=P.editing.point,y=P.screenInfo.curve._curves;return R===y[0]._p1?"source":R===y[y.length-1]._p4?"target":!1},Dr.prototype._editEdgeSourceTarget=function(_,r,T){var K,i=this,o=i.target;if(K="source"===_?o.getSource():o.getTarget()){var O=i._interactor.gv,G=ak.toWorldPosition(O,r),h=i._calcHostAnchor(o,_,G,K);if(!T){var p=i._interactor.getStyle("anchorRound"),m=i._interactor.getStyle("anchorSensitivity");h.x=ak.roundTo(h.x,p,m),h.y=ak.roundTo(h.y,p,m)}if(i._interactor.getStyle("edgeHostDetectPerFrame")||h.x<0||h.x>1||h.y<0||h.y>1){var s=O.getDataAt(G,function(S){return O.isSelectable(S)?Or(S)?!0:!1:!1});if(s){var M=i._calcHostAnchor(o,_,G,s);K=s,i._nextChangeEdgeHost={type:_,host:s},h=M,T||(h.x=ak.roundTo(h.x,p,m),h.y=ak.roundTo(h.y,p,m))}}if(!T){var l=Sp(O,K,0,0,0,h.x,h.y),e=ak.toScreenPosition(O,l);r.x=e.x,r.y=e.y}var $,j=[];if(xo(K,O)){var A=pf(O,K);$=[{x:A.x,y:A.y},{x:A.x+A.width,y:A.y},{x:A.x+A.width,y:A.y+A.height},{x:A.x,y:A.y+A.height}]}else $=K.getCorners();return $.forEach(function(z){var I=ak.toScreenPosition(O,z);j.push(I.x,I.y)}),i._edgeHostGuideInfo=j,{host:K,anchor:h,tipText:""+h.x.toFixed(2)+", "+h.y.toFixed(2)}}},Dr.prototype._guidingToEdit=function(X,U){var J,r,o=this;if(J=o.screenInfo.curve){r=J._curves;var s,B,K,p,W,e,D,E,b=1/0,z=1/0,h=[];for(o.editing&&"realPoint"===o.editing.type&&(E=o.editing.point),W=0,e=2*r.length;e>W;W++)D=r[Math.floor(W/2)][W%2?"_p4":"_p1"],h.indexOf(D)>=0||(h.push(D),E&&E===D||(K=D.x-X.x,p=D.y-X.y,Math.abs(K)<Math.abs(b)?(b=K,s=[D]):K===b&&s.push(D),Math.abs(p)<Math.abs(z)?(z=p,B=[D]):p===z&&B.push(D)));var l=o._interactor.getStyle("smartGuideSensitivity");if((Math.abs(b)>l||"y"===U)&&(s=null),(Math.abs(z)>l||"x"===U)&&(B=null),s||B){var S=!1,u={};if(s&&(S=!0,u.xList=s,u.x=b),B&&(S=!0,u.yList=B,u.y=z),S)return u}}},Dr.prototype._46O=function(f){var J=this;J.editing&&(J.editing=null,J._interactor.fi({kind:"endEditPoint",event:f})),J._guideInfo=null,J._edgeHostGuideInfo=null,J._pan&&(J._pan=null,J._interactor.fi({kind:"endPan",event:f})),J.tipInfo=null},Dr.prototype._canDeletePoint=function(d,I){var N=this.target;if(!(N instanceof b.Edge))return!0;var c=d._curves[0],P=d._curves[d._curves.length-1];return c._p1===I||P._p4===I?!1:!0},Dr.prototype.handleDelete=function(){var $=this;if($.activing&&$.screenInfo){var X=b.Default.isShiftDown(),f=$.screenInfo.curve;$._canDeletePoint(f,$.activing.point)&&f.deleteRealPoint($.activing.point,X),$.activing.selections&&$.activing.selections.forEach(function(c){$._canDeletePoint(f,c)&&f.deleteRealPoint(c,X)}),delete $.activing,delete $.editing,delete $.tipInfo,delete $._pan,$._writeToHt(),$._interactor.fp("deleteShapePoint",!1,!0)}},Dr.prototype.handleDoubleClick=function(A){var d=this,H=d._interactor._getLogicalPoint(A);if(d.screenInfo&&d._checkEditRealPoint(H)){var V=d.getCurrentSelectintStatus(),k=ak.Curve.PointType;return V=V===k.Mirrored?k.Straight:k.Mirrored,d.setCurrentSelectionStatus(V),d._interactor._42(),!0}},Dr.prototype._drawHighlight=function(h){var x=this,e=x.highlight;if(e){var m=e.bezier,v=x._interactor;m&&ak.Icons.DrawIcon(v,h,ak.Icons.ShapeHighlightCurve,[m._p1.x,m._p1.y,m._p2.x,m._p2.y,m._p3.x,m._p3.y,m._p4.x,m._p4.y]);var H=e.point;H&&"insertKnot"===e.type&&ak.Icons.DrawIcon(v,h,ak.Icons.ShapeHighlighPoint,H)}},Dr.prototype._drawGuide=function(l){var R=this,z=R._guideInfo;if(z){var E,y,e,C,X=z.v;for(E=0;2>E;E++)if(C=0===E?z.xList:z.yList)for(y=0,e=C.length;e>y;y++)ak.Icons.DrawIcon(R._interactor,l,ak.Icons.ShapeGuideLine,[X.x,X.y,C[y].x,C[y].y])}},Dr.prototype._drawCurrentPoint=function(x){var C=this;if(C.activing){var N=C.activing,i=C.getCurrentSelectintStatus(),J=C._interactor;if(i!==ak.Curve.PointType.Straight){var o=N.pairs,K=N.hlpair,b=N.hltype,H=N.selections;if(o&&!H){var u,e,t;for(e=0,t=o.length;t>e;e++)u=o[e],e===K&&u[b]?ak.Icons.DrawIcon(J,x,ak.Icons.ShapeActivingCtrl,{point:u.point,c1:u.c1,c2:u.c2,hl:b}):ak.Icons.DrawIcon(J,x,ak.Icons.ShapeActivingCtrl,u)}}ak.Icons.DrawIcon(J,x,ak.Icons.ShapeHighlighRealPoint,C.activing.point),H&&H.forEach(function(K){ak.Icons.DrawIcon(J,x,ak.Icons.ShapeHighlighRealPoint,K)})}},Dr.prototype.clear=function(){var Y=this;Y.editing=null,Y._guideInfo=null,Y.activing=null,Y.highlight=null},Dr.prototype._42=function(c){var P=this;P.info={},P.editing||(P.screenInfo=null);var T=P._interactor;return T.editDetail?P.target&&P._interactor.gv.isSelected(P.target)&&P._interactor.gv.isVisible(P.target)?(P.gatherSingleTarget(T.gv,P.target),ak.Icons.DrawIcon(T,c,ak.Icons.ShapeBgCurve,P.screenInfo),P._drawHighlight(c),P._drawCurrentPoint(c),P._getRealPoint().forEach(function(w){ak.Icons.DrawIcon(T,c,ak.Icons.ShapePoint,w)}),P._drawGuide(c),P.tipInfo&&ak.Icons.DrawIcon(T,c,ak.Icons.TipHelper,P.tipInfo),P._edgeHostGuideInfo&&ak.Icons.DrawIcon(T,c,ak.Icons.EdgeHostGuide,P._edgeHostGuideInfo),void 0):(T.editDetail=!1,P.clear(),void 0):(P.clear(),void 0)},Dr.prototype._getRealPoint=function(){var M=this.screenInfo,m=M.P,X=M.S,d=-1,K=[];return X.each(function(e){var H=1;if(3===e)H=2;else if(4===e)H=3;else if(5===e)return;d+=H,K.push({x:m[2*d],y:m[2*d+1]})}),K};var Sf=ak.MoveHelper=function(A){var X=this;X.catalog="Move",X._interactor=A};Sf.prototype={},Sf.prototype.constructor=Sf,Sf.prototype.calcShift=function(g,K,p){var k,Y,m=this,A=m._interactor.gv,T=A.lp(K);if("beginMove"===g&&m._gatherGridInfo(p._lastLogicalPoint||T),k=m._target){var O=k.downPosition;if(O){var E=m._interactor.getStyle("moveSensitivity")/A._zoom;if(O.distanceTo(T)<E)return{x:0,y:0};delete k.downPosition}var W;Y=b.Default.isShiftDown(K),Y&&(T=m._dealShiftDown(T),W=k.shiftGuide.dir);var a,G=k.rawPos={x:k.pos.x+T.x-k.lp.x,y:k.pos.y+T.y-k.lp.y};if(b.Default.isCtrlDown(K)){if(a=m._calcShiftByAddon(),m._target.node instanceof ak.Group){var w=m._target.node;w._position.x+=a.x,w._position.y+=a.y}return a}for(var Q,y=k.x+G.x,P=k.y+G.y,C={x:y,y:P},n={x:y+k.w/2,y:P+k.h/2},t={x:y+k.w,y:P+k.h},q=m._interactor.rectGuide,I=m._interactor.gridGuide,M=[q.findClosest(C,W),q.findClosest(n,W),q.findClosest(t,W),I.findClosest(C,W),I.findClosest(n,W),I.findClosest(t,W)],f=1/0,D=1/0,l=0,i=M.length;i>l;l++)Q=M[l],Q&&(y=Q.x,P=Q.y,isFinite(y)&&Math.abs(y)<Math.abs(f)&&(f=y),isFinite(P)&&Math.abs(P)<Math.abs(D)&&(D=P));if(isFinite(f)||(f=0),isFinite(D)||(D=0),a=m._calcShiftByAddon(f,D),m._target.node instanceof ak.Group){var w=m._target.node;w._position.x+=a.x,w._position.y+=a.y}var d=k.node;if(!xo(d,A)){var u=G.x+f,R=G.y+D;m._interactor.rectGuide.gatherLines({node:d,x:k.x+u,y:k.y+R,w:k.w,h:k.h},W)}return a}},Sf.prototype._calcShiftByAddon=function(R,E){var v=this._target,t=v.rawPos,B=v.node.getPosition();return R=R||0,E=E||0,{x:t.x-B.x+R,y:t.y-B.y+E}},Sf.prototype._dealShiftDown=function(y){var L=this,m=L._target.shiftGuide,w=L._target.lp,f=Math.abs(y.x-w.x),$=Math.abs(y.y-w.y);f>$&&f>m.limit&&"y"===m.dir&&(m.dir="x"),$>f&&$>m.limit&&"x"===m.dir&&(m.dir="y");var F=m.dir;return"x"===F?(y.y=w.y,m.limit=Math.max(m.limit,f)):"y"===F&&(y.x=w.x,m.limit=Math.max(m.limit,$)),y},Sf.prototype._gatherGridInfo=function(X){var r,f=this,m=f._interactor,g=m._getValidSelection();if(1===g.length){if(r=g[0],!r.getRect)return f._target=null,void 0}else if(r=ak.Group.findOrCreateGroup(g),!r)return f._target=null,void 0;var n=r.getPosition(),R=r.getRect();f._target={node:r,x:R.x-n.x,y:R.y-n.y,w:R.width,h:R.height,lp:{x:X.x,y:X.y},pos:{x:n.x,y:n.y},shiftGuide:{dir:"x",limit:0},downPosition:new ak.Math.Vector2(X)},m.rectGuide.gatherRects()},Sf.prototype.clear=function(){var H=this;H._interactor.rectGuide.clear(),H._interactor._42()};var Ao="directional",zj="point",om="spot",Kk="light.color",wh=function(C,j){Xr(j)&&ue.test(j)?Gg(C,j):Ip[C]=j},Pr=function(J){var R=Ip[J];return J&&R===K&&ue.test(J)&&(Td&&Td[J]||Gg(J,J)),R};Jn(y,{graph3dViewAttributes:E,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:z/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:_j,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:z/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:wh,getShape3dModel:Pr,createMatrix:function(w,e){_n(w)||(w=[w]);for(var x=w.length-1;x>=0;x--){var f=w[x];e=Zb(f.mat,f.s3,f.r3,f.rotationMode,f.t3,e)}return e},transformVec:function(H,h){return nf(H,h)},createBoxModel:function(){return{vs:Ag,ns:Tg,uv:io,is:_d}},createRoundRectModel:function(H,K){return Qg.roundRect(H,K)},createStarModel:function(v,W){return Qg.star(v,W)},createRectModel:function(k,Q){return Qg.rect(k,Q)},createTriangleModel:function(W,R){return Qg.triangle(W,R)},createRightTriangleModel:function(G,r){return Qg.rightTriangle(G,r)},createParallelogramModel:function(e,h){return Qg.parallelogram(e,h)},createTrapezoidModel:function(P,O){return Qg.trapezoid(P,O)},createSmoothSphereModel:function(b,s,w,R,k,j,N){return Hh(new Um(b,s,w,R,k,j,N))},createSphereModel:function(B,Q,c,P,K,F){return B?Jc(B,Q,c,P,K,F):y.createSmoothSphereModel()},createSmoothConeModel:function(t,Y,I,$,N){return $h(t,Y,I,$,N)},createConeModel:function(m,o,e,M,r,F){return m?Wp(m,o,e,M,r,F):$h(F)},createSmoothCylinderModel:function(X,x,u,O,q,Q,S,M){return Hh(new Lb(X,x,u,O,q,Q,S,M))},createCylinderModel:function(N,r,h,t,c,b,l){return N?wg(N,r,h,t,c,b,l):Mg(b,l)},createSmoothTorusModel:function(E,s,X,c,j,F){return Hh(new Pm(E,s,X,c,j,F))},createTorusModel:function(G,i,V,c,t,x,H){return G?sd(G,i,V,c,t,x,H):yl(x,H)},createExtrusionModel:function(A,H,o,D,g,K,e,C){return Dg(A,H,o,D,g,K,e,C)},createSmoothRingModel:function(I,W,F,k,s,z){for(var E=[],m=0;m<I.length-1;m+=2)E.push({x:I[m],y:I[m+1]});for(I=dd(E,W,F)[0],E=[],m=0;m<I.length;m++){var H=I[m];E.push(new Iq(H.x,0,H.y))}return Hh(new ul(E,z,k,s))},createTextGeometry:function(F,_){return Hh(new jh(F,_))},loadFontFace:function(E,U){y.xhrLoad(E,function(H){if(!H)return U();var V;try{V=JSON.parse(H)}catch(L){V=JSON.parse(H.substring(65,H.length-2))}Cf.loadFace(V),U&&U(V.familyName.toLowerCase())},U?null:{sync:!0})},getRotationFromMatrix4:function(c,I){var h=G,M=c[0],A=c[4],l=c[8],p=c[1],H=c[5],B=c[9],g=c[2],x=c[6],F=c[10];I=I||"xyz",I=I[2]+I[1]+I[0],I=I.toUpperCase();var _={};if("XYZ"===I)_._y=Math.asin(h(l,-1,1)),Math.abs(l)<.99999?(_._x=Math.atan2(-B,F),_._z=Math.atan2(-A,M)):(_._x=Math.atan2(x,H),_._z=0);else if("YXZ"===I)_._x=Math.asin(-h(B,-1,1)),Math.abs(B)<.99999?(_._y=Math.atan2(l,F),_._z=Math.atan2(p,H)):(_._y=Math.atan2(-g,M),_._z=0);else if("ZXY"===I)_._x=Math.asin(h(x,-1,1)),Math.abs(x)<.99999?(_._y=Math.atan2(-g,F),_._z=Math.atan2(-A,H)):(_._y=0,_._z=Math.atan2(p,M));else if("ZYX"===I)_._y=Math.asin(-h(g,-1,1)),Math.abs(g)<.99999?(_._x=Math.atan2(x,F),_._z=Math.atan2(p,M)):(_._x=0,_._z=Math.atan2(-A,H));else if("YZX"===I)_._z=Math.asin(h(p,-1,1)),Math.abs(p)<.99999?(_._x=Math.atan2(-B,H),_._y=Math.atan2(-g,M)):(_._x=0,_._y=Math.atan2(l,F));else{if("XZY"!==I)return null;_._z=Math.asin(-h(A,-1,1)),Math.abs(A)<.99999?(_._x=Math.atan2(x,H),_._y=Math.atan2(l,M)):(_._x=Math.atan2(-B,F),_._y=0)}return[_._x,_._y,_._z]},createRingModel:function(G,x,e,m,v,j,T,o,$,c){for(var k=[],X=0;X<G.length-1;X+=2)k.push({x:G[X],y:G[X+1]});j=j||y.shapeSide,T=T||0,o=o||j;var h,q,Q,l,s,L,H,u,C,J,X,g,r,D,A,d,S,P,t=[],I=[],N=$?[]:E,K=$?[]:E,V=c?[]:E,O=c?[]:E,M=m?[]:E,w=m?[]:E,p=v?[]:E,f=v?[]:E,G=dd(k,x,e),i=vh(G),n=0,Z=2*Math.PI/j;return G.forEach(function(W){if(Q=W.length,Q>1){if(l=W[0],m)for(L=l.x,u=l.y,X=T;o>X;X++)g=X+1,r=X*Z,D=g*Z,A=B(r),d=Y(r),S=B(D),P=Y(D),M.push(A*L,u,-d*L,S*L,u,-P*L,0,u,0),w.push(.5-.5*A,.5-.5*d,.5-.5*S,.5-.5*P,.5,.5);for(J=0;Q>J;J++){for(s=W[J],L=l.x,H=s.x,u=l.y,C=s.y,h=n/i,n+=tm(l,s),q=n/i,X=T;o>X;X++)g=X+1,r=X*Z,D=g*Z,A=B(r),d=Y(r),S=B(D),P=Y(D),t.push(A*H,C,-d*H,S*H,C,-P*H,A*L,u,-d*L,S*H,C,-P*H,S*L,u,-P*L,A*L,u,-d*L),I.push(X/j,q,g/j,q,X/j,h,g/j,q,g/j,h,X/j,h),$&&X===T&&(N.push(0,u,0,0,C,0,A*H,C,-d*H,A*H,C,-d*H,A*L,u,-d*L,0,u,0),K.push(0,.5-u,0,.5-C,2*H,.5-C,2*H,.5-C,2*L,.5-u,0,.5-u)),c&&g===o&&(V.push(0,u,0,S*H,C,-P*H,0,C,0,S*H,C,-P*H,0,u,0,S*L,u,-P*L),O.push(1,.5-u,1-2*H,.5-C,1,.5-C,1-2*H,.5-C,1,.5-u,1-2*L,.5-u));l=s}if(v)for(L=l.x,u=l.y,X=T;o>X;X++)g=X+1,r=X*Z,D=g*Z,A=B(r),d=Y(r),S=B(D),P=Y(D),p.push(S*L,u,-P*L,A*L,u,-d*L,0,u,0),f.push(.5-.5*S,.5+.5*P,.5-.5*A,.5+.5*d,.5,.5)}}),{vs:t,uv:I,bottom_vs:p,bottom_uv:f,top_vs:M,top_uv:w,from_vs:N,from_uv:K,to_vs:V,to_uv:O}}},!0),Jn($,{"3d.move.mode":K,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":K,"edge.gradient.color":K,"edge.source.t3":K,"edge.target.t3":K,"light.type":zj,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":z/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Lc,"wf.short":!1,"wf.mat":K,batch:K,"transparent.mask":!1,brightness:K,"select.brightness":.7,"repeat.uv.length":K,alphaTest:.4,"label.face":oh,"label.t3":K,"label.r3":K,"label.texture.scale":2,"label.rotationMode":uj,"label.light":!1,"label.blend":K,"label.reverse.flip":!1,"label.reverse.color":Dq,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":oh,"label2.t3":K,"label2.r3":K,"label2.texture.scale":2,"label2.rotationMode":uj,"label2.light":!1,"label2.blend":K,"label2.reverse.flip":!1,"label2.reverse.color":Dq,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":oh,"note.t3":K,"note.r3":K,"note.texture.scale":2,"note.rotationMode":uj,"note.light":!1,"note.blend":K,"note.reverse.flip":!1,"note.reverse.color":Dq,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":oh,"note2.t3":K,"note2.r3":K,"note2.texture.scale":2,"note2.rotationMode":uj,"note2.light":!1,"note2.blend":K,"note2.reverse.flip":!1,"note2.reverse.color":Dq,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:K,"shape3d.color":Yd,"shape3d.top.color":K,"shape3d.bottom.color":K,"shape3d.from.color":K,"shape3d.to.color":K,"shape3d.image":K,"shape3d.top.image":K,"shape3d.bottom.image":K,"shape3d.from.image":K,"shape3d.to.image":K,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":K,"shape3d.side.to":K,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":K,"shape3d.opacity":K,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Dq,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":K,"shape3d.uv.scale":K,"shape3d.top.uv.offset":K,"shape3d.top.uv.scale":K,"shape3d.bottom.uv.offset":K,"shape3d.bottom.uv.scale":K,"shape3d.from.uv.offset":K,"shape3d.from.uv.scale":K,"shape3d.to.uv.offset":K,"shape3d.to.uv.scale":K,"shape3d.top.cap":K,"shape3d.bottom.cap":K,"shape3d.start.angle":0,"shape3d.sweep.angle":I,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"all.light":!0,"all.visible":!0,"all.color":Yd,"all.image":K,"all.blend":K,"all.opacity":K,"all.reverse.flip":!1,"all.reverse.color":Dq,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":K,"all.uv.offset":K,"all.uv.scale":K,"all.discard.selectable":!0,mat:K,"left.mat":K,"right.mat":K,"top.mat":K,"bottom.mat":K,"front.mat":K,"back.mat":K},!0);var wj,Pk=!1,Vk=[0,0,0,0],js={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:nl,2:yf,3:lf,4:ec,5:oh,6:_g}},vl=function(v,p,G,w){if(p.getFaceVisible(v,G)){cl(p,rp(v,p.getFaceMat(v,G)||p.getMat(v)));
var s=p._26I;p.getFaceReverseCull(v,G)?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),of(s,p._prg.uFixPickReverseColor,js[G]),Ap(s),zb(s,w,6),Oi(s),wp(p)}},Ee=function(B){return B instanceof qm},vg=function(X){return[X.x,X.e||0,X.y]},ad=function(d,M,J){for(var M=pe(M),q=M[0],B=M[1],y=M[2];J--;)d.push(q,B,y)},Xn=function(y,o,J){for(var o=pe(o),r=o[0],D=o[1],w=o[2],V=o[3];J--;)y.push(r,D,w,V)},Xp=function(j,U,M){if(U)for(var K,v,g,$=U[0],i=U[1],V=U[2],w=U[4],q=U[5],F=U[6],X=U[8],C=U[9],T=U[10],Q=U[12],u=U[13],G=U[14],t=M.length,c=0,c=0;t>c;c+=3)K=M[c],v=M[c+1],g=M[c+2],j.push($*K+w*v+X*g+Q,i*K+q*v+C*g+u,V*K+F*v+T*g+G);else vp(j,M)},ep=function(C,K){var P=K.s("light.intensity"),W=pe(K.s(Kk)),F=W[0],x=W[1],Q=W[2];1!==P&&(F*=P,x*=P,Q*=P),C.push(F,x,Q,K.s("light.disabled")?1:0)},Xi=function(V,j,y){of(j,y.uHeadlightRange,V._headlightRange);var $=V._headlightIntensity,q=pe(V._headlightColor);1!==$&&(q=[q[0]*$,q[1]*$,q[2]*$]),of(j,y.uHeadlightColor,[q[0],q[1],q[2],V._headlightDisabled?1:0]);var I=V._59O,M=V._spots,F=V._dirs;if(I.length){var p=[],l=[],Z=[];I.forEach(function(T){ep(p,T),vp(l,V._transformPointToViewSpace(T.p3())),Z.push(T.s("light.range"))}),j.uniform4fv(y.uPointColor,p),j.uniform1fv(y.uPointRange,Z),j.uniform3fv(y.uPointPosition,l)}if(M.length){var A=[],v=[],U=[],D=[],u=[],n=[];M.forEach(function(e){ep(A,e),vp(v,V._transformPointToViewSpace(e.p3())),vp(u,V._transformDirectionToViewSpace(e.p3(),e.s("light.center"))),U.push(e.s("light.range")),D.push(B(e.s("light.angle")/2)),n.push(e.s("light.exponent"))}),j.uniform4fv(y.uSpotColor,A),j.uniform1fv(y.uSpotRange,U),j.uniform1fv(y.uSpotAngle,D),j.uniform1fv(y.uSpotExponent,n),j.uniform3fv(y.uSpotPosition,v),j.uniform3fv(y.uSpotDirection,u)}if(F.length){var h=[],s=[];F.forEach(function(G){ep(h,G),vp(s,V._transformDirectionToViewSpace(G.p3()))}),j.uniform4fv(y.uDirColor,h),j.uniform3fv(y.uDirDirection,s)}},al=function(k){return k>0&&0===(k-1&k)},$j=function(x){return x=M(0,i(z,x)),x=M(je,i(z-je,x))},ks=function(){return.05+f()/2},Vn=function(z,F,N,g){var y,M=z.getEye();return z.isOrtho()?(y=Qh(z.getCenter(),M),y[0]+=g[0],y[1]+=g[1],y[2]+=g[2]):y=M,Vi(F,N,g,y)},Vi=function(A,r,w,W){var X=We(A,r),N=Qh(W,w,!0),l=We(N,r);if(a(l)<je)return E;var Z=(X-We(w,r))/l;return[w[0]+N[0]*Z,w[1]+N[1]*Z,w[2]+N[2]*Z]},$i=function(Q,p){return{x:2*Q.x-p.x,y:2*Q.y-p.y}},Po=function(A,L,O,V){var s,$;if(!A)return s=F(L.y-O.y,O.x-L.x),{x:L.x+V*Y(s),y:L.y+V*B(s)};if(!O)return s=F(A.y-L.y,L.x-A.x),{x:L.x+V*Y(s),y:L.y+V*B(s)};var J=Qh([A.x,A.y,0],[L.x,L.y,0],!0),p=Qh([O.x,O.y,0],[L.x,L.y,0],!0),U=-(J[0]+p[0])/2,I=-(J[1]+p[1])/2,k=d(U*U+I*I);if(je>k)return s=F(A.y-L.y,L.x-A.x),{x:L.x+V*Y(s),y:L.y+V*B(s)};var b=A.x-L.x,Z=A.y-L.y,j=O.x-L.x,h=O.y-L.y,r=d(b*b+Z*Z),W=d(j*j+h*h);s=N(We(J,p))/2,$=J[1]*p[0]-J[0]*p[1]>0?-1:1,U/=k,I/=k;var n=V/Y(s),w=M(r,W)/B(s);k=Math.min(n,w);var f={x:L.x+$*k*U,y:L.y+$*k*I};return O.b&&n>W/B(s)&&(f.adjust=!0),f},qb=function(Y){var e=Y[1],J=Y[2],p=Y[3],u=Y[6],W=Y[7],E=Y[11];Y[1]=Y[4],Y[2]=Y[8],Y[3]=Y[12],Y[4]=e,Y[6]=Y[9],Y[7]=Y[13],Y[8]=J,Y[9]=u,Y[11]=Y[14],Y[12]=p,Y[13]=W,Y[14]=E},Gk=function(w){var n=w[0],W=w[1],T=w[2],u=w[3],I=w[4],V=w[5],y=w[6],U=w[7],C=w[8],p=w[9],J=w[10],Z=w[11],B=w[12],R=w[13],d=w[14],s=w[15],X=n*V-W*I,H=n*y-T*I,m=n*U-u*I,g=W*y-T*V,b=W*U-u*V,K=T*U-u*y,c=C*R-p*B,t=C*d-J*B,l=C*s-Z*B,i=p*d-J*R,k=p*s-Z*R,Y=J*s-Z*d,L=X*Y-H*k+m*i+g*l-b*t+K*c;return L?(L=1/L,w[0]=(V*Y-y*k+U*i)*L,w[1]=(T*k-W*Y-u*i)*L,w[2]=(R*K-d*b+s*g)*L,w[3]=(J*b-p*K-Z*g)*L,w[4]=(y*l-I*Y-U*t)*L,w[5]=(n*Y-T*l+u*t)*L,w[6]=(d*m-B*K-s*H)*L,w[7]=(C*K-J*m+Z*H)*L,w[8]=(I*k-V*l+U*c)*L,w[9]=(W*l-n*k-u*c)*L,w[10]=(B*b-R*m+s*X)*L,w[11]=(p*m-C*b-Z*X)*L,w[12]=(V*t-I*i-y*c)*L,w[13]=(n*i-W*t+T*c)*L,w[14]=(R*H-B*g-d*X)*L,w[15]=(C*g-p*H+J*X)*L,void 0):E},xj=function(M,e){if(e){var t=e[0],I=e[1],w=e[2];M[12]=M[0]*t+M[4]*I+M[8]*w+M[12],M[13]=M[1]*t+M[5]*I+M[9]*w+M[13],M[14]=M[2]*t+M[6]*I+M[10]*w+M[14],M[15]=M[3]*t+M[7]*I+M[11]*w+M[15]}},Nl=function(e,l){if(l){var E=l[0],T=l[1],_=l[2];e[0]=e[0]*E,e[1]=e[1]*E,e[2]=e[2]*E,e[3]=e[3]*E,e[4]=e[4]*T,e[5]=e[5]*T,e[6]=e[6]*T,e[7]=e[7]*T,e[8]=e[8]*_,e[9]=e[9]*_,e[10]=e[10]*_,e[11]=e[11]*_}},sf=function(x,w,g){var b=w[0],N=w[1],v=w[2],i=w[3],V=w[4],U=w[5],o=w[6],k=w[7],Q=w[8],M=w[9],f=w[10],W=w[11],D=w[12],d=w[13],E=w[14],e=w[15],B=g[0],q=g[1],m=g[2],s=g[3];return x[0]=B*b+q*V+m*Q+s*D,x[1]=B*N+q*U+m*M+s*d,x[2]=B*v+q*o+m*f+s*E,x[3]=B*i+q*k+m*W+s*e,B=g[4],q=g[5],m=g[6],s=g[7],x[4]=B*b+q*V+m*Q+s*D,x[5]=B*N+q*U+m*M+s*d,x[6]=B*v+q*o+m*f+s*E,x[7]=B*i+q*k+m*W+s*e,B=g[8],q=g[9],m=g[10],s=g[11],x[8]=B*b+q*V+m*Q+s*D,x[9]=B*N+q*U+m*M+s*d,x[10]=B*v+q*o+m*f+s*E,x[11]=B*i+q*k+m*W+s*e,B=g[12],q=g[13],m=g[14],s=g[15],x[12]=B*b+q*V+m*Q+s*D,x[13]=B*N+q*U+m*M+s*d,x[14]=B*v+q*o+m*f+s*E,x[15]=B*i+q*k+m*W+s*e,x},Do=function(O,P,q,Y){var n,k,p,U,u,_,m,h,z,o,E=P[0],l=P[1],s=P[2],x=Y[0],B=Y[1],X=Y[2],J=q[0],f=q[1],W=q[2];return a(E-J)<je&&a(l-f)<je&&a(s-W)<je?Mi(O):(m=E-J,h=l-f,z=s-W,o=1/d(m*m+h*h+z*z),m*=o,h*=o,z*=o,n=B*z-X*h,k=X*m-x*z,p=x*h-B*m,o=d(n*n+k*k+p*p),o?(o=1/o,n*=o,k*=o,p*=o):(n=0,k=0,p=0),U=h*p-z*k,u=z*n-m*p,_=m*k-h*n,o=d(U*U+u*u+_*_),o?(o=1/o,U*=o,u*=o,_*=o):(U=0,u=0,_=0),O[0]=n,O[1]=U,O[2]=m,O[3]=0,O[4]=k,O[5]=u,O[6]=h,O[7]=0,O[8]=p,O[9]=_,O[10]=z,O[11]=0,O[12]=-(n*E+k*l+p*s),O[13]=-(U*E+u*l+_*s),O[14]=-(m*E+h*l+z*s),O[15]=1,O)},pp=function(P,v,R,l,T){var X=1/g(v/2),y=1/(l-T);return P[0]=X/R,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=X,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=(T+l)*y,P[11]=-1,P[12]=0,P[13]=0,P[14]=2*T*l*y,P[15]=0,P},ko=function(u,J,m,D,l,w,q){var f=1/(J-m),I=1/(D-l),s=1/(w-q);return u[0]=-2*f,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*I,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*s,u[11]=0,u[12]=(J+m)*f,u[13]=(l+D)*I,u[14]=(q+w)*s,u[15]=1,u},Rd=function(P,$){var J=$[0],m=$[1],b=$[2],K=$[3],i=J*J+m*m+b*b+K*K,W=i?1/i:0;return P[0]=-J*W,P[1]=-m*W,P[2]=-b*W,P[3]=K*W,P},Op=function(I,d){var b=d[0]+d[5]+d[10],M=0;return b>0?(M=2*Math.sqrt(b+1),I[3]=.25*M,I[0]=(d[6]-d[9])/M,I[1]=(d[8]-d[2])/M,I[2]=(d[1]-d[4])/M):d[0]>d[5]&d[0]>d[10]?(M=2*Math.sqrt(1+d[0]-d[5]-d[10]),I[3]=(d[6]-d[9])/M,I[0]=.25*M,I[1]=(d[1]+d[4])/M,I[2]=(d[8]+d[2])/M):d[5]>d[10]?(M=2*Math.sqrt(1+d[5]-d[0]-d[10]),I[3]=(d[8]-d[2])/M,I[0]=(d[1]+d[4])/M,I[1]=.25*M,I[2]=(d[6]+d[9])/M):(M=2*Math.sqrt(1+d[10]-d[0]-d[5]),I[3]=(d[1]-d[4])/M,I[0]=(d[8]+d[2])/M,I[1]=(d[6]+d[9])/M,I[2]=.25*M),I},Yo=function(P,B,O){var s=B[0],l=B[1],U=B[2],M=B[3],v=s+s,r=l+l,x=U+U,f=s*v,V=s*r,I=s*x,n=l*r,t=l*x,h=U*x,H=M*v,X=M*r,N=M*x;return P[0]=1-(n+h),P[1]=V+N,P[2]=I-X,P[3]=0,P[4]=V-N,P[5]=1-(f+h),P[6]=t+H,P[7]=0,P[8]=I+X,P[9]=t-H,P[10]=1-(f+n),P[11]=0,P[12]=O[0],P[13]=O[1],P[14]=O[2],P[15]=1,P},Gi=y.getRotationFromMatrix4,Me=function(){var K=[0,0,0],W=[0,0,0],i=[0,0,0],R=function(k,P,Y){k[0]=P[1]*Y[2]-P[2]*Y[1],k[1]=P[2]*Y[0]-P[0]*Y[2],k[2]=P[0]*Y[1]-P[1]*Y[0]},h=function(j){return j[0]*j[0]+j[1]*j[1]+j[2]*j[2]},a=function(y){var v=Math.sqrt(h(y));y[0]/=v,y[1]/=v,y[2]/=v},e=function(T,N,M){T[0]=N[0]-M[0],T[1]=N[1]-M[1],T[2]=N[2]-M[2]};return function(b,c,x){var $=kd();return e(i,b,c),0===h(i)&&(i[2]=1),a(i),R(K,x,i),0===h(K)&&(1===Math.abs(x[2])?i[0]+=1e-4:i[2]+=1e-4,a(i),R(K,x,i)),a(K),R(W,i,K),$[0]=K[0],$[4]=W[0],$[8]=i[0],$[1]=K[1],$[5]=W[1],$[9]=i[1],$[2]=K[2],$[6]=W[2],$[10]=i[2],$}}(),mq=function(H,E){return Do(E?E:kd(),H._eye,H._center,H._up)},Qr=function(B){var y=B.getAspect(),A=B._near,i=B._far,p=kd();if(B._ortho){var W=B._orthoWidth/2,n=W/y;ko(p,-W,W,-n,n,A,i)}else pp(p,B._fovy,y,A,i);return p},ze=function(L,l){if(!L)return E;var _=0,o=1,V=2,F=[],k=0,C=L.length,P=C/3;if(l){for(;C>k;k++)F[k]=0;for(k=0;k<l.length;k+=3){var i=[],m=[],Q=[];i[_]=L[3*l[k+1]+_]-L[3*l[k]+_],i[o]=L[3*l[k+1]+o]-L[3*l[k]+o],i[V]=L[3*l[k+1]+V]-L[3*l[k]+V],m[_]=L[3*l[k+2]+_]-L[3*l[k+1]+_],m[o]=L[3*l[k+2]+o]-L[3*l[k+1]+o],m[V]=L[3*l[k+2]+V]-L[3*l[k+1]+V],Q[_]=i[o]*m[V]-i[V]*m[o],Q[o]=i[V]*m[_]-i[_]*m[V],Q[V]=i[_]*m[o]-i[o]*m[_];for(var W=0;3>W;W++)F[3*l[k+W]+_]+=Q[_],F[3*l[k+W]+o]+=Q[o],F[3*l[k+W]+V]+=Q[V]}}else for(k=0;P>k;k+=3){var i=[],m=[],Q=[];i[_]=L[3*(k+1)+_]-L[3*k+_],i[o]=L[3*(k+1)+o]-L[3*k+o],i[V]=L[3*(k+1)+V]-L[3*k+V],m[_]=L[3*(k+2)+_]-L[3*(k+1)+_],m[o]=L[3*(k+2)+o]-L[3*(k+1)+o],m[V]=L[3*(k+2)+V]-L[3*(k+1)+V],Q[_]=i[o]*m[V]-i[V]*m[o],Q[o]=i[V]*m[_]-i[_]*m[V],Q[V]=i[_]*m[o]-i[o]*m[_];for(var W=0;3>W;W++)F[3*(k+W)+_]=Q[_],F[3*(k+W)+o]=Q[o],F[3*(k+W)+V]=Q[V]}for(k=0;C>k;k+=3){var g=[];g[_]=F[k+_],g[o]=F[k+o],g[V]=F[k+V];var O=d(g[_]*g[_]+g[o]*g[o]+g[V]*g[V]);0===O&&(O=je),g[_]=g[_]/O,g[o]=g[o]/O,g[V]=g[V]/O,F[k+_]=g[_],F[k+o]=g[o],F[k+V]=g[V]}return new Uf(F)},eb=function(F,B,e,_){if(e||(e=F.createTexture()),B){var P=F.TEXTURE_2D,d=F.REPEAT,m=F.CLAMP_TO_EDGE,s=F.TEXTURE_MIN_FILTER;_!==F.NEAREST&&(_=F.LINEAR),jb(F,e),F.texImage2D(P,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,B),zm(F,F.TEXTURE_MAG_FILTER,_),al(B.width)&&al(B.height)&&!B.clampToEdge?(zm(F,F.TEXTURE_WRAP_S,d),zm(F,F.TEXTURE_WRAP_T,d),zm(F,s,F.LINEAR_MIPMAP_LINEAR),F.generateMipmap(P)):(zm(F,F.TEXTURE_WRAP_S,m),zm(F,F.TEXTURE_WRAP_T,m),zm(F,s,_)),jb(F,E)}return e},Aq=function(N,j){var J=new Uint8Array(3);return j=j||N.createTexture(),jb(N,j),zm(N,N.TEXTURE_MIN_FILTER,N.LINEAR),N.texImage2D(N.TEXTURE_2D,0,N.RGB,1,1,0,N.RGB,N.UNSIGNED_BYTE,J),j},Rn=function(K){K._26I&&K._prg&&(K._26I.deleteProgram(K._prg),K._prg=E)},_o=function(E,Z,N,f){var U=E.createShader(N);return E.shaderSource(U,f),E.compileShader(U),E.attachShader(Z,U),U},Zj=function(S){return S.createBuffer()},jb=function(j,q){j.bindTexture(j.TEXTURE_2D,q)},Mk=function(c,e){c.bindFramebuffer(c.FRAMEBUFFER,e)},zm=function(e,V,U){e.texParameteri(e.TEXTURE_2D,V,U)},Cj=function(d,s){if(s){var s=pe(s);d.clearColor(s[0],s[1],s[2],s[3])}},Yq=function(M,x){of(M,x.uFix,!0),Xo(M,x.aNormal)},te=function(U,B){of(U,B.uFix,!1),Dj(U,B.aNormal)},Fi=function(w,b,o,T,O,x,I,V){w._picking||(o?(of(w,b.uBlend,!0),of(w,b.uBlendColor,o)):of(w,b.uBlend,!1),of(w,b.uLight,T==E?!0:T),ve(O)&&1!==O&&of(w,b.uPartOpacity,O),of(w,b.uReverseFlip,x==E?!1:x),of(w,b.uFixPickReverseColor,I||Dq)),V?w.enable(w.CULL_FACE):w.disable(w.CULL_FACE)},Mo=function(i,p){i._picking||of(i,p.uPartOpacity,1)},Ap=function(J,U,R,D,S,l,r,k,t){if(!R)return J.activeTexture(J.TEXTURE0),jb(J,J._emptyTexture),J.activeTexture(J.TEXTURE1),jb(J,J._emptyBlendTexture),void 0;of(J,U.uTexture,!0),of(J,U.uDiscardSelectable,er(D)?D:!0),Dj(J,U.aUv),Vj(J,S,l,U.aUv,2),t?(of(J,U.uBlendTexture,!0),J.activeTexture(J.TEXTURE1),jb(J,t),J.uniform1i(U.uBlendSampler,1)):(of(J,U.uBlendTexture,!1),J.activeTexture(J.TEXTURE1),jb(J,J._emptyBlendTexture)),J.activeTexture(J.TEXTURE0),jb(J,R),J.uniform1i(U.uSampler,0);var n=[0,0,1,1];r&&(n[0]=r[0],n[1]=r[1]),k&&(n[2]=k[0],n[3]=k[1]),of(J,U.uOffsetScale,n)},Oi=function(w,_,u){w.activeTexture(w.TEXTURE0),jb(w,E),w.activeTexture(w.TEXTURE1),jb(w,E),u&&(Xo(w,_.aUv),of(w,_.uTexture,!1),of(w,_.uBlendTexture,!1))},cc=function(Y,z,o,A,F,B){!o||X||c||Y.lineWidth(o),A&&!Y._picking&&of(Y,z.uFixPickReverseColor,A),F&&Vj(Y,F,B,z.aPosition)},$f=function(U,e,T,k){wj&&(k=U[wj]),U.drawArrays(k==E?U.TRIANGLES:k,e,T);var r=U._renderInfo;r&&(r.calls++,r.vertices+=T,(k==E||k===U.TRIANGLES)&&(r.faces+=T/3),k===U.LINES&&(r.lines+=T/2))},zb=function(Q,m,S,K){wj&&(K=Q[wj]),Q.drawElements(K==E?Q.TRIANGLES:K,S,Q.UNSIGNED_SHORT,m==E?0:2*m);var D=Q._renderInfo;D&&(D.calls++,D.vertices+=S,(K==E||K===Q.TRIANGLES)&&(D.faces+=S/3),K===Q.LINES&&(D.lines+=S/2))},Vj=function(H,L,k,n,N){var R=H.ARRAY_BUFFER;H.bindBuffer(R,L),k&&H.bufferData(R,k,H.STATIC_DRAW),n!=E&&H.vertexAttribPointer(n,N?N:3,H.FLOAT,!1,0,0)},hk=function(E,Y,U){var r=E.ELEMENT_ARRAY_BUFFER;E.bindBuffer(r,Y),U&&E.bufferData(r,U,E.STATIC_DRAW)},of=function(z,c,G){if(G!=E&&c!=E){G=pe(G);var m=G.length;3===m?z.uniform3fv(c,G):4===m?z.uniform4fv(c,G):16===m?z.uniformMatrix4fv(c,!1,G):er(G)?z.uniform1i(c,G?1:0):2===m?z.uniform2fv(c,G):z.uniform1f(c,G)}},Dj=function(w,A){A!=E&&A>=0&&w.enableVertexAttribArray(A)},Xo=function(Q,f){f!=E&&f>=0&&Q.disableVertexAttribArray(f)},wp=function(f,z){var A=f.getGL(),X=f._prg;f._7O=f._8O.pop(),z&&(of(A,X.uMVMatrix,f._7O),f._6O=z,of(A,X.uNMatrix,z))},me=function(l,_){return _||(_=kd()),ig(_,l),Gk(_),qb(_),_},cl=function(n,B){var L=n.getGL(),k=n._prg,O=n._7O;B&&(n._8O.push(Lg(O)),sf(O,O,B)),of(L,k.uMVMatrix,O),of(L,k.uNMatrix,me(O,n._6O))},ic=function(T,y,l,A,d,S){if(l){if(A){var x=l.value++,L=[(255&x>>24)/255,(255&x>>16)/255,(255&x>>8)/255,(255&x)/255];l[x]={data:d,part:S}}else L=Vk;return of(T,y.uFixPickReverseColor,L),L}},Li=function(){var $={center:function(z,n,Q,e,Z){var x=-n[1]/2,o={x:-n[0]/2,y:x,width:n[0],height:n[1]},P=Bi(z,o,Q);return[P.x+e,-P.y-Z,ks()]},front:function(N,W,d,O,z){var T=-W[1]/2,t={x:-W[0]/2,y:T,width:W[0],height:W[1]},e=Bi(N,t,d);return[e.x+O,-e.y-z,W[2]/2+ks()]},back:function(s,n,l,o,Y){var k=-n[0]/2,x=-n[1]/2,e={x:k,y:x,width:n[0],height:n[1]},J=Bi(s,e,l);return[-J.x-o,-J.y-Y,-n[2]/2-ks()]},left:function(F,B,x,s,r){var M=-B[1]/2,d={x:-B[2]/2,y:M,width:B[2],height:B[1]},q=Bi(F,d,x);return[-B[0]/2-ks(),-q.y-r,q.x+s]},right:function(V,Y,s,U,C){var F=-Y[2]/2,b=-Y[1]/2,_={x:F,y:b,width:Y[2],height:Y[1]},G=Bi(V,_,s);return[Y[0]/2+ks(),-G.y-C,-G.x-U]},top:function(D,C,p,E,I){var Y={x:-C[0]/2,y:-C[2]/2,width:C[0],height:C[2]},W=Bi(D,Y,p);return[W.x+E,C[1]/2+ks(),W.y+I]},bottom:function(T,J,O,_,E){var h=-J[2]/2,B={x:-J[0]/2,y:h,width:J[0],height:J[2]},g=Bi(T,B,O);return[g.x+_,-J[1]/2-ks(),-g.y-E]}};return function(m,F,v,g,n,W){return $[g](m,F,v,n||0,W||0)}}(),Nq=function(i,S,p,l,f,h,E,M,w,q){if(f&&(S[0]+=f[0],S[1]+=f[1],S[2]+=f[2]),xj(i,p),M){var W=kd();if(nn(W,w,q),nf(S,W),xj(i,S),i.auto=M,i.pos=nf([0,0,0],i),h){var k=i.mat2=kd();nn(k,h,E)}}else nn(i,w,q),xj(i,S),l===nl?so(i,-T):l===yf?so(i,T):l===lf?Cm(i,-T):l===ec?Cm(i,T):l===_g&&so(i,z),nn(i,h,E);return i},rn=function(p,_){var z=_.auto,$=_.mat2,q=p.gv;if(z){var O,T=kd(),d=[0,0,0,0];O="string"==typeof z?[z.indexOf("x")<0?q._eye[0]:q._center[0],z.indexOf("y")<0?q._eye[1]:q._center[1],z.indexOf("z")<0?q._eye[2]:q._center[2]]:q._eye,Op(d,Do(kd(),O,q._center,q._up)),Yo(T,Rd(d,d),_.pos),$&&sf(T,T,$),cl(q,T)}else cl(q,_)},Ri=function(S,E,p,I,n){var K=S.s,s=S.gv,y=s.getGL(),L=s._prg,b=s._buffer,J=s._1O;eb(y,cj,J),rn(S,p),Fi(y,L,K(E+".blend"),K(E+".light"),K(E+".opacity"),K(E+".reverse.flip"),K(E+".reverse.color"),K(E+".reverse.cull")),Ap(y,L,J,n,b.uv,yq),Vj(y,b.vs,I,L.aPosition),Vj(y,b.ns,th,L.aNormal),hk(y,b.is,Se),zb(y,0,Se.length),Oi(y,L,J),Mo(y,L),wp(s)},il=function(X,C,Z){var n=X.gv,G=X.data,z=X[C]={blend:n.getBodyColor(G)||n.getFaceBlend(G,C),light:n.getFaceLight(G,C),color:n.getFaceColor(G,C),opacity:n.getFaceOpacity(G,C),transparent:n.getFaceTransparent(G,C),reverseFlip:n.getFaceReverseFlip(G,C),reverseColor:n.getFaceReverseColor(G,C),reverseCull:n.getFaceReverseCull(G,C),texture:n.getFaceImage(G,C),blendTexture:n.getFaceBlendImage(G,C),discardSelectable:n.getFaceDiscardSelectable(G,C)};if("csg"!==C){z.uv=n.getFaceUv(G,C)||Z&&Z[C+"Uv"],z.uvScale=n.getFaceUvScale(G,C)||Z&&Z[C+"UvScale"],z.uvOffset=n.getFaceUvOffset(G,C)||Z&&Z[C+"UvOffset"];var d=n.getFaceMat(G,C);d&&(z.mat=rp(G,d))}return z},rs=function(p,j,J,C,f){if(C){if(!f(C.transparent))return;var B=p.data,t=p.gv,L=t._buffer,s=t.getTexture(C.texture,B),b=t.getTexture(C.blendTexture,B);Ap(j,J,s,C.discardSelectable,L.uv,C.tuv,C.uvOffset,C.uvScale,b),Fi(j,J,C.blend,C.light,C.opacity,C.reverseFlip,C.reverseColor,C.reverseCull),of(j,J.uDiffuse,C.color),Vj(j,L.vs,C.vs,J.aPosition),Vj(j,L.ns,C.ns,J.aNormal),$f(j,0,C.vs.length/3),Mo(j,J),Oi(j,J,s)}},dr=function(g,R,E,u,M,s){var l,i,Y,b,p,_,m,Z,L,o,W,D=[u-R,M-E],v=g?g.length:0;for(Y=0;v>Y;Y++){for(b=2,l=g[Y],p=l[0],_=l[1];b+1<l.length;){if(m=l[b],Z=l[b+1],i=od(R,E,u,M,p,_,m,Z,!0)){L=[m-p,Z-_],o=tm(L),L[0]/=o,L[1]/=o,o=We(D,L),o=o>0?s:-s,W=[L[0]*o,L[1]*o];break}p=m,_=Z,b+=2}if(W)break}if(W)for(u=R+W[0],M=E+W[1],Y=0;v>Y;Y++)for(b=2,l=g[Y],p=l[0],_=l[1];b+1<l.length;){if(m=l[b],Z=l[b+1],i=od(R,E,u,M,p,_,m,Z,!0))return[0,0];p=m,_=Z,b+=2}return W?W:[u-R,M-E]},qs=b.graph3d={},ti=function(b,f,p){ok(R+".graph3d."+b,f,p)},wi="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",bg="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Jn(y,{setBatchInfo:function(D,B){ie[D]=B},getBatchInfo:function(Q){return ie[Q]}},!0);var lo=[1,1,1],ho=[1,0,0,0,0,1,0,1,1,1,1,0],Kd=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Am=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Bc=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Hi=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],uc=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],uf=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Ng=function(v,k){vi(v,k),Ij(v,k,"_wireframeModelMap","_wireframeIndexMap"),Ij(v,k,"_polylineModelMap","_polylineIndexMap"),Ij(v,k,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Ij(v,k,"_polylineModelMapSwap","_polylineIndexMapSwap")},vi=function(l,w){if(w){var h,e,U=w._id,v=l._33O,S=l._34O,r=S[U];if(r){e=r.batch,h=v[e];var g=r.begin,K=r.size,N=3*g,R=3*K,z=4*g,D=4*K,$=h.vs,M=h.uv,k=h.cs,A=h.bs,y=h.rs,n=h.ds,j=r.index;if(h.invalidate=!0,delete S[U],n.splice(j,1),Zq(n))delete v[e];else{for(;j<n.length;j++)r=S[n[j]._id],r.index--,r.begin-=K;$.splice(N,R),h.ns.splice(N,R),h.ps.splice(z,D),M&&M.splice(2*g,2*K),k&&k.splice(z,D),A&&A.splice(N,R),y&&y.splice(g,K)}}}else l._34O={},l._33O={}},Ij=function(F,D,G,Y){if(D){var A,a,j=D._id,Q=F[G],u=F[Y],s=u[j];if(s){a=s.batch,A=Q[a];var M=s.begin,H=s.size,V=3*M,S=3*H,O=4*M,R=4*H,E=A.ds,J=s.index;if(A.invalidate=!0,delete u[j],E.splice(J,1),Zq(E))delete Q[a];else{for(;J<E.length;J++)s=u[E[J]._id],s.index--,s.begin-=H;A.vs.splice(V,S),A.cs.splice(O,R),A.ps.splice(O,R),A.ls&&A.ls.splice(M,H)}}}else F[G]={},F[Y]={}},Bp=function(Z,c,V,R){if(!R)return E;var r=c[R];if(!r){var L=ie[R]||fc,S=L.image?[]:E;r=c[R]={vs:[],ns:[],uv:S,cs:S?E:L.color?E:[],bs:L.blend?[]:E,ps:[],rs:L.brightness?[]:E,ds:[]}}return r.invalidate=!0,Z[V._id]={index:r.ds.length,begin:r.vs.length/3,batch:R},r.ds.push(V),r},eg=function(R,z){return z!=E&&1!==z?[R[0]*z,R[1]*z,R[2]*z,R[3]]:R},Tq=function(h,z,p){var c=h.getBrightness(z),b=pe(p.color||"white"),n=b[3]<1,o=Math.ceil(p.width)||1,r=(n?"T":"O")+o,O=h._wireframeIndexMap,Q=h._wireframeModelMap,x=Q[r];x||(x=Q[r]={vs:[],cs:[],ps:[],ds:[],T:n,W:o});var M,L=h.getData3dUI(z),y=dq(L);if(p.geometry){if(!y)return;if(M=On(y),!M)return}else M=p.short?bm:_k;x.invalidate=!0;var s=x.vs,X=x.cs,m=x.ds,E=O[z._id]={index:m.length,begin:s.length/3,batch:r};m.push(z);var Z=rp(z,p.mat),D=L._calcAnchorMat(z);D&&sf(Z,Z,D),Xp(s,Z,M);var A=E.size=s.length/3-E.begin;Xn(X,eg(b,c),A)},Dl=function(k,v,c,J,u,H,S,Q,i){var o=k.getBrightness(v);o==E&&(o=1);var p=eg(pe(J),o),W=p[3]<1;H=Math.ceil(H)||1;var X=(W?"T":"O")+H;if(S){var x=S[0],A=(S[1]||x)+x;X+="-"+x+"-"+A,i&&(X+="-"+ye(i)+"-"+o,i=eg(pe(i),o))}var U=k._polylineIndexMap,w=k._polylineModelMap,f=w[X];f||(f=w[X]={vs:[],cs:[],ps:[],ds:[],ls:S?[]:E,T:W,W:H},S&&(f.D=x,f.G=A,f.A=i)),f.invalidate=!0;var G,D=f.vs,m=f.cs,T=f.ds,C=f.ls,q=U[v._id]={index:T.length,begin:D.length/3,batch:X};T.push(v),vp(D,c);var _,h=q.size=D.length/3-q.begin,B=c.length,I=0,g=[];if(S||u)for(G=0;B>G;G+=6)_=tm([c[G],c[G+1],c[G+2]],[c[G+3],c[G+4],c[G+5]]),g.push(_),I+=_;if(I&&u){var s,V=eg(pe(u),o),j=[V[0]-p[0],V[1]-p[1],V[2]-p[2],V[3]-p[3]],O=0;for(G=0;B>G;G+=6)s=O/I,Xn(m,[p[0]+j[0]*s,p[1]+j[1]*s,p[2]+j[2]*s,p[3]+j[3]*s],1),O+=g[G/6],s=O/I,Xn(m,[p[0]+j[0]*s,p[1]+j[1]*s,p[2]+j[2]*s,p[3]+j[3]*s],1)}else Xn(m,p,h);if(S)for(O=Q||0,G=0;B>G;G+=6)C.push(O),O+=g[G/6],C.push(O)},sl=function($,v,z){if(v)for(var M=4*v.begin,T=z[v.batch].ps,m=0;m<v.size;m++)T[M++]=$[0],T[M++]=$[1],T[M++]=$[2],T[M++]=$[3]},hg=function(K,J){var Q=J+["32"],B=K[J],L=K[Q];B?L&&L.length===B.length?L.set(B):K[Q]=new Uf(B):delete K[Q]},Ro=function(e,S,t,U,x,E,Z,a,B){if(_n(t))t.forEach(function(u){Ro(e,S,u,U,x,E,Z,a,B)});else if(Xr(t))Ro(e,S,dq(U,t),U,x,E,Z,a,B);else if(ki(t)){var r,$=_h(t.mat,S,e),N=_h(t.s3,S,e),b=_h(t.t3,S,e),I=_h(t.r3,S,e);if((N||I||b||$)&&(r=Zb($,N,I,_h(t.rotationMode,S,e),b),E.push(r)),t.shape3d)Ro(e,S,t.shape3d,U,x,E,Z,a,t);else{var g=U.s;B=B||fc;var K=E[0],_=E.length,l=g("shape3d.color",t.color,B.color);if(x||(x=g("shape3d.blend",t.blend,B.blend)),_>1){K=Lg(K);for(var T=1;_>T;T++)sf(K,K,E[T])}t.vs&&g(nj,t.visible,B.visible)&&mj(K,Z,a,t.vs,t.uv,t.is,x,l),t.top_vs&&g(Wl,t.topVisible,B.topVisible)&&mj(K,Z,a,t.top_vs,t.top_uv,t.top_is,x,g("shape3d.top.color",t.topColor,B.topColor)||l),t.bottom_vs&&g(pb,t.bottomVisible,B.bottomVisible)&&mj(K,Z,a,t.bottom_vs,t.bottom_uv,t.bottom_is,x,g("shape3d.bottom.color",t.bottomColor,B.bottomColor)||l),t.from_vs&&g(Oj,t.fromVisible,B.fromVisible)&&mj(K,Z,a,t.from_vs,t.from_uv,t.from_is,x,g("shape3d.from.color",t.fromColor,B.fromColor)||l),t.to_vs&&g(jk,t.toVisible,B.toVisible)&&mj(K,Z,a,t.to_vs,t.to_uv,t.to_is,x,g("shape3d.to.color",t.toColor,B.toColor)||l)}r&&E.pop()}},mj=function(f,x,k,E,F,S,i,D){var e,u=x.cs,R=x.uv,K=x.bs;if(S){e=S.length;for(var d=0;e>d;d++){var L=S[d];Xp(k,f,[E[3*L],E[3*L+1],E[3*L+2]]),R&&vp(R,[F[2*L],F[2*L+1]])}}else e=E.length/3,Xp(k,f,E),R&&vp(R,F);u&&Xn(u,D,e),K&&(i?ad(K,i,e):vp(K,lo,e))},tc=function(h,g,d,P){var U=[];P?Ro(h.gv,h.data,P,h,h.getBodyColor(),[g],d,U):(mg(h,nl,g,d,U),mg(h,yf,g,d,U),mg(h,oh,g,d,U),mg(h,_g,g,d,U),mg(h,lf,g,d,U),mg(h,ec,g,d,U),mg(h,"csg",g,d,U)),U.length&&(vp(d.vs,U),vp(d.ns,ze(U)))},mg=function(g,$,d,Q,G){var K=g[$];if(K){var k=K.tuv;if(k){var P,D,c,B,O=K.uvScale,Z=K.uvOffset;if(O)for(P=k.length,D=O[0],c=O[1],B=0;P>B;B+=2)k[B]*=D,k[B+1]*=c;if(Z)for(P=k.length,D=Z[0],c=Z[1],B=0;P>B;B+=2)k[B]+=D,k[B+1]+=c}mj(d,Q,G,K.vs,k,E,K.blend,K.color)}},gm=function(Y,n,c,x,C,d,u,a){var f,k=c.cs,R=c.uv,K=c.bs;if(Y.getFaceVisible(n,d)){var i=Y.getFaceMat(n,d);if(i&&(C=rp(n,i)),Xp(u,C,a),k&&Xn(k,Y.getFaceColor(n,d),6),R){var U=Y.getFaceUv(n,d)||x[d+"Uv"],y=Y.getFaceUvScale(n,d)||x[d+"UvScale"],l=Y.getFaceUvOffset(n,d)||x[d+"UvOffset"];U=U?[U[6],U[7],U[0],U[1],U[2],U[3],U[2],U[3],U[4],U[5],U[6],U[7]]:ho;var F=U[0],_=U[1],w=U[2],v=U[3],V=U[4],D=U[5],j=U[6],p=U[7],o=U[8],S=U[9],L=U[10],H=U[11];if(y){var I=y[0],m=y[1];F*=I,_*=m,w*=I,v*=m,V*=I,D*=m,j*=I,p*=m,o*=I,S*=m,L*=I,H*=m}if(l){var W=l[0],A=l[1];F+=W,_+=A,w+=W,v+=A,V+=W,D+=A,j+=W,p+=A,o+=W,S+=A,L+=W,H+=A}R.push(F,_,w,v,V,D,j,p,o,S,L,H)}K&&(f=Y.getBodyColor(n)||Y.getFaceBlend(n,d),f?ad(K,f,6):vp(K,lo,6))}},$d=function(w,K,X,y){var W=w.getGL(),Q=w._prg,A=w._buffer;if(!jj(K)){cl(w),Yq(W,Q);for(var I in K){var d=K[I];if(!(y&&!d.T||!y&&d.T)){d.invalidate?(d.invalidate=!1,hg(d,"vs"),hg(d,"cs"),hg(d,"ls"),hg(d,"ps")):X&&hg(d,"ps");var m=d.vs32,a=X?d.ps32:d.cs32;cc(W,Q,d.W,E,A.vs,m);var T=d.D,j=!w._dashDisabled&&T;of(W,Q.uAlphaTest,$.alphaTest),j&&(of(W,Q.uDash,!0),of(W,Q.uDashDistance,T),of(W,Q.uDashGapDistance,d.G),Dj(W,Q.aLineDistance),Vj(W,A.lineDistance,d.ls32,Q.aLineDistance,1),of(W,Q.uDiffuse,d.A||hj));var c=!w._batchColorDisabled;c&&(of(W,Q.uBatchColor,!0),Dj(W,Q.aBatchColor),Vj(W,A.batchColor,a,Q.aBatchColor,4)),Ap(W),$f(W,0,m.length/3,W.LINES),Oi(W),c&&(of(W,Q.uBatchColor,!1),Xo(W,Q.aBatchColor)),j&&(of(W,Q.uDash,!1),Xo(W,Q.aLineDistance))}}te(W,Q)}},Kg=function(W,_,l){var o,u,M,t,c,Q,k,h,j,a,F,P=W.getGL(),i=W._prg,z=W._buffer,N=W._33O;if(!jj(N)){cl(W);for(o in N)if(u=ie[o]||fc,!(l&&!u.transparent||!l&&u.transparent)&&(M=N[o],_||!u.transparentMask)){var G=l&&u.autoSort!==!1&&(W._33Q||M.invalidate);if(M.invalidate?(M.invalidate=!1,hg(M,"vs"),hg(M,"ns"),hg(M,"cs"),hg(M,"rs"),hg(M,"ps"),hg(M,"bs"),hg(M,"uv")):_&&hg(M,"ps"),c=M.vs32,Q=_?M.ps32:M.cs32,j=M.uv32,k=M.bs32,h=M.rs32,F=c.length/3,G&&(M.is=ts(c,W.getEye())),F){t=u.light,a=W.getTexture(u.image),Fi(P,i,E,u.light,u.opacity,u.reverseFlip,u.reverseColor,u.reverseCull),Q?W._batchColorDisabled||(of(P,i.uBatchColor,!0),Dj(P,i.aBatchColor),Vj(P,z.batchColor,Q,i.aBatchColor,4)):of(P,i.uDiffuse,u.color);var Z=u.alphaTest;of(P,i.uAlphaTest,Z===K?$.alphaTest:Z);var y=k&&!W._batchBlendDisabled;y&&(of(P,i.uBatchBlend,!0),Dj(P,i.aBatchBlend),Vj(P,z.batchBlend,k,i.aBatchBlend));var p=h&&!W._batchBrightnessDisabled;p&&(of(P,i.uBatchBrightness,!0),Dj(P,i.aBatchBrightness),Vj(P,z.batchBrightness,h,i.aBatchBrightness,1)),j?Ap(P,i,a,u.discardSelectable,z.uv,j,u.uvOffset,u.uvScale):Ap(P),Vj(P,z.vs,c,i.aPosition),Vj(P,z.ns,M.ns32,i.aNormal),M.is?(hk(P,z.is,M.is),zb(P,0,F)):$f(P,0,F),j?Oi(P,i,a):Oi(P),Q&&!W._batchColorDisabled&&(of(P,i.uBatchColor,!1),Xo(P,i.aBatchColor)),y&&(of(P,i.uBatchBlend,!1),Xo(P,i.aBatchBlend)),p&&(of(P,i.uBatchBrightness,!1),Xo(P,i.aBatchBrightness)),Mo(P,i)}}}},ts=function(e,j){for(var i=e.length/3,E=new Array(i),d=i/3,H=new Array(d),I=0;d>I;I++)H[I]=I;H.sort(function(v,R){var N=9*v,$=[(e[N]+e[N+3]+2*e[N+6])/4,(e[N+1]+e[N+4]+2*e[N+7])/4,(e[N+2]+e[N+5]+2*e[N+8])/4];N=9*R;var l=[(e[N]+e[N+3]+2*e[N+6])/4,(e[N+1]+e[N+4]+2*e[N+7])/4,(e[N+2]+e[N+5]+2*e[N+8])/4],P=tm(j,$)-tm(j,l);return P>0?-1:0>P?1:0});for(var I=0;d>I;I++){var P=3*I,A=3*H[I];E[P]=A,E[P+1]=A+1,E[P+2]=A+2}return new Ik(E)};y.handleModelLoaded=function(){},y.handleUnfoundModel=function(){};var Td=E,Ul=E,Yr=function(y){Td&&!y._loadingModelView_&&(Ul||(Ul={}),Ul[y._loadingModelView_=Yj()]=y)},Gg=function(p,F){Td||(Td={});var R=Td[p];if(R){if(R.url===F)return;R.request.onload=Di,R.request.onerror=Di}var r=new XMLHttpRequest;if(Td[p]={request:r,url:F},r.overrideMimeType&&r.overrideMimeType("text/plain"),F=y.beforeLoadURL(F),F.data){var B=y.parse(F.data);xh(p,B),y.handleModelLoaded(p,B)}else r.open("GET",encodeURI(F),!0),r.onload=function(R){if(200===this.status||0===this.status){var $=y.parse(R.target.response||R.target.responseText);if("obj"===$.modelType){var d={cube:!0,center:!0,finishFunc:function(G,c){if(G){var c=[];for(var S in G){var B=G[S];c.rawS3=B.rawS3,c.push(B)
}c.json=$,xh(p,c),y.handleModelLoaded(p,c)}else xh(p,y.handleUnfoundModel(p,F)||E)}};y.loadObj($.obj,$.mtl,d)}}else xh(p,y.handleUnfoundModel(p,F)||E)},r.onerror=function(){xh(p,y.handleUnfoundModel(p,F)||E)},r.send(null)},xh=function(s,u){if(Ip[s]=u,delete Td[s],jj(Td)&&(Td=E,Ul)){for(var b in Ul){var k=Ul[b];k._2O&&(k._2O={}),k.invalidateAll&&k.invalidateAll(K,"modelLoaded",s),k.redraw&&k.redraw(),k.iv(),delete k._loadingModelView_}Ul=E}if(u&&Ul)for(var b in Ul){var k=Ul[b];k.invalidateAll&&k.invalidateAll(K,"modelLoading",s),k.redraw&&k.redraw(),k.iv()}},yq=new Uf([0,0,0,1,1,1,1,0]),th=new Uf([0,0,1,0,0,1,0,0,1,0,0,1]),Se=new Ik([0,1,2,2,3,0]),Ag=new Uf([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),_d=new Ik([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),io=new Uf([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),vk=new Uf([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Tg=ze(Ag,_d),_k=(new Uf([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Ik([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5]),bm=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Jc=function(H,D,w,Z,R,U){U=U||16,H=H||16,D=D||0,w=w||H;var y,E,q,b,J,W,n,g,T=.5,d=[],k=[],M=I/H,$=z/U;for(y=0;U>y;y++)for(J=y+1,b=y*$,g=J*$,E=D;w>E;E++)W=E+1,q=E*M,n=W*M,d.push(T*Y(b)*B(q),T*B(b),-T*Y(b)*Y(q),T*Y(g)*B(n),T*B(g),-T*Y(g)*Y(n),T*Y(b)*B(n),T*B(b),-T*Y(b)*Y(n),T*Y(b)*B(q),T*B(b),-T*Y(b)*Y(q),T*Y(g)*B(q),T*B(g),-T*Y(g)*Y(q),T*Y(g)*B(n),T*B(g),-T*Y(g)*Y(n)),k.push(E/H,y/U,W/H,J/U,W/H,y/U,E/H,y/U,E/H,J/U,W/H,J/U);if(Z){var t=[],l=[];for(q=D*M,y=0;U>y;y++)J=y+1,b=y*$,g=J*$,t.push(0,0,0,T*Y(g)*B(q),T*B(g),-T*Y(g)*Y(q),T*Y(b)*B(q),T*B(b),-T*Y(b)*Y(q)),l.push(0,.5,D/H,J/U,D/H,y/U)}if(R){var Q=[],c=[];for(q=w*M,y=0;U>y;y++)J=y+1,b=y*$,g=J*$,Q.push(0,0,0,T*Y(b)*B(q),T*B(b),-T*Y(b)*Y(q),T*Y(g)*B(q),T*B(g),-T*Y(g)*Y(q)),c.push(1,.5,w/H,y/U,w/H,J/U)}return{vs:d,uv:k,from_vs:t,from_uv:l,to_vs:Q,to_uv:c}},yl=function(T,b,k){T=T||.17,b=b||12,k=k||18,0>T?T=0:T>.25&&(T=.25);var N,r,L,R,H,u,X,x=.5,D=[],g=[],V=[],l=I/k,_=I/b,j=x-T;for(r=0;b>=r;r++)for(R=-z+r*_,u=B(R),H=Y(R),N=0;k>=N;N++)L=N*l,X=j+T*u,D.push(B(L)*X,H*T,-Y(L)*X),g.push(N/k,1-r/b);for(r=0;b>r;r++){var S=r*(k+1),o=(r+1)*(k+1);for(N=0;k>N;N++)V.push(S+N,o+N+1,o+N,S+N,S+N+1,o+N+1)}return{vs:D,uv:g,is:V}},sd=function(n,e,p,A,K,s,U){U=U||12,n=n||18,e=e||0,p=p||n,s=s||.17,0>s?s=0:s>.25&&(s=.25);var d,$,L,S,J,g,R,c,W,w,q=.5,X=[],h=[],u=I/n,y=I/U,T=q-s;for(L=0;U>L;L++)for(S=L+1,R=-z+L*y,c=-z+S*y,d=e;p>d;d++)$=d+1,J=d*u,g=$*u,W=T+s*B(R),w=T+s*B(c),X.push(B(J)*W,Y(R)*s,-Y(J)*W,B(g)*W,Y(R)*s,-Y(g)*W,B(g)*w,Y(c)*s,-Y(g)*w,B(J)*W,Y(R)*s,-Y(J)*W,B(g)*w,Y(c)*s,-Y(g)*w,B(J)*w,Y(c)*s,-Y(J)*w),h.push(d/n,1-L/U,$/n,1-L/U,$/n,1-S/U,d/n,1-L/U,$/n,1-S/U,d/n,1-S/U);if(A){var t=[],r=[];for(L=0;U>L;L++)S=L+1,R=-z+L*y,c=-z+S*y,J=e*u,W=T+s*B(R),w=T+s*B(c),t.push(B(J)*W,Y(R)*s,-Y(J)*W,B(J)*w,Y(c)*s,-Y(J)*w,B(J)*T,0,-Y(J)*T),r.push(.5+.5*B(R),.5-.5*Y(R),.5+.5*B(c),.5-.5*Y(c),.5,.5)}if(K){var P=[],G=[];for(L=0;U>L;L++)S=L+1,R=-z+L*y,c=-z+S*y,J=p*u,W=T+s*B(R),w=T+s*B(c),P.push(B(J)*W,Y(R)*s,-Y(J)*W,B(J)*T,0,-Y(J)*T,B(J)*w,Y(c)*s,-Y(J)*w),G.push(.5-.5*B(R),.5-.5*Y(R),.5,.5,.5-.5*B(c),.5-.5*Y(c))}return{vs:X,uv:h,from_vs:t,from_uv:r,to_vs:P,to_uv:G}},Mg=function(b,n){for(var O,M,f,L=.5,r=16,d=[],p=[],G=[],x=I/r,D=0;r>=D;D++)O=D*x,M=B(O)*L,f=Y(O)*L,d.push(M,-L,f,M,L,f),p.push(1-D/r,1,1-D/r,0);for(D=0;r>D;D++)G.push(2*D,2*D+1,2*D+3,2*D,2*D+3,2*D+2);if(n){var H=[],C=[],w=[];for(H.push(0,-L,0),C.push(.5,.5),D=0;r>=D;D++)O=D*x,M=B(O),f=Y(O),H.push(M*L,-L,-f*L),C.push(.5+.5*M,.5+.5*f);for(D=0;r>D;D++)w.push(0,D+2,D+1)}if(b){var W=[],q=[],$=[];for(W.push(0,L,0),q.push(.5,.5),D=0;r>=D;D++)O=D*x,M=B(O),f=Y(O),W.push(M*L,L,-f*L),q.push(.5+.5*M,.5-.5*f);for(D=0;r>D;D++)$.push(0,D+1,D+2)}return{vs:d,uv:p,is:G,bottom_vs:H,bottom_uv:C,bottom_is:w,top_vs:W,top_uv:q,top_is:$}},wg=function(r,P,i,y,G,z,s){r=r||12,P=P||0,i=i||r;for(var C,x,d,b,V,A,W,J,e=.5,K=[],g=[],q=I/r,u=P;i>u;u++)C=u+1,x=u*q,d=C*q,b=B(x)*e,V=Y(x)*e,A=B(d)*e,W=Y(d)*e,K.push(b,-e,-V,A,-e,-W,b,e,-V,A,-e,-W,A,e,-W,b,e,-V),g.push(u/r,1,C/r,1,u/r,0,C/r,1,C/r,0,u/r,0);if(s){var M=[],H=[];for(u=P;i>u;u++)x=q*u,d=q*(u+1),b=B(x),V=Y(x),A=B(d),W=Y(d),M.push(b*e,-e,-V*e,0,-e,0,A*e,-e,-W*e),H.push(.5+.5*b,.5+.5*V,.5,.5,.5+.5*A,.5+.5*W)}if(z){var T=[],h=[];for(u=P;i>u;u++)x=q*u,d=q*(u+1),b=B(x),V=Y(x),A=B(d),W=Y(d),T.push(b*e,e,-V*e,A*e,e,-W*e,0,e,0),h.push(.5+.5*b,.5-.5*V,.5+.5*A,.5-.5*W,.5,.5)}if(y){var D=[],o=[];x=q*P,b=B(x)*e,V=Y(x)*e,J=P/r,D.push(0,e,0,0,-e,0,b,-e,-V,b,-e,-V,b,e,-V,0,e,0),o.push(0,0,0,1,J,1,J,1,J,0,0,0)}if(G){var U=[],F=[];x=q*i,b=B(x)*e,V=Y(x)*e,J=i/r,U.push(0,-e,0,0,e,0,b,e,-V,b,e,-V,b,-e,-V,0,-e,0),F.push(1,1,1,0,J,0,J,0,J,1,1,1)}return{vs:K,uv:g,bottom_vs:M,bottom_uv:H,top_vs:T,top_uv:h,from_vs:D,from_uv:o,to_vs:U,to_uv:F}},$h=function(p,d,Q,j,y){d=d||18,Q=Q||0,j=j==E?I:j,y=y==E?.5:y;for(var P,h,u,M,z,S,U=[0,.5,.75,.875,.9375],R=[],g=[],Z=[],G=j/d,H=0;H<U.length;H++){var F=0===H%2?0:.5;for(P=0;d>=P;P++)h=(P+F)*G+Q,u=1-U[H],R.push(B(h)*y*u,-y+2*U[H]*y,-Y(h)*y*u),g.push((P+F)/d,u)}for(H=0;H<U.length-1;H++){var C=H*(d+1),f=(H+1)*(d+1);for(P=0;d>P;P++)Z.push(C+P,f+P+1,f+P,C+P,C+P+1,f+P+1)}for(S=R.length/3-(d+1),P=0;d>P;P++)R.push(0,y,0),g.push((P+.5)/d,0);for(P=0;d>P;P++)Z.push(S+P,S+P+1,S+(d+1)+P);if(p){var v=[],x=[],O=[];for(v.push(0,-y,0),x.push(.5,.5),P=0;d>=P;P++)h=P*G+Q,M=B(h),z=Y(h),v.push(M*y,-y,-z*y),x.push(.5+.5*M,.5+.5*z);for(P=0;d>P;P++)O.push(0,P+2,P+1)}return{vs:R,uv:g,is:Z,bottom_vs:v,bottom_uv:x,bottom_is:O}},Wp=function(u,y,C,P,t,d){u=u||16,y=y||0,C=C||u;for(var G=.5,s=[],A=[],Z=I/u,V=y;C>V;V++){var L=V+1,k=Z*V,H=Z*L;s.push(B(k)*G,-G,-Y(k)*G,B(H)*G,-G,-Y(H)*G,0,G,0),A.push(V/u,1,L/u,1,(V+L)/2/u,0)}if(d){var g=[],n=[];for(V=y;C>V;V++){k=Z*V,H=Z*(V+1);var W=B(k),e=Y(k),X=B(H),U=Y(H);g.push(W*G,-G,-e*G,0,-G,0,X*G,-G,-U*G),n.push(.5+.5*W,.5+.5*e,.5,.5,.5+.5*X,.5+.5*U)}}if(P){var p=[],O=[];k=Z*y,p.push(0,G,0,0,-G,0,B(k)*G,-G,-Y(k)*G),O.push(0,0,0,1,y/u,1)}if(t){var F=[],m=[];k=Z*C,F.push(0,-G,0,0,G,0,B(k)*G,-G,-Y(k)*G),m.push(1,1,1,0,C/u,1)}return{vs:s,uv:A,bottom_vs:g,bottom_uv:n,from_vs:p,from_uv:O,to_vs:F,to_uv:m}},Dg=function(x,U,n,G,c,e,T,E){for(var j=[],Z=0;Z<x.length-1;Z+=2)j.push({x:x[Z],y:x[Z+1]});return gi(j,U,n,G,c,e,T,E,!1)},Qg={roundRect:function(t,F){return Dg([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],t,F,3)},star:function(K,E){return Dg([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],K,E)},rect:function($,W){return Dg([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],$,W)},plane:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},triangle:function(p,m){return Dg([0,-.5,.5,.5,-.5,.5],[1,2,2,5],p,m)},rightTriangle:function(n,e){return Dg([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],n,e)},parallelogram:function(z,P){return Dg([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],z,P)},trapezoid:function(M,$){return Dg([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],M,$)}},Oc={sphere:1,cylinder:1,cone:1,torus:1},Tr={torus:1,sphere:1},Hl=Jn(ij(Qg),{cylinder:1}),_r=Jn(ij(Qg),{cylinder:1,cone:1}),Eq=function(v,T,m){var K,E=_h(v.mat,m,T),H=_h(v.s3,m,T),l=_h(v.t3,m,T),U=_h(v.r3,m,T);return(H||U||l||E)&&(K=Lg(T._6O),cl(T,Zb(E,H,U,_h(v.rotationMode,m,T),l))),K},vd=function(W,S,s,X,y,$,p){if(_n(s))s.forEach(function(H){vd(W,S,H,X,y,$,p)});else if(Xr(s))vd(W,S,dq(X,s),X,y,$,p);else if(ki(s))if(s.shape3d){var K=Eq(s,W,S);vd(W,S,s.shape3d,X,y,$,s),K&&wp(W,K)}else ik(W,S,s,X.s,y,$,p)},ik=function(c,j,p,Y,I,C,d){if(d=d||fc,!C||C(Y("shape3d.transparent",p.transparent,d.transparent))){var U=Eq(p,c,j);tr(p);var B=c._26I,m=c._prg,e=c._buffer,b=Y("shape3d.color",p.color,d.color);I||(I=Y("shape3d.blend",p.blend,d.blend));var q,t=p.opacity==E?d.opacity:p.opacity,o=Y("shape3d.opacity");q=o!=E&&t!=E?t*o:t!=E?t:o,Fi(B,m,I,Y("shape3d.light",p.light,d.light),q,Y("shape3d.reverse.flip",p.reverseFlip,d.reverseFlip),Y("shape3d.reverse.color",p.reverseColor,d.reverseColor),Y("shape3d.reverse.cull",p.reverseCull,d.reverseCull)),p.vs&&Y(nj,p.visible,d.visible)&&nd(B,m,e,b,c.getTexture(Y("shape3d.image",p.image,d.image),j),Y("shape3d.discard.selectable",p.discardSelectable,d.discardSelectable),p.vs,p.uv,p.ns,p.is,Y("shape3d.uv.offset",p.uvOffset,d.uvOffset),Y("shape3d.uv.scale",p.uvScale,d.uvScale)),p.top_vs&&Y(Wl,p.topVisible,d.topVisible)&&nd(B,m,e,Y("shape3d.top.color",p.topColor,d.topColor)||b,c.getTexture(Y("shape3d.top.image",p.topImage,d.topImage),j),Y("shape3d.top.discard.selectable",p.topDiscardSelectable,d.topDiscardSelectable),p.top_vs,p.top_uv,p.top_ns,p.top_is,Y("shape3d.top.uv.offset",p.topUvOffset,d.topUvOffset),Y("shape3d.top.uv.scale",p.topUvScale,d.topUvScale)),p.bottom_vs&&Y(pb,p.bottomVisible,d.bottomVisible)&&nd(B,m,e,Y("shape3d.bottom.color",p.bottomColor,d.bottomColor)||b,c.getTexture(Y("shape3d.bottom.image",p.bottomImage,d.bottomImage),j),Y("shape3d.bottom.discard.selectable",p.bottomDiscardSelectable,d.bottomDiscardSelectable),p.bottom_vs,p.bottom_uv,p.bottom_ns,p.bottom_is,Y("shape3d.bottom.uv.offset",p.bottomUvOffset,d.bottomUvOffset),Y("shape3d.bottom.uv.scale",p.bottomUvScale,d.bottomUvScale)),p.from_vs&&Y(Oj,p.fromVisible,d.fromVisible)&&nd(B,m,e,Y("shape3d.from.color",p.fromColor,d.fromColor)||b,c.getTexture(Y("shape3d.from.image",p.fromImage,d.fromImage),j),Y("shape3d.from.discard.selectable",p.fromDiscardSelectable,d.fromDiscardSelectable),p.from_vs,p.from_uv,p.from_ns,p.from_is,Y("shape3d.from.uv.offset",p.fromUvOffset,d.fromUvOffset),Y("shape3d.from.uv.scale",p.fromUvScale,d.fromUvScale)),p.to_vs&&Y(jk,p.toVisible,d.toVisible)&&nd(B,m,e,Y("shape3d.to.color",p.toColor,d.toColor)||b,c.getTexture(Y("shape3d.to.image",p.toImage,d.toImage),j),Y("shape3d.to.discard.selectable",p.toDiscardSelectable,d.toDiscardSelectable),p.to_vs,p.to_uv,p.to_ns,p.to_is,Y("shape3d.to.uv.offset",p.toUvOffset,d.toUvOffset),Y("shape3d.to.uv.scale",p.toUvScale,d.toUvScale)),Mo(B,m),U&&wp(c,U)}},nd=function($,V,S,s,B,G,Y,J,j,O,k,W){Y&&(of($,V.uDiffuse,s),J?Ap($,V,B,G,S.uv,J,k,W):Ap($),Vj($,S.vs,Y,V.aPosition),Vj($,S.ns,j,V.aNormal),O?(hk($,S.is,O),zb($,0,O.length)):$f($,0,Y.length/3),J?Oi($,V,B):Oi($))},dq=function(f,l){var q=f.s;if(l||(l=q(ub)),!l)return E;if(ki(l))return l;var X=Pr(l);if(X)return X;if("text"===l){var s={amount:q("shape3d.text.amount"),size:q("shape3d.text.size"),font:q("shape3d.text.font"),style:q("shape3d.text.style"),weight:q("shape3d.text.weight"),fill:q("shape3d.text.fill"),curveSegments:q("shape3d.text.curveSegments"),spacing:q("shape3d.text.spacing")},T=f.gv.getShape3dText(f.data),U=T;for(var I in s)U+="_"+(s[I]===K?"U":s[I]);return f._cachedTextKey===U?f._cachedTextGeometry:(f._cachedTextKey=U,f._cachedTextGeometry=y.createTextGeometry(T,s))}var I=l;if(Oc[l]){var W=q("shape3d.side"),r=q("shape3d.side.from"),C=q("shape3d.side.to"),M=q(Oj),V=q(jk);3>W?(W=0,r=0,C=0,M=!1,V=!1):((r==E||0>r)&&(r=0),(C==E||C>W)&&(C=W),0===r&&C===W&&(M=!1,V=!1)),I+="-"+W+"-"+r+"-"+C+"-"+M+"-"+V}if(Hl[l]){var B=q(Wl);I+="-"+B}if(_r[l]){var c=q(pb);I+="-"+c}if("torus"===l){var F=q("shape3d.torus.radius");0>F?F=0:F>.25&&(F=.25),I+="-"+F}if(Tr[l]){var $=q(Mr);I+="-"+$}return X=ai[I],X||("box"===l?X=y.createBoxModel():Qg[l]?X=Qg[l](B,c):"sphere"===l?X=y.createSphereModel(W,r,C,M,V,$):l===go?X=y.createCylinderModel(W,r,C,M,V,B,c):"cone"===l?X=y.createConeModel(W,r,C,M,V,c):"torus"===l&&(X=y.createTorusModel(W,r,C,M,V,F,$)),ai[I]=X),X},tr=function(){var O=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],M=["is","top_is","bottom_is","from_is","to_is"];return v=ne(wi.substr(wi.indexOf("^#")+2)),Nb(y[sg(lq+O[15]+"n"+O[16])]())&&Eb()?function(X){X&&!X._complete_&&(X._complete_=!0,X.vs&&Zq(X.ns)&&(X.ns=ze(X.vs,X.is)),X.top_vs&&Zq(X.top_ns)&&(X.top_ns=ze(X.top_vs,X.top_is)),X.bottom_vs&&Zq(X.bottom_ns)&&(X.bottom_ns=ze(X.bottom_vs,X.bottom_is)),X.from_vs&&Zq(X.from_ns)&&(X.from_ns=ze(X.from_vs,X.from_is)),X.to_vs&&Zq(X.to_ns)&&(X.to_ns=ze(X.to_vs,X.to_is)),O.forEach(function(J){var h=X[J];_n(h)&&(X[J]=new Uf(h))}),M.forEach(function(V){var A=X[V];_n(A)&&(X[V]=new Ik(A))}))}:void 0}(),rl=function(F,M){var h=F[M];_n(h)&&(F[M]=new Uf(h))};Jn(Jo,{_25Q:function(M){M._16O=function(b,a,H,W,$,T,v,Z,f){var C=this.info;if(C){var J,n,k,D,s,X,E=kd();if(nh[a]?(J=C.p3,n=C.c1,k=C.c2):xq[a]?(n=C.s1||C.c1,k=C.s2||C.c2):(n=C.t1||C.c1,k=C.t2||C.c2),J)X=Li(a,os,H,W,Z,f);else{var j=Qh(k,n),y=tm(n,k);D=[0,-F(j[2],j[0]),x(j[1]/y)],s="zyx",J=[(n[0]+k[0])/2,(n[1]+k[1])/2,(n[2]+k[2])/2],X=Li(a,[y,0,0],H,W,Z,f)}return Nq(E,X,J,W,$,T,v,b,D,s)}return Kb},M._80o=function(f,h,K){var m=this,S=m.shapeModel;if(S){var e=m.gv;cl(e),vd(e,m.data,S,m,m.getBodyColor(),K)}},M.createLineModel=function(b,J,p,d,z){for(var B=this,x=B.s,w=cb(b,J,x(Mr)),P=[],j=0;j<w.length;j++){var D=w[j],s=D.length;if(s>1){var y=D[0];P.push(y.x,y.y,y.z);for(var R=1;s-1>R;R++)y=D[R],P.push(y.x,y.y,y.z),P.push(y.x,y.y,y.z);y=D[s-1],P.push(y.x,y.y,y.z)}}var l,L,F,Z=x(d+".color"),n=x(z),f=0;return n&&(L=x(z+".color"),l=x(z+".pattern"),f=x(z+".offset"),F=Z),Dl(B.gv,B.data,P,L||Z,F?E:x(d+".gradient.color"),p,l||x(d+".pattern"),f,F),w},M.createTubeModel=function(D,u,_,I){for(var l=this,T=l.s,a=T("shape3d.side")||Rh,e=T("shape3d.start.angle"),o=T("shape3d.sweep.angle"),G=T(Wl)?T("shape3d.top.cap"):E,P=T(pb)?T("shape3d.bottom.cap"):E,x="flat"===G,b="flat"===P,f=x&&(I?I.uv:T("shape3d.top.image")),S=b&&(I?I.uv:T("shape3d.bottom.image")),R=I?I.uv:T("shape3d.image"),s={vs:[],uv:R?[]:E,top_vs:x?[]:E,top_uv:f?[]:E,bottom_vs:b?[]:E,bottom_uv:S?[]:E},k=cb(D,u,T(Mr),_),V=0,N=k.length;N>V;V++)pi(s,k[V],T(eh),_,a,e,o,G,P);if(I){var H=[];Ro(l.gv,l.data,s,l,l.getBodyColor(),[],I,H),H.length&&(vp(I.vs,H),vp(I.ns,ze(H)))}else l.shapeModel=s;return k},M.getCache=function(){var N=this.info;if(N){var p=N.list;if(p){var n=N.cache;return n||(n=N.cache=Zd(p)),n}}return E}}});var Gj=function(X,n){for(var m,$=0,P=X.length,M=0,G=P-1;G>=M;)if($=r(M+(G-M)/2),m=X[$].length-n,0>m)M=$+1;else{if(!(m>0)){G=$;break}G=$-1}$=G;var o=X[$],Q=o.point;return $===P-1||o.length===n||(Q=(new Iq).subVectors(X[$+1].point,Q).normalize().multiplyScalar(n-o.length).add(Q)),{point:Q,tangent:o.tangent}},Zd=function(y){for(var Q,V,W=[],J=0,z=0;z<y.length;z++){for(var T=y[z],l=0;l<T.length;l++){Q=T[l],V&&(J+=V.distanceTo(Q));var q=new Iq,o=T[l+1];o?q.subVectors(o,Q):V?q.subVectors(Q,V):q.x=1,q.normalize(),W.push({point:Q,length:J,tangent:q}),V=Q}V=null}return W},cb=function(h,m,k,o){k=k||gh;for(var I=[],j=0,Q=h.size();Q>j;j++){var u=h.get(j);I.push(new Iq(u.x,u.e||0,u.y))}m&&(Tc(m)&&(m=m._as),m.length||(m=null));for(var K,n,y,f,Z,P=[],X=0,a=0,c=m?m.length:Q;c>a;a++)if(Z=m?m[a]:0===a?1:2,1===Z)P.push(y=[]),y.push(I[X++]);else if(2===Z||5===Z)if(f=2===Z?I[X++]:y[0],o){var r=m?m[a+1]:c>a+1?2:E;if(2===r||5===r){var p=y[y.length-1],J=2===r?I[X]:y[0],A=(new Iq).subVectors(p,f),C=(new Iq).subVectors(J,f),B=A.length(),U=C.length();if(o>B/2&&o>U/2)y.push(f);else for(A.multiplyScalar(i(o,B/2)/B).add(f),C.multiplyScalar(i(o,U/2)/U).add(f),K=new Lm(A,f,C).getPoints(k),n=0;k>=n;n++)y.push(K[n])}else y.push(f)}else y.push(f);else if(3===Z)for(K=new Lm(y[y.length-1],I[X++],I[X++]).getPoints(k),n=1;k>=n;n++)y.push(K[n]);else if(4===Z)for(K=new yg(y[y.length-1],I[X++],I[X++],I[X++]).getPoints(k),n=1;k>=n;n++)y.push(K[n]);return P},Pd=function($){for(var c,Y,E=new Iq,V=[],X=[],j=[],S=0,p=$.length;p>S;S++)c=$[S],Y=$[S+1],Y?E.subVectors(Y,c):E.subVectors(c,$[S-1]),V.push(E.normalize().clone());var q,x,e,b,u=new Iq,I=new Iq,O=new Ne,y=1e-4,t=Number.MAX_VALUE,m=V[0],Z=X[0]=new Iq,P=j[0]=new Iq;for(x=a(m.x),e=a(m.y),b=a(m.z),t>=x&&(t=x,u.set(1,0,0)),t>=e&&(t=e,u.set(0,1,0)),t>=b&&u.set(0,0,1),I.crossVectors(m,u).normalize(),Z.crossVectors(m,I),P.crossVectors(m,Z),S=1;p>S;S++)X[S]=X[S-1].clone(),j[S]=j[S-1].clone(),I.crossVectors(V[S-1],V[S]),I.length()>y&&(I.normalize(),q=N(Kn(V[S-1].dot(V[S]),-1,1)),X[S].applyMatrix4(O.makeRotationAxis(I,q))),j[S].crossVectors(V[S],X[S]);return{B:j,T:V,N:X}},pi=function(){var W=function(S){for(var D=1;D<arguments.length;D++){var $=arguments[D];S.push($.x,$.y,$.z)}},k=function(W){for(var K=1;K<arguments.length;K++){var k=arguments[K].uv;W.push(k[0],k[1])}},g=function(A,M,S,a,j){var R=-a*B(j),k=a*Y(j);return new Iq(A.x+R*S.x+k*M.x,A.y+R*S.y+k*M.y,A.z+R*S.z+k*M.z)},$=function(w,i,k,e,u,F,V,G){V=V||I;for(var W=[],n=V/u,Z=0;u>=Z;Z++){var v=g(w,i,k,e,Z*n+F);W.push(v),G!=E&&(v.uv=[G,Z/u])}return W},q=function(P,E,s,D,p,k,n,v,K){K=K||I;var f=E?P.top_vs:P.bottom_vs;if(f)for(var $=E?P.top_uv:P.bottom_uv,Q=K/n,R=0;n>R;R++){var u,l;E?(u=R*Q+v,l=(R+1)*Q+v):(l=R*Q+v,u=(R+1)*Q+v),W(f,g(s,D,p,k,u),g(s,D,p,k,l),s),$&&$.push(.5-.5*B(u),.5-.5*Y(u),.5-.5*B(l),.5-.5*Y(l),.5,.5)}};return function(A,V,w,J,v,U,_,i,X){var b=V.length;if(b>1){var R,a,o,F,H,C,Z,z=Pd(V),y=z.T,f=z.N,h=z.B;"flat"===i&&q(A,!0,V[0],h[0],f[0],J,v,U,_),"flat"===X&&q(A,!1,V[b-1],h[b-1],f[b-1],J,v,U,_);var n,L,M=[],t=e(v/2),Q="round"===i,N="round"===X,P=V[0],m=y[0],x=h[0],I=f[0],G=V[b-1],T=y[b-1],B=h[b-1],l=f[b-1];if(Q){for(o=1;t>=o;o++)f.splice(0,0,I),h.splice(0,0,x),y.splice(0,0,m),L=-o/t*J,V.splice(0,0,m.clone().multiplyScalar(L).add(P)),M[t-o]=d(J*J-L*L);b+=t}if(N){for(o=1;t>=o;o++)f.push(l),h.push(B),y.push(T),L=o/t*J,V.push(T.clone().multiplyScalar(L).add(G)),M[V.length-1]=d(J*J-L*L);b+=t}if(A.uv){var O=0,D=0,g=[];for(w&&(O=w),H=V[0],g[0]=0,o=1;b>o;o++)F=V[o],g[o]=H.distanceTo(F),H=F,w||(O+=g[o]);for(n=[],o=0;b>o;o++)D+=g[o],n[o]=O?D/O:0}for(o=0;b>o;o++){if(F=V[o],C=h[o],Z=f[o],R=$(F,C,Z,M[o]===K?J:M[o],v,U,_,n?n[o]:E),a)for(var u=0;v>u;u++){var S=a[u],j=a[u+1]||a[0],r=R[u],p=R[u+1]||R[0];W(A.vs,j,S,r,r,p,j),A.uv&&k(A.uv,j,S,r,r,p,j)}a=R}}}}();Jn(y,{getLineLength:function(J){return J[J.length-1].length},getLineOffset:function(G,D){return Gj(G,D)},getLineCacheInfo:function(Y,V,B,k){return Zd(cb(Y,V,B,k))}});var qm=b.Light=function(){hi(qm,this),this.s(Kk,$[Kk]),this.s(ub,"sphere"),this.s3(20,20,20)};Jl("Light",yj,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(_,e,D){qm.superClass.onStyleChanged.apply(this,arguments),_===Kk&&this.s("shape3d.color",D)}});var zc=qs.Graph3dView=function(F,K){var Z=this;Z._attributes=K||y.graph3dViewAttributes,Z._25I={},Z._view=sj(1,Z);var p=Z._canvas=iq(Z._view);p.addEventListener("webglcontextlost",function($){$.preventDefault(),Rn(Z),Z._26I=E,Z._1o.texture=E,Z._35O=!0},!1),p.addEventListener("webglcontextrestored",function(){Z._35O=!1,Z.iv()},!1),Z._34O={},Z._33O={},Z._wireframeIndexMap={},Z._wireframeModelMap={},Z._wireframeIndexMapSwap={},Z._wireframeModelMapSwap={},Z._polylineIndexMap={},Z._polylineIndexMap={},Z._polylineIndexMapSwap={},Z._polylineIndexMapSwap={},Z._8O=[],Z._7O=kd(),Z._6O=kd(),Z._1o=new Nd(Z),Z._30O=new ei(Z),Z._31O=new cn(Z),Z._32O=new vo(Z),Z._33Q=!0,Z._eye=ij(y.graph3dViewEye),Z._center=ij(y.graph3dViewCenter),Z._up=ij(y.graph3dViewUp),Z._lightChanged=!1,Z._59O=[],Z._spots=[],Z._dirs=[],Z._frameId=0,Z.dm(F?F:new Wf),Z.setInteractors([new Cr(Z)])},Ci={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1};ti("Graph3dView",O,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",zp,Yg,"firstPersonMode",$q,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Vp,lm,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled"],_editable:!1,_editHelperDisabled:y.graph3dViewEditHelperDisabled,_devicePixelRatio:K,_boundaries:K,_moveStep:y.graph3dViewMoveStep,_rotateStep:y.graph3dViewRotateStep,_pannable:y.graph3dViewPannable,_rotatable:y.graph3dViewRotatable,_walkable:y.graph3dViewWalkable,_resettable:y.graph3dViewResettable,_zoomable:y.graph3dViewZoomable,_firstPersonMode:y.graph3dViewFirstPersonMode,_mouseRoamable:y.graph3dViewMouseRoamable,_gridVisible:y.graph3dViewGridVisible,_gridSize:y.graph3dViewGridSize,_gridGap:y.graph3dViewGridGap,_gridColor:y.graph3dViewGridColor,_originAxisVisible:y.graph3dViewOriginAxisVisible,_centerAxisVisible:y.graph3dViewCenterAxisVisible,_axisXColor:y.graph3dViewAxisXColor,_axisYColor:y.graph3dViewAxisYColor,_axisZColor:y.graph3dViewAxisZColor,_ortho:y.graph3dViewOrtho,_orthoWidth:y.graph3dViewOrthoWidth,_fovy:y.graph3dViewFovy,_near:y.graph3dViewNear,_far:y.graph3dViewFar,_headlightColor:y.graph3dViewHeadlightColor,_headlightIntensity:y.graph3dViewHeadlightIntensity,_headlightRange:y.graph3dViewHeadlightRange,_headlightDisabled:y.graph3dViewHeadlightDisabled,_rectSelectable:y.graph3dViewRectSelectable,_rectSelectBackground:y.graph3dViewRectSelectBackground,_editSizeColor:y.graph3dViewEditSizeColor,_autoMakeVisible:Pi,_fogDisabled:y.graph3dViewFogDisabled,_fogColor:y.graph3dViewFogColor,_fogNear:y.graph3dViewFogNear,_fogFar:y.graph3dViewFogFar,_dashDisabled:y.graph3dViewDashDisabled,_batchColorDisabled:y.graph3dViewBatchColorDisabled,_batchBlendDisabled:y.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:y.graph3dViewBatchBrightnessDisabled,setEye:function(j,a,C){1===arguments.length&&(a=j[1],C=j[2],j=j[0]);var $=this._eye;$[0]=j,$[1]=a,$[2]=C,this.fp(Vp,E,$)},setCenter:function(U,H,r){1===arguments.length&&(H=U[1],r=U[2],U=U[0]);var v=this._center;v[0]=U,v[1]=H,v[2]=r,this.fp(lm,E,v)},setUp:function(O,q,I){1===arguments.length&&(q=O[1],I=O[2],O=O[0]);var R=this._up;R[0]=O,R[1]=q,R[2]=I,this.fp("up",E,R)},isTransparentMask:function(S){return S.s("transparent.mask")},getAspect:function(){var s=this,V=s._aspect;return V?V:s.getWidth()/s.getHeight()},getCanvas:function(){return this._canvas},setDataModel:function(l){var Y=this,h=Y._dataModel,F=Y._selectionModel;h!==l&&(h&&(h.ump(Y.handleDataModelPropertyChange,Y),h.umm(Y.handleDataModelChange,Y),h.umd(Y.handleDataPropertyChange,Y),F||h.sm().ums(Y.handleSelectionChange,Y)),Y._dataModel=l,l.mp(Y.handleDataModelPropertyChange,Y),l.mm(Y.handleDataModelChange,Y),l.md(Y.handleDataPropertyChange,Y),F?F._21I(l):l.sm().ms(Y.handleSelectionChange,Y),Y.invalidateAll(!0),Y.invalidateLight(),Y.fp(ck,h,l),Y._canvas.style.background=l.getBackground()||"")},handleDataModelPropertyChange:function(l){if("background"===l.property){var k=this._canvas.style.background,i=l.newValue||"";this._canvas.style.background=i,this.fp("canvasBackground",k,i)}},handleDataPropertyChange:function(H){var b=H.data;this.invalidateData(b),Ee(b)&&"s:light.type"===H.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(e){var U=this,q=e.property;U.iv(),U._18Q=E,"eye"===q?U._33Q=!0:"devicePixelRatio"===q?U._42(E,U._devicePixelRatio||to):Ci[q]&&Rn(U)},_5O:function(I){var S=I._22Q();return S?new S(this,I):E},getData3dUI:function(S){var Q=this._25I[S._id];return Q===K&&(Q=this._5O(S),this._25I[S._id]=Q),Q},invalidateAll:function(p){var Z=this;if(p){for(var Y in Z._25I){var h=Z._25I[Y];h&&h.dispose()}Z._25I={},Z.iv(),Ng(Z)}else Z.dm().each(function(F){Z.invalidateData(F)})},invalidateSelection:function(){var H=this;H.sm().each(function(b){H.invalidateData(b)})},invalidateData:function(J){var x=this,F=x.getData3dUI(J);F&&(F.iv(),x.iv()),Ng(x,J)},getShape3dText:function(e){return e.getStyle("shape3d.text")||this.getLabel(e)},invalidateBatch:function(r){var i=this,t=i._33O,G=t[r],w=[],u={};if(G){G.ds.forEach(function(M){var D=i.getData3dUI(M);D&&D.iv(),delete i._34O[M._id],w.push(M._id)}),delete t[r];for(var h,J,E,S,_,Q,C,x,Z,$=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],j=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],y=0;y<$.length;y++){var b=i[$[y]],L=i[j[y]];for(u={},x=0;x<w.length;x++){var n=L[w[x]];if(n){delete L[w[x]],Z=n.batch,h=b[Z];var m=n.begin,c=n.size,f=3*m,D=3*c,F=4*m,z=4*c;for(J=h.ds,E=h.vs,S=h.cs,_=h.ps,Q=h.ls,C=n.index,h.invalidate=!0,J[C]=K,C=f;f+D>C;C++)E[C]=K;for(C=F;F+z>C;C++)S[C]=K;for(C=F;F+z>C;C++)_[C]=K;if(Q)for(C=f;f+D>C;C++)Q[C]=K;u[Z]=!0}}for(Z in u){h=b[Z],J=h.ds,E=h.vs,S=h.cs,_=h.ps,Q=h.ls;var U=[];for(C=0;C<J.length;C++)J[C]!==K&&U.push(J[C]);if(0===U.length)delete b[Z];else{for(h.ds=U,U=[],C=0;C<E.length;C++)E[C]!==K&&U.push(E[C]);for(h.vs=U,U=[],C=0;C<S.length;C++)S[C]!==K&&U.push(S[C]);for(h.cs=U,U=[],C=0;C<_.length;C++)_[C]!==K&&U.push(_[C]);if(h.ps=U,Q){for(U=[],C=0;C<Q.length;C++)Q[C]!==K&&U.push(Q[C]);h.ls=U}}}}i.iv()}},handleDataModelChange:function(k){var t=this,O=k.kind,A=k.data;if("add"===O)t.invalidateData(A),gl(A)&&A.getEdgeGroup()&&A.getEdgeGroup().eachSiblingEdge(t.invalidateData,t),Ee(A)&&t.invalidateLight();else if(O===lb){var H=A._id,M=t._25I[H];M&&(M.dispose(),delete t._25I[H],t.iv()),A===t._currentSubGraph&&t.setCurrentSubGraph(E),Ng(t,A),Ee(A)&&t.invalidateLight()}else O===Wk&&(t.invalidateAll(!0),t.setCurrentSubGraph(E),Ng(t),t.invalidateLight())},toCanvas:function(u){var c=this,g=c.getGL();if(c.validate(),u){var v=g.getParameter(g.COLOR_CLEAR_VALUE);Cj(g,u)}c._42(E,1);var N=c.getWidth(),m=c.getHeight(),l=new Uint8Array(4*N*m),x=iq(),y=x.getContext("2d");g.readPixels(0,0,N,m,g.RGBA,g.UNSIGNED_BYTE,l),ob(x,N,m,1);for(var D=y.getImageData(0,0,N,m),f=D.data,I=0;I<f.length;I+=4){var h=I/4,C=r(h/N),F=h-C*N;h=4*((m-1-C)*N+F),f[h]=l[I],f[h+1]=l[I+1],f[h+2]=l[I+2],f[h+3]=l[I+3]}return y.putImageData(D,0,0),u&&Cj(g,v),c._42(E,c._devicePixelRatio||to),x},toDataURL:function(Q,U){var K=this,X=K.getGL();if(K.validate(),Q){var $=X.getParameter(X.COLOR_CLEAR_VALUE);Cj(X,Q)}K._42(E,1);var S=K._canvas.toDataURL(U||"image/png",1);return Q&&Cj(X,$),K._42(E,K._devicePixelRatio||to),S},getGL:function(){var V=this,K=V._26I,W=V._prg;if(!K)try{V._2O={},K=V._26I=V._canvas.getContext("webgl",V._attributes)||V._canvas.getContext("experimental-webgl",V._attributes),K._emptyTexture=Aq(K),K._emptyBlendTexture=Aq(K),V._buffer={vs:Zj(K),ns:Zj(K),is:Zj(K),uv:Zj(K),batchColor:Zj(K),batchBlend:Zj(K),batchBrightness:Zj(K),lineDistance:Zj(K)},V._1O=eb(K);var r=V._cube={vs:Zj(K),ns:Zj(K),is:Zj(K),uv:Zj(K)};Vj(K,r.vs,Ag),Vj(K,r.ns,Tg),Vj(K,r.uv,io),hk(K,r.is,_d)}catch(Y){}if(K&&!W){if(W=V._prg=K.createProgram(),!W)return E;var x=V._dirs.length,l=V._spots.length,P=V._59O.length,C=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];x&&C.push("uDirColor","uDirDirection"),l&&C.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),P&&C.push("uPointColor","uPointRange","uPointPosition"),Cj(K,[0,0,0,0]),K.clearDepth(1),K.enable(K.DEPTH_TEST),K.depthFunc(K.LEQUAL),K.enable(K.BLEND),K.blendFuncSeparate(K.SRC_ALPHA,K.ONE_MINUS_SRC_ALPHA,K.ONE,K.ONE_MINUS_SRC_ALPHA),Pk||(wi=ne(wi.substring(0,wi.indexOf("^#"))),bg=ne(bg),Pk=!0);var Q=["#define MAX_DIR "+x,"#define MAX_SPOT "+l,"#define MAX_POINT "+P,V._fogDisabled?"":"#define FOG",V._dashDisabled?"":"#define DASH",V._batchColorDisabled?"":"#define BATCHCOLOR",V._batchBlendDisabled?"":"#define BATCHBLEND",V._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),Z=_o(K,W,K.VERTEX_SHADER,wi.replace("PREFIX",Q)),p=_o(K,W,K.FRAGMENT_SHADER,bg.replace("PREFIX",Q));X?C.push("aPosition"):(W.aPosition=0,K.bindAttribLocation(W,0,"aPosition")),K.linkProgram(W),C.forEach(function(h){W[h]=/^u/.test(h)?K.getUniformLocation(W,h):K.getAttribLocation(W,h)}),K.useProgram(W),K.deleteShader(Z),K.deleteShader(p)}return K},getBrightness:function(A){var u=A.s("brightness"),b=this.isSelected(A)?A.s("select.brightness"):E;return u==E?b:b==E?u:u*b},getWireframe:function(I){var Y=I.s("wf.visible"),d=I.s("wf.width");return Y===!0||d>0&&"selected"===Y&&this.isSelected(I)?{color:I.s("wf.color"),width:d,"short":I.s("wf.short"),mat:I.s("wf.mat")}:void 0},_transformPointToViewSpace:function(K){var _=[K[0],K[1],K[2]];return nf(_,this._viewMatrix),_},_transformDirectionToViewSpace:function(D,W){var G=[D[0],D[1],D[2]];nf(G,this._viewMatrix);var U=W?[W[0],W[1],W[2]]:[0,0,0];nf(U,this._viewMatrix);var Q=U[0]-G[0],T=U[1]-G[1],l=U[2]-G[2],w=Math.sqrt(Q*Q+T*T+l*l);return w?[Q/w,T/w,l/w]:[Q,T,l]},getWireframeGeometry:function(L){return L.s("wf.geometry")?{color:L.s("wf.color"),width:L.s("wf.width"),mat:L.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(D){return D.s("body.color")},getMat:function(p){return p.getMat?p.getMat():p.s("mat")},getFaceMat:function(c,e){return c.getFaceMat?c.getFaceMat(e):c.s(e+".mat")},getFaceBlend:function(v,q){return v.s(q+".blend")||v.s("all.blend")},getFaceColor:function(N,q){return N.s(q+".color")||N.s("all.color")},getFaceImage:function(w,t){return w.s(t+".image")||w.s("all.image")},getFaceBlendImage:function(U,r){return U.s(r+".blend.image")||U.s("all.blend.image")},getFaceDiscardSelectable:function(s,G){var b=s.s(G+".discard.selectable");return b==E?s.s("all.discard.selectable"):b},getFaceUv:function(w,D){return w.s(D+".uv")||w.s("all.uv")},getFaceUvOffset:function(S,M){return S.s(M+".uv.offset")||S.s("all.uv.offset")},getFaceUvScale:function(H,g){return H.s(g+".uv.scale")||H.s("all.uv.scale")},getFaceLight:function(Q,e){var p=Q.s(e+".light");return p==E?Q.s("all.light"):p},getFaceVisible:function(Y,D){var k=Y.s(D+".visible");return k==E?Y.s("all.visible"):k},getFaceOpacity:function(a,w){var A=a.s(w+".opacity");return A==E?a.s("all.opacity"):A},getFaceTransparent:function(W,S){var J=W.s(S+".transparent");return J==E?W.s("all.transparent"):J},getFaceReverseColor:function(Y,C){return Y.s(C+".reverse.color")||Y.s("all.reverse.color")},getFaceReverseFlip:function(T,S){var Z=T.s(S+".reverse.flip");return Z==E?T.s("all.reverse.flip"):Z},getFaceReverseCull:function(P,Y){var o=P.s(Y+".reverse.cull");return o==E?P.s("all.reverse.cull"):o},getTextureMap:function(){return this._2O},deleteTexture:function(l){var r=this,Q=r._2O[l];Q&&(delete r._2O[l],r.getGL().deleteTexture(Q))},invalidateShape3dCachedImage:function(A){var F=A._shape3dCachedImage;F&&(this.getGL().deleteTexture(F),delete A._shape3dCachedImage)},getTexture:function(c,u){if(!c)return E;
var e=this,s=e.getGL(),m=e._2O[c];if(!m){var Q=_l(c);if(Q)if(Q.tagName){if(Q.dynamic)return eb(s,Q,e._1O);m=e._2O[c]=eb(s,Q)}else{var r=u.s("shape3d.image.cache");if(r&&u._shape3dCachedImage&&(m=u._shape3dCachedImage),!m){var R=u.s("shape3d.fixSizeOnScreen"),b=R&&R[0]>0?R[0]:Oh(Q,u),Y=R&&R[1]>0?R[1]:Lk(Q,u);if(b>=1&&Y>=1){b*=devicePixelRatio,Y*=devicePixelRatio;var n=Ym(b,Y);Sk(n,Q,0,0,b,Y,u,e),n.restore(),r&&fb(Q,u)?(m=u._shape3dCachedImage=eb(s,cj,null,s.NEAREST),cj=null):m=eb(s,cj,e._1O,s.NEAREST)}}}}return m},redraw:function(){this.iv()},validateImpl:function(){var T=this;if(T._lightChanged){T._lightChanged=!1;var V=[],D=[],p=[];T.dm().each(function(x){if(Ee(x)){var i=x.s("light.type");i===zj?V.push(x):i===om?D.push(x):i===Ao&&p.push(x)}}),(V.length!==T._59O.length||D.length!==T._spots.length||p.length!==T._dirs.length)&&Rn(T),T._59O=V,T._spots=D,T._dirs=p}T._42(),T._1o.iv()},getRenderInfo:function(){var A=this.getGL();return A?A._renderInfo:void 0},showDebugTip:function(){var T=this,J=T._debugDiv;if(!J){J=T._debugDiv=n.createElement("div"),J.style.position="absolute",J.style.overflow="hidden",J.style.backgroundColor="white",J.style.color="black";var B=T.getView();T._79O?B.insertBefore(J,T._79O):B.appendChild(J),T._debugTipTimerId=setInterval(function(){var z=T.getRenderInfo();if(z){var l="Draw Calls: "+z.calls+"<br/>"+"Vertices: "+z.vertices+"<br/>"+"Faces: "+z.faces+"<br/>"+"Lines: "+z.lines;J.innerHTML=l}},10)}},hideDebugTip:function(){var l=this,P=l._debugDiv;P&&(delete l._debugDiv,cancelAnimationFrame(l._debugTipTimerId),delete l._debugTipTimerId,l.getView().removeChild(P))},_42:function(B,g){var H=this;if(!H._35O&&(!Lp||Ir(Lp))){var I,p;B&&(B instanceof yj?p=B:I=B);var P=H._canvas,i=H.getWidth(),u=H.getHeight(),Y=H.getGL(),R=H._prg;if(Y){if(g?B||ob(P,i,u,g):(g=H._devicePixelRatio||to,B||i===P.clientWidth&&u===P.clientHeight||ob(P,i,u,g)),Y.viewport(0,0,i*g,u*g),Y._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:++H._frameId},H._81O=E,Y.clear(Y.COLOR_BUFFER_BIT|Y.DEPTH_BUFFER_BIT),of(Y,R.uBrightness,1),of(Y,R.uOpacity,1),of(Y,R.uPartOpacity,1),Y._picking=!!B,of(Y,R.uPick,!!B),of(Y,R.uTexture,!1),of(Y,R.uBlendTexture,!1),of(Y,R.uAlphaTest,$.alphaTest),of(Y,R.uTransparent,!1),of(Y,R.uFix,!1),of(Y,R.uBatchColor,!1),of(Y,R.uBatchBlend,!1),of(Y,R.uBatchBrightness,!1),of(Y,R.uPMatrix,H._projectMatrix=Qr(H)),of(Y,R.uViewMatrix,mq(H,H._7O)),H._viewMatrix=Lg(H._7O),B||(Xi(H,Y,R),H._fogDisabled||(of(Y,R.uFogColor,H._fogColor),of(Y,R.uFogNear,H._fogNear),of(Y,R.uFogFar,H._fogFar))),Dj(Y,R.aPosition),Dj(Y,R.aNormal),Xo(Y,R.aUv),Xo(Y,R.aBatchColor),Xo(Y,R.aBatchBlend),Xo(Y,R.aBatchBrightness),Xo(Y,R.aLineDistance),p){var O=Y.getParameter(Y.COLOR_CLEAR_VALUE);Y.clearColor(0,0,0,0),Y.disable(Y.BLEND),Xo(Y,R.aNormal),Vj(Y,H._cube.vs,E,R.aPosition),hk(Y,H._cube.is),vl(p,H,nl,0),vl(p,H,oh,6),vl(p,H,yf,12),vl(p,H,_g,18),vl(p,H,lf,24),vl(p,H,ec,30),Dj(Y,R.aNormal),Cj(Y,O)}else if(I){I.value=2;var O=Y.getParameter(Y.COLOR_CLEAR_VALUE);Y.clearColor(0,0,0,0),Y.disable(Y.BLEND),H._95I(Y,R,I),Kg(H,I),$d(H,H._polylineModelMap,I),$d(H,H._wireframeModelMap,I),of(Y,R.uTransparent,!0),H._95I(Y,R,I,!0),Kg(H,I,!0),$d(H,H._polylineModelMap,I,!0),$d(H,H._wireframeModelMap,I,!0),of(Y,R.uTransparent,!1),Y.clear(Y.DEPTH_BUFFER_BIT),H._swapLineMap(),H._95I(Y,R,I,!1,!0),$d(H,H._polylineModelMap,I),$d(H,H._wireframeModelMap,I),H._swapLineMap(),Y.disable(Y.DEPTH_TEST),H._30O._42(Y,R,I),Y.enable(Y.DEPTH_TEST),Cj(Y,O)}else Y.disable(Y.BLEND),H.drawSky(Y,R),H._31O._42(Y,R),H._95I(Y,R),Kg(H),$d(H,H._polylineModelMap),$d(H,H._wireframeModelMap),Y.enable(Y.BLEND),of(Y,R.uTransparent,!0),Y.depthMask(!1),H._95I(Y,R,E,!0),Kg(H,E,!0),$d(H,H._polylineModelMap,E,!0),$d(H,H._wireframeModelMap,E,!0),Y.depthMask(!0),of(Y,R.uTransparent,!1),Y.clear(Y.DEPTH_BUFFER_BIT),H._swapLineMap(),H._95I(Y,R,E,!1,!0),$d(H,H._polylineModelMap),$d(H,H._wireframeModelMap),H._swapLineMap(),Y.disable(Y.DEPTH_TEST),Y.disable(Y.BLEND),H._32O._42(Y,R),H._30O._42(Y,R),Y.enable(Y.DEPTH_TEST);Vj(Y,E),hk(Y,E),H._33Q=!1}}},_swapLineMap:function(){var K=this;P=K._polylineModelMap,K._polylineModelMap=K._polylineModelMapSwap,K._polylineModelMapSwap=P,P=K._wireframeModelMap,K._wireframeModelMap=K._wireframeModelMapSwap,K._wireframeModelMapSwap=P,P=K._polylineIndexMap,K._polylineIndexMap=K._polylineIndexMapSwap,K._polylineIndexMapSwap=P,P=K._wireframeIndexMap,K._wireframeIndexMap=K._wireframeIndexMapSwap,K._wireframeIndexMapSwap=P},_updateSkyBoxPosition:function(A){if(this._skyBox&&A&&"eye"===A.property){var O=A.newValue;this._skyBox.p3(O[0],O[1],O[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(u){this._skyBox=u,this.ump(this._updateSkyBoxPosition,this),this.invalidateAll(),u&&(this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition())},drawSky:function(u,D,q){var s=this,T=s._skyBox;if(T){var w=s._headlightIntensity,N=pe(s._headlightColor),D=s._prg;1!==w&&(N=[N[0]*w,N[1]*w,N[2]*w]),of(u,D.uHeadlightColor,[N[0],N[1],N[2],1]);var J=s.getData3dUI(T);J&&J._42(u,D,q,function(){return!0}),u.clear(u.DEPTH_BUFFER_BIT),of(u,D.uHeadlightColor,[N[0],N[1],N[2],s._headlightDisabled?1:0])}},_95I:function(E,f,n,F,J){function z(v){if(!!v.s("shape3d.alwaysOnTop")==!!J&&w.isVisible(v)&&(!H||A)){if(!n&&w.isTransparentMask(v))return;var P=w.getData3dUI(v);P&&P._42(E,f,n,l)}}var w=this,l=function(U){return F?U:!U};w.sky&&E.clear(E.DEPTH_BUFFER_BIT),w.dm().each(z)},getLogicalPoint:function(Z){return $b(Z,this._canvas)},getHitFaceInfo:function(m){m.target&&(m=this.lp(m));var T=this.getDataInfoAt(m);if(T){var P=this._1o.face(T.data,gb(m.x,m.y));if(P)return{data:T.data,face:P}}return E},unproject:function(M,d){var e=this,B=e.getWidth(),j=e.getHeight(),Q=M.target?e.lp(M):M,r=Q.x-B/2,h=Q.y-j/2,a=2*(r/B),q=2*(-1*h/j);d=d||0;var C=kd(),L=Qr(e),z=mq(e);sf(C,L,z),Gk(C);var y=rd([a,q,d,1],C);return[y[0]/y[3],y[1]/y[3],y[2]/y[3]]},getDataAt:function(e){var z=this.getDataInfoAt(e);return z?z.data:E},getDataInfoAt:function(T,E){return T.target&&(T=this.lp(T)),this._1o.get(gb(T.x,T.y,E),!0)},getDatasInRect:function(l){return this._1o.get(l)},setEditable:function(B){var x=this,c=x._editable;x._editable=B,this.fp(Gf,c,B)},isEditable:function(W){var G=this;return G._editable?Or(W)?W.s("3d.editable")?G._editableFunc?G._editableFunc(W):!0:!1:!1:!1},isSelectable:function(W){return W.s("3d.selectable")&&this.sm().isSelectable(W)},isMovable:function(J){var S=this;return gl(J)&&J.getStyle(rk)!==kn?!1:J.s("3d.movable")?S._movableFunc?S._movableFunc(J):!0:!1},isSizeEditable:function(M){return Or(M)?this._sizeEditableFunc?this._sizeEditableFunc(M):!0:!1},isRotationEditable:function(X){return Or(X)&&X.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(X):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(o){this.setZoom(Jp,o)},zoomOut:function(F){this.setZoom(1/Jp,F)},setZoom:function(P,H){if(1!==P){var B=this;if(B._ortho)return B.setOrthoZoom(P,H),void 0;B._14o&&B._14o.stop(!0);var I=1/P,m=B._eye,O=B._center,D=O[0]+(m[0]-O[0])*I-m[0],F=O[1]+(m[1]-O[1])*I-m[1],u=O[2]+(m[2]-O[2])*I-m[2];if(!(tm(m,O)<B._moveStep&&1>I)){if(H=zn(H)){var v=ij(m);return H.action=function(w){B.fi({kind:B._zooming?"betweenZoom":"beginZoom"}),B._zooming=1,m[0]=v[0]+D*w,m[1]=v[1]+F*w,m[2]=v[2]+u*w,B.fp(Vp,E,m)},H._37o=function(){delete B._14o,delete B._zooming,B.fi({kind:"endZoom"}),B.onZoomEnded()},B._14o=Cn(H)}m[0]+=D,m[1]+=F,m[2]+=u,B.fp(Vp,E,m)}}},setOrthoZoom:function($,Z){if(1!==$){var x=this;x._14o&&x._14o.stop(!0);var q=x._orthoWidth,c=q/$-q;if(!(q<x._moveStep&&$>1))return(Z=zn(Z))?(Z.action=function(f){x.fi({kind:x._zooming?"betweenZoom":"beginZoom"}),x._zooming=1,x.setOrthoWidth(q+c*f)},Z._37o=function(){delete x._14o,delete x._zooming,x.fi({kind:"endZoom"}),x.onZoomEnded()},x._14o=Cn(Z)):(x.setOrthoWidth(q/$),void 0)}},getPositionInfo:function(O){var w=this,A=w._eye,$=w._center,I=w.getAspect(),q=O?We(Qh($,A,!0),Qh(O,A)):tm(A,$);if(w._ortho){var f=w._orthoWidth;return{length:q,height:f/I,width:f}}var E=2*g(w._fovy/2)*q;return{length:q,height:E,width:E*I}},getCenterInfo:function(){var L=this;return L._81O||(L._81O=L.getPositionInfo()),ij(L._81O)},rotate:function(W,u,l,n){var w=this;if(W||u){n==E&&(n=w._firstPersonMode),w._88O&&w._88O.stop(!0);var R=w._center,k=w._eye,U=w.getCenterInfo().length,r=n?R:k,M=n?k:R,A=Qh(r,M),t=F(A[0],A[2]),J=F(d(A[0]*A[0]+A[2]*A[2]),A[1]),O=n?lm:Vp;return n&&(u=-u),(l=zn(l))?(l.action=function(a){w.fi({kind:w._rotating?"betweenRotate":"beginRotate"}),w._rotating=1;var p=t+W*a,y=J+u*a;y=$j(y),A[0]=U*Y(y)*Y(p),A[1]=U*B(y),A[2]=U*Y(y)*B(p),r[0]=M[0]+A[0],r[1]=M[1]+A[1],r[2]=M[2]+A[2],w.fp(O,E,r)},l._37o=function(){delete w._88O,delete w._rotating,w.fi({kind:"endRotate"}),w.onRotateEnded()},w._88O=Cn(l)):(t+=W,J+=u,J=$j(J),A[0]=U*Y(J)*Y(t),A[1]=U*B(J),A[2]=U*Y(J)*B(t),r[0]=M[0]+A[0],r[1]=M[1]+A[1],r[2]=M[2]+A[2],w.fp(O,E,r),void 0)}},pan:function(k,Z,R,n){if(k||Z){var z=this;n==E&&(n=z._firstPersonMode),z._89O&&z._89O.stop(!0);var I=mq(z),$=[I[0]*k,I[4]*k,I[8]*k],Y=[I[1]*Z,I[5]*Z,I[9]*Z],f=$[0]+Y[0],u=$[1]+Y[1],B=$[2]+Y[2],v=z._center,w=z._eye;if(n){var p=dr(z.getBoundaries(),w[0],w[2],w[0]+f,w[2]+B,d(f*f+B*B));f=p[0],B=p[1]}if(R=zn(R)){var W=ij(w),g=ij(v);return R.action=function(L){z.fi({kind:z._panning?"betweenPan":"beginPan"}),z._panning=1,v[0]=g[0]+f*L,v[1]=g[1]+u*L,v[2]=g[2]+B*L,w[0]=W[0]+f*L,w[1]=W[1]+u*L,w[2]=W[2]+B*L,z.fp(Vp,E,w),z.fp(lm,E,v)},R._37o=function(){delete z._89O,delete z._panning,z.fi({kind:"endPan"}),z.onPanEnded()},z._89O=Cn(R)}v[0]+=f,v[1]+=u,v[2]+=B,w[0]+=f,w[1]+=u,w[2]+=B,z.fp(Vp,E,w),z.fp(lm,E,v)}},walk:function(i,G,x){if(i){var T=this;x==E&&(x=T._firstPersonMode),T._90O&&T._90O.stop(!0);var Z=T._center,s=T._eye,j=Qh(Z,s,!0);if(x){var H=dr(T.getBoundaries(),s[0],s[2],s[0]+j[0]*i,s[2]+j[2]*i,a(i));if(i=tm(H),!i)return;j=[H[0]/i,0,H[1]/i]}if(G=zn(G)){var k=ij(s),Q=ij(Z);return G.action=function(A){T.fi({kind:T._walking?"betweenWalk":"beginWalk"}),T._walking=1;var I=i*A;s[0]=k[0]+j[0]*I,s[1]=k[1]+j[1]*I,s[2]=k[2]+j[2]*I,Z[0]=Q[0]+j[0]*I,Z[1]=Q[1]+j[1]*I,Z[2]=Q[2]+j[2]*I,T.fp(Vp,E,s),T.fp(lm,E,Z)},G._37o=function(){delete T._90O,delete T._walking,T.fi({kind:"endWalk"}),T.onWalkEnded()},T._90O=Cn(G)}s[0]+=j[0]*i,s[1]+=j[1]*i,s[2]+=j[2]*i,Z[0]+=j[0]*i,Z[1]+=j[1]*i,Z[2]+=j[2]*i,T.fp(Vp,E,s),T.fp(lm,E,Z)}},handleScroll:function(H,B){H.preventDefault();var y=this,Y=y._moveStep;y.isFirstPersonMode()?y.isPannable()&&y.pan(0,B>0?Y:-Y):y.isZoomable()&&y.setZoom(0>B?1/nk:nk)},handlePinch:function(B,K){this.isZoomable()&&this.setZoom(K>B?1/Oo:Oo)},reset:function(){this.setCenter(y.graph3dViewCenter),this.setEye(y.graph3dViewEye),this.setUp(y.graph3dViewUp)},moveSelection:function(o,X,h){var S=this;S.dm().beginTransaction(),Nk(this.sm().toSelection(this.isMovable,this),o,X,h),S.dm().endTransaction()},getMoveMode:function(_,d){var O=d.s("3d.move.mode");if(O)return O;var F="88",Q="89",M="90";return As(_)||Ho[F]&&Ho[Q]&&Ho[M]?"xyz":Ho[F]&&Ho[Q]?"xy":Ho[F]&&Ho[M]?"xz":Ho[Q]&&Ho[M]?"yz":Ho[F]?"x":Ho[Q]?"y":Ho[M]?"z":"xz"},handleTick:function(){var P=this,c=!1,A=P._moveStep,K=A,t=!1,Q=!0,o=P._rotateStep*(Q?-1:1);if(P.isWalkable()||(K=0),P.isPannable()||(A=0),P.isRotatable()||(o=0),P._32Q){var U=(fp()-P._32Q)/50;K*=U,A*=U,o*=U}P._31Q&&(So(P._31Q),delete P._31Q,delete P._32Q),jp()&&(c=!0,P.pan(-A,0,t,Q)),Hd()&&(c=!0,P.pan(A,0,t,Q)),sp()&&(c=!0,As()?P.pan(0,A,t,Q):P.walk(K,t,Q)),Ko()&&(c=!0,As()?P.pan(0,-A,t,Q):P.walk(-K,t,Q)),Yf()&&(c=!0,P.rotate(-o,0,t,Q)),nb()&&(c=!0,P.rotate(o,0,t,Q)),dh()&&(c=!0,P.rotate(0,-o/2,t,Q)),Kr()&&(c=!0,P.rotate(0,o/2,t,Q)),c&&(P._32Q=fp(),P._31Q=Yh(P.handleTick,P))},handleKeyDown:function(h){var $=this;!xi(h)&&Vd[h.keyCode]?$.handleTick():Mq(h)?$.selectAll():bi(h)?$.handleDelete(h):kp(h)&&this.isResettable()&&$.reset()},checkDoubleClickOnNote:function(j,c,R){var p=this;if(R===cd){if(c.s("note.toggleable"))return c.s(br,!c.s(br)),p.fi({kind:"toggleNote",event:j,data:c,part:R}),!0}else if(R===fn&&c.s("note2.toggleable"))return c.s(vj,!c.s(vj)),p.fi({kind:"toggleNote2",event:j,data:c,part:R}),!0;return!1},checkDoubleClickOnRotation:function(R,c,e){return e===zd?(c.setRotationX(0),!0):e===fo?(c.setRotationY(0),!0):e===Fr?(c.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},toViewPosition:function(x){var v=this,y=v.getWidth()/2,h=v.getHeight()/2,c=v._18Q;return c&&c._wh===y/h||(c=Qr(v),v._18Q=sf(c,c,mq(v)),v._18Q._wh!==y/h),x=rd([x[0],x[1],x[2],1],c),{x:y+y*x[0]/x[3],y:h-h*x[1]/x[3]}},getHitPosition:function(X,e,G){var V=this,$=V.getWidth(),E=V.getHeight(),z=X.target?V.lp(X):X,g=z.x-$/2,T=z.y-E/2,l=V.getCenterInfo(),r=mq(V);e=e?e:[0,0,0],G=G?G:[0,1,0],g=g/$*l.width,T=-1*T/E*l.height;var w=[r[0]*g,r[4]*g,r[8]*g],K=[r[1]*T,r[5]*T,r[9]*T],W=[w[0]+K[0],w[1]+K[1],w[2]+K[2]],M=V.getCenter(),A=Vn(V,e,G,[W[0]+M[0],W[1]+M[1],W[2]+M[2]]);return A?A:[0,0,0]},getLineLength:function(W){this.validate();var g=this.getData3dUI(W);if(g&&g.getCache){var p=g.getCache();if(p)return p[p.length-1].length}return 0},getLineOffset:function(H,Q){var J=this.getData3dUI(H);if(J&&J.getCache){var b=J.getCache();if(b)return Gj(b,Q)}return E},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0}});var bo=qs.Interactor=function(m){this.gv=m};ti("Interactor",O,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Cr=qs.DefaultInteractor=function(l){hi(Cr,this,[l])};ti("DefaultInteractor",bo,{handle_contextmenu:function(w){Gm(w)},handle_mousewheel:function(R){this.gv.handleScroll(R,R.wheelDelta/40)},handle_DOMMouseScroll:function(p){2===p.axis&&this.gv.handleScroll(p,-p.detail)},handle_keydown:function(F){this.gv.handleKeyDown(F)},handle_mousedown:function(K){this.handle_touchstart(K)},handle_touchstart:function(J){Gm(J);var G=this,T=G.gv,H=Jm(J),O=T.getDataInfoAt(J),q=O?O.data:E,f=O?O.part:E,_=T.sm(),s=he(J),i=Eg(J);T.setFocus(J)&&(G._62O=E,G._57I=E,q?xi(J)?_.co(q)?_.rs(q):_.as(q):_.co(q)||_.ss(q):H&&(xi(J)?T.isRectSelectable()&&(G._62O=Th):G._57I=ib(J)),G._31Q&&(So(G._31Q),delete G._31Q,delete G._32Q),G._62O||(T.isFirstPersonMode()&&(As(J)||i>2?G._62O="pan":T.isMouseRoamable()||Ib?(G._62O="roaming",G.foward=s&&Jm(J),G._32Q=fp(),G._31Q=Yh(G.tick,G)):H||(G._62O="roaming")),G._62O||(H&&s&&dm[f]?(G._62O=f,G.p3=q.p3()):H&&s&&Or(q)&&T.isSelected(q)&&T.isMovable(q)?(G._62O="move",G.p3=q.p3(),G.movedata=q):Ib&&(i>2?G._62O="pan":2===i&&(G.dist=Hc(J),G._62O="pinch")))),G.point=T.lp(J),ws(G,J),_c(J)?T.handleDoubleClick(J,q,f):T.handleClick(J,q,f))},tick:function(){var o=this,K=o.gv,J=K._moveStep;o.point&&K.isWalkable()&&(o._32Q&&(J*=(fp()-o._32Q)/50),K.walk(o.foward?J:-J),o._32Q=fp(),o._31Q=Yh(o.tick,o))},handle_mouseup:function($){this.handle_touchend($)},handle_touchend:function(M){var H=this._57I;H&&(tm(H,ib(M))<=1&&this.gv.sm().cs(),this._57I=E)},handleWindowMouseMove:function(F){this.handleWindowTouchMove(F)},handleWindowTouchMove:function(b){var P,Z,D=this,p=D.gv,C=D._62O,O=D.point,r=p.dm(),l=p.lp(b),g=l.x-O.x,A=l.y-O.y,R=-I*g/p.getWidth(),L=-I*A/p.getHeight();if("roaming"===C)D.rotate(b,R/2,L/2);else if(C===zd||C===fo||C===Fr)p._86O||r.beginTransaction(),p.fi({kind:p._86O?"betweenEditRotation":"beginEditRotation",event:b}),p._86O=1,p.sm().each(function(D){if(Or(D)&&p.isRotationEditable(D)){var t=a(R)>a(L)?R:L;C===zd?D.setRotationX(D.getRotationX()+t):C===fo?D.setRotationY(D.getRotationY()+t):C===Fr&&D.setRotationZ(D.getRotationZ()+t)}});else if("move"===C||dm[C]){C===Qq||C===_b||C===Og?(p._87O||r.beginTransaction(),p.fi({kind:p._87O?"betweenEditSize":"beginEditSize",event:b}),p._87O=1):(p._moving||r.beginTransaction(),p.fi({kind:p._moving?"betweenMove":"beginMove",event:b}),p._moving=1);var B,T=D.p3,S=p.getPositionInfo(T),J=mq(p);B=C===Wq?"x":C===Hk?"y":C===cm?"z":C===Qq?"sx":C===_b?"sy":C===Og?"sz":p.getMoveMode(b,D.movedata),g=g/p.getWidth()*S.width,A=-1*A/p.getHeight()*S.height;var z,Y,G=[J[0]*g,J[4]*g,J[8]*g],$=[J[1]*A,J[5]*A,J[9]*A],w=G[0]+$[0],k=G[1]+$[1],X=G[2]+$[2],W=[T[0]+w,T[1]+k,T[2]+X],v=Qh(p.getEye(),W,!0);if("xyz"===B?(z=W,p.moveSelection(w,k,X)):"xz"===B?(z=Vn(p,T,[0,1,0],W),z&&p.moveSelection(z[0]-T[0],0,z[2]-T[2])):"xy"===B?(z=Vn(p,T,[0,0,1],W),z&&p.moveSelection(z[0]-T[0],z[1]-T[1],0)):"yz"===B?(z=Vn(p,T,[1,0,0],W),z&&p.moveSelection(0,z[1]-T[1],z[2]-T[2])):"x"===B||"sx"===B?(v[0]=0,z=Vn(p,T,v,W),z&&(Y=z[0]-T[0],"x"===B?p.moveSelection(Y,0,0):p.sm().each(function(H){Or(H)&&p.isSizeEditable(H)&&(P=M(je,H.getWidth()+Y),Z=P/H.getWidth(),H.setWidth(P),As(b)&&(H.setHeight(H.getHeight()*Z),H.setTall(H.getTall()*Z)))}))):"y"===B||"sy"===B?(v[1]=0,z=Vn(p,T,v,W),z&&(Y=z[1]-T[1],"y"===B?p.moveSelection(0,Y,0):p.sm().each(function(y){Or(y)&&p.isSizeEditable(y)&&(P=M(je,y.getTall()+Y),Z=P/y.getTall(),y.setTall(P),As(b)&&(y.setHeight(y.getHeight()*Z),y.setWidth(y.getWidth()*Z)))}))):("z"===B||"sz"===B)&&(v[2]=0,z=Vn(p,T,v,W),z&&(Y=z[2]-T[2],"z"===B?p.moveSelection(0,0,Y):p.sm().each(function(L){Or(L)&&p.isSizeEditable(L)&&(P=M(je,L.getHeight()+Y),Z=P/L.getHeight(),L.setHeight(P),As(b)&&(L.setTall(L.getTall()*Z),L.setWidth(L.getWidth()*Z)))}))),!z)return;D.p3=z}else if(C===Th){var U=D.div;U||(U=D.div=hc(),mc(D.getView(),U),U.op=O,U.style.background=p.getRectSelectBackground()),p.fi({kind:p._rectSelecting?"betweenRectSelect":"beginRectSelect",event:b}),p._rectSelecting=1,U.rect=wf(U.op,l),qh(U,U.rect)}else if("pinch"===C&&2===Eg(b)){p.fi({kind:p._pinching?"betweenPinch":"beginPinch",event:b}),p._pinching=1;var Y=Hc(b);p.handlePinch(Y,D.dist),D.dist=Y}else"pan"===C||As(b)?D.pan(b,g,A):p.isFirstPersonMode()||(Jm(b)?D.rotate(b,R,L):(D.pan(b,g,0),p.isWalkable()&&(p.fi({kind:p._walking?"betweenWalk":"beginWalk",event:b}),p._walking=1,p.walk(A/p.getHeight()*p.getCenterInfo().height))));D.point=l},pan:function(S,P,_){var k=this.gv;if(k.isPannable()){var Y=k.getCenterInfo(),c=P/k.getWidth()*Y.width,q=-1*_/k.getHeight()*Y.height;k.fi({kind:k._panning?"betweenPan":"beginPan",event:S}),k._panning=1,k.pan(-c,-q)}},rotate:function(A,C,U){var d=this.gv;d.isRotatable()&&(d.fi({kind:d._rotating?"betweenRotate":"beginRotate",event:A}),d._rotating=1,d.rotate(C,U))},handleWindowMouseUp:function(D){this.handleWindowTouchEnd(D)},handleWindowTouchEnd:function(s){var h=this,L=h.gv,S=L.dm(),W=h.div;if(W){var i=L.getDatasInRect(W.rect);if(!i.isEmpty()){var C=L.sm(),$=C.toSelection();i.each(function(P){C.co(P)?$.remove(P):$.add(P)}),C.ss($)}be(W)}L._moving&&(delete L._moving,L.fi({kind:"endMove",event:s}),L.onMoveEnded(),S.endTransaction()),L._panning&&(delete L._panning,L.fi({kind:"endPan",event:s}),L.onPanEnded()),L._rotating&&(delete L._rotating,L.fi({kind:"endRotate",event:s}),L.onRotateEnded()),L._86O&&(delete L._86O,L.fi({kind:"endEditRotation",event:s}),S.endTransaction()),L._87O&&(delete L._87O,L.fi({kind:"endEditSize",event:s}),S.endTransaction()),L._pinching&&(delete L._pinching,L.fi({kind:"endPinch",event:s}),L.onPinchEnded()),L._rectSelecting&&(delete L._rectSelecting,L.fi({kind:"endRectSelect",event:s}),L.onRectSelectEnded()),L._walking&&(delete L._walking,L.fi({kind:"endWalk",event:s}),L.onWalkEnded()),h.dist=h.point=h._62O=h.p3=h.movedata=h.div=h._57I=h._32Q=h._31Q=h.foward=E}});var Nd=function(G){this.gv=G};ok(Nd,O,{_iv:!0,iv:function(){this._iv=!0},face:function(m,v){var T=this,p=T.gv.getGL();if(!p||!Or(m))return E;var i=v.x,G=v.width,S=v.height,V=T.height-v.y-S,U=r(G/2),h=new Uint8Array(4*G*S),K=0;for(T.iv(),T.validate(m),Mk(p,T.frame),p.readPixels(i,V,G,S,p.RGBA,p.UNSIGNED_BYTE,h),Mk(p,E),T.iv();U>=K;K++)for(var d=U-K,L=U+K,F=d;L>=F;F++)for(var l=d;L>=l;l++)if(F===d||F===L||l===d||l===L){var Z=js.m[h[4*(F*G+l)]];if(Z)return Z}},get:function(M,T){this.validate();var X=this,K=X.gv.getGL();if(!K)return E;var h,j,y=M.x,I=M.width,U=M.height,Z=X.height-M.y-U,_=r(I/2),W=new Uint8Array(4*I*U),x=0,A=W.length,a=T?E:new Km,v=T?E:{};if(Mk(K,X.frame),K.readPixels(y,Z,I,U,K.RGBA,K.UNSIGNED_BYTE,W),Mk(K,E),T){for(;_>=x;x++)for(var G=_-x,s=_+x,$=G;s>=$;$++)for(var n=G;s>=n;n++)if(($===G||$===s||n===G||n===s)&&(h=X.info(W,4*($*I+n))))return h}else for(;A>x;x+=4)h=X.info(W,x),h&&(j=h.data,v[j._id]||(a.add(j),v[j._id]=j));return a},info:function(X,Q){return this.colorMap[(X[Q]<<24)+(X[Q+1]<<16)+(X[Q+2]<<8)+X[Q+3]]},validate:function(w){var c=this,s=c.gv,p=s.getGL();if(p){var q=s.getWidth(),I=s.getHeight(),T=p.RGBA,Z=p.TEXTURE_2D,g=p.RENDERBUFFER,n=p.FRAMEBUFFER;c.texture||(c.texture=eb(p),c.render=p.createRenderbuffer(),c.frame=p.createFramebuffer()),(c.width!==q||c.height!==I)&&(jb(p,c.texture),p.texImage2D(Z,0,T,q,I,0,T,p.UNSIGNED_BYTE,E),zm(p,p.TEXTURE_MIN_FILTER,p.LINEAR),p.bindRenderbuffer(g,c.render),p.renderbufferStorage(g,p.DEPTH_COMPONENT16,q,I),Mk(p,c.frame),p.framebufferTexture2D(n,p.COLOR_ATTACHMENT0,Z,c.texture,0),p.framebufferRenderbuffer(n,p.DEPTH_ATTACHMENT,g,c.render),jb(p,E),p.bindRenderbuffer(g,E),Mk(p,E),c.width=q,c.height=I),c._iv&&(c._iv=!1,Mk(p,c.frame),s._42(w||(c.colorMap={}),1),Mk(p,E))}}});var cn=function(Z){this.gv=Z};ok(cn,O,{gap:0,size:0,_42:function(K,y){var q=this,Y=q.gv,H=Y._gridGap,b=Y._gridSize;if(Y._gridVisible){if(q.gap!==H||q.size!==b){for(var o=[],M=Y._gridSize/2,S=H*M,D=0;2*M+1>D;D++){var U=6*D,a=6*(2*M+1)+U;o[U]=-S,o[U+1]=0,o[U+2]=-S+D*H,o[U+3]=S,o[U+4]=0,o[U+5]=-S+D*H,o[a]=-S+D*H,o[a+1]=0,o[a+2]=-S,o[a+3]=-S+D*H,o[a+4]=0,o[a+5]=S}q.vs=new Uf(o),q.gap=H,q.size=b}cl(Y),Yq(K,y),Ap(K),cc(K,y,1,Y._gridColor,Y._buffer.vs,q.vs),$f(K,0,q.vs.length/3,K.LINES),Oi(K),te(K,y)}else q.vs=q.gap=q.size=E}});var vo=function(U){this.gv=U};ok(vo,O,{_42:function(D,W){var J=this.gv,N=J._buffer.vs,c=J._axisXColor,x=J._axisYColor,j=J._axisZColor,$=J._originAxisVisible,S=J._centerAxisVisible;if($||S){var L=X?D.TRIANGLES:D.TRIANGLE_FAN,O=D.LINES;if(cl(J),Yq(D,W),Ap(D),$){var b=J.getCenterInfo(),Y=i(b.width,b.height)/5,s=.8*Y,l=.05*Y;cc(D,W,1.5,c,N,new Uf([0,0,0,Y,0,0,s,l,0,s,0,l,s,-l,0,s,0,-l,s,l,0,0,0,0,0,Y,0,l,s,0,0,s,l,-l,s,0,0,s,-l,l,s,0,0,0,0,0,0,Y,l,0,s,0,l,s,-l,0,s,0,-l,s,l,0,s])),$f(D,0,2,O),$f(D,1,6,L),cc(D,W,E,x),$f(D,7,2,O),$f(D,8,6,L),cc(D,W,E,j),$f(D,14,2,O),$f(D,15,6,L)}if(S){var d=J._center,o=d[0],z=d[1],w=d[2],b=J.getPositionInfo(d);Y=i(b.width,b.height)/20,cc(D,W,1.5,c,N,new Uf([o,z,w,o+Y,z,w,o,z,w,o,z+Y,w,o,z,w,o,z,w+Y])),$f(D,0,2,O),cc(D,W,E,x),$f(D,2,2,O),cc(D,W,E,j),$f(D,4,2,O)}Oi(D),te(D,W)}}});var ei=function(H){this.gv=H},Wq="edit_tx",Hk="edit_ty",cm="edit_tz",zd="edit_rx",fo="edit_ry",Fr="edit_rz",Qq="edit_sx",_b="edit_sy",Og="edit_sz",dm={};dm[Wq]=1,dm[Hk]=1,dm[cm]=1,dm[zd]=1,dm[fo]=1,dm[Fr]=1,dm[Qq]=1,dm[_b]=1,dm[Og]=1,ok(ei,O,{_42:function(J,E,s){var M=this,w=M.gv,Y=w.sm().ld();if(w.isEditable(Y)&&!w.isEditHelperDisabled()&&Or(Y)&&(!w.isFirstPersonMode()||!w.isMouseRoamable()&&!Ib)){cl(w);var W,h,I=w.isMovable(Y),d=w.isRotationEditable(Y),H=w.isSizeEditable(Y),N=w._axisXColor,D=w._axisYColor,G=w._axisZColor,g=w._editSizeColor,x=w.getCenterInfo(),v=i(x.width,x.height)/10,P=v/(s?5:10),F=.7*v,k=.4*F,L=Y.p3(),S=L[0],V=L[1],e=L[2];W=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],I&&M._17O(J,E,Y,s,Wq,N,W,[S,V-P,e,S+F,V-P,e,S+F,V,e,S+F,V,e,S,V,e,S,V-P,e,S,V-P,e+P,S+F,V-P,e+P,S+F,V-P,e,S+F,V-P,e,S,V-P,e,S,V-P,e+P]),h=S+F,H&&M._17O(J,E,Y,s,Qq,g,W,[h,V-P,e,h+k,V-P,e,h+k,V,e,h+k,V,e,h,V,e,h,V-P,e,h,V-P,e+P,h+k,V-P,e+P,h+k,V-P,e,h+k,V-P,e,h,V-P,e,h,V-P,e+P]),h+=k,d&&M._17O(J,E,Y,s,zd,N,W,[h,V-P,e,h+k,V-P,e,h+k,V,e,h+k,V,e,h,V,e,h,V-P,e,h,V-P,e+P,h+k,V-P,e+P,h+k,V-P,e,h+k,V-P,e,h,V-P,e,h,V-P,e+P]),W=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],I&&M._17O(J,E,Y,s,Hk,D,W,[S,V,e,S,V+F,e,S-P,V+F,e,S-P,V+F,e,S-P,V,e,S,V,e,S,V,e,S,V,e-P,S,V+F,e-P,S,V+F,e-P,S,V+F,e,S,V,e]),h=V+F,H&&M._17O(J,E,Y,s,_b,g,W,[S,h,e,S,h+k,e,S-P,h+k,e,S-P,h+k,e,S-P,h,e,S,h,e,S,h,e,S,h,e-P,S,h+k,e-P,S,h+k,e-P,S,h+k,e,S,h,e]),h+=k,d&&M._17O(J,E,Y,s,fo,D,W,[S,h,e,S,h+k,e,S-P,h+k,e,S-P,h+k,e,S-P,h,e,S,h,e,S,h,e,S,h,e-P,S,h+k,e-P,S,h+k,e-P,S,h+k,e,S,h,e]),W=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],I&&M._17O(J,E,Y,s,cm,G,W,[S,V,e,S,V,e+F,S,V-P,e+F,S,V-P,e+F,S,V-P,e,S,V,e,S,V-P,e,S-P,V-P,e,S-P,V-P,e+F,S-P,V-P,e+F,S,V-P,e+F,S,V-P,e]),h=e+F,H&&M._17O(J,E,Y,s,Og,g,W,[S,V,h,S,V,h+k,S,V-P,h+k,S,V-P,h+k,S,V-P,h,S,V,h,S,V-P,h,S-P,V-P,h,S-P,V-P,h+k,S-P,V-P,h+k,S,V-P,h+k,S,V-P,h]),h+=k,d&&M._17O(J,E,Y,s,Fr,G,W,[S,V,h,S,V,h+k,S,V-P,h+k,S,V-P,h+k,S,V-P,h,S,V,h,S,V-P,h,S-P,V-P,h,S-P,V-P,h+k,S-P,V-P,h+k,S,V-P,h+k,S,V-P,h])}},_17O:function(K,b,d,i,l,R,Q,s){var m=this.gv._buffer;ic(K,b,i,!0,d,l),Fi(K,b,E,!0,E,!0,E,!1),of(K,b.uDiffuse,R),Vj(K,m.vs,new Uf(s),b.aPosition),Vj(K,m.ns,new Uf(Q),b.aNormal),Ap(K),$f(K,0,12),Oi(K),Mo(K,b)}});var Mp=function(h,N){this.gv=h,this.s=function(K,r,c){return r==E&&(r=c),r==E?N.getStyle(K):_h(r,N,h)},this.data=N};ok(Mp,O,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(Q,g,v,U){var w=this,O=w.data;if(!(O instanceof ff)){var l,M,q,S,B,r,e,y=w.gv,J=O._id,D=w.s("shape3d.alwaysOnTop")?null:w.s("batch"),b=y._34O,k=y._33O,X=y.isSelectable(O),n=y.getBrightness(O),V=n!=E&&1!==n;if(w.needValidate(Q)){if(q=Bp(b,k,O,D),w.validate(q,D?ie[D]||fc:E),q&&(S=b[J],B=S.size=q.vs.length/3-S.begin,e=q.rs))for(n=V?n:1,r=0;B>r;r++)e.push(n);if(Or(O)){var j=y.getWireframeGeometry(O);if(j)Tq(y,O,j);else{var s=y.getWireframe(O);s&&Tq(y,O,s)}}w.labelInfo=w.label2Info=w.noteInfo=w.note2Info=w._38o=E,w._24O(Yk,"getLabel"),w._24O(Ye,"getLabel2"),w._26O(cd,"getNote"),w._26O(fn,"getNote2"),w._15O(),w._iv=!1}V&&of(Q,g.uBrightness,n),of(Q,g.uAlphaTest,w.s("alphaTest")),M=ic(Q,g,v,X,O,hq),M&&(sl(M,b[J],k),sl(M,y._polylineIndexMap[J],y._polylineModelMap),sl(M,y._wireframeIndexMap[J],y._wireframeModelMap)),b[J]||w._80o(Q,g,U),y.isLabelVisible(O)&&((l=w.labelInfo)&&(ic(Q,g,v,X,O,Yk),w._28O(l,Yk,U)),(l=w.label2Info)&&(ic(Q,g,v,X,O,Ye),w._28O(l,Ye,U))),y.isNoteVisible(O)&&((l=w.noteInfo)&&(ic(Q,g,v,X,O,cd),w._29O(l,cd,U)),(l=w.note2Info)&&(ic(Q,g,v,X,O,fn),w._29O(l,fn,U))),(l=w._38o)&&w._99O(Q,g,l,v,X,U),V&&of(Q,g.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Kb},_80o:function(){},dispose:function(){},_calcAnchorMat:function(K){if(K.hasOwnProperty("_anchor")||K.hasOwnProperty("_anchorElevation")){var S=K.getAnchor3d(),j={x:S.x-.5,y:S.y-.5,z:S.z-.5},e=kd();return xj(e,[-j.x,-j.y,-j.z]),e}},getBodyColor:function(e){var s=this.data,q=this.gv.getBodyColor(s);return q?q:e?s.getStyle(e):E},_24O:function(S,J){var T=this,b=T.data,A=T.gv,M=T.s,u=A[J](b);if(u!=E){var c=M(S+".scale"),B=M(S+".max"),N=T[S+"Info"]={label:u,textureScale:M(S+".texture.scale"),color:A[J+"Color"](b),font:M(S+".font"),align:M(S+".align"),background:A[J+"Background"](b)},I=N.rect=Sj(N,u);B>0&&B<I.width&&(N.labelWidth=I.width,I.width=B),I.x=I.y=0,I.width*=c,I.height*=c,N.mat=T._16O(M(S+".autorotate"),M(S+".position"),I,M(S+".face"),M(S+".t3"),M(S+".r3"),M(S+".rotationMode"));var P=I.width/2,k=I.height/2;N.vs=new Uf([-P,k,0,-P,-k,0,P,-k,0,P,k,0]),I.width/=c,I.height/=c}},_26O:function(i,J){var r=this,W=r.data,S=r.gv,I=r.s,y=S[J](W);if(y!=E){var e=I(i+".scale"),p=this[i+"Info"]={note:y,textureScale:I(i+".texture.scale"),expanded:I(i+".expanded"),font:I(i+".font"),color:I(i+".color"),align:I(i+".align"),borderWidth:I(i+".border.width"),borderColor:I(i+".border.color"),background:S[J+"Background"](W)};if(p.expanded){var b=I(i+".max"),M=Sj(p,y);M.width+=6,M.height+=2,b>0&&b<M.width&&(p.labelWidth=M.width,M.width=b);var v={x:-M.width/2,y:-8-M.height,width:M.width,height:M.height+8}}else v={x:-6,y:-18,width:12,height:18};p.mat=r._16O(I(i+".autorotate"),I(i+".position"),E,I(i+".face"),I(i+".t3"),I(i+".r3"),I(i+".rotationMode")),p.rect=v,1!==e&&(v=ij(v),v.x*=e,v.height*=e,v.y=-v.height,v.width*=e);var s=v.x,A=v.y,L=v.width,B=v.height;p.vs=new Uf([s,-A,0,s,-A-B,0,s+L,-A-B,0,s+L,-A,0])}},_28O:function(t,j,Q){if(Q(this.s(j+".transparent"))){var O=t.rect,P=t.textureScale,n=O.width*P,G=O.height*P;if(n>=1&&G>=1){var X=Ym(n,G);1!==P&&(X.translate(X,O.x,O.y),X.scale(P,P),X.translate(X,-O.x,-O.y)),fq(X,t),X.restore(),Ri(this,j,t.mat,t.vs,!0)}}},_29O:function(E,T,l){if(l(this.s(T+".transparent"))){var V=E.rect,t=E.textureScale,y=V.x,R=V.y,i=V.width*t,F=V.height*t;if(i>=1&&F>=1){V.x=V.y=0;var w=Ym(i,F);1!==t&&w.scale(t,t),gj(w,E),w.restore(),V.x=y,V.y=R,Ri(this,T,E.mat,E.vs,!1)}}},_99O:function(J,O,r,B,z,F){if(r){var o=this,x=o.gv,u=o.data,y=x._buffer,v=x._1O,$=r.icons;for(var M in $){var h=$[M],Y=r.rects[M];if(Y&&F(_h(h.transparent,u,x))){ic(J,O,B,z,u,M);var S=_h(h.shape3d,u,x),N=S?[S]:_h(h.names,u,x),q=N?N.length:0,t=_h(h.textureScale,u,x)||1,W=_h(h.light,u,x);W==E&&(W=S?!0:!1),Fi(J,O,_h(h.blend,u,x),W,_h(h.opacity,u,x),_h(h.reverseFlip,u,x),_h(h.reverseColor,u,x),_h(h.reverseCull,u,x));for(var I=0;q>I;I++){var V=N[I],e=Y[I];if(rn(o,e.mat),S)vd(x,u,dq(o,S),o);else{var d=_l(V);if(d){var Z=e.width*t,C=e.height*t;if(Z>=1&&C>=1){var b=Ym(Z,C);Tb(b,d,_h(h.stretch,u,x),0,0,Z,C,u,x),b.restore(),eb(J,cj,v),Ap(J,O,v,_h(h.discardSelectable,u,x),y.uv,yq),Vj(J,y.vs,e.vs,O.aPosition),Vj(J,y.ns,th,O.aNormal),hk(J,y.is,Se),zb(J,0,Se.length),Oi(J,O,v)}}}wp(x)}Mo(J,O)}}}}});var ng=function(W,f){hi(ng,this,[W,f])};ok(ng,Mp,{_16O:function(H,y,q,p,c,G,K,t,Z){var W=this.data,U=W.getFinalScale3d(),f=Li(y,U,q,p,t,Z);if(W.hasOwnProperty("_anchor")||W.hasOwnProperty("_anchorElevation")){var P=W.getAnchor3d();f[0]-=(P.x-.5)*U[0],f[1]-=(P.y-.5)*U[1],f[2]-=(P.z-.5)*U[2]}return Nq(kd(),f,W.p3(),p,c,G,K,H,W.r3(),W.getRotationMode())},clear:function(){var Z=this;Z.faceMat=Z.mat=Z.shapeModel=Z.left=Z.right=Z.front=Z.back=Z.top=Z.bottom=Z.csg=E},needValidate:function(A){if(this._iv)return this._validateFrameId=A._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")){var K=A._renderInfo.frame;if(this._validateFrameId!==K)return this._validateFrameId=K,!0}return!1},validate:function(i,f){var R=this,B=R.gv,k=R.data,e=dq(R);R._updateAutoRotation(),R._updateFixSize2d(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Ij(B,k,"_wireframeModelMap","_wireframeIndexMap"),Ij(B,k,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var Y=rp(k,B.getMat(k),e?R.s("shape3d.scaleable"):!0),L=R._calcAnchorMat(k);if(L&&sf(Y,Y,L),R.clear(),i){var b=[];e?Ro(B,k,e,R,R.getBodyColor(),[Y],i,b):(gm(B,k,i,f,Y,nl,b,Kd),gm(B,k,i,f,Y,yf,b,Am),gm(B,k,i,f,Y,lf,b,Bc),gm(B,k,i,f,Y,ec,b,Hi),gm(B,k,i,f,Y,oh,b,uc),gm(B,k,i,f,Y,_g,b,uf)),b.length&&(vp(i.vs,b),vp(i.ns,ze(b)))}else R.mat=Y,(R.shapeModel=e)||(R.vf(nl),R.vf(yf),R.vf(oh),R.vf(_g),R.vf(lf),R.vf(ec))},_updateAutoRotation:function(){var o=this,N=o.s("shape3d.autorotate");if(N){var E,y=o.gv,P=o.data;E="string"==typeof N?[N.indexOf("x")<0?y._eye[0]:y._center[0],N.indexOf("y")<0?y._eye[1]:y._center[1],N.indexOf("z")<0?y._eye[2]:y._center[2]]:y._eye;var L=y._center,v=[E[0]-L[0],E[1]-L[1],E[2]-L[2]],D=P.p3(),p=Me([D[0]+v[0],D[1]+v[1],D[2]+v[2]],D,y._up),m=P.r3(),c=Gi(p,P.getRotationMode());Math.abs(m[0]-c[0])<1e-5&&Math.abs(m[1]-c[1])<1e-5&&Math.abs(m[2]-c[2])<1e-5||P.r3(c)}},_updateFixSize2d:function(){var B=this,$=B.data,b=B.s("shape3d.fixSizeOnScreen");if(!b)return $._dynamicScale3d&&delete $._dynamicScale3d,void 0;var Q=B.gv;$.getFinalScale3d();var k=rp($,Q.getMat($)),Z=nf([0,0,0],k),T=Q.toViewPosition(Z);if(!isNaN(T.x)&&!isNaN(T.y)){var z=nf([1,0,0],k),Y=Q.toViewPosition(z),G=nf([0,1,0],k),V=Q.toViewPosition(G),x=Y.x-T.x,R=V.y-T.y,L=$._dynamicScale3d||[1,1,1],U=_l($.s("shape3d.image")),X=b[0]>0?b[0]:U?Oh(U,B):20,O=b[1]>0?b[1]:U?Lk(U,B):20,P=Math.abs(x/X),w=Math.abs(R/O);Math.abs(P-1)<.001&&Math.abs(w-1)<.001||($._dynamicScale3d=[L[0]/P,L[1]/w,L[2]])}},vf:function(U){var Z=this;if(Z.gv.getFaceVisible(Z.data,U)){var d=il(Z,U);return d.mat&&(Z.faceMat=!0),d}},_80o:function(r,K,q){var W=this,I=W.gv,Y=W.data,k=I._cube,B=W.shapeModel;cl(I,W.mat),B?vd(I,Y,B,W,W.getBodyColor(),q):(Vj(r,k.vs,E,K.aPosition),Vj(r,k.ns,E,K.aNormal),hk(r,k.is),W._18O(r,K,W.left,0,q),W._18O(r,K,W.front,6,q),W._18O(r,K,W.right,12,q),W._18O(r,K,W.back,18,q),W._18O(r,K,W.top,24,q),W._18O(r,K,W.bottom,30,q)),wp(I),W.faceMat&&(W._18O(r,K,W.left,0,q,!0),W._18O(r,K,W.front,6,q,!0),W._18O(r,K,W.right,12,q,!0),W._18O(r,K,W.back,18,q,!0),W._18O(r,K,W.top,24,q,!0),W._18O(r,K,W.bottom,30,q,!0))
},_18O:function(u,U,R,z,_,p){if(R){if(!_(R.transparent))return;if(p&&!R.mat||!p&&R.mat)return;p&&cl(this.gv,R.mat);var e=this,B=e.data,N=e.gv,g=N.getTexture(R.texture,B),F=R.uv,A=R.uvScale,C=R.uvOffset,b=R.discardSelectable;if(g)if(F){for(var $=8*(z/6),L=0;8>L;L++)vk[$+L]=F[L];Ap(u,U,g,b,N._buffer.uv,vk,C,A)}else Ap(u,U,g,b,N._cube.uv,E,C,A);else Ap(u);Fi(u,U,R.blend,R.light,R.opacity,R.reverseFlip,R.reverseColor,R.reverseCull),of(u,U.uDiffuse,R.color),zb(u,z,6),Mo(u,U),Oi(u,U,g),p&&wp(N)}}});var Ob=function(h,z){hi(Ob,this,[h,z])};ok(Ob,Mp,{_25Q:1,validate:function(A){var w=this,N=w.gv,T=w.data,S=w.s,j=S("edge.width"),Z=T._40I,M=T._41I;if(w.shapeModel=w.info=E,Z&&M){var r,k,n,B,Y,u,P,R,v,t,C=T.isLooped(),x=S(rk),X=y.getEdgeType(x);if(X){var b=X(T,mi(w,N,T,C,x),N,w._19Q);if(!b.points||b.points.isEmpty())return;u=w.info={},P=b.segments,Y=b.points,R=Y.size();for(var W=Z.getElevation(),J=M.getElevation(),H=0;R>H;H++){var _=Y.get(H);_.e==E&&(_.e=W+(J-W)*H/(R-1))}v=vg(Y.get(0)),t=vg(Y.get(R-1));var p=R%2;0===p?(u.c1=vg(Y.get(R/2-1)),u.c2=vg(Y.get(R/2))):u.p3=vg(Y.get((R-p)/2)),u.s1=v,u.s2=vg(Y.get(1)),u.t1=vg(Y.get(R-2)),u.t2=t}else{Y=new Km,u=w.info={};var f=S("edge.offset"),D=S("edge.center"),q=S("edge.source.t3"),I=S("edge.target.t3"),m=Z.p3(),F=M.p3();if(q&&(m[0]+=q[0],m[1]+=q[1],m[2]+=q[2]),I&&(F[0]+=I[0],F[1]+=I[1],F[2]+=I[2]),x===kn){P=S("edge.segments");var o=u.points=S(ss)||pd;if(R=o.size()){v=vg(o.get(0)),t=vg(o.get(R-1)),!D&&f&&(n=Qh(v,m,!0),f=i(f,tm(m,v)),m=[m[0]+n[0]*f,m[1]+n[1]*f,m[2]+n[2]*f],n=Qh(F,t,!0),f=i(f,tm(t,F)),F=[F[0]-n[0]*f,F[1]-n[1]*f,F[2]-n[2]*f]);var p=R%2;0===p?(r=vg(o.get(R/2-1)),k=vg(o.get(R/2))):u.p3=vg(o.get((R-p)/2)),u.s1=m,u.s2=v,u.t1=t,u.t2=F}else!D&&f&&(n=Qh(F,m,!0),B=tm(m,F),f=ji(f,B),m=[m[0]+n[0]*f,m[1]+n[1]*f,m[2]+n[2]*f],F=[F[0]-n[0]*f,F[1]-n[1]*f,F[2]-n[2]*f]),r=m,k=F;Y.add({x:m[0],y:m[2],e:m[1]}),Y.addAll(o),Y.add({x:F[0],y:F[2],e:F[1]})}else{var h=mi(w,N,T,C,x);if(w._19Q||(h=-h),C){var l=m[0],L=m[1],s=m[2],U=Z.getTall()/2+h;r=[l-h,L+U,s],k=[l+h,L+U,s],Y.add({x:l-h,y:s,e:L}),Y.add({x:l-h,y:s,e:L+U}),Y.add({x:l+h,y:s,e:L+U}),Y.add({x:l+h,y:s,e:L})}else{n=Qh(F,m,!0),B=tm(m,F);var z={x:m[0],y:m[2]},e={x:F[0],y:F[2]},K=Po(E,z,e,h),c=K.x-z.x,G=K.y-z.y;f=ji(f,B),n[0]*=f,n[1]*=f,n[2]*=f,r=[m[0]+n[0]+c,m[1]+n[1],m[2]+n[2]+G],k=[F[0]-n[0]+c,F[1]-n[1],F[2]-n[2]+G],D?(Y.add({x:m[0],y:m[2],e:m[1]}),Y.add({x:r[0],y:r[2],e:r[1]}),Y.add({x:k[0],y:k[2],e:k[1]}),Y.add({x:F[0],y:F[2],e:F[1]})):(Y.add({x:r[0],y:r[2],e:r[1]}),Y.add({x:k[0],y:k[2],e:k[1]}))}}u.c1=r,u.c2=k}u.list=S(ub)===go?w.createTubeModel(Y,P,j/2,A):w.createLineModel(Y,P,j,"edge","edge.dash")}}});var us=function(c,b){hi(us,this,[c,b])};ok(us,ng,{_80o:function(U,Y,v){var W=this,l=W.gv,L=W.shapeModel;cl(l,W.mat),L?vd(l,W.data,L,W,W.getBodyColor(),v):(rs(W,U,Y,W.left,v),rs(W,U,Y,W.front,v),rs(W,U,Y,W.right,v),rs(W,U,Y,W.back,v),rs(W,U,Y,W.top,v),rs(W,U,Y,W.bottom,v)),wp(l)},validate:function(K,o){var N,u,M=this,w=M.s,c=M.data,A=c.p3(),U=c._thickness/2,v=c.isClosePath(),r=c.getPoints(),x=c.getSegments(),a=w(Mr),L=K&&K.uv;if(M.clear(),0>U)u=M.shapeModel=gi(r,x,w(Wl),w(pb),a,w(eh),c.getTall(),c.getShapeElevation(),v),w(nj)?w("shape3d.image")||delete u.uv:(delete u.vs,delete u.ns,delete u.uv),w("shape3d.top.image")||delete u.top_uv,w("shape3d.bottom.image")||delete u.bottom_uv;else if(w(ub)===go)N=dd(r,x,a,v),u=M.shapeModel={vs:[]},w("shape3d.image")&&(u.uv=[],u.sum=w(eh)||vh(N)||1,u.len=0),w(Wl)&&!v&&(u.top_vs=[],w("shape3d.top.image")&&(u.top_uv=[])),w(pb)&&!v&&(u.bottom_vs=[],w("shape3d.bottom.image")&&(u.bottom_uv=[])),M._12O(N,U);else{var S,F,Y,$,Q,e,W,O,l,X;if(N=dd(r,x,a,v),Q=M.vf(oh,L,!1,o),U&&(e=M.vf(_g,L,!1,o),W=v?E:M.vf(nl,L,!1,o),O=v?E:M.vf(yf,L,!1,o),l=M.vf(lf,L,!1,o),X=M.vf(ec,L,!1,o)),U){for(var b=0,Z=N.length;Z>b;b++)N[b]=M._tryRemoveBezierPoints(N[b],U);M._12O(N,U)}else Q&&N.forEach(function(c){if($=c.length,$>0)for(S=c[0],Y=1;$>Y;Y++)F=c[Y],M.addV(Q.vs,S,F),S=F});M._20Q(N),K||(Q&&(Q.ns=ze(Q.vs),rl(Q,"vs"),rl(Q,$e)),U&&(e&&(e.ns=ze(e.vs),rl(e,"vs"),rl(e,$e)),W&&(W.ns=ze(W.vs),rl(W,"vs"),rl(W,$e)),O&&(O.ns=ze(O.vs),rl(O,"vs"),rl(O,$e)),l&&(l.ns=ze(l.vs),rl(l,"vs"),rl(l,$e)),X&&(X.ns=ze(X.vs),rl(X,"vs"),rl(X,$e))))}var k=M.mat=kd();xj(k,A),nn(k,c.r3(),c.getRotationMode());var d=c.getScale3d(),i=c._dynamicScale3d;i&&(d[0]*=i[0],d[1]*=i[1],d[2]*=i[2]),Nl(k,d),xj(k,tb(A)),K&&(tc(M,k,K,u),M.clear())},_20Q:function(R){var I,a,Q,h,v,m,p,P=this,U=P.front,q=P.back,M=P.top,z=P.bottom,N=U?U.tuv:E,f=q?q.tuv:E,k=M?M.tuv:E,G=z?z.tuv:E,H=0;(N||f||k||G)&&(I=P.s(eh)||vh(R)||1,R.forEach(function(Y){if(a=Y.length,a>0)for(m=Y[0],Q=1;a>Q;Q++)p=Y[Q],h=H/I,H+=tm(m,p),v=H/I,P._14O(U,h,v),P._14O(q,1-v,1-h),P._14O(M,h,v),P._14O(z,h,v),m=p}))},_14O:function(B,A,C){if(B){var c=B.uv,N=B.tuv;if(N){if(c)var n=c[0]+(c[6]-c[0])*A,p=c[1]+(c[7]-c[1])*A,b=c[2]+(c[4]-c[2])*A,$=c[3]+(c[5]-c[3])*A,E=c[2]+(c[4]-c[2])*C,T=c[3]+(c[5]-c[3])*C,Q=c[0]+(c[6]-c[0])*C,S=c[1]+(c[7]-c[1])*C;else n=A,p=0,b=A,$=1,E=C,T=1,Q=C,S=0;N.push(b,$,E,T,Q,S,Q,S,n,p,b,$)}}},_13O:function(n){var F=n.uv,q=n.tuv;q&&(F?q.push(F[2],F[3],F[4],F[5],F[6],F[7],F[6],F[7],F[0],F[1],F[2],F[3]):q.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(q,O){var r=q.length;if(4>r)return q;var k,N,P,J,E,R,S=!1,c=function(O){return q[O]},a=function(Q){return q[r-1-Q]};for(E=0;1>=E;E++)for(R=E?a:c,N=R(0),P=R(1),k=2;r-1>k;k++)if(J=R(k),!J.remove)if(J.b){var f=Po(N,P,J,O);f.adjust?(J.remove=!0,S=!0):(N=P,P=J)}else N=P,P=J;if(!S)return q;var y=[];for(k=0;r>k;k++)q[k].remove||y.push(q[k]);return y},_12O:function(u,H){var t,O,$,g,I,Y=this;u.forEach(function(m){if(I=m.length,I>0)for(t={p:m[0],n:!0},g=1;I>g;g++)O=m[g],$=I-1>g?m[g+1]:E,Y.addPoint(t,O,$,H,m)})},addPoint:function(W,p,y,f,z){var s,V,P,Q,j,n,k,B,g,m=this,u=W.p,G=W.f,o=W.b,L=m.s("shape3d.side")||Rh,r=m.s("shape3d.start.angle"),t=m.s("shape3d.sweep.angle"),D=m.shapeModel,X=m.data.isClosePath();if(W.n&&(W.n=!1,G=X&&z.length>2?Po(z[z.length-2],u,p,f):Po(E,u,p,f),o=$i(u,G),D?D.top_vs&&m._10O(o,G,L,r,t,D.top_vs,D.top_uv):(s=m.left)&&(m.addV(s.vs,o,G),m._13O(s))),V=y?Po(u,p,y,f):X&&z.length>2?Po(u,p,z[1],f):Po(u,p,E,f),P=$i(p,V),D){var F,l,A=D.vs,K=D.uv,M=D.sum;for(K&&(F=D.len/M,D.len+=tm(u,p),l=D.len/M),n=m._9O(o,G,L,r,t),k=m._9O(P,V,L,r,t),B=0;L>B;B++)g=B+1,vp(A,n[g]),vp(A,k[B]),vp(A,n[B]),vp(A,k[B]),vp(A,n[g]),vp(A,k[g]),K&&(Q=B/L,j=g/L,K.push(F,j,l,Q,F,Q,l,Q,F,j,l,j));!y&&D.bottom_vs&&m._10O(P,V,L,r,t,D.bottom_vs,D.bottom_uv,!0)}else!y&&(s=m.right)&&(m.addV(s.vs,V,P),m._13O(s)),(s=m.front)&&m.addV(s.vs,G,V),(s=m.back)&&m.addV(s.vs,P,o),(s=m.top)&&m.addH(s.vs,G,V,P,o,!0),(s=m.bottom)&&m.addH(s.vs,o,P,V,G);W.p=p,W.f=V,W.b=P},_10O:function(N,o,$,l,a,T,z,E){var x,F,g=this,K=g.data,e=g._9O(N,o,$,l,a),S=(N.x+o.x)/2,J=(N.y+o.y)/2,i=K.getShapeElevation(),h=0;for(h=0;$>h;h++)E?(vp(T,e[h]),vp(T,e[h+1])):(vp(T,e[h+1]),vp(T,e[h])),vp(T,[S,i,J]),z&&(E?(x=I*(h+1)/$+l,F=I*h/$+l):(x=I*h/$+l,F=I*(h+1)/$+l),z.push(.5-.5*B(F),.5-.5*Y(F),.5-.5*B(x),.5-.5*Y(x),.5,.5))},_9O:function(W,D,o,Z,V){var n,s,L=this,f=L.data,t=[],e=(W.x+D.x)/2,b=(W.y+D.y)/2,q=f.getTall()/2,g=f.getShapeElevation(),Q=0;for(V=V||I;o>=Q;Q++)n=V*Q/o+Z,s=B(n),t.push([e+(W.x-e)*s,g+q*Y(n),b+(W.y-b)*s]);return t},addV:function(w,b,f){var Q=b.x,n=b.y,s=f.x,m=f.y,F=this.data,c=F.getShapeElevation(),A=F.getTall()/2;w.push(Q,c-A,n,s,c-A,m,s,c+A,m,s,c+A,m,Q,c+A,n,Q,c-A,n)},addH:function(h,e,r,Y,d,A){var V=this.data,M=V.getTall()/2,f=V.getShapeElevation()+(A?M:-M);h.push(e.x,f,e.y,r.x,f,r.y,Y.x,f,Y.y,Y.x,f,Y.y,d.x,f,d.y,e.x,f,e.y)},vf:function(I,L,g,d){var k,Z=this,X=Z.gv.getFaceVisible(Z.data,I);return(g||X)&&(k=il(Z,I,d),k.vs=[],k.tuv=X&&(k.texture||L)?[]:E,k.visible=X),k}});var Dd=function(b,l){hi(Dd,this,[b,l])};ok(Dd,Mp,{_25Q:1,validate:function(m){var x=this,k=x.data,z=x.s,L=k.getPoints(),j=L.size();if(x.shapeModel=x.info=E,j>1){var U=x.info={},b=k.getSegments(),W=k.getThickness(),w=vg(L.get(0)),R=vg(L.get(j-1)),p=j%2;0===p?(U.c1=vg(L.get(j/2-1)),U.c2=vg(L.get(j/2))):U.p3=vg(L.get((j-p)/2)),U.s1=w,U.s2=vg(L.get(1)),U.t1=vg(L.get(j-2)),U.t2=R,U.list=z(ub)===go?x.createTubeModel(L,b,W/2,m):x.createLineModel(L,b,W,"shape.border","shape.dash")}}}),Jn(y,{accordionViewExpandIcon:No(Ui),accordionViewCollapseIcon:No(Ui,!0),accordionViewLabelColor:Qo,accordionViewLabelFont:vm,accordionViewTitleBackground:Qk,accordionViewSelectBackground:Lc,accordionViewSelectWidth:3,accordionViewSeparatorColor:K,splitViewDividerSize:1,splitViewDividerBackground:Qk,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Hn,rect:[2,2,12,12],background:Ui}]},propertyViewLabelColor:lk,propertyViewLabelSelectColor:Qo,propertyViewLabelFont:vm,propertyViewExpandIcon:No(Tk),propertyViewCollapseIcon:No(Tk,!0),propertyViewBackground:eo,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Pn,propertyViewColumnLineColor:Pn,propertyViewSelectBackground:Lc,listViewLabelColor:lk,listViewLabelSelectColor:Qo,listViewLabelFont:vm,listViewRowLineVisible:!1,listViewRowLineColor:Pn,listViewSelectBackground:Lc,treeViewLabelColor:lk,treeViewLabelSelectColor:Qo,treeViewLabelFont:vm,treeViewExpandIcon:No(jo),treeViewCollapseIcon:No(jo,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Pn,treeViewSelectBackground:Lc,treeViewDoubleClickToToggle:!0,tableViewLabelColor:lk,tableViewLabelSelectColor:Qo,tableViewLabelFont:vm,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Pn,tableViewColumnLineColor:Pn,tableViewSelectBackground:Lc,treeTableViewLabelColor:lk,treeTableViewLabelSelectColor:Qo,treeTableViewLabelFont:vm,treeTableViewExpandIcon:No(jo),treeTableViewCollapseIcon:No(jo,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Pn,treeTableViewColumnLineColor:Pn,treeTableViewSelectBackground:Lc,tableHeaderLabelColor:lk,tableHeaderLabelFont:vm,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:sm,tableHeaderBackground:eo,tableHeaderMoveBackground:Sn,tableHeaderInsertColor:Lc,tableHeaderSortDescIcon:_q(Tk,!0),tableHeaderSortAscIcon:_q(Tk),tabViewTabGap:1,tabViewLabelColor:Qo,tabViewLabelFont:vm,tabViewTabBackground:Qk,tabViewSelectWidth:3,tabViewSelectBackground:Lc,tabViewMoveBackground:Sn,tabViewInsertColor:Lc,toolbarLabelColor:lk,toolbarLabelSelectColor:Qo,toolbarLabelFont:vm,toolbarBackground:eo,toolbarSelectBackground:Lc,toolbarItemGap:8,toolbarSeparatorColor:Ck},!0);var Em={translateX:1,sortColumn:1},fk={sortable:1,sortOrder:1,sortFunc:1},Sl={focusData:1},Qp={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Ej={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},cg=function(H,L){L.add(H),H.hasChildren()&&H.eachChild(function(F){cg(F,L)})},pm=function(V,D,m,r,Y,F,O,h,C,g,c){var L,S=m.getValueType(g),e=m.getAlign(g);if(m.getEnumValues(g)){var o=m.toEnumLabel(D,g),$=Nj||0,A=0,d=F,G=y.getTextSize(r,o).width;return L=_l(m.toEnumIcon(D,g)),L&&(A=F+Nj/2,"center"===e?A+=(h-($+G))/2:"right"===e&&(A=A+h-($+G)),ms(V,L,A,O+C/2,g,c),d=A+Nj/2),o!=E&&(L?$c(V,o,r,Y,d,O,h-(d-F),C):$c(V,o,r,Y,F,O,h,C,e)),void 0}return D=m.formatValue(D),D!=E?S===Gl?(an(V,F,O,h,C,D),void 0):S===jr||!S&&er(D)?(L=_l(D?Fn:Xh),ms(V,L,F+h/2,O+C/2,g,c),void 0):($c(V,D,r,Y,F,O,h,C,e),void 0):void 0},zs=function(H,u){var m=u.view,$=Tf(H),R=u.column||u.property;m.getDataModel().beginTransaction(),u.editor=H,H.info=u,m.setCurrentEditor(H),m.getView().insertBefore($,m._79O),qh(H,u.editorRect),H.setFocus?H.setFocus():Rg(H),H.commitValue=function(){H._17Q&&(H=H._17Q),m.setValue(u.data,R,H.getValue?H.getValue():H.value),H.close&&H.close(),be($)},R.onEditorCreated&&R.onEditorCreated(u)},Jq=function(a,t,o,k,v){var q=Bm(a,o),Z=t.value,V=t.view,f=v.getValueType(t.data);return q.onblur=q.onchange=function(){V.endEditing()},"input"===a?(Z=v.formatValue(Z),Z!=E&&(q.value=Z),q.onkeydown=function(s){Im(s)&&V.endEditing()},(f===lq||f===Uq)&&q.addEventListener(Vg,y.numberListener,!1)):a===Th&&k.forEach(function(k){var L=n.createElement("option");L.innerHTML=v.toEnumLabel(k),L.value=k,v.isEnumEqual(Z,k)&&(L.selected=!0),mc(q,L)}),zs(q,t),q},bs=b.widget={},$m=function(S,G,K){ok(R+".widget."+S,G,K)};Jn(Jo,{ms_value:function(U){U.getValue=function(W){var e=this.getItemById(W),u=e.element;return Xr(u)?u:u?u.getValue?u.getValue():u.value:e.selected},U.setValue=function(l,b){var G=this.getItemById(l),_=G.element;_&&!Xr(_)?_.setValue?_.setValue(b):_.value=b:er(b)?(G.selected=b,this.iv()):(G.element=b,this.iv())},U.v=function(v,B){var C=this;if(2===arguments.length)C.setValue(v,B);else{if(!ki(v))return C.getValue(v);for(var l in v)C.setValue(l,v[l])}return C}},_46o:function(m){m._icon=E,m._accessType=E,m._valueType=E,m._editable=!1,m._batchEditable=!0,m._align=nl,m._nullable=!0,m._emptiable=!1,m.setParent=xf,m.formatValue=function(g){var e=this,s=e._valueType;return e.getEnumValues()?e.toEnumLabel(g):s===jr?!!g:g!=E&&s===lq?U(g):g},m.setEnum=function(H,x,S,u,W,q,D){var j=this;H&&!_n(H)&&H.values&&(u=H.editable,S=H.icons,x=H.labels,W=H.strict,q=H.maxHeight,D=H.dropDownWidth,H=H.values),Tc(H)&&(H=H._as),Tc(x)&&(x=x._as),Tc(S)&&(S=S._as),j._enumValues=H,j._enumLabels=x,j._enumIcons=S,j._enumEditable=u,j._enumStrict=W==E?!0:W,j._enumMaxHeight=q,j._enumDropDownWidth=D,H&&H.length&&ve(H[0])&&(j._valueType=Uq),j.fp("enum",!1,!0)},m.getEnumDropDownWidth=function(){return this._enumDropDownWidth},m.getEnumMaxHeight=function(){return this._enumMaxHeight},m.isEnumEditable=function(){return this._enumEditable},m.getEnumValues=function(){return this._enumValues},m.getEnumLabels=function(){return this._enumLabels},m.getEnumIcons=function(){return this._enumIcons},m.isEnumStrict=function(){return this._enumStrict},m.isEnumEqual=function(Y,z){return this._enumStrict?Y===z:Y==z},m.toEnumLabel=function(R,y){var H=this,q=H.getEnumValues(y),Q=H.getEnumLabels(y);if(q&&Q)for(var C=0;C<q.length;C++)if(H.isEnumEqual(R,q[C]))return Q[C];return R},m.toEnumIcon=function(v,R){var w=this,Y=w.getEnumValues(R),p=w.getEnumIcons(R);if(Y&&p)for(var P=0;P<Y.length;P++)if(w.isEnumEqual(v,Y[P]))return p[P];return K}},_45o:function(c){c._87o=function(X,q,D,L,f,h){if(X){var d=this,s=d._90I,E=hc(1);d._columnLineVisible&&(f-=1),d._rowLineVisible&&(h-=1),0>=f||0>=h||(d._90I||(s=d._90I={}),s[q]||(s[q]=new Km),qh(E,d.tx()+D,d.ty()+L,f,h),mc(E,X),d._view.insertBefore(E,d._79O),X.onParentAdded&&X.onParentAdded(E),s[q].add(E))}},c._76o=function(){var x=this,I=x._90I;if(I){for(var U in I)I[U].each(function(K){be(K)});delete x._90I}},c._77o=function(g){var r=this;if(r._90I){var v=r._90I[g];v&&(v.each(function(E){be(E)}),delete r._90I[g])}}},_47o:function(s){s.getValue=function(T,d){return d.getValue?d.getValue(T,d,this):tj(T,d.getAccessType(),d.getName())},s.setValue=function(r,I,i){if(I.isEmptiable(r)||""!==i||(i=K),I.isNullable(r)||i!=E){var x=this,Y=I.getName(r),J=I.getAccessType(r),T=I.getValueType(r);T===lq&&Xr(i)?i=l(i):T===Uq&&Xr(i)?i=parseFloat(i):T===jr&&Xr(i)&&(i="true"===i),x._batchEditable&&I._batchEditable&&x.isSelected(r)?x.sm().each(function(K){I.setValue?I.setValue(K,I,i,x):yb(K,J,Y,i)}):I.setValue?I.setValue(r,I,i,x):yb(r,J,Y,i)}},s.setCurrentEditor=function($){this.endEditing(),this._currentEditor=$,this.redraw()},s.isEditing=function(X,m){var E=this,n=E._currentEditor;if(!n)return!1;if(m){var j=n.info;return j?(j.column||j.property)===m&&j.data===X:!1}return!0},s.endEditing=function(){var t=this,S=t._currentEditor;S&&(delete t._currentEditor,S.commitValue&&S.commitValue(S.info),t.redraw(),t.getDataModel().endTransaction())},s.beginEditing=function(L){this.endEditing();var K=this,Y=L.column||L.property;if(Y.beginEditing)Y.beginEditing(L);else{var m=L.data,i=L.value,H=K.getSelectBackground(m),j=Y.getEnumValues(m),Z=Y.getSlider(m),S=Y.getColorPicker(m);if(Z){var C=Vo(bs.Slider,Z);return C.setValue(i),C.getView().onblur=function(){K.endEditing()},C.isInstant()&&(C.onValueChanged=function(){K.setValue(m,Y,C.getValue())}),zs(C,L),void 0}if(S||Y.getValueType(m)===Gl){var U=Vo(bs.ColorPicker,S);return U.setValue(i),U.onClosed=function(){K.endEditing()},U.isInstant()&&(U.onValueChanged=function(i,j){K.setValue(m,Y,j)}),zs(U,L),U.open(),void 0}if(j){if(bs.ComboBox){var X=new bs.ComboBox;X.setValue(i),X.setValues(j),X.setLabels(Y.getEnumLabels(m)),X.setIcons(Y.getEnumIcons(m)),X.setEditable(Y.isEnumEditable(m)),X.setStrict(Y.isEnumStrict(m)),X.setMaxHeight(Y.getEnumMaxHeight(m)),X.setDropDownWidth(Y.getEnumDropDownWidth(m)),X.onClosed=function(){K.endEditing()},zs(X,L),X.open()}else Jq(Th,L,H,j,Y);return}var T=Y.getValueType(m);if(T===jr||er(i))return K.setValue(m,Y,!i),void 0;if(Y.getItemEditor(m)){var R=Rj(Y.getItemEditor(m)),F=new R(m,Y,K,L),e=F.getView();return e._17Q=F,F.setValue(i),qq(e),zs(e,L),F.editBeginning&&F.editBeginning(),void 0}Jq("input",L,H,E,Y)}}},_44o:function(_){_.init=function(D){var Q=this,v=Q.th=new Zn(D),b=Q._view=sj(1,Q);Q.tv=Q._tableView=D,mc(b,v.getView()),mc(b,D.getView()),v.mp(function(y){y.property===Of&&Q.iv()}),Q.iv()},_.getTableView=function(){return this.tv},_.getTableHeader=function(){return this.th},_.getDataModel=function(){return this.tv.dm()},_.getColumnModel=function(){return this.tv.getColumnModel()},_.setColumns=function(s){this.tv.setColumns(s)},_.addColumns=function(F){this.tv.addColumns(F)},_.endEditing=function(){this.tv.endEditing()},_.validateImpl=function(){var r=this,n=r.th,Q=ll(n),P={x:0,y:0,width:r.getWidth(),height:Q};qh(n,P),P.y=Q,P.height=M(0,r.getHeight()-Q),qh(r.tv,P)}},ms_vs:function(j){j._41o=function(){return this._29I.height<this._59I},j._43o=function(){var s=this;s._41o()&&(s._58I||(_(function(){s._94O()},Dc),s.iv()),s._58I=new Date)},j._94O=function(){var j=this;if(j._58I){var i=new Date;i.getTime()-j._58I.getTime()>=Dc?(delete j._58I,j.iv()):_(function(){j._94O()},Dc)}},j._93I=function(){var w=this,c=w._27I;if(w._58I||!w._autoHideScrollBar){c||mc(w._79O,c=w._27I=hc());var m=w._29I,A=m.height,Z=w._59I,J=w.getScrollBarSize(),s=m.width-J-2,e=A*(-w.ty()/Z),b=A*(A/Z),M=c.style;Z>A?(Jg>b&&(e=e+b/2-Jg/2,0>e&&(e=0),e+Jg>A&&(e=A-Jg),b=Jg),M.visibility=oj,M.background=w.getScrollBarColor(),M.borderRadius=J/2+pn,qh(c,s,e,J,b)):M.visibility=mb}else c&&(c.style.visibility=mb)}},ms_hs:function(R){R._40o=function(){return this._29I.width<this._91I},R._42o=function(){var B=this;B._40o()&&(B._95O||(_(function(){B._94I()},Dc),B.iv()),B._95O=new Date)},R._94I=function(){var Y=this;if(Y._95O){var Z=new Date;Z.getTime()-Y._95O.getTime()>=Dc?(delete Y._95O,Y.iv()):_(function(){Y._94I()},Dc)}},R._92I=function(){var z=this,k=z._28I;if(z._95O||!z._autoHideScrollBar){k||mc(z._79O,k=z._28I=hc());var d=z._29I,w=d.width,t=z._91I,P=z.getScrollBarSize(),c=d.height-P-2,X=w*(-z.tx()/t),l=w*(w/t),q=k.style;t>w?(Jg>l&&(X=X+l/2-Jg/2,0>X&&(X=0),X+Jg>w&&(X=w-Jg),l=Jg),q.visibility=oj,q.background=z.getScrollBarColor(),q.borderRadius=P/2+pn,qh(k,X,c,l,P)):q.visibility=mb}else k&&(k.style.visibility=mb)}}}),kg(Fn,Bs(16,16,[{type:qo,rect:[1,1,14,14],background:Lc},{type:bb,rect:[1,1,14,14],width:1,color:zg},{type:np,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),kg(Xh,Bs(16,16,{type:bb,rect:[1,1,14,14],width:1,color:zg})),kg(rc,Bs(16,16,[{type:Ei,rect:[2,2,12,12],borderWidth:1,borderColor:zg,background:"#FFF"},{type:Ei,rect:[4,4,8,8],background:Lc}])),kg(Ie,Bs(16,16,{type:Ei,rect:[2,2,12,12],borderWidth:1,borderColor:zg})),Jo._15Q=function(i){i._29I=mr,i._59I=0,i._91I=0,i._5o=function(t){var N=this;N._30I=new Km,N._rows=new Km,N._rowMap={},N._31I=0,N._14I=0,N._view=sj(1,N),N._canvas=iq(N._view),mc(N._view,N._79O=hc()),N.dm(t?t:new Wf)},i.getCheckIcon=function(J){var B=this.sm(),R=B.co(J);return B.sg()?_l(R?rc:Ie):_l(R?Fn:Xh)},i.checkData=function(q){var V=this.sm(),Q=V.co(q);V.sg()&&Q||(this._32o=1,Q?V.rs(q):V.as(q),delete this._32o)},i.getDataAt=function(R){R.target&&(R=this.lp(R));var D=r(R.y/this._rowHeight),Y=this._rows;return 0>D||D>=Y.size()?E:Y.get(D)},i.onDataDoubleClicked=function(){},i.onDataClicked=function(){},i.adjustTranslateX=function(){return 0},i.adjustTranslateY=function(A){var q=this.getHeight()-this._59I;return q>A&&(A=q),A>0?0:U(A)},i.onPropertyChanged=function(e){var T=this,S=e.property;Qp[S]?T.ivm():Sl[S]||T.redraw(),S===xd?T._42o():S===Md&&T._43o()},i.getLabel=function(E){return E.toLabel()},i.getLabelFont=function(){return this._labelFont},i.getLabelColor=function(H){var l=this;if(l.isCheckMode()){if(l._focusData===H)return l._labelSelectColor}else if(l.isSelected(H))return l._labelSelectColor;return l._labelColor},i.getStartRowIndex=function(){return this._31I},i.getEndRowIndex=function(){return this._14I},i.getRowDatas=function(){return this._rows},i.getRowIndex=function(p){return this._rowMap[p._id]},i.getRowSize=function(){return this._rows.size()},i.getViewRect=function(){return ij(this._29I)},i.isVisible=function(e){return this._visibleFunc?this._visibleFunc(e):!0},i.getCurrentSortFunc=function(){return this._sortFunc},i.setDataModel=function(M){var O=this,r=O._dataModel,J=O._selectionModel;r!==M&&(r&&(r.umm(O.handleDataModelChange,O),r.umd(O.handleDataPropertyChange,O),r.umh(O.handleHierarchyChange,O),J||r.sm().ums(O.handleSelectionChange,O)),O._dataModel=M,M.mm(O.handleDataModelChange,O),M.md(O.handleDataPropertyChange,O),M.mh(O.handleHierarchyChange,O),J?J._21I(M):M.sm().ms(O.handleSelectionChange,O),O.fp("dataModel",r,M))},i.validateModel=function(){var C=this;C._rows.clear(),C._rowMap={},C.buildChildren(C._dataModel._roots);var D=C._rows=C._rows.toList(C.isVisible,C),I=0,B=C.getCurrentSortFunc(),Q=D.size();for(B&&D.sort(B);Q>I;I++)C._rowMap[D.get(I)._id]=I},i.buildChildren=function(E){var s=this;E.each(function(o){s._rows.add(o),s.buildChildren(o._children)})},i.handleDataModelChange=function(){this.ivm()},i.handleDataPropertyChange=function(z){"parent"===z.property?this.ivm():this.invalidateData(z.data)},i.handleHierarchyChange=function(){this.ivm()},i.handleSelectionChange=function(J){J.datas.each(this.invalidateData,this),this.onSelectionChanged(J)},i.onSelectionChanged=function(k){var X=this,v=X.sm();!X.isAutoMakeVisible()||1!==v.size()||"set"!==k.kind&&"append"!==k.kind||X._32o||X.makeVisible(v.ld())},i.handleBackgroundClick=function(G){Jm(G)&&!this.isCheckMode()&&this.sm().cs()},i.makeVisible=function(C){C&&(this._23I=C,this.iv())},i.scrollToIndex=function(j){var Z=this,x=Z._29I,p=x.height,b=Z._rowHeight,V=b*j;j>=0&&j<Z._rows.size()&&p>0&&(V+b>x.y+p?Z.ty(-V+p-b):V<x.y&&Z.ty(-V))},i.autoScroll=function(P,p){var w=this,d=w._rowHeight,I=d,m=d/4,Q=w._29I,j=w.lp(P),V={x:w.tx(),y:w.ty()};return d>0&&Q&&(j.x-Q.x<I?w.translate(m,0):Q.x+Q.width-j.x<I&&w.translate(-m,0),j.y-Q.y<I?w.translate(0,m):Q.y+Q.height-j.y<I&&w.translate(0,-m)),V.x=w.tx()-V.x,V.y=w.ty()-V.y,p&&(p.x+=V.x,p.y+=V.y),V},i.getTopRowOrderSelection=function(){var R=this.sm().getTopSelection(),Z={},Q=new Km;return R.each(function(z){Z[z._id]=z}),this._rows.each(function(L){Z[L._id]&&Q.add(L)}),Q},i.getRowOrderSelection=function(){var X=new Km;return this._rows.each(function(i){this.isSelected(i)&&X.add(i)},this),X},i.ivm=function(){this.invalidateModel()},i.invalidateModel=function(){var A=this;A._96I||(A._96I=1,A._32I=1,delete A._24I),A.iv()},i.redraw=function(){var S=this;S._32I||(S._32I=1,delete S._24I,S.iv())},i.invalidateData=function(L){var S=this;j?S.redraw():S._32I||(S._24I||(S._24I={}),S._24I[L._id]=L,S.iv())},i.getFocusData=function(){return this._focusData},i.setFocusDataById=function(q){this.setFocusData(this.dm().getDataById(q))},i.setFocusData=function(D){var p=this,l=p._focusData;l!==D&&(p._focusData=D,p.fp("focusData",l,D),l&&p.invalidateData(l),D&&(p.invalidateData(D),p.isAutoMakeVisible()&&p.makeVisible(D)))},i.drawRowBackground=function(m,T,s,b,q,f,L){var v=this,K=v.isCheckMode();(T===v._focusData&&K||s&&!K)&&an(m,b,q,f,L,v.getSelectBackground(T))},i.drawData=function(c,Z,E){var y=this,J=y._rowHeight,j=J*E,s=y._29I,k=s.x,z=s.width;c.save(),c.beginPath(),c.rect(k,j,z,J),c.clip(),y._87o(y.drawRow(c,Z,y.isSelected(Z),k,j,z,J),E,k,j,z,J),c.restore(),y._rowLineVisible&&an(c,k,j+J-1,z,1,y._rowLineColor)},i._12I=function(q){var K=this,F=K._31I,I=K._29I,W=I.x,V=I.y,j=I.width,P=I.height;for(q.beginPath(),q.rect(W,V,j,P),q.clip(),q.clearRect(W,V,j,P),K._76o(),K._93db(q);F<K._14I;F++)K.drawData(q,K._rows.get(F),F);K._92db(q)},i._13I=function(b){for(var M,s=this,g=s._rowHeight,Y=s._29I,X=Y.x,V=Y.width,j=s._31I,H=s._30I;j<s._14I;j++)M=s._rows.get(j),s._24I[M._id]&&H.add({data:M,index:j});H.isEmpty()||(b.beginPath(),H.each(function(p){b.rect(X,p.index*g,V,g)}),b.clip(),H.each(function(m){b.clearRect(X,m.index*g,V,g)}),H.each(function(Y){s._77o(Y.index)}),s._93db(b),H.each(function(m){s.drawData(b,m.data,m.index)}),s._92db(b),H.clear())},i.validateImpl=function(){var t=this,$=t._canvas,b=t.getWidth(),z=t.getHeight(),j=t._rowHeight,w=t._32I;(b!==$.clientWidth||z!==$.clientHeight)&&(ob($,b,z),w=1);var h=H&&!A;t._96I&&!h&&t.validateModel();var C=t._29I,u={x:-t.tx(),y:-t.ty(),width:b,height:z},S=t._rows.size(),q=$l($),T=t._23I;w||Al(u,C)||(w=1),t._29I=u,t._59I=S*j,t._31I=r(u.y/j),t._14I=e((u.y+u.height)/j),t._31I<0&&(t._31I=0),t._14I>S&&(t._14I=S),t._99I&&w&&t._99I(),mh(q,t.tx(),t.ty(),1),w?t._12I(q):t._24I&&t._13I(q),t._93I(),t._92I(),q.restore(),t._32I=t._24I=t._96I=E,T&&(t.scrollToIndex(t.getRowIndex(T)),delete t._23I),t.tx(t.tx()),t.ty(t.ty())}},Jo._48o=function(i){i._rootVisible=!0,i._rootData=E,i._35o=function(){this._expandMap={},this._levelMap={}},i.validateModel=function(){var k=this,L=k._rootData;k._rows.clear(),k._levelMap={},k._rowMap={},k._currentLevel=0,L?k._rootVisible?k.isVisible(L)&&k.buildData(L):k.buildChildren(L):k.buildChildren(),delete k._currentLevel},i.buildData=function(e){var i=this,p=e._id,b=i._rows;i._rowMap[p]=b.size(),b.add(e),i._levelMap[p]=i._currentLevel,i.isExpanded(e)&&(i._currentLevel++,i.buildChildren(e),i._currentLevel--)},i.buildChildren=function(G){var F=this,K=G?G._children:F._dataModel._roots,T=F.getCurrentSortFunc();T&&F.isChildrenSortable(G)?K.toList(F.isVisible,F).sort(T).each(F.buildData,F):K.each(function(g){F.isVisible(g)&&F.buildData(g)})},i.getLevel=function(M){return this._levelMap[M._id]},i.getToggleIcon=function(B){var f=this,n=f._loader,W=f._collapseIcon;return n&&!n.isLoaded(B)?W:B.hasChildren()?f.isExpanded(B)?f._expandIcon:W:E},i.isCheckMode=function(){return this._checkMode!=E},i.isChildrenSortable=function(){return!0},i.handleDataModelChange=function(B){var Y=this;B.kind===lb?delete Y._expandMap[B.data._id]:B.kind===Wk&&(Y._expandMap={}),Y.ivm()},i.toggle=function(_){var Y=this;Y.isExpanded(_)?Y.collapse(_):Y.expand(_)},i.isExpanded=function(X){return 1===this._expandMap[X._id]},i.expand=function(Q){var j=this,$=j._loader;j.isExpanded(Q)||($&&!$.isLoaded(Q)&&$.load(Q),j._expandMap[Q._id]=1,j.ivm(),j.onExpanded(Q))},i.onExpanded=function(){},i.collapse=function(R){var e=this;e.isExpanded(R)&&(delete e._expandMap[R._id],e.ivm(),e.onCollapsed(R))},i.onCollapsed=function(){},i.expandAll=function(h){if(h)this.expand(h),h.eachChild(function(o){this.expandAll(o)},this);else{var b=this;b._dataModel.each(function(G){G.hasChildren()&&(b._expandMap[G._id]=1)}),b.ivm()}},i.collapseAll=function(){this._expandMap={},this.ivm()},i.makeVisible=function(B){if(B){var Z=this;if(!Z._rootData||B.isDescendantOf(Z._rootData)){for(var k=B._parent;k;)Z.expand(k),k=k._parent;Z._23I=B,Z.iv()}}},i.checkData=function(G){var l,o=this,I=o._checkMode,S=o.sm(),$=S.co(G);if(!S.sg()||!$){if(o._32o=1,I===jl)$?S.rs(G):S.as(G);else if(I===Zc)l=new Km(G),l.addAll(G._children);else if("descendant"===I)l=new Km,cg(G,l);else if("all"===I&&(l=new Km,cg(G,l),!$))for(var W=G._parent;W;)l.add(W),W=W._parent;l&&($?S.rs(l):S.as(l)),delete o._32o}},i._97I=function(k,J,R,F,Z,A,K){var M=this,D=M._indent,U=M._levelMap[J._id],a=M.getIconWidth(J),z=_l(M.getToggleIcon(J));z?(F+=D*U,ms(k,z,F+D/2,Z+K/2,J,M),F+=D):F+=D*(U+1),M._checkMode&&(ms(k,M.getCheckIcon(J),F+D/2,Z+K/2,J,M),F+=D),M.drawIcon(k,J,F,Z,a,K),M.drawLabel(k,J,F+a,Z,K)}},Jo._14Q=function(T){T.getIcon=function(K){return K.getIcon()},T.getIconWidth=function(i){return this.getIcon(i)?this._indent:0},T.drawIcon=function(n,y,J,t,$,a){if($){var v=this,h=v.getBodyColor(y),M=_l(v.getIcon(y),h);M&&(a-=v.isRowLineVisible()?1:0,Tb(n,M,ao,J,t,$,a,y,v,h),Wn(n,v.getBorderColor(y),J,t,$,a))}},T.drawLabel=function($,E,C,m,V){var J=this;$c($,J.getLabel(E),J.getLabelFont(E),J.getLabelColor(E),C,m,0,V)}},Jo._50o=function(t){t._98I=function(){var x=this,S=x._39o=new Wf;x._60I=new Km,S.mm(x._17o,x),S.md(x._18o,x),S.mh(x._19o,x)},t.setColumns=function(V){this._39o.clear(),this.addColumns(V)},t.addColumns=function(J){var R=this._39o;J.forEach(function(B){if(!(B instanceof we)){var t=Rj(B.className);B=Vo(t?t:we,B)}R.add(B)})},t.onColumnClicked=function(){},t.onCheckColumnClicked=function(){},t._3Q=function(V){for(var G,z=0,x=this._60I,P=x.size();P>z;z++)if(G=x.get(z),G.column===V)return G;return E},t.getColumnAt=function(m){var v=this._4Q(m);return v?v.column:E},t._4Q=function(c){for(var S=this,L=c.target?S.lp(c).x:c.x,e=S._60I,M=0;M<e.size();M++){var d=e.get(M),i=d.startX;if(L>=i&&L<i+d.column.getWidth())return d}return E},t.getToolTip=function(z){var a=this,s=a.getDataAt(z),Q=a.getColumnAt(z);return s&&Q?Q.getToolTip(s,a):E},t.adjustTranslateX=function(z){var F=this.getWidth()-this._91I;return F>z&&(z=F),z>0?0:U(z)},t._99I=function(){var F=this,i=F._29I,s=F._60I;s.clear(),F._91I=0,F._39o._roots.each(function(J){if(J.isVisible()){var H=F._91I+J.getWidth();F._91I<=i.x+i.width&&H>=i.x&&s.add({column:J,startX:F._91I}),F._91I=H}})},t.drawData=function(L,e,A){var n=this,N=n._rowHeight,u=N*A,m=n.isSelected(e),S=n._29I,f=S.x,w=S.width;n.drawRowBackground(L,e,m,f,u,w,N),n._60I.each(function(I){var M=I.column,Y=I.startX,f=M.getWidth();f>0&&!n.isEditing(e,M)&&(L.save(),L.beginPath(),L.rect(Y,u,f,N),L.clip(),n._87o(n.drawCell(L,e,m,M,Y,u,f,N),A,Y,u,f,N),n._columnLineVisible&&an(L,Y+f-1,u,1,N,n._columnLineColor),L.restore())}),n._rowLineVisible&&an(L,f,u+N-1,w,1,n._rowLineColor)},t.drawCell=function(D,m,p,l,y,j,x,S){var d=this;if(l.drawCell)return l.drawCell(D,m,p,l,y,j,x,S,d);var X=d.getValue(m,l);pm(D,X,l,d.getLabelFont(m,l,X),d.getLabelColor(m,l,X),y,j,x,S,m,d)},t.getColumnModel=function(){return this._39o},t._17o=function(){this.redraw()},t._18o=function(Q){var G=this;Q.data===G._sortColumn&&fk[Q.property]?G.ivm():(G._42o(),G.redraw())},t._19o=function(){this.redraw()},t.getCurrentSortFunc=function(){var Z=this,P=Z._sortColumn;if(P&&P.isSortable()){var Q=P.getSortFunc(),L=Qi===P.getSortOrder()?1:-1;return Q||(Q=yd),function(D,i){return Q.call(Z,Z.getValue(D,P),Z.getValue(i,P),D,i)*L}}return Z._sortFunc},t.isCellEditable=function(t,z){return!this.isCheckMode()&&this.isSelected(t)||this.isCheckMode()&&t===this._focusData?z.isEditable()&&this.isEditable():!1},t._37O=function(K,l){if(Jm(l))for(var h=this,$=h.lp(l),j=h._60I,a=h._rowHeight,C=h._29I,E=C.x,Q=C.y,c=C.width,r=C.height,z=0;z<j.size();z++){var P=j.get(z),p=P.startX,d=P.column,X=d.getWidth();if(d!==h._31o&&d!==h._4o&&h.isCellEditable(K,d,l)&&$.x>=p&&$.x<p+X){var O={x:p,y:h.getRowIndex(K)*a,width:X,height:a},x={x:O.x+h.tx(),y:O.y+h.ty(),width:O.width,height:O.height},k=0,L=0;return O.x<E?k=O.x-E:O.x+O.width>E+c&&(k=O.x+O.width-E-c),k&&(h.tx(h.tx()-k),x.x-=k),O.y<Q?L=O.y-Q:O.y+a>Q+r&&(L=O.y+a-Q-r),L&&(h.ty(h.ty()-L),x.y-=L),h.beginEditing({data:K,column:d,value:h.getValue(K,d),event:l,rect:O,editorRect:x,view:h}),void 0}}}},bs.BaseItemEditor=function(X,p,K,H){this._data=X,this._column=p,this._master=K,this._editInfo=H},$m("BaseItemEditor",O,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var ys=b.Tab=function(){hi(ys,this)};Jl("Tab",Wm,{ms_ac:["view","closable","disabled"],_icon:E,_closable:!1,_disabled:!1,setParent:xf});var we=b.Column=function(){hi(we,this)};Jl("Column",Wm,{_46o:1,ms_ac:["accessType","valueType",oj,Gf,yk,gf,"align",Gl,"sortOrder",Cd,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Qi,_sortFunc:E,_sortable:!0,_clickable:!0,setWidth:function(y){16>y&&(y=16);var V=this._width;
this._width=y,this.fp(gf,V,y)},getToolTip:function(P,D){return this.formatValue(D.getValue(P,this))}});var Sb=b.Property=function(){hi(Sb,this)};Jl("Property",Wm,{_46o:1,ms_ac:["accessType","valueType",Gf,yk,"categoryName",Gl,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:E,getToolTip:function(d,c,$){var a=this;return c?a.formatValue($.getValue(d,a)):$.getPropertyName(a)}}),bs.AccordionView=function(){var h=this;h._20o={},h._21o=new Km,h._10o=E,h._9o=E,h._11o=E,h._view=sj(0,h),h.iv()},$m("AccordionView",O,{ms_v:1,ms_fire:1,ms_ac:[hr,og,"titleHeight",Ji,Kq,"titleBackground","selectWidth",Xq,"orientation","separatorColor"],_expandIcon:y.accordionViewExpandIcon,_collapseIcon:y.accordionViewCollapseIcon,_titleHeight:up,_labelColor:y.accordionViewLabelColor,_labelFont:y.accordionViewLabelFont,_titleBackground:y.accordionViewTitleBackground,_selectBackground:y.accordionViewSelectBackground,_selectWidth:y.accordionViewSelectWidth,_orientation:"v",_separatorColor:y.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(r,V,v,Y){var Q=this,R=hc();if(Q._20o[r])throw r+" already exists";R.onmousedown=Gm,R.style.cursor=yn,R.addEventListener(Ib?Ac:ln,function(h){Gm(h)},!1),R.addEventListener(Ib?hm:Ff,function(I){Gm(I),Jm(I)&&(Q._10o===r?Q.collapse():Q.expand(r))},!1),mc(Q._view,R),Q._20o[r]={content:V,div:R,canvas:iq(R),icon:Y},Q._21o.add(r),v&&Q.expand(r),Q.iv()},remove:function($){var m=this,O=m._20o[$];O&&(be(O.div),delete m._20o[$],m._21o.remove($),m.iv())},clear:function(){var B=this;B._20o={},B._21o.clear(),B.iv()},isExpanded:function(w){return this._10o===w},expand:function(v){var D=this;D._20o[v]&&D._10o!==v&&(D._10o=v,D.onExpanded(v),D.iv())},onExpanded:function(){},collapse:function(){var h=this;h._10o&&(h.onCollapsed(h._10o),delete h._10o,h.iv())},onCollapsed:function(){},initCanvas:function(z,R,_){ob(z,R,_);var V=$l(z);return mh(V,0,0,1),V.clearRect(0,0,R,_),V},drawTitle:function(v,S,u,o,g){var m=this,M=_l(g.icon),k=m.isExpanded(S),b=m._titleHeight,K=m._titleBackground,s=m._selectWidth,l=m._separatorColor,r=_l(k?m._expandIcon:m._collapseIcon),I=s+4;an(v,0,0,u,o,K),k&&s&&an(v,0,0,s,o,m._selectBackground),(k||m._21o.get(m._21o.size()-1)!==S)&&an(v,0,o-1,u,1,l?l:Kp(K)),M&&(ms(v,M,I+Oh(M)/2,b/2),I+=Oh(M)+2),$c(v,S,m.getLabelFont(S),m.getLabelColor(S),I,0,0,b),r&&ms(v,r,u-Oh(r)/2-4,b/2)},validateImpl:function(){var g=this,_=g._view,y=0,t=0,F=g.getWidth(),x=g.getHeight(),P=g._titleHeight,s=g._21o.size()*P,B=g._11o,z=g._9o;delete g._11o,delete g._9o,g._21o.each(function(r){var v,Q,c=g._20o[r],X=c.content,i=g._10o===r;Pl(g)?(qh(c.div,y,0,P,x),v=g.initCanvas(c.canvas,P,x),lp(v,0,x),Kh(v,-T),g.drawTitle(v,r,x,P,c),v.restore(),i?(Q=M(0,F-s),X&&(g._11o=X,g._9o=Tf(X),qh(X,y+P,0,Q,x)),y+=P+Q):y+=P):(qh(c.div,0,t,F,P),v=g.initCanvas(c.canvas,F,P),g.drawTitle(v,r,F,P,c),v.restore(),i?(Q=M(0,x-s),X&&(g._11o=X,g._9o=Tf(X),qh(X,0,t+P,F,Q)),t+=P+Q):t+=P)});var X=g._9o;B&&B!==g._11o&&B.endEditing&&B.endEditing(),X&&X!==z&&mc(_,X),z&&z!==X&&be(z)}}),bs.SplitView=function(s,t,W,H){var l=this,V=l._dividerDiv=hc(),k=l._60O=iq(),y=l._61O=iq(),b=k.style,p=y.style;l._view=sj(1,l),mc(l._view,V),b.msTouchAction=Mc,b.pointerEvents=Mc,b.cursor=yn,p.msTouchAction=Mc,p.pointerEvents=Mc,p.cursor=yn,s&&l.setLeftView(s),t&&l.setRightView(t),W&&l.setOrientation(W),H!=E&&l.setPosition(H),l.setStatus(Ek),new Zp(l)},$m("SplitView",O,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:y.splitViewDividerSize,_dividerBackground:y.splitViewDividerBackground,_dragOpacity:y.splitViewDragOpacity,_toggleIcon:y.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(X,n){var G=this,R=G._position;isNaN(X)||(n||(G._82O=0>X?-1:X>1?1:0),G._position=X,G.fp(ph,R,X))},getLeftView:function(){return this._leftView},setLeftView:function(i){var v=this,F=v._leftView,y=v._view;if(v._leftView!==i){if(F&&F!==v._rightView){var O=Tf(F);O.parentNode===y&&be(O)}if(v._leftView=i,i){var Z=Tf(i);Z.parentNode!==y&&y.insertBefore(Z,v._dividerDiv)}v.fp("leftView",F,i)}},getRightView:function(){return this._rightView},setRightView:function(h){var v=this,Q=v._rightView,H=v._view;if(v._rightView!==h){if(Q&&Q!==v._leftView){var A=Tf(Q);A.parentNode===H&&be(A)}if(v._rightView=h,h){var Z=Tf(h);Z.parentNode!==H&&H.insertBefore(Z,v._dividerDiv)}v.fp("rightView",Q,h)}},validateImpl:function(){var m=this,y=m._draggable,w=m._position,k=m.getWidth(),E=m.getHeight(),W=m._dividerSize,u=m._dividerBackground,P=Ib?18:8,n=m._dividerDiv,t=m._82O,j=m._60O,V=m._61O,C=m._toggleIcon,Q=m._status,L=n.style,R=null,v=Ib?20:4,g=C.comps[0];W>=P||0===W?m._coverDiv&&(be(m._coverDiv),delete m._coverDiv):m._coverDiv||(m._coverDiv=hc(),X&&(m._coverDiv.style.background=Nm),mc(n,m._coverDiv)),m._togglable?j.parentNode||(mc(n,j),mc(n,V)):(be(j),be(V));var x=m._coverDiv,q=m._leftView,Z=m._rightView;if(Pl(m)){if(W>k&&(W=k),Q===Ek)if(1===t)var D=i(w,k),F=M(0,k-W-D);else-1===t?(F=i(-w,k),D=M(0,k-W-F)):(D=U((k-W)*w),F=M(0,k-W-D));else"cl"===Q?(D=0,F=M(0,k-W)):"cr"===Q&&(F=0,D=M(0,k-W));q&&qh(q,0,0,D,E),Z&&qh(Z,D+W,0,F,E),qh(n,D,0,W,E),m._22o=D,x&&(qh(x,W/2-P/2,0,P,E),x.style.cursor=y?In:""),n.style.cursor=y?In:"";var G=n.clientHeight/2,c=n.clientWidth;ob(j,c,c),qh(j,0,G-c-v,c,c),R=$l(j),mh(R,0,0,1),g.rotation=-T,Sk(R,C,0,0,c,c),R.restore(),ob(V,c,c),qh(V,0,G+v,c,c),R=$l(V),mh(R,0,0,1),g.rotation=T,Sk(R,C,0,0,c,c),R.restore()}else{if(W>E&&(W=E),Q===Ek)if(1===t)var s=i(w,E),J=M(0,E-W-s);else-1===t?(J=i(-w,E),s=M(0,E-W-J)):(s=U((E-W)*w),J=M(0,E-W-s));else"cl"===Q?(s=0,J=M(0,E-W)):"cr"===Q&&(J=0,s=M(0,E-W));q&&qh(q,0,0,k,s),Z&&qh(Z,0,s+W,k,J),qh(n,0,s,k,W),m._22o=s,x&&(qh(x,0,W/2-P/2,k,P),x.style.cursor=y?ce:""),L.cursor=y?ce:"";var r=n.clientWidth/2,c=n.clientHeight;ob(j,c,c),qh(j,r-c-v,0,c,c),R=$l(j),mh(R,0,0,1),g.rotation=0,Sk(R,C,0,0,c,c),R.restore(),ob(V,c,c),qh(V,r+v,0,c,c),R=$l(V),mh(R,0,0,1),g.rotation=z,Sk(R,C,0,0,c,c),R.restore()}L.background=u}});var Zp=function(u){this.sv=u,this.addListeners()};ok(Zp,O,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(I){var O=this,N=O.sv,y=N._dividerDiv,W=N._60O,H=N._61O,_=N._status,E=I.target;if(E===W)_===Ek?N.setStatus("cl"):"cr"===_&&N.setStatus(Ek);else if(E===H)_===Ek?N.setStatus("cr"):"cl"===_&&N.setStatus(Ek);else if(he(I)&&(E===y||E===N._coverDiv)&&(Gm(I),N.isDraggable())){N.getLeftView(),N.getRightView();var M=O.maskDiv=hc();if(M.style.left=0,M.style.top=0,M.style.width=N.getWidth()+"px",M.style.height=N.getHeight()+"px",N.getView().appendChild(M),!N.isContinuousLayout()){var J=O.resizeDiv=hc();J.style.left=y.style.left,J.style.top=y.style.top,J.style.width=y.style.width,J.style.height=y.style.height,J.style.opacity=N.getDragOpacity(),J.style.background=N.getDividerBackground(),mc(O.getView(),J)}O._lastAbsPosition=N._22o,O._86o=Pl(N)?ib(I).x:ib(I).y,ws(O,I)}},handleWindowTouchMove:function(u){he(u)&&this.update(u,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(J){var Y=this;Y.update(J,!0),Y.sv.setStatus(Ek),Y.maskDiv&&be(Y.maskDiv),Y.resizeDiv&&be(Y.resizeDiv),Y.maskDiv=Y.resizeDiv=E},handle_mousedown:function(V){Jm(V)&&this.handle_touchstart(V)},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowMouseUp:function(M){this.handleWindowTouchEnd(M)},update:function(I,m){var x=this,$=x.sv,O=Pl($)?$.getWidth():$.getHeight(),P=$._dividerSize,f=x._lastAbsPosition-x._86o;Pl($)?(f+=ib(I).x,f>O-P&&(f=O-P),0>f&&(f=0),x.resizeDiv&&(x.resizeDiv.style.left=f+pn)):(f+=ib(I).y,f>O-P&&(f=O-P),0>f&&(f=0),x.resizeDiv&&(x.resizeDiv.style.top=f+pn)),m&&O!==P&&(1===$._82O?$.setPosition(f,1):-1===$._82O?$.setPosition(f-O+P,1):$.setPosition(f/(O-P),1))}}),bs.TabView=function(){var F=this,W=F._view=sj(1,F),K=F._91O=hc(1),t=F._tabModel=new Wf,d=t.sm(),x=F.invalidate;F._7o=new Km,F._canvas=iq(K),mc(W,K),mc(W,F._92O=hc(1)),d.setSelectionMode($k),d.ms(x,F),t.mm(x,F),t.md(x,F),t.mh(x,F),new zk(F),F.iv()},$m("TabView",O,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Ji,Kq,"tabBackground","selectWidth",Xq,"moveBackground","insertColor"],_tabPosition:lf,_tabHeight:up,_tabGap:y.tabViewTabGap,_labelColor:y.tabViewLabelColor,_labelFont:y.tabViewLabelFont,_tabBackground:y.tabViewTabBackground,_selectWidth:y.tabViewSelectWidth,_selectBackground:y.tabViewSelectBackground,_moveBackground:y.tabViewMoveBackground,_insertColor:y.tabViewInsertColor,_movable:!0,getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(s,Y,n){var J=new ys,W=this._tabModel;return J.setName(s),J.setView(Y),W.add(J),n&&W.sm().ss(J),J},getLabel:function(L){return L.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(f){this._23o=f,this.iv()},get:function(Q){var x=this,u=x._tabModel;if(ve(Q))return u._roots.get(Q);if(Xr(Q)){var D;return u.each(function(R){Q===x.getLabel(R)&&(D=R)}),D}return Q instanceof ys?Q:E},select:function(D){this._tabModel.sm().ss(this.get(D))},remove:function(X){var P=this;if(X=P.get(X)){var E=P._tabModel,D=E._roots.indexOf(X);P._tabModel.remove(X),P._12Q(--D)}},getCurrentTab:function(){return this._8o},hideTabView:function(j,W){W.parentNode===this._92O&&(Hb(W)?(W.style.display=fj,W._tab_=j):be(W),Zm())},showTabView:function(F,u){Hb(u)&&(u.style.display="block",u._tab_=F),u.parentNode!==this._92O&&(mc(this._92O,u),Zm())},_24o:function(){var j,R=this,M=R._8o,r=R._9o,z=R._tabModel.sm().ld();z&&(j=Tf(z.getView())),j!==r&&(r&&(M.getView()&&M.getView().endEditing&&M.getView().endEditing(),R.hideTabView(M,r)),j&&R.showTabView(z,j)),R._8o=z,R._9o=j,M!==z&&R.onTabChanged(M,z)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(l,V){this._12Q(--V)},_12Q:function(w){var h=this,B=h._tabModel,a=B.size();if(a&&!B.sm().ld()){w==E&&(w=0),w>=a&&(w=a-1),0>w&&(w=0);for(var c=w;c>=0;c--){var p=h.get(c);if(!p.isDisabled())return h.select(p),p}for(c=w+1;a>c;c++)if(p=h.get(c),!p.isDisabled())return h.select(p),p}},getTabWidth:function(C){var y=4,$=_l(C.getIcon());$&&(y+=Oh($,C)+4);var W=this.getLabel(C);return W&&(y+=wr(this.getLabelFont(C),W).width+4),C.isClosable()&&(y+=10),y},drawTab:function(x,I,b,d,n,J,G){var Z,P=this,m=P._tabPosition,S=b+4,N=P._selectWidth,M=_l(I.getIcon()),Y=I.isDisabled(),W=P.getLabelColor(I),o=P.getLabelFont(I),p=P.getLabel(I),O=P._selectBackground,c=m===nl+"-vertical",X=m===yf+"-vertical";(c||X)&&(S=d+4),Y&&(x.globalAlpha=xg),an(x,b,d,n,J,G),I===P._8o&&N&&(m===lf?an(x,b,d+J-N,n,N,O):m===nl?an(x,b+n-N,d,N,J,O):m===yf?an(x,b,d,N,J,O):c?an(x,b+n-N,d,N,J,O):X?an(x,b,d,N,J,O):an(x,b,d,n,N,O));var g=n/2;if(c&&(lp(x,g,d+J/2),Kh(x,z),lp(x,-g,-d-J/2)),M){var q=Lk(M,I),v=Oh(M,I);if(c||X){var s=b+n/2,r=S+q/2;lp(x,s,r),Kh(x,T),lp(x,-s,-r),ms(x,M,b+n/2,S+q/2,I,P),lp(x,s,r),Kh(x,-T),lp(x,-s,-r),S+=q+4}else ms(x,M,S+v/2,d+J/2,I,P),S+=v+4}return c||X?(lp(x,n/2,S+n/2),Kh(x,T),lp(x,-n/2,-S-n/2),$c(x,p,o,W,b,S,J,n),lp(x,n/2,S+n/2),Kh(x,-T),lp(x,-n/2,-S-n/2)):$c(x,p,o,W,S,d,n,J),c&&(lp(x,g,d+J/2),Kh(x,-z),lp(x,-g,-d-J/2)),I.isClosable()&&(Z=X?{x:b+n-12,y:d+J-12,width:12,height:12}:{x:b+n-12,y:d+2,width:12,height:12},this.drawCloseIcon(I,x,W,Z)),Y&&(x.globalAlpha=1),Z},drawCloseIcon:function(Z,G,q,b){var k=b.x,S=b.y;G.strokeStyle=q,G.lineWidth=1,G.beginPath(),G.moveTo(k+2,S+8),G.lineTo(k+8,S+2),G.moveTo(k+8,S+8),G.lineTo(k+2,S+2),G.stroke()},validateImpl:function(){var e=this;e._24o();var y,z=e._canvas,o=e._tabPosition,w=e._91O,v=e._92O,B=e._tabModel,j=e.getWidth(),t=e.getHeight(),L=e._tabHeight,G=e._7o,R=e._tabGap,N=o===lf,c=o===nl,i=o===yf,Q=o===nl+"-vertical",X=o===yf+"-vertical",J=e._23o,u=0;if((c||i)&&B._roots.each(function(c){u=M(e.getTabWidth(c),u)}),N?(qh(w,0,0,j,L),y={x:0,y:L,width:j,height:M(0,t-L)}):c?(qh(w,0,0,u,t),y={x:u,y:0,width:M(0,j-u),height:t}):i?(qh(w,j-u,0,u,t),y={x:0,y:0,width:M(0,j-u),height:t}):Q?(qh(w,0,0,L,t),y={x:L,y:0,width:M(0,j-L),height:t}):X?(qh(w,j-L,0,L,t),y={x:0,y:0,width:M(0,j-L),height:t}):(qh(w,0,t-L,j,L),y={x:0,y:0,width:j,height:M(0,t-L)}),qh(v,y),Q||X){e._9o&&(y.x=0,qh(e._8o.getView(),y)),ob(z,L,t);var V=$l(z),O=0;if(mh(V,0,e.ty(),1),V.clearRect(0,0,L,t),G.clear(),B._roots.each(function(q){var A,Y=e.getTabWidth(q);J&&J.tab===q||(A=e.drawTab(V,q,0,O,L,Y,e._tabBackground)),G.add({_75o:A,tab:q,startY:O,endY:O+Y,height:Y}),O+=Y+R}),e._23Q=M(0,O-R),J){var F=J.position;e.drawTab(V,J.tab,0,J.startY,L,J.height,e._moveBackground),an(V,0,F,L,1,e._insertColor)}V.restore(),e.ty(e.ty())}else if(c||i){e._9o&&(y.x=0,qh(e._8o.getView(),y)),ob(z,u,t);var V=$l(z),O=0;if(mh(V,0,e.ty(),1),V.clearRect(0,0,u,t),G.clear(),B._roots.each(function(w){var i;J&&J.tab===w||(i=e.drawTab(V,w,0,O,u,L,e._tabBackground)),G.add({_75o:i,tab:w,startY:O,endY:O+L,height:L}),O+=L+R}),e._23Q=M(0,O-R),J){var F=J.position;e.drawTab(V,J.tab,0,J.startY,u,J.height,e._moveBackground),an(V,0,F,u,1,e._insertColor)}V.restore(),e.ty(e.ty())}else{e._9o&&(y.y=0,qh(e._8o.getView(),y)),ob(z,j,L);var V=$l(z),U=0;if(mh(V,e.tx(),0,1),V.clearRect(0,0,j,L),G.clear(),B._roots.each(function(q){var a,E=e.getTabWidth(q);J&&J.tab===q||(a=e.drawTab(V,q,U,0,E,L,e._tabBackground)),G.add({_75o:a,tab:q,startX:U,endX:U+E,width:E}),U+=E+R}),e._64I=M(0,U-R),J){var F=J.position;e.drawTab(V,J.tab,J.startX,0,J.width,L,e._moveBackground),Np(V,e._insertColor,F,0,L)}V.restore(),e.tx(e.tx())}for(var k=[],P=v.children,Z=0;Z<P.length;Z++){var m=P[Z],I=m._tab_;I&&!B.contains(I)&&k.push(m)}k.forEach(function(I){v.removeChild(I)})}});var zk=function(D){this.tv=D,this.addListeners()};ok(zk,O,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(G){this.handleScroll(G,10*(G.wheelDelta/40))},handle_DOMMouseScroll:function(b){this.handleScroll(b,10*-b.detail)},handleScroll:function(B,n){Gm(B);var P=this.tv,D=P._tabPosition;!P._40o()||D!==lf&&D!==ec||P.tx(this.tv.tx()+n),!P._41o()||D!==nl&&D!==yf&&D!==nl+"-vertical"&&D!==yf+"-vertical"||P.ty(this.tv.ty()+n)},_8Q:function(m){var h,u,D=this.tv,K=D._tabPosition,C=D._7o;if(K===lf||K===ec){var $=D.lp(m).x;for(h=0;h<C.size();h++)if(u=C.get(h),u.startX<=$&&$<=u.endX)return u}else if(K===nl||K===yf||K===nl+"-vertical"||K===yf+"-vertical"){var F=D.lp(m).y;for(h=0;h<C.size();h++)if(u=C.get(h),u.startY<=F&&F<=u.endY)return u}return E},isClickable:function(j){var A=this.tv,L=A._tabPosition,b=this._73o=this._8Q(j);return!A._40o()||L!==lf&&L!==ec?!A._41o()||L!==nl&&L!==yf&&L!==nl+"-vertical"&&L!==yf+"-vertical"?b&&(!b.tab.isDisabled()||A.isMovable()):!0:!0},handle_mousemove:function(l){var f=this;tk?f._74o=f._8Q(l):f.getView().style.cursor=f.isClickable(l)?yn:""},handle_mousedown:function(R){this.handle_mousemove(R),this.handle_touchstart(R)},handle_touchstart:function(O){var j=this,q=j.tv,p=q._tabPosition;Gm(O),j.isClickable(O)&&(p===lf||p===ec?(j.x=ib(O).x,j.lp=q.lp(O),j.tx=q.tx()):(j.y=ib(O).y,j.lp=q.lp(O),j.ty=q.ty()),ws(j,O))},handleWindowMouseMove:function(g){this.handleWindowTouchMove(g)},handleWindowTouchMove:function(J){var L,K=this,C=K.tv,j=C._tabPosition,S=K._73o;if(j===lf||j===ec){if(L=ib(J).x-K.x,!K._25o&&!K.moving&&a(L)>2&&(C._40o()&&!xi(J)?K._25o=1:S&&C.isMovable()&&(K.moving=1)),K._25o)C.tx(K.tx+L);else if(K.moving){var c=K.lp.x+L,$=C._tabGap/2;C._7o.each(function(W){var P=W.endX,E=c-W.startX<P-c;c>=W.startX&&P>=c&&C._7Q({tab:S.tab,startX:S.startX+L,width:S.width,front:E,insertTab:W.tab,position:E?M(0,W.startX-$):i(C._64I,P+$)})})}}else if(L=ib(J).y-K.y,!K._25o&&!K.moving&&a(L)>2&&(C._41o()&&!xi(J)?K._25o=1:S&&C.isMovable()&&(K.moving=1)),K._25o)C.ty(K.ty+L);else if(K.moving){var n=K.lp.y+L,$=C._tabGap/2;C._7o.each(function(U){var E=U.endY,Q=n-U.startY<E-n;n>=U.startY&&E>=n&&C._7Q({tab:S.tab,startY:S.startY+L,height:S.height,front:Q,insertTab:U.tab,position:Q?M(0,U.startY-$):i(C._23Q,E+$)})})}},handleWindowMouseUp:function(E){this.handleWindowTouchEnd(E)},handleWindowTouchEnd:function(){var l=this,v=l.tv,_=v._tabPosition,W=v.getTabModel(),y=W._roots,D=l._73o;if(l.moving){var b=v._23o;if(b&&b.insertTab!==b.tab){var M=b.tab,C=y.remove(M),R=y.indexOf(b.insertTab);R>=0&&(b.front||R++,R<=y.size()&&(y.add(M,R),W._38I(M,C,R)))}v._7Q(E),delete l.moving}else if(!l._25o&&D){M=D.tab;var r=l._74o;if(!r||r.tab===M)if(!M.isDisabled()&&Jd(D._75o,l.lp)){var f=function(){var l=y.indexOf(M);W.remove(M),v.onTabClosed(M,l)};v.onTabClosing(M,f)&&f()}else M.isDisabled()||v._8o===M||W.sm().ss(M)}l._25o=l._73o=l._74o=_===lf||_===ec?l.x=l.lp=l.tx=E:l.y=l.lp=l.ty=E}}),bs.PropertyView=function(M){var o=this;o._view=sj(1,o),o._canvas=iq(o._view),mc(o._view,o._79O=hc()),o._rows=new Km,o._28o=new Km,o._26o={},o._26Q={};var _=o._propertyModel=new Wf,c=o.ivm;_.mm(c,o),_.md(c,o),_.mh(c,o),o.dm(M?M:new Wf),new fd(o)},$m("PropertyView",O,{ms_ac:[Ji,dc,Kq,Gf,yk,"categorizable",Xl,Cd,$q,hr,og,md,dj,yc,"selectRowIndex",Xq,"background",vn,un,zi,Rp,Eo],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:mr,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Nj,_background:y.propertyViewBackground,_expandIcon:y.propertyViewExpandIcon,_collapseIcon:y.propertyViewCollapseIcon,_scrollBarColor:Tl,_scrollBarSize:$n,_autoHideScrollBar:cs,_selectBackground:y.propertyViewSelectBackground,_rowHeight:Ed,_rowLineVisible:y.propertyViewRowLineVisible,_rowLineColor:y.propertyViewRowLineColor,_10I:.5,_columnLineVisible:y.propertyViewColumnLineVisible,_columnLineColor:y.propertyViewColumnLineColor,_labelColor:y.propertyViewLabelColor,_labelSelectColor:y.propertyViewLabelSelectColor,_labelFont:y.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(F){0>F&&(F=0),F>1&&(F=1);var J=this,e=J._10I;J._10I=F,J.fp("columnPosition",e,F)},getPropertyName:function(v){return v.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(i,w,y){return y===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(h,i){return i===this._selectRowIndex?this._labelSelectColor:h.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(q){var H=this.getHeight()-this._59I;return H>q&&(q=H),q>0?0:U(q)},isExpanded:function(D){if(!D)return!0;var A=this._26o[D];return A?A.isExpanded:!(this._26Q[D]===!1)},toggle:function(y){var O=this;O.isExpanded(y)?O.collapse(y):O.expand(y)},expandAll:function(){this.validate();for(var k in this._26o)this.expand(k)},expand:function(j){if(j&&j!==fj){var L=this,W=L._26o[j];W&&!W.isExpanded&&(W.isExpanded=!0,L.onExpanded(j),L.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var t in this._26o)this.collapse(t)},collapse:function(y){if(y&&y!==fj){var M=this,k=M._26o[y];k&&k.isExpanded&&(k.isExpanded=!1,M.onCollapsed(y),M.ivm())}},onCollapsed:function(){},getCategoryName:function(z){if(!this.isCategorizable())return fj;var r=z.getCategoryName();return r?r:fj},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(n){var Y=this,E=Y._dataModel;E!==n&&(E&&(E.umd(Y.handlePropertyChange,Y),Y._selectionModel||E.sm().ums(Y.handleSelectionChange,Y)),Y._dataModel=n,n.md(Y.handlePropertyChange,Y),Y._selectionModel?Y._selectionModel._21I(n):n.sm().ms(Y.handleSelectionChange,Y),Y.fp(ck,E,n))},isVisible:function(U){return this._visibleFunc?this._visibleFunc(U):!0},onPropertyChanged:function(e){var a=this,P=e.property;Ej[P]?a.ivm():a.iv(),P===Md&&a._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:pd},handlePropertyChange:function(K){this._27o===K.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var G=this;G._96I||(G.setSelectRowIndex(-1),G._96I=1,G.iv())},redraw:function(){this.iv()},validateModel:function(){var J=this,T=J._rows,r=J._28o,i={},c=new Km,F=J._27o;J.updateCurrentData(),F!==J._27o&&J.endEditing(),T.clear(),r.clear(),J.getRawProperties().each(function(G){if(J.isVisible(G)){c.add(G);var $=J.getCategoryName(G);i[$]||(r.add($,$===fj?0:K),i[$]={isExpanded:J.isExpanded($),properties:new Km})}}),J._sortFunc&&c.sort(J._sortFunc);for(var v in J._26o)J._26Q[v]=J.isExpanded(v);J._26o=i,r.each(function(N){N!==fj&&T.add(N);var r=i[N];r.isExpanded&&c.each(function(F){J.getCategoryName(F)===N&&(r.properties.add(F),T.add({property:F,data:J._27o}))},J)})},validateImpl:function(){var v=this;v._76o(),v._96I&&(v.validateModel(),delete v._96I);var W=v._canvas,z=v.getWidth(),L=v.getHeight(),b=-v.ty(),T=v._rowHeight,V=v._indent,c=z-V,k=v._rows,Z=k.size(),u=v._9I=V+c*v._10I,f=v._59I=Z*T;ob(W,z,L),v._29I={x:0,y:b,width:z,height:L},v._31I=r(b/T),v._14I=e((b+L)/T),v._31I<0&&(v._31I=0),v._14I>Z&&(v._14I=Z);var n,P=$l(W),H=v._background;mh(P,0,-b,1),P.beginPath(),P.rect(0,b,z,L),P.clip(),P.clearRect(0,b,z,L),v._93db(P),H&&an(P,0,0,V,f,H);for(var i=v._31I;i<v._14I;i++){var M=k.get(i),b=T*i;if(Xr(M))H&&an(P,V,b,c,T,H),n=_l(v.isExpanded(M)?v._expandIcon:v._collapseIcon),n&&Tb(P,n,ao,0,b,V,T),P.save(),P.beginPath(),P.rect(V,b,c,T),P.clip(),v.drawCategoryName(P,M,i,V,b,c,T),P.restore();else{var o=M.property,F=M.data,n=_l(o.getIcon()),g=v._selectRowIndex===i?v.getSelectBackground():E;if(n&&Tb(P,n,ao,0,b,V,T),g&&an(P,V,b,c,T,g),P.save(),P.beginPath(),P.rect(V,b,u-V,T),P.clip(),v.drawPropertyName(P,o,i,V,b,u-V,T),P.restore(),!v.isEditing(F,o)){var h=u+1,J=z-u-1;P.save(),P.beginPath(),P.rect(h,b,J,T),P.clip(),v._87o(v.drawPropertyValue(P,o,v.getValue(F,o),i,h,b,J,T,F),i,h,b,J,T),P.restore()}}v._rowLineVisible&&an(P,V,b+T-1,c,1,v._rowLineColor)}v._columnLineVisible&&(an(P,u,0,1,f,v._columnLineColor),an(P,z-1,0,1,f)),v._92db(P),v._93I(),P.restore(),v.ty(v.ty())},drawCategoryName:function(O,m,g,L,R,V,P){$c(O,m,this.getCategoryFont(m),this.getCategoryColor(m),L,R,V,P)},drawPropertyName:function(r,l,e,b,v,x,C){return l.drawPropertyName?(l.drawPropertyName(r,l,e,b,v,x,C,this),void 0):($c(r,this.getPropertyName(l),this.getPropertyFont(l,e),this.getPropertyColor(l,e),b,v,x,C),void 0)},drawPropertyValue:function(y,g,r,I,O,S,U,q,Z){return g.drawPropertyValue?g.drawPropertyValue(y,g,r,I,O,S,U,q,Z,this):(pm(y,r,g,this.getLabelFont(g,r,I),this.getLabelColor(g,r,I),O,S,U,q,Z,this),void 0)},isPropertyEditable:function(Y){return Y.isEditable()&&this.isEditable()},setProperties:function(B){this._propertyModel.clear(),this.addProperties(B)},addProperties:function(g){if(g){var X=this._propertyModel;g.forEach(function(q){if(!(q instanceof Sb)){var N=Rj(q.className);q=Vo(N?N:Sb,q)}X.add(q)})}},getRowIndexAt:function(j){var w=this,s=r(w.lp(j).y/w._rowHeight);return s>=0&&s<w._rows.size()?s:-1},getPropertyAt:function(R){var F=this,S=F.getRowIndexAt(R);return S>=0?F._rows.get(S).property:E},getToolTip:function(A){var Z=this,F=Z.getPropertyAt(A),I=Z._27o;return F&&I?F.getToolTip(I,Z._9I<Z.lp(A).x,Z):E}});var fd=function(g){this.pv=g,this.addListeners()};ok(fd,O,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(S){this.getView().style.cursor=S},clear:function(){var Y=this;Y._62O=Y.cp=Y.ty=Y.p=E,Y.setCursor(jl)},handle_mousedown:function(s){this.handle_touchstart(s)},handle_touchstart:function(h){var A=this,r=A.pv;Gm(h),r.setFocus(h)&&(Jm(h)?(A.cp=ib(h),A.ty=r.ty(),A.p=r.getColumnPosition(),A.handle_touchmove(h)):r.setSelectRowIndex(r.getRowIndexAt(h)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(e){this.handle_touchend(e)},handle_touchend:function(H){var m=this;if(m.cp&&!m._62O){var b=m.pv,R=b.lp(H),t=R.x,$=R.y,u=b._indent,W=b.getRowIndexAt(H),x=b._9I;if(W>=0){var s=b._rowHeight,w=s*W,K=b._rows.get(W),j=K.property;if(Xr(K))_l(b.isExpanded(K)?b._expandIcon:b._collapseIcon)&&t>=0&&u>=t&&$>=w&&w+s>=$?b.toggle(K):_c(H)&&b.toggle(K);else if(t>x&&b.isPropertyEditable(j,H)){var N={x:x+1,y:w,width:b.getWidth()-x-1,height:s},S={x:N.x+b.tx(),y:N.y+b.ty(),width:N.width,height:N.height},o=0,C=b._29I;N.y<C.y?o=N.y-C.y:N.y+s>C.y+C.height&&(o=N.y+s-C.y-C.height),o&&(b.ty(b.ty()-o),S.y-=o),b.beginEditing({data:K.data,property:j,value:b.getValue(K.data,j),event:H,rect:N,editorRect:S,view:b})}}b.setSelectRowIndex(W)}m.clear()},handleWindowMouseMove:function(_){this.handleWindowTouchMove(_)},handleWindowTouchMove:function(Q){var H=this,T=H.pv,U=H.ty,O=H.cp,y=ib(Q),m=H._62O;if("p"===m)T.setTranslateY(U+y.y-O.y);else if("c"===m){var G=T.getWidth()-T._indent;if(G>16){var C=H.p-(O.x-y.x)/G,u=16/G;u>C&&(C=u),C>1-u&&(C=1-u),T.setColumnPosition(C)}}else"s"===m&&T.setTranslateY(U+(O.y-y.y)*T._59I/T._29I.height)},handle_mousemove:function(S){this.handle_touchmove(S)},handle_touchmove:function(V){if(!tk&&Jm(V)){var E=this,X=E.pv,J=a(X.lp(V).x-X._9I)<=(Ib?8:3);E.cp?E._62O||(J?(E._62O="c",ws(E)):a(ib(V).y-E.cp.y)>=2&&(E._62O=E.isV(V)?"s":"p",ws(E))):(J?E.setCursor(In):E.setCursor(jl),E.isV(V)&&X._43o())}},isV:function(_){var x=this.pv,S=x._29I;return x._41o()&&S.x+S.width-x.lp(_).x<en},handle_mousewheel:function(R){this.handleScroll(R,R.wheelDelta/40)},handle_DOMMouseScroll:function(o){2===o.axis&&this.handleScroll(o,-o.detail)},handleScroll:function(A,G){var J=this.pv;Gm(A),J.endEditing(),J.translate(0,G*J.getRowHeight())},handle_keydown:function(p){var N=this.pv,A=N._rows.size(),T=N._selectRowIndex+(dh(p)?-1:1);(dh(p)||Kr(p))&&(0>T&&(T=0),T>=A&&(T=A-1),N.setSelectRowIndex(T))}}),bs.ListView=function(E){this._5o(E),new pq(this)},$m("ListView",O,{ms_ac:[Ji,dc,Kq,vn,Xl,un,zi,Cd,$q,md,dj,yc,Yg,Xq],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Nj,_rowHeight:Ed,_rowLineVisible:y.listViewRowLineVisible,_rowLineColor:y.listViewRowLineColor,_scrollBarColor:Tl,_scrollBarSize:$n,_autoMakeVisible:Pi,_autoHideScrollBar:cs,_selectBackground:y.listViewSelectBackground,_labelColor:y.listViewLabelColor,_labelSelectColor:y.listViewLabelSelectColor,_labelFont:y.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(E){var r=this,f=r._checkMode;r._checkMode=E,r.fp(ni,f,E)},drawRow:function(N,K,T,q,g,f,I){var t=this,X=0,l=t._indent,U=t.getIconWidth(K);t.drawRowBackground(N,K,T,q,g,f,I),t._checkMode&&(ms(N,_l(t.getCheckIcon(K)),X+l/2,g+I/2,K,t),X+=l),t.drawIcon(N,K,X,g,U,I),t.drawLabel(N,K,X+U,g,I)}});var pq=function(H){this.list=H,this._lastSelectDataTime=fp(),this.addListeners()};ok(pq,O,{ms_listener:1,getView:function(){return this.list._view},clear:function($){var z=this,s=z.list;$&&"d"===z._62O&&!z.dragCancel&&s.handleDragAndDrop($,"end"),s.draggingData&&(s.draggingData=null,s.redraw()),z.dragCancel=z._62O=z._isV=z._isH=z.cp=z.tx=z.ty=E},handle_mousedown:function(E){this.handle_touchstart(E)},handle_touchstart:function(b){var z=this,k=z.list;if(Gm(b),k.setFocus(b)){var o=k.getDataAt(b);z.cp=ib(b),z.tx=k.tx(),z.ty=k.ty(),Jm(b)?o&&k.handleDragAndDrop&&!z.isV(b)&&!z.isH(b)&&(k.draggingData=o,k.redraw(),k.handleDragAndDrop(b,"prepare")):(o&&z._33o(b,o),z.clear(b))}},handleWindowMouseUp:function(_){this.clear(_)},handleWindowTouchEnd:function(Z){this.clear(Z)},handle_mouseup:function(p){this.handle_touchend(p)},handle_touchend:function(s){var U=this,S=U.list;if(!U._isV&&!U._isH&&U.cp&&!U._62O){var C=S.getDataAt(s);C?(S.isCheckMode()?U._34o(s,C):U._33o(s,C),_c(s)?S.onDataDoubleClicked(C,s):S.onDataClicked(C,s)):S.handleBackgroundClick(s)}U.clear(s)},handleWindowMouseMove:function(O){this.handleWindowTouchMove(O)},handleWindowTouchMove:function(E){var l=this,A=l.list,F=l._62O,X=l.tx,c=l.ty,i=l.cp,w=ib(E),N=A._29I;"p"===F?A.setTranslate(X+w.x-i.x,c+w.y-i.y):"v"===F?A.ty(c+(i.y-w.y)*A._59I/N.height):"h"===F?A.tx(X+(i.x-w.x)*A._91I/N.width):"d"===F&&(l.dragCancel||A.handleDragAndDrop(E,"between"))},handle_mousemove:function(V){this.handle_touchmove(V)},handle_touchmove:function(l){if(!tk&&Jm(l)){var C=this,T=C.list;if(C._isV=C.isV(l),C._isH=C.isH(l),C.cp){if(!C._62O){if(tm(ib(l),C.cp)<2)return;C._isV?C._62O="v":C._isH?C._62O="h":T.draggingData&&!this.dragCancel?(C._62O="d",T.handleDragAndDrop(l,"begin")):C._62O="p",C._62O&&"d"!==C._62O&&T.draggingData&&(T.draggingData=null,T.redraw()),ws(C)}}else C._isV&&T._43o(),C._isH&&T._42o()}},isV:function(Y){var m=this.list,H=m._29I;return m._41o()&&H.x+H.width-m.lp(Y).x<en},isH:function(i){var d=this.list,J=d._29I;return d._40o()&&J.y+J.height-d.lp(i).y<en},handle_mousewheel:function(w){this.handleScroll(w,w.wheelDelta/40,w.wheelDelta!==w.wheelDeltaX)},handle_DOMMouseScroll:function(L){this.handleScroll(L,-L.detail,1)},handleScroll:function(R,F,r){var D=this.list;Gm(R),D.endEditing&&D.endEditing(),r&&D._41o()?D.translate(0,F*D.getRowHeight()):D._40o()&&D.translate(10*F,0)},handle_keydown:function(J){if(!y.isInput(J.target)){var j,c=this.list,q=c.sm(),w=c._rows,E=w.size();if(Mq(J))c.selectAll();else if(bi(J))c.handleDelete&&c.handleDelete(J);else if(Xm(J))"d"!==this._62O||this.dragCancel||(c.handleDragAndDrop(J,"cancel"),this.dragCancel=!0);else if(kp(J))c.isCheckMode()&&(j=c.getFocusData(),j&&c.checkData(j));else if(dh(J)||Kr(J)){var v=c.isCheckMode();if(j=v?c.getFocusData():q.ld()){var D=c.getRowIndex(j);D>=0&&(dh(J)?0!==D&&(j=w.get(D-1),v?c.setFocusData(j):q.ss(j)):D!==E-1&&(j=w.get(D+1),v?c.setFocusData(j):q.ss(j)))}else E>0&&(j=w.get(0),v?c.setFocusData(j):q.ss(j))}}},_34o:function(D,K){var W=this.list,u=W.lp(D).x;return u>=0&&u<=W._indent?(W.checkData(K),void 0):(W.setFocusData(K),void 0)},_33o:function(z,A){var x=this.list,H=x.sm(),E=H.ld();if(xi(z))x.isSelected(A)?H.rs(A):H.as(A);else if(As(z))if(E)for(var S=x.getRowIndex(E),y=x.getRowIndex(A);S!==y;)S+=y>S?1:-1,H.as(x._rows.get(S));else H.ss(A);else if(Jm(z)){var K=fp();if(H.contains(A)){var l=K-this._lastSelectDataTime;x.handleDataDoubleSelect&&l>500&&1500>l&&x.handleDataDoubleSelect(z,A)}H.ss(A),this._lastSelectDataTime=K}else H.contains(A)||H.ss(A)}}),bs.TreeView=function(P){var l=this;l._35o(),l._5o(P),new xr(l)},$m("TreeView",O,{ms_ac:[Ji,dc,Kq,"rootVisible",ni,"rootData",Cd,$q,md,dj,yc,Xl,vn,un,zi,hr,og,Yg,Xq,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:E,_indent:Nj,_rowHeight:Ed,_rowLineVisible:y.treeViewRowLineVisible,_rowLineColor:y.treeViewRowLineColor,_scrollBarColor:Tl,_scrollBarSize:$n,_autoHideScrollBar:cs,_expandIcon:y.treeViewExpandIcon,_collapseIcon:y.treeViewCollapseIcon,_autoMakeVisible:Pi,_selectBackground:y.treeViewSelectBackground,_labelColor:y.treeViewLabelColor,_labelSelectColor:y.treeViewLabelSelectColor,_labelFont:y.treeViewLabelFont,_doubleClickToToggle:y.treeViewDoubleClickToToggle,drawRow:function(H,O,l,V,T,N,w){var u=this;u.drawRowBackground(H,O,l,V,T,N,w),u._97I(H,O,l,0,T,N,w)},isOnToggleIcon:function(A){var M=this.getDataAt(A);if(M){var o=this.getIndent(),i=this.lp(A).x;if(_l(this.getToggleIcon(M))){var S=o*this.getLevel(M);if(i>=S&&S+o>=i)return!0}}return!1}});var xr=function(G){hi(xr,this,[G])};ok(xr,pq,{toggle:function(l,C,m,v){var r=this.list,S=r.lp(l).x;if(_l(r.getToggleIcon(C))){var o=m*v;if(S>=o&&o+m>=S)return r.toggle(C),!0}return r.isDoubleClickToToggle()&&_c(l)?(r.toggle(C),!0):!1},_34o:function(X,S){var N=this.list,C=N.lp(X).x,H=N._levelMap[S._id],r=N._indent,p=r*(H+1);return C>=p&&p+r>=C?(N.checkData(S),void 0):(this.toggle(X,S,r,H)||N.setFocusData(S),void 0)},_33o:function(Q,S){var E=this,J=E.list;E.toggle(Q,S,J._indent,J.getLevel(S))||xr.superClass._33o.call(E,Q,S)},handle_keydown:function(R){if(Yf(R)||nb(R)){var I=this.list,W=I._rows,b=I.isCheckMode(),F=I.sm(),u=b?I.getFocusData():F.ld();
u?u.hasChildren()&&(Yf(R)?I.collapse(u):I.expand(u)):W.size()>0&&(u=W.get(0),b?I.setFocusData(u):F.ss(u))}else xr.superClass.handle_keydown.call(this,R)}});var Cl=bs.TableView=function(h){this._98I(),this._5o(h),new ci(this)};$m("TableView",O,{ms_ac:[Ji,dc,Kq,"sortMode",Gf,yk,vn,un,zi,Rp,Eo,"sortColumn",Cd,$q,md,dj,yc,Yg,Xq],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Ln,_editable:!0,_batchEditable:!1,_rowHeight:Ed,_rowLineVisible:y.tableViewRowLineVisible,_rowLineColor:y.tableViewRowLineColor,_columnLineVisible:y.tableViewColumnLineVisible,_columnLineColor:y.tableViewColumnLineColor,_scrollBarColor:Tl,_scrollBarSize:$n,_autoHideScrollBar:cs,_autoMakeVisible:Pi,_selectBackground:y.tableViewSelectBackground,_labelColor:y.tableViewLabelColor,_labelSelectColor:y.tableViewLabelSelectColor,_labelFont:y.tableViewLabelFont,getCheckColumn:function(){var f=this;if(!f._31o){var b=f._31o=new we;b.setEditable(!0),b.setWidth(40),b.getValue=f.getCheckColumValue,b.drawCell=f.drawCheckColumnCell}return f._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(x){var s=this,R=s._39o,m=s.getCheckColumn();x!==s.isCheckMode()&&(x?R.add(m,0):R.remove(m),s.fp(ni,!x,x))},getCheckColumValue:function(T,m,q){return q.isSelected(T)},drawCheckColumnCell:function($,s,i,b,L,X,v,J,u){ms($,u.getCheckIcon(s),L+v/2,X+J/2,s,u)}});var ci=function(a){hi(ci,this,[a])};ok(ci,pq,{_34o:function(G,x){var i=this.list,j=i._31o;if(i.isCellEditable(x,j,G)){var N=i._3Q(j),V=i.lp(G).x;if(N&&V>=N.startX&&V<N.startX+j.getWidth())return i.checkData(x),void 0}i._37O(x,G),i.setFocusData(x)},_33o:function(X,a){this.list._37O(a,X),ci.superClass._33o.apply(this,arguments)}});var fh=bs.TreeTableView=function(K){var z=this,h=z._4o=new we;z._35o(),z._98I(),z._5o(K),h.setDisplayName("Name"),h.setEditable(!0),h.setWidth(180),h.drawCell=gq,h.getValue=Ni,z._39o.add(h),new mp(z)},gq=function(p,Q,B,c,k,h,v,d,F){F._97I(p,Q,B,k,h,v,d)},Ni=function(P,p,F){return F.getLabel(P)};$m("TreeTableView",O,{ms_ac:[Ji,dc,Kq,"sortMode",Gf,yk,Xl,ni,"rootData","rootVisible",Cd,$q,"sortColumn",hr,og,md,dj,yc,Yg,zi,vn,un,Rp,Eo,Xq,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Ln,_checkMode:E,_editable:!0,_batchEditable:!1,_indent:Nj,_rowHeight:Ed,_rowLineVisible:y.treeTableViewRowLineVisible,_rowLineColor:y.treeTableViewRowLineColor,_columnLineVisible:y.treeTableViewColumnLineVisible,_columnLineColor:y.treeTableViewColumnLineColor,_expandIcon:y.treeTableViewExpandIcon,_collapseIcon:y.treeTableViewCollapseIcon,_scrollBarColor:Tl,_scrollBarSize:$n,_autoHideScrollBar:cs,_autoMakeVisible:Pi,_selectBackground:y.treeTableViewSelectBackground,_labelColor:y.treeTableViewLabelColor,_labelSelectColor:y.treeTableViewLabelSelectColor,_labelFont:y.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var mp=function(t){hi(mp,this,[t])};ok(mp,pq,{_34o:function(x,G){var J=this.list,k=J._4o,q=J._3Q(k),i=J.lp(x).x;if(q){var t=J._indent,o=q.startX+t*J.getLevel(G);if(_l(J.getToggleIcon(G))&&i>=o&&o+t>=i)return J.toggle(G),void 0;if(J.isCellEditable(G,k)&&(o+=t,i>=o&&o+t>=i))return J.checkData(G),void 0}J._37O(G,x),J.setFocusData(G)},_33o:function(U,r){var N=this.list,n=N.lp(U).x;if(_l(N.getToggleIcon(r))){var Z=N._3Q(N._4o);if(Z){var W=N._indent,v=Z.startX+W*N.getLevel(r);if(n>=v&&v+W>=n)return N.toggle(r),void 0}}N._37O(r,U),mp.superClass._33o.apply(this,arguments)}});var Zn=bs.TableHeader=function(m){var M=this,f=M._view=sj(1,M),U=M._39o=m.getColumnModel(),S=M.iv;M.tv=M._tableView=m,M._60I=new Km,M._canvas=iq(f),f.style.background=y.tableHeaderBackground||"",f.style.height=Ch+pn,U.mm(S,M),U.md(S,M),U.mh(S,M),m.mp(function(P){Em[P.property]&&M.iv()},M),new Ab(M),M.iv()};$m("TableHeader",O,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Ji,Kq,Xl,"moveBackground","insertColor",Rp,Eo,"resizable","movable"],_checkIcon:Xh,_movable:!0,_resizable:!0,_labelColor:y.tableHeaderLabelColor,_labelFont:y.tableHeaderLabelFont,_columnLineColor:y.tableHeaderColumnLineColor,_columnLineVisible:y.tableHeaderColumnLineVisible,_sortDescIcon:y.tableHeaderSortDescIcon,_sortAscIcon:y.tableHeaderSortAscIcon,_moveBackground:y.tableHeaderMoveBackground,_insertColor:y.tableHeaderInsertColor,_indent:Nj,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(m){return m.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(z){return z.getColor()||this._labelColor},getLabelAlign:function(b){return b._align},onPropertyChanged:function(){this.iv()},_5Q:function(L){this._61I=L,this.iv()},getLogicalPoint:function(t){return $b(t,this._canvas,this.tv.tx())},validateImpl:function(){var w=this,c=w._canvas,G=w.getWidth(),L=w.getHeight(),P=w.tv,M=w._60I,m=w._61I,A=-P.tx(),O=0;(G!==c.clientWidth||L!==c.clientHeight)&&ob(c,G,L),M.clear(),w._39o._roots.each(function(N){if(N.isVisible()){var b=O+N.getWidth();A+G>=O&&b>=A&&M.add({column:N,startX:O}),O=b}});var K=$l(c);if(mh(K,-A,0,1),K.beginPath(),K.rect(A,0,G,L),K.clip(),K.clearRect(A,0,G,L),M.each(function(r){var O=r.column,M=r.startX,$=O.getWidth();$>0&&(K.save(),K.beginPath(),K.rect(M,0,$,L),K.clip(),m&&m.column===O||w.drawColumn(K,O,M,0,$,L),w._columnLineVisible&&an(K,M+$-1,0,1,L,w._columnLineColor),K.restore())}),m){var s=m.column,O=m.startX,v=m.position,$=s.getWidth();K.save(),K.beginPath(),K.rect(O,0,$,L),K.clip(),K.fillStyle=w._moveBackground,K.fill(),w.drawColumn(K,s,O,0,$,L),K.restore(),Np(K,w._insertColor,v,0,L)}K.restore()},_6Q:function(X){var T=this.tv;return T._31o===X&&T.sm().getSelectionMode()===Yb},drawColumn:function(E,w,B,l,v,W){var Q=this,z=Q.tv,a=_l(w.getIcon()),n=Q.getLabelAlign(w);if(Q._6Q(w)){var c=_l(Q._checkIcon);ms(E,c,B+v/2,l+W/2,w,Q)}else{var H=Q.getLabel(w),N=Q.getLabelFont(w),k=Q.getLabelColor(w),R=wr(N,H).width,Y=a?Q._indent:0;n===nl?(a&&Tb(E,a,ao,B,l,Y,W),$c(E,H,N,k,B+Y,l,v,W,nl)):n===yf?(a&&Tb(E,a,ao,B+v-R-Y,l,Y,W),$c(E,H,N,k,B,l,v,W,yf)):(a&&Tb(E,a,ao,B+(v-R-Y)/2,l,Y,W),$c(E,H,N,k,B+(v-R+Y)/2,l,0,W,nl))}if(w.isSortable()&&z.getSortColumn()===w&&(a=_l(w.getSortOrder()===Qi?Q._sortAscIcon:Q._sortDescIcon))){var x=Oh(a,w)/2+2;ms(E,a,n===yf?B+x:B+v-x,l+W/2,w,z)}}});var Ab=function(J){var L=this;L.th=J,L.tv=J._tableView,L.addListeners()};ok(Ab,O,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(M){this.getView().style.cursor=M},handle_mousemove:function(K){if(!tk){var z=this;delete z._29o,z.setCursor(jl);for(var w=z.th,M=w._60I,B=w.lp(K).x,X=M.size()-1;X>=0;X--){var U=M.get(X),i=U.column,_=U.startX+i.getWidth();if(w.isResizable()&&a(_-B)<=(Ib?10:3))return z._29o=U,z.setCursor(In),void 0;B>U.startX&&_>B&&(z._29o=U),(i.isClickable()||i.isSortable()||w.isMovable()||z.tv.getCheckColumn&&i===z.tv.getCheckColumn())&&B>U.startX&&_>B&&z.setCursor(yn)}}},handle_mousedown:function(d){this.handle_touchstart(d)},handle_touchstart:function(i){var d=this;Gm(i),d.tv.endEditing(),d.handle_mousemove(i),d._29o&&(d.x=ib(i).x,d.lx=d.th.lp(i).x,d.w=d._29o.column.getWidth(),ws(d,i))},handleWindowMouseMove:function(M){this.handleWindowTouchMove(M)},handleWindowTouchMove:function(F){var C=this,Q=C.th,X=C.getView().style.cursor,J=C._29o,o=ib(F).x-C.x;if(C.resizing||C.moving||(X===In?C.resizing=1:Q.isMovable()&&X===yn&&a(o)>2&&(C.moving=1)),C.resizing)J.column.setWidth(C.w+o);else if(C.moving){var L=C.lx+o;Q._60I.each(function(K){var Y=K.startX,I=Y+K.column.getWidth();if(L>=Y&&I>=L){var v={column:J.column,startX:J.startX+o,front:I-L>L-Y,insertColumn:K.column};v.position=v.front?Y:I,Q._5Q(v)}})}},_16Q:function(p,V){var D=this,v=D.tv,o=D.th,f=o._checkIcon;if(o._6Q(p)){var I=_l(f),l=D.lx,Y=p.getWidth(),U=Oh(I,p);if(l>=V+Y/2-U&&V+Y/2+U>=l){o.setCheckIcon(f===Fn?Xh:Fn);var q=v.sm(),B=v._rows;return f===Fn?q.rs(B):q.ss(B),v.onCheckColumnClicked(p),!0}}return!1},handleWindowMouseUp:function(A){this.handleWindowTouchEnd(A)},handleWindowTouchEnd:function(Z){var g=this,n=g.tv,i=g.th,j=g._29o;if(g.moving){var m=i._61I;if(m&&m.insertColumn!==m.column){var d=m.column,b=n.getColumnModel()._roots,s=b.remove(d),Y=b.indexOf(m.insertColumn);Y>=0&&(m.front||Y++,Y<=b.size()&&(b.add(d,Y),n.getColumnModel()._38I(d,s,Y)))}i._5Q(E),delete g.moving}else if(!g.resizing&&j){d=j.column;var t=i.lp(Z).x,P=j.startX,J=!0;if(i.onColumnClicked){var S=i.onColumnClicked(d,Z,P);S===!1&&(J=!1)}if(J&&t>=P&&t<=P+d.getWidth()&&!g._16Q(d,P)){if(d.isSortable()){var R=n.getSortMode(),h=d.getSortOrder();R===Ln?n.getSortColumn()===d?(h===pg&&n.setSortColumn(E),d.setSortOrder(h===Qi?pg:Qi)):n.setSortColumn(d):"bistate"===R&&(n.getSortColumn()===d?d.setSortOrder(h===Qi?pg:Qi):n.setSortColumn(d))}n.onColumnClicked(d,Z,P)}}g._29o=g.resizing=g.x=g.lx=g.w=E}}),bs.TablePane=function(i){this.init(new Cl(i))},$m("TablePane",O,{ms_v:1,_44o:1}),bs.TreeTablePane=function(a){this.init(new fh(a))},$m("TreeTablePane",O,{ms_v:1,_44o:1}),bs.Toolbar=function(C){var T=this,F=T._view=sj(1,T),k=F.style;k.background=y.toolbarBackground||"",k.height=up+pn,T._canvas=iq(F),T._30o=new Km,T._90I=new Km,T.setItems(C||[]),F.handleGroupSelectedChanged=function(V){if(V.isSelected()){var m=V.getGroupId();null!=m&&T._items.forEach(function(n){var k=n.element;k&&k!==V&&k.setSelected&&k.getGroupId&&k.getGroupId()===m&&k.setSelected(!1)})}},new Df(T)},$m("Toolbar",O,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[bn,Ji,Kq,dc,Xq,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:y.toolbarLabelColor,_labelSelectColor:y.toolbarLabelSelectColor,_labelFont:y.toolbarLabelFont,_selectBackground:y.toolbarSelectBackground,_itemGap:y.toolbarItemGap,_separatorColor:y.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(v){var O=this.getItemInfoAt(v);return O?O.item.toolTip:E},getLabelColor:function(t){return t&&t.selected&&t.type!==Fn&&t.type!==pk?this._labelSelectColor:this._labelColor},onPropertyChanged:function(Q){this.iv(),Q.property===bn&&this._items.forEach(function(I){Jk(I)})},redraw:function(){this.iv()},addItem:function(C,L){var w=this._items;L==E?w.push(C):w.splice(L,0,C),this.fp(bn,E,w)},removeItem:function(N){if(N)for(var j=this._items,H=0;H<j.length;H++)N===j[H]&&(j.splice(H,1),this.fp(bn,E,j))},removeItemById:function(L){if(L!=E)for(var D=this._items,b=0;b<D.length;b++)if(L===D[b].id){var d=D.splice(b,1)[0];return this.fp(bn,E,D),d}},getItemById:function(H){if(H!=E)for(var Z=this._items,V=0;V<Z.length;V++){var S=Z[V];if(H===S.id)return S}},setItemVisible:function(g,O){var _=this.getItemById(g);_&&(_.visible=O)},getItemInfos:function(){return this._30o},getItemInfoAt:function(p){var D=this,J=0,W=D._30o,e=D.lp(p),r=e.x,Y=e.y;if(Y>=0&&Y<=D.getHeight())for(;J<W.size();J++){var s=W.get(J);if(s.startX<=r&&r<=s.endX)return s}return E},drawItem:function(w,D,d,r,G){if(D.visible===!1)return 0;if(hl(D.visible)&&!D.visible())return 0;var V=this,$=D.disabled;$&&(w.globalAlpha=xg);var T=V.drawItemImpl(w,D,d,r,G),e=V._itemGap;return $&&(w.globalAlpha=1),this._currentItem!==D||"separator"===D||D.separator===!0||D.unfocusable||Wn(w,V._separatorColor,d-e/2,0,T+e,r),T},drawItemImpl:function(n,p,v,Z,R){var I=this,t=I._view,h=I._itemGap,y=Z/2,U=p.type,D=p.element,P=p.label;Xr(D)&&(P=D,D=E);var N,o=I.getLabelFont(p),H=I.getLabelColor(p),k=p.selected,j=_l(p.icon),S=Oh(j,p),c=0,O=S+(P?wr(o,P).width:0);if("separator"===p||p.separator===!0)return Np(n,I._separatorColor,v,Z/4,y),1;if(D){j&&ms(n,j,v+S/2,y,p,I),$c(n,P,o,H,v+S,0,0,Z);var m=Tf(D);R||I._90I.add(m),m.parentNode!==t&&mc(t,m),D.iv&&D.iv(),D.validate&&D.validate();var g=m.getBoundingClientRect(),w=g.width,f=m.style;return qq(m),f.left=I.tx()+v+O+pn,f.top=(Z-g.height)/2+pn,O+w}return U===pk?N=_l(k?rc:Ie):U===Fn&&(N=_l(k?Fn:Xh)),N?(c=Oh(N,p),ms(n,N,v+c/2,y,p,I),v+=c,O+=c):k&&an(n,v-h/2,0,O+h,Z,I.getSelectBackground(p)),j&&ms(n,j,v+S/2,y,p,I),$c(n,P,o,H,v+S,0,0,Z),O},validateImpl:function(){var b=this,w=b._canvas,g=b.getWidth(),L=b.getHeight(),o=b._30o,p=b._items;ob(w,g,L);var D=$l(w),q=b._itemGap,J=q/2;mh(D,b.tx(),0,1),D.clearRect(0,0,g,L);var n=b._90I;b._90I=new Km,o.clear(),p.forEach(function(P){var t=b.drawItem(D,P,J,L);o.add({item:P,startX:J,endX:J+t,width:t}),t&&(J+=t+q)}),n.each(function(G){b._90I.contains(G)||be(G)});var X=b._64I;b._64I=M(0,J),D.restore(),b._stickToRight?(b._65O=0,D=$l(w),J=g-b._64I+q,mh(D,0,0,1),D.clearRect(0,0,g,L),o.clear(),p.forEach(function(r){var V=b.drawItem(D,r,J,L,!0);o.add({item:r,startX:J,endX:J+V,width:V}),V&&(J+=V+q)}),D.restore()):b.tx(b.tx()),X!==b._64I&&b.onSumWidthChanged(X,b._64I)},onSumWidthChanged:function(){},handleClick:function(H,z){var R=this,t=H.type,J=H.action,P=H.groupId,O=H.selected;H.disabled||(P!=E?O||(H.selected=!0,this._items.forEach(function(N){N.groupId===P&&H!==N&&(N.selected=!1)}),J&&H.action(H,R,z)):t===Fn||"toggle"===t?(H.selected=!O,J&&H.action(H,R,z)):J&&H.action(H,R,z)),Zm(),R.iv()}});var Df=function(x){this.tb=x,this.addListeners()};ok(Df,O,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(O){this.handleScroll(O,10*(O.wheelDelta/40))},handle_DOMMouseScroll:function(l){this.handleScroll(l,10*-l.detail)},handleScroll:function(b,k){Gm(b);var I=this.tb;I.isScrollable()&&!I._stickToRight&&(I.tx(I.tx()+k),Gd())},handle_mousemove:function(T){var u=this;tk||u.setItem(T)},handle_mouseout:function(D){var Q=this;D.target===Q.getView()?Q.tb.setCurrentItem(E):Q.handle_mousemove(D)},handle_mousedown:function(b){this.handle_mousemove(b),this.handle_touchstart(b)},handle_touchstart:function(l){var T=this,r=T.tb,V=l.target;Jm(l)&&(V===T.getView()||V===r._canvas)&&(Gm(l),r.setFocus(l)&&(this.setItem(l,!0),(r.isScrollable()||T.info&&!T.info.item.disabled)&&(T.x=ib(l).x,T.tx=r.tx(),ws(T,l))))},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(P){var v=this,H=v.tb;if(!H._stickToRight){var M=ib(P).x-v.x;!v._25o&&a(M)>2&&H.isScrollable()&&(v._25o=1),v._25o&&H.tx(v.tx+M)}},handleWindowMouseUp:function(s){this.handleWindowTouchEnd(s)},handleWindowTouchEnd:function(n){var o=this,p=o.tb,C=o.info,f=o.tb.getItemInfoAt(n);if(!o._25o&&C){var y=C.item;f&&f.item===y&&p.handleClick(y,n)}o._25o=o.x=o.tx=E,o.setItem()},setItem:function(l,A){var o=this,U=o.tb,V=o.info=l?U.getItemInfoAt(l):E,L=V?V.item:E;U.setCurrentItem(L),A&&L&&hl(L.onDown)&&L.onDown(l)}}),bs.BorderPane=function(){this._view=sj(1,this),this.iv()},$m("BorderPane",O,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(y,f){this._12o("leftView",y),f!=E&&this.setLeftWidth(f)},getRightView:function(){return this._rightView},setRightView:function(F,q){this._12o("rightView",F),q!=E&&this.setRightWidth(q)},getTopView:function(){return this._topView},setTopView:function(Z,K){this._12o("topView",Z),K!=E&&this.setTopHeight(K)},getBottomView:function(){return this._bottomView},setBottomView:function(v,L){this._12o("bottomView",v),L!=E&&this.setBottomHeight(L)},getCenterView:function(){return this._centerView},setCenterView:function(d){this._12o("centerView",d)},_12o:function(L,v){var p=this,x="_"+L,w=p._view,U=p[x];U!==v&&(U&&(U.getView?be(U.getView()):be(U)),p[x]=v,v&&(v.getView?mc(w,v.getView(),1):mc(w,v,1)),p.fp(L,U,v))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var b=this,D=b._topView,R=b._bottomView,y=b._leftView,w=b._rightView,B=b._centerView,f=b.getWidth(),Z=b.getHeight(),W=0,I=0,S=f,i=Z,n=0,F=0,O=0,c=0;D&&(n=b._topHeight==E?ll(D):b._topHeight,I=n),R&&(F=b._bottomHeight==E?ll(R):b._bottomHeight,i=Z-F),y&&(O=b._leftWidth==E?ag(y):b._leftWidth,W=O),w&&(c=b._rightWidth==E?ag(w):b._rightWidth,S=f-c);var N=M(0,S-W),s=M(0,i-I);D&&qh(D,0,0,f,n),R&&qh(R,0,i,f,F),y&&qh(y,0,I,O,s),w&&qh(w,S,I,c,s),B&&qh(B,W,I,N,s)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);